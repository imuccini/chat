(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68689,e=>{"use strict";let t,r,n,i,s,o,a,l,u;var c,d,h,p,f,m,g,y,v,b,x,w,_=e.i(43476),T=e.i(71645),S=e.i(18566);let E=Object.create(null);E.open="0",E.close="1",E.ping="2",E.pong="3",E.message="4",E.upgrade="5",E.noop="6";let k=Object.create(null);Object.keys(E).forEach(e=>{k[E[e]]=e});let z={type:"error",data:"parser error"},R="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),I="function"==typeof ArrayBuffer,O=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,C=({type:e,data:t},r,n)=>{if(R&&t instanceof Blob)if(r)return n(t);else return j(t,n);if(I&&(t instanceof ArrayBuffer||O(t)))if(r)return n(t);else return j(new Blob([t]),n);return n(E[e]+(t||""))},j=(e,t)=>{let r=new FileReader;return r.onload=function(){t("b"+(r.result.split(",")[1]||""))},r.readAsDataURL(e)};function A(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$="u"<typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<N.length;e++)$[N.charCodeAt(e)]=e;let P="function"==typeof ArrayBuffer,L=(e,t)=>{if("string"!=typeof e)return{type:"message",data:M(e,t)};let r=e.charAt(0);return"b"===r?{type:"message",data:B(e.substring(1),t)}:k[r]?e.length>1?{type:k[r],data:e.substring(1)}:{type:k[r]}:z},B=(e,t)=>P?M((e=>{let t=.75*e.length,r=e.length,n,i=0,s,o,a,l;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let u=new ArrayBuffer(t),c=new Uint8Array(u);for(n=0;n<r;n+=4)s=$[e.charCodeAt(n)],o=$[e.charCodeAt(n+1)],a=$[e.charCodeAt(n+2)],l=$[e.charCodeAt(n+3)],c[i++]=s<<2|o>>4,c[i++]=(15&o)<<4|a>>2,c[i++]=(3&a)<<6|63&l;return u})(e),t):{base64:!0,data:e},M=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer;function D(e){return e.reduce((e,t)=>e+t.length,0)}function H(e,t){if(e[0].length===t)return e.shift();let r=new Uint8Array(t),n=0;for(let i=0;i<t;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function F(e){if(e){var t=e;for(var r in F.prototype)t[r]=F.prototype[r];return t}}F.prototype.on=F.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},F.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},F.prototype.off=F.prototype.removeListener=F.prototype.removeAllListeners=F.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},F.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,t)}return this},F.prototype.emitReserved=F.prototype.emit,F.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},F.prototype.hasListeners=function(e){return!!this.listeners(e).length};let U="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Z="u">typeof self?self:"u">typeof window?window:Function("return this")();function W(e,...t){return t.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}let V=Z.setTimeout,q=Z.clearTimeout;function G(e,t){t.useNativeTimers?(e.setTimeoutFn=V.bind(Z),e.clearTimeoutFn=q.bind(Z)):(e.setTimeoutFn=Z.setTimeout.bind(Z),e.clearTimeoutFn=Z.clearTimeout.bind(Z))}function J(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class Q extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class K extends F{constructor(e){super(),this.writable=!1,G(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new Q(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=L(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return -1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){let t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}class Y extends K{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};((e,t)=>{let r=e.split("\x1e"),n=[];for(let e=0;e<r.length;e++){let i=L(r[e],t);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){let e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){var t;let r,n,i;this.writable=!1,t=e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})},n=Array(r=e.length),i=0,e.forEach((e,s)=>{C(e,!1,e=>{n[s]=e,++i===r&&t(n.join("\x1e"))})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=J()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let X=!1;try{X="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}let ee=X;function et(){}class er extends Y{constructor(e){if(super(e),"u">typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="u">typeof location&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class en extends F{constructor(e,t,r){super(),this.createRequest=e,G(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var e;let t=W(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let e in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this._opts.extraHeaders[e])}catch(e){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}null==(e=this._opts.cookieJar)||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null==(e=this._opts.cookieJar)||e.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof r.status?r.status:0)},0))},r.send(this._data)}catch(e){this.setTimeoutFn(()=>{this._onError(e)},0);return}"u">typeof document&&(this._index=en.requestsCount++,en.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=et,e)try{this._xhr.abort()}catch(e){}"u">typeof document&&delete en.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function ei(){for(let e in en.requests)en.requests.hasOwnProperty(e)&&en.requests[e].abort()}en.requestsCount=0,en.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",ei):"function"==typeof addEventListener&&addEventListener("onpagehide"in Z?"pagehide":"unload",ei,!1));let es=(n=eo({xdomain:!1}))&&null!==n.responseType;function eo(e){let t=e.xdomain;try{if("u">typeof XMLHttpRequest&&(!t||ee))return new XMLHttpRequest}catch(e){}if(!t)try{return new Z[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}let ea="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class el extends K{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,r=ea?{}:W(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;C(r,this.supportsBinary,e=>{try{this.doWrite(r,e)}catch(e){}n&&U(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=J()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}let eu=Z.WebSocket||Z.MozWebSocket,ec={websocket:class extends el{createSocket(e,t,r){return ea?new eu(e,t,r):t?new eu(e,t):new eu(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends K{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{var n,i;let s,o,a,l,u=(n=Number.MAX_SAFE_INTEGER,i=this.socket.binaryType,r||(r=new TextDecoder),s=[],o=0,a=-1,l=!1,new TransformStream({transform(e,t){for(s.push(e);;){if(0===o){if(1>D(s))break;let e=H(s,1);l=(128&e[0])==128,o=(a=127&e[0])<126?3:126===a?1:2}else if(1===o){if(2>D(s))break;let e=H(s,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),o=3}else if(2===o){if(8>D(s))break;let e=H(s,8),r=new DataView(e.buffer,e.byteOffset,e.length),n=r.getUint32(0);if(n>2097151){t.enqueue(z);break}a=0x100000000*n+r.getUint32(4),o=3}else{if(D(s)<a)break;let e=H(s,a);t.enqueue(L(l?e:r.decode(e),i)),o=0}if(0===a||a>n){t.enqueue(z);break}}}})),c=e.readable.pipeThrough(u).getReader(),d=new TransformStream({transform(e,r){var n;n=t=>{let n,i=t.length;if(i<126)new DataView((n=new Uint8Array(1)).buffer).setUint8(0,i);else if(i<65536){let e=new DataView((n=new Uint8Array(3)).buffer);e.setUint8(0,126),e.setUint16(1,i)}else{let e=new DataView((n=new Uint8Array(9)).buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(n[0]|=128),r.enqueue(n),r.enqueue(t)},R&&e.data instanceof Blob?e.data.arrayBuffer().then(A).then(n):I&&(e.data instanceof ArrayBuffer||O(e.data))?n(A(e.data)):C(e,!1,e=>{t||(t=new TextEncoder),n(t.encode(e))})}});d.readable.pipeTo(e.writable),this._writer=d.writable.getWriter();let h=()=>{c.read().then(({done:e,value:t})=>{e||(this.onPacket(t),h())}).catch(e=>{})};h();let p={type:"open"};this.query.sid&&(p.data=`{"sid":"${this.query.sid}"}`),this._writer.write(p).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;this._writer.write(r).then(()=>{n&&U(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null==(e=this._transport)||e.close()}},polling:class extends er{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=es&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new en(eo,this.uri(),e)}}},ed=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eh=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ep(e){var t,r;let n,i;if(e.length>8e3)throw"URI too long";let s=e,o=e.indexOf("["),a=e.indexOf("]");-1!=o&&-1!=a&&(e=e.substring(0,o)+e.substring(o,a).replace(/:/g,";")+e.substring(a,e.length));let l=ed.exec(e||""),u={},c=14;for(;c--;)u[eh[c]]=l[c]||"";return -1!=o&&-1!=a&&(u.source=s,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),n=(t=u.path).replace(/\/{2,9}/g,"/").split("/"),("/"==t.slice(0,1)||0===t.length)&&n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),u.pathNames=n,r=u.query,i={},r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(i[t]=r)}),u.queryKey=i,u}let ef="function"==typeof addEventListener&&"function"==typeof removeEventListener,em=[];ef&&addEventListener("offline",()=>{em.forEach(e=>e())},!1);class eg extends F{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const r=ep(e);t.hostname=r.host,t.secure="https"===r.protocol||"wss"===r.protocol,t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=ep(t.host).host);G(this,t),this.secure=null!=t.secure?t.secure:"u">typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("u">typeof location?location.hostname:"localhost"),this.port=t.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{let t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),ef&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},em.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);let e=this.opts.rememberUpgrade&&eg.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",eg.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r&&(e+="string"==typeof r?function(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(r):Math.ceil(1.33*(r.byteLength||r.size))),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,U(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(eg.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ef&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let e=em.indexOf(this._offlineEventListener);-1!==e&&em.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}eg.protocol=4;class ey extends eg{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;eg.priorWebsocketSuccess=!1;let n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;eg.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{r||"closed"!==this.readyState&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{let e=Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function i(){r||(r=!0,u(),t.close(),t=null)}let s=e=>{let r=Error("probe error: "+e);r.transport=t.name,i(),this.emitReserved("upgradeError",r)};function o(){s("transport closed")}function a(){s("socket closed")}function l(e){t&&e.name!==t.name&&i()}let u=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",o),this.off("close",a),this.off("upgrading",l)};t.once("open",n),t.once("error",s),t.once("close",o),this.once("close",a),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}class ev extends ey{constructor(e,t={}){const r="object"==typeof e?e:t;(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(e=>ec[e]).filter(e=>!!e)),super(e,r)}}ev.protocol;let eb="function"==typeof ArrayBuffer,ex=Object.prototype.toString,ew="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===ex.call(Blob),e_="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===ex.call(File);function eT(e){return eb&&(e instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer))||ew&&e instanceof Blob||e_&&e instanceof File}let eS=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];(c=g||(g={}))[c.CONNECT=0]="CONNECT",c[c.DISCONNECT=1]="DISCONNECT",c[c.EVENT=2]="EVENT",c[c.ACK=3]="ACK",c[c.CONNECT_ERROR=4]="CONNECT_ERROR",c[c.BINARY_EVENT=5]="BINARY_EVENT",c[c.BINARY_ACK=6]="BINARY_ACK";class eE{constructor(e){this.replacer=e}encode(e){return(e.type===g.EVENT||e.type===g.ACK)&&function e(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(e(t[r]))return!0;return!1}if(eT(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)?this.encodeAsBinary({type:e.type===g.EVENT?g.BINARY_EVENT:g.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===g.BINARY_EVENT||e.type===g.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t,r,n=(t=[],r=e.data,e.data=function e(t,r){if(!t)return t;if(eT(t)){let e={_placeholder:!0,num:r.length};return r.push(t),e}if(Array.isArray(t)){let n=Array(t.length);for(let i=0;i<t.length;i++)n[i]=e(t[i],r);return n}if("object"==typeof t&&!(t instanceof Date)){let n={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e(t[i],r));return n}return t}(r,t),e.attachments=t.length,{packet:e,buffers:t}),i=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(i),s}}class ek extends F{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let r=(t=this.decodeString(e)).type===g.BINARY_EVENT;r||t.type===g.BINARY_ACK?(t.type=r?g.EVENT:g.ACK,this.reconstructor=new ez(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(eT(e)||e.base64)if(this.reconstructor)(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(void 0===g[r.type])throw Error("unknown packet type "+r.type);if(r.type===g.BINARY_EVENT||r.type===g.BINARY_ACK){let n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);let i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){let n=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(n,t)}else r.nsp="/";let n=e.charAt(t+1);if(""!==n&&Number(n)==n){let n=t+1;for(;++t;){let r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){let n=this.tryParse(e.substr(t));if(ek.isPayloadValid(r.type,n))r.data=n;else throw Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case g.CONNECT:return eI(t);case g.DISCONNECT:return void 0===t;case g.CONNECT_ERROR:return"string"==typeof t||eI(t);case g.EVENT:case g.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===eS.indexOf(t[0]));case g.ACK:case g.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ez{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t,r;let e=(t=this.reconPack,r=this.buffers,t.data=function e(t,r){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<r.length)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=e(t[n],r);else if("object"==typeof t)for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e(t[n],r));return t}(t.data,r),delete t.attachments,t);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}let eR=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function eI(e){return"[object Object]"===Object.prototype.toString.call(e)}function eO(e){var t;return"string"==typeof e.nsp&&(void 0===(t=e.id)||eR(t))&&function(e,t){switch(e){case g.CONNECT:return void 0===t||eI(t);case g.DISCONNECT:return void 0===t;case g.EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===eS.indexOf(t[0]));case g.ACK:return Array.isArray(t);case g.CONNECT_ERROR:return"string"==typeof t||eI(t);default:return!1}}(e.type,e.data)}function eC(e,t,r){return e.on(t,r),function(){e.off(t,r)}}e.s(["Decoder",()=>ek,"Encoder",()=>eE,"PacketType",()=>g,"isPacketValid",()=>eO,"protocol",0,5],51890);let ej=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class eA extends F{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[eC(e,"open",this.onopen.bind(this)),eC(e,"packet",this.onpacket.bind(this)),eC(e,"error",this.onerror.bind(this)),eC(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,n,i;if(ej.hasOwnProperty(e))throw Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let s={type:g.EVENT,data:t};if(s.options={},s.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){let e=this.ids++,r=t.pop();this._registerAckCallback(e,r),s.id=e}let o=null==(n=null==(r=this.io.engine)?void 0:r.transport)?void 0:n.writable,a=this.connected&&!(null==(i=this.io.engine)?void 0:i._hasPingExpired());return this.flags.volatile&&!o||(a?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var r;let n=null!=(r=this.flags.timeout)?r:this._opts.ackTimeout;if(void 0===n){this.acks[e]=t;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,Error("operation has timed out"))},n),s=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,e)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...t){return new Promise((r,n)=>{let i=(e,t)=>e?n(e):r(t);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...n)=>(this._queue[0],null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;let t=this._queue[0];(!t.pending||e)&&(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:g.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case g.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case g.EVENT:case g.BINARY_EVENT:this.onevent(e);break;case g.ACK:case g.BINARY_ACK:this.onack(e);break;case g.DISCONNECT:this.ondisconnect();break;case g.CONNECT_ERROR:this.destroy();let t=Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){let t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(let t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...n){r||(r=!0,t.packet({type:g.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:g.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}var eN=e.i(51890);function e$(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e$.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(1&Math.floor(10*t))==0?e-r:e+r}return 0|Math.min(e,this.max)},e$.prototype.reset=function(){this.attempts=0},e$.prototype.setMin=function(e){this.ms=e},e$.prototype.setMax=function(e){this.max=e},e$.prototype.setJitter=function(e){this.jitter=e};class eP extends F{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,G(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(r=t.randomizationFactor)?r:.5),this.backoff=new e$({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||eN;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null==(t=this.backoff)||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null==(t=this.backoff)||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null==(t=this.backoff)||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ev(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=eC(t,"open",function(){r.onopen(),e&&e()}),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=eC(t,"error",i);if(!1!==this._timeout){let e=this._timeout,r=this.setTimeoutFn(()=>{n(),i(Error("timeout")),t.close()},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(eC(e,"ping",this.onping.bind(this)),eC(e,"data",this.ondata.bind(this)),eC(e,"error",this.onerror.bind(this)),eC(e,"close",this.onclose.bind(this)),eC(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){U(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new eA(this,e,t),this.nsps[e]=r),r}_destroy(e){for(let e of Object.keys(this.nsps))if(this.nsps[e].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),null==(r=this.engine)||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}let eL={};function eB(e,t){let r;"object"==typeof e&&(t=e,e=void 0);let n=function(e,t="",r){let n=e;r=r||"u">typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=ep(e)),!n.port&&(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),i=n.source,s=n.id,o=n.path,a=eL[s]&&o in eL[s].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?r=new eP(i,t):(eL[s]||(eL[s]=new eP(i,t)),r=eL[s]),n.query&&!t.query&&(t.query=n.queryKey),r.socket(n.path,t)}Object.assign(eB,{Manager:eP,Socket:eA,io:eB,connect:eB});var eM=e.i(41533),eD=e.i(75555),eH=e.i(40143),eF=e.i(86491),eU=e.i(15823),eZ=e.i(93803),eW=e.i(19273),eV=e.i(80166),eq=class extends eU.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,eZ.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#n=void 0;#i=void 0;#s=void 0;#o;#a;#r;#t;#l;#u;#c;#d;#h;#p;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#n.addObserver(this),eG(this.#n,this.options)?this.#m():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return eJ(this.#n,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return eJ(this.#n,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#v(),this.#n.removeObserver(this)}setOptions(e){let t=this.options,r=this.#n;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,eW.resolveEnabled)(this.options.enabled,this.#n))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#n.setOptions(this.options),t._defaulted&&!(0,eW.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#n,observer:this});let n=this.hasListeners();n&&eQ(this.#n,r,this.options,t)&&this.#m(),this.updateResult(),n&&(this.#n!==r||(0,eW.resolveEnabled)(this.options.enabled,this.#n)!==(0,eW.resolveEnabled)(t.enabled,this.#n)||(0,eW.resolveStaleTime)(this.options.staleTime,this.#n)!==(0,eW.resolveStaleTime)(t.staleTime,this.#n))&&this.#x();let i=this.#w();n&&(this.#n!==r||(0,eW.resolveEnabled)(this.options.enabled,this.#n)!==(0,eW.resolveEnabled)(t.enabled,this.#n)||i!==this.#p)&&this.#_(i)}getOptimisticResult(e){var t,r;let n=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(n,e);return t=this,r=i,(0,eW.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#s=i,this.#a=this.options,this.#o=this.#n.state),i}getCurrentResult(){return this.#s}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#n}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#m(e){this.#b();let t=this.#n.fetch(this.options,e);return e?.throwOnError||(t=t.catch(eW.noop)),t}#x(){this.#y();let e=(0,eW.resolveStaleTime)(this.options.staleTime,this.#n);if(eW.isServer||this.#s.isStale||!(0,eW.isValidTimeout)(e))return;let t=(0,eW.timeUntilStale)(this.#s.dataUpdatedAt,e);this.#d=eV.timeoutManager.setTimeout(()=>{this.#s.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#n):this.options.refetchInterval)??!1}#_(e){this.#v(),this.#p=e,!eW.isServer&&!1!==(0,eW.resolveEnabled)(this.options.enabled,this.#n)&&(0,eW.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=eV.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||eD.focusManager.isFocused())&&this.#m()},this.#p))}#g(){this.#x(),this.#_(this.#w())}#y(){this.#d&&(eV.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#v(){this.#h&&(eV.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,n=this.#n,i=this.options,s=this.#s,o=this.#o,a=this.#a,l=e!==n?e.state:this.#i,{state:u}=e,c={...u},d=!1;if(t._optimisticResults){let r=this.hasListeners(),s=!r&&eG(e,t),o=r&&eQ(e,n,t,i);(s||o)&&(c={...c,...(0,eF.fetchState)(u.data,e.options)}),"isRestoring"===t._optimisticResults&&(c.fetchStatus="idle")}let{error:h,errorUpdatedAt:p,status:f}=c;r=c.data;let m=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===f){let e;s?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(e=s.data,m=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(f="success",r=(0,eW.replaceData)(s?.data,e,t),d=!0)}if(t.select&&void 0!==r&&!m)if(s&&r===o?.data&&t.select===this.#l)r=this.#u;else try{this.#l=t.select,r=t.select(r),r=(0,eW.replaceData)(s?.data,r,t),this.#u=r,this.#t=null}catch(e){this.#t=e}this.#t&&(h=this.#t,r=this.#u,p=Date.now(),f="error");let g="fetching"===c.fetchStatus,y="pending"===f,v="error"===f,b=y&&g,x=void 0!==r,w={status:f,fetchStatus:c.fetchStatus,isPending:y,isSuccess:"success"===f,isError:v,isInitialLoading:b,isLoading:b,data:r,dataUpdatedAt:c.dataUpdatedAt,error:h,errorUpdatedAt:p,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>l.dataUpdateCount||c.errorUpdateCount>l.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:v&&!x,isPaused:"paused"===c.fetchStatus,isPlaceholderData:d,isRefetchError:v&&x,isStale:eK(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,eW.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==w.data,r="error"===w.status&&!t,i=e=>{r?e.reject(w.error):t&&e.resolve(w.data)},s=()=>{i(this.#r=w.promise=(0,eZ.pendingThenable)())},o=this.#r;switch(o.status){case"pending":e.queryHash===n.queryHash&&i(o);break;case"fulfilled":(r||w.data!==o.value)&&s();break;case"rejected":r&&w.error===o.reason||s()}}return w}updateResult(){let e=this.#s,t=this.createResult(this.#n,this.options);if(this.#o=this.#n.state,this.#a=this.options,void 0!==this.#o.data&&(this.#c=this.#n),(0,eW.shallowEqualObjects)(t,e))return;this.#s=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;let n=new Set(r??this.#f);return this.options.throwOnError&&n.add("error"),Object.keys(this.#s).some(t=>this.#s[t]!==e[t]&&n.has(t))};this.#T({listeners:r()})}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#n)return;let t=this.#n;this.#n=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#T(e){eH.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#n,type:"observerResultsUpdated"})})}};function eG(e,t){return!1!==(0,eW.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&eJ(e,t,t.refetchOnMount)}function eJ(e,t,r){if(!1!==(0,eW.resolveEnabled)(t.enabled,e)&&"static"!==(0,eW.resolveStaleTime)(t.staleTime,e)){let n="function"==typeof r?r(e):r;return"always"===n||!1!==n&&eK(e,t)}return!1}function eQ(e,t,r,n){return(e!==t||!1===(0,eW.resolveEnabled)(n.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&eK(e,r)}function eK(e,t){return!1!==(0,eW.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,eW.resolveStaleTime)(t.staleTime,e))}var eY=e.i(47167),eX=e.i(12598),e0=T.createContext((i=!1,{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i})),e1=T.createContext(!1);e1.Provider;var e2=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()}),e4=e.i(82568);(0,e4.registerPlugin)("CapacitorSQLite",{web:()=>e.A(29126).then(e=>new e.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite});let e5=new class{sqlite=null;db=null;dbName="chat_cache";async initialize(){console.log("SQLite: Disabled for debugging.")}async saveMessage(e,t=!0){if(this.db||await this.initialize(),!this.db)return;let r=`
            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, isGlobal)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?);
        `,n=[e.id,e.text,e.senderId,e.senderAlias,e.senderGender,e.timestamp,e.recipientId||null,+!!t];try{await this.db.run(r,n)}catch(e){console.error("Error saving message to SQLite:",e)}}async getMessages(e=!0,t){if(this.db||await this.initialize(),!this.db)return[];let r="",n=[];e?r="SELECT * FROM messages WHERE isGlobal = 1 ORDER BY timestamp ASC LIMIT 100;":(r="SELECT * FROM messages WHERE isGlobal = 0 AND (recipientId = ? OR senderId = ?) ORDER BY timestamp ASC LIMIT 100;",n=[t,t]);try{return((await this.db.query(r,n)).values||[]).map(e=>({...e,isGlobal:void 0}))}catch(e){return console.error("Error fetching messages from SQLite:",e),[]}}async clearMessages(){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages;",[])}catch(e){console.error("Error clearing messages from SQLite:",e)}}async getPrivateChats(e){if(this.db||await this.initialize(),!this.db)return[];try{let t=((await this.db.query("SELECT * FROM messages WHERE isGlobal = 0 ORDER BY timestamp ASC;",[])).values||[]).map(e=>({id:e.id,text:e.text,senderId:e.senderId,senderAlias:e.senderAlias,senderGender:e.senderGender,timestamp:e.timestamp,recipientId:e.recipientId})),r=new Map;for(let n of t){let t=n.senderId===e?n.recipientId:n.senderId;r.has(t)||r.set(t,[]),r.get(t).push(n)}return Array.from(r.entries()).map(([e,t])=>({peerId:e,messages:t}))}catch(e){return console.error("Error loading private chats from SQLite:",e),[]}}};(d=y||(y={})).Dark="DARK",d.Light="LIGHT",d.Default="DEFAULT",(h=v||(v={})).Body="body",h.Ionic="ionic",h.Native="native",h.None="none";let e6=(0,e4.registerPlugin)("Keyboard");var e3=e.i(67065);let e9=(0,e4.registerPlugin)("Haptics",{web:()=>e.A(19924).then(e=>new e.HapticsWeb)});(p=b||(b={})).Dark="DARK",p.Light="LIGHT",p.Default="DEFAULT",(f=x||(x={})).None="NONE",f.Slide="SLIDE",f.Fade="FADE";let e8=(0,e4.registerPlugin)("StatusBar"),e7=Object.create(null),te=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?e7:globalThis),tt=new Proxy(e7,{get:(e,t)=>te()[t]??e7[t],has:(e,t)=>t in te()||t in e7,set:(e,t,r)=>(te(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=te(!0);return delete r[t],!0},ownKeys:()=>Object.keys(te(!0))});function tr(e,t){return void 0!==eY.default&&eY.default.env?eY.default.env[e]??t:"u">typeof Deno?Deno.env.get(e)??t:"u">typeof Bun?Bun.env[e]??t:t}void 0!==eY.default&&eY.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return tr("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return tr("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return tr("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return tr("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return tr("NODE_ENV","development")},get PACKAGE_VERSION(){return tr("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return tr("BETTER_AUTH_TELEMETRY_ENDPOINT","")}});let tn={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},ti=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),ts=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],to="\x1b[0m",ta="\x1b[31m",tl="\x1b[32m",tu="\x1b[33m",tc="\x1b[34m",td="\x1b[35m",th=["debug","info","success","warn","error"],tp={info:tc,success:tl,warn:tu,error:ta,debug:td};function tf(e,t,r){function n(r,n){if(r._zod||Object.defineProperty(r,"_zod",{value:{def:n,constr:o,traits:new Set},enumerable:!1}),r._zod.traits.has(e))return;r._zod.traits.add(e),t(r,n);let i=o.prototype,s=Object.keys(i);for(let e=0;e<s.length;e++){let t=s[e];t in r||(r[t]=i[t].bind(r))}}let i=r?.Parent??Object;class s extends i{}function o(e){var t;let i=r?.Parent?new s:this;for(let r of(n(i,e),(t=i._zod).deferred??(t.deferred=[]),i._zod.deferred))r();return i}return Object.defineProperty(s,"name",{value:e}),Object.defineProperty(o,"init",{value:n}),Object.defineProperty(o,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(o,"name",{value:e}),o}s=m?.disabled!==!0,o=m?.level??"warn",a=m?.disableColors!==void 0?!m.disableColors:1!==function(){if(void 0!==tr("FORCE_COLOR"))switch(tr("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==tr("NODE_DISABLE_COLORS")&&""!==tr("NODE_DISABLE_COLORS")||void 0!==tr("NO_COLOR")&&""!==tr("NO_COLOR")||"dumb"===tr("TERM"))return 1;if(tr("TMUX"))return 24;if("TF_BUILD"in tt&&"AGENT_NAME"in tt)return 4;if("CI"in tt){for(let{0:e,1:t}of ti)if(e in tt)return t;return"codeship"===tr("CI_NAME")?8:1}if("TEAMCITY_VERSION"in tt)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(tr("TEAMCITY_VERSION"))?4:1;switch(tr("TERM_PROGRAM")){case"iTerm.app":if(!tr("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(tr("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===tr("COLORTERM")||"24bit"===tr("COLORTERM"))return 24;if(tr("TERM")){if(null!==/truecolor/.exec(tr("TERM")))return 24;if(null!==/^xterm-256/.exec(tr("TERM")))return 8;let e=tr("TERM").toLowerCase();if(tn[e])return tn[e];if(ts.some(t=>null!==t.exec(e)))return 4}return tr("COLORTERM")?4:1}(),Object.fromEntries(th.map(e=>[e,(...[t,...r])=>((e,t,r=[])=>{let n;if(!s||!(th.indexOf(e)>=th.indexOf(o)))return;let i=(n=new Date().toISOString(),a?`\x1b[2m${n}${to} ${tp[e]}${e.toUpperCase()}${to} \x1b[1m[Better Auth]:${to} ${t}`:`${n} ${e.toUpperCase()} [Better Auth]: ${t}`);m&&"function"==typeof m.log?m.log("success"===e?"info":e,t,...r):"error"===e?console.error(i,...r):"warn"===e?console.warn(i,...r):console.log(i,...r)})(e,t,r)])),Object.freeze({status:"aborted"}),Symbol("zod_brand");class tm extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class tg extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let ty={};function tv(e){return e&&Object.assign(ty,e),ty}function tb(e){return e}function tx(e){return e}function tw(e){}function t_(e){throw Error("Unexpected value in exhaustive check")}function tT(e){}function tS(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function tE(e,t="|"){return e.map(e=>t0(e)).join(t)}function tk(e,t){return"bigint"==typeof t?t.toString():t}function tz(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function tR(e){return null==e}function tI(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function tO(e,t){let r=(e.toString().split(".")[1]||"").length,n=t.toString(),i=(n.split(".")[1]||"").length;if(0===i&&/\d?e-\d?/.test(n)){let e=n.match(/\d?e-(\d?)/);e?.[1]&&(i=Number.parseInt(e[1]))}let s=r>i?r:i;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}let tC=Symbol("evaluating");function tj(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==tC)return void 0===n&&(n=tC,n=r()),n},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function tA(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function tN(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function t$(...e){let t={};for(let r of e)Object.assign(t,Object.getOwnPropertyDescriptors(r));return Object.defineProperties({},t)}function tP(e){return t$(e._zod.def)}function tL(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function tB(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r})}function tM(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function tD(e){return JSON.stringify(e)}function tH(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let tF="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function tU(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let tZ=tz(()=>{if("u">typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function tW(e){if(!1===tU(e))return!1;let t=e.constructor;if(void 0===t||"function"!=typeof t)return!0;let r=t.prototype;return!1!==tU(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function tV(e){return tW(e)?{...e}:Array.isArray(e)?[...e]:e}function tq(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}let tG=new Set(["string","number","symbol"]),tJ=new Set(["string","number","bigint","boolean","symbol","undefined"]);function tQ(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tK(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function tY(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function tX(e){let t;return new Proxy({},{get:(r,n,i)=>(t??(t=e()),Reflect.get(t,n,i)),set:(r,n,i,s)=>(t??(t=e()),Reflect.set(t,n,i,s)),has:(r,n)=>(t??(t=e()),Reflect.has(t,n)),deleteProperty:(r,n)=>(t??(t=e()),Reflect.deleteProperty(t,n)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,n)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)),defineProperty:(r,n,i)=>(t??(t=e()),Reflect.defineProperty(t,n,i))})}function t0(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function t1(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let t2={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},t4={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function t5(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".pick() cannot be used on object schemas containing refinements");let i=t$(e._zod.def,{get shape(){let e={};for(let n in t){if(!(n in r.shape))throw Error(`Unrecognized key: "${n}"`);t[n]&&(e[n]=r.shape[n])}return tN(this,"shape",e),e},checks:[]});return tK(e,i)}function t6(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".omit() cannot be used on object schemas containing refinements");let i=t$(e._zod.def,{get shape(){let n={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete n[e]}return tN(this,"shape",n),n},checks:[]});return tK(e,i)}function t3(e,t){if(!tW(t))throw Error("Invalid input to extend: expected a plain object");let r=e._zod.def.checks;if(r&&r.length>0){let r=e._zod.def.shape;for(let e in t)if(void 0!==Object.getOwnPropertyDescriptor(r,e))throw Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}let n=t$(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tN(this,"shape",r),r}});return tK(e,n)}function t9(e,t){if(!tW(t))throw Error("Invalid input to safeExtend: expected a plain object");let r=t$(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tN(this,"shape",r),r}});return tK(e,r)}function t8(e,t){let r=t$(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return tN(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return tK(e,r)}function t7(e,t,r){let n=t._zod.def.checks;if(n&&n.length>0)throw Error(".partial() cannot be used on object schemas containing refinements");let i=t$(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)i[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return tN(this,"shape",i),i},checks:[]});return tK(t,i)}function re(e,t,r){let n=t$(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in i))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)i[t]=new e({type:"nonoptional",innerType:n[t]});return tN(this,"shape",i),i}});return tK(t,n)}function rt(e,t=0){if(!0===e.aborted)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function rr(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function rn(e){return"string"==typeof e?e:e?.message}function ri(e,t,r){let n={...e,path:e.path??[]};return e.message||(n.message=rn(e.inst?._zod.def?.error?.(e))??rn(t?.error?.(e))??rn(r.customError?.(e))??rn(r.localeError?.(e))??"Invalid input"),delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function rs(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function ro(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function ra(e){let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":if(null===e)return"null";if(Array.isArray(e))return"array";if(e&&Object.getPrototypeOf(e)!==Object.prototype&&"constructor"in e&&e.constructor)return e.constructor.name}return t}function rl(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}}function ru(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function rc(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function rd(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function rh(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return rc(t+r)}function rp(e){return rd(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function rf(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=Number.parseInt(t.slice(e,e+2),16);return r}function rm(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class rg{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,t4,"Class",()=>rg,"NUMBER_FORMAT_RANGES",0,t2,"aborted",()=>rt,"allowsEval",0,tZ,"assert",()=>tT,"assertEqual",()=>tb,"assertIs",()=>tw,"assertNever",()=>t_,"assertNotEqual",()=>tx,"assignProp",()=>tN,"base64ToUint8Array",()=>rc,"base64urlToUint8Array",()=>rh,"cached",()=>tz,"captureStackTrace",0,tF,"cleanEnum",()=>ru,"cleanRegex",()=>tI,"clone",()=>tK,"cloneDef",()=>tP,"createTransparentProxy",()=>tX,"defineLazy",()=>tj,"esc",()=>tD,"escapeRegex",()=>tQ,"extend",()=>t3,"finalizeIssue",()=>ri,"floatSafeRemainder",()=>tO,"getElementAtPath",()=>tL,"getEnumValues",()=>tS,"getLengthableOrigin",()=>ro,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("u">typeof Map&&e instanceof Map)return"map";if("u">typeof Set&&e instanceof Set)return"set";if("u">typeof Date&&e instanceof Date)return"date";if("u">typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>rs,"hexToUint8Array",()=>rf,"isObject",()=>tU,"isPlainObject",()=>tW,"issue",()=>rl,"joinValues",()=>tE,"jsonStringifyReplacer",()=>tk,"merge",()=>t8,"mergeDefs",()=>t$,"normalizeParams",()=>tY,"nullish",()=>tR,"numKeys",()=>tq,"objectClone",()=>tA,"omit",()=>t6,"optionalKeys",()=>t1,"parsedType",()=>ra,"partial",()=>t7,"pick",()=>t5,"prefixIssues",()=>rr,"primitiveTypes",0,tJ,"promiseAllObject",()=>tB,"propertyKeyTypes",0,tG,"randomString",()=>tM,"required",()=>re,"safeExtend",()=>t9,"shallowClone",()=>tV,"slugify",()=>tH,"stringifyPrimitive",()=>t0,"uint8ArrayToBase64",()=>rd,"uint8ArrayToBase64url",()=>rp,"uint8ArrayToHex",()=>rm,"unwrapMessage",()=>rn],22143);let ry=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,tk,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},rv=tf("$ZodError",ry),rb=tf("$ZodError",ry,{Parent:Error}),rx=e=>(t,r,n,i)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},o=t._zod.run({value:r,issues:[]},s);if(o instanceof Promise)throw new tm;if(o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>ri(e,s,tv())));throw tF(t,i?.callee),t}return o.value},rw=rx(rb),r_=e=>async(t,r,n,i)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=t._zod.run({value:r,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>ri(e,s,tv())));throw tF(t,i?.callee),t}return o.value},rT=r_(rb),rS=e=>(t,r,n)=>{let i=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},i);if(s instanceof Promise)throw new tm;return s.issues.length?{success:!1,error:new(e??rv)(s.issues.map(e=>ri(e,i,tv())))}:{success:!0,data:s.value}},rE=rS(rb),rk=e=>async(t,r,n)=>{let i=n?Object.assign(n,{async:!0}):{async:!0},s=t._zod.run({value:r,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(e=>ri(e,i,tv())))}:{success:!0,data:s.value}},rz=rk(rb),rR=/^[cC][^\s-]{8,}$/,rI=/^[0-9a-z]+$/,rO=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,rC=/^[0-9a-vA-V]{20}$/,rj=/^[A-Za-z0-9]{27}$/,rA=/^[a-zA-Z0-9_-]{21}$/,rN=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,r$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,rP=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,rL=rP(4),rB=rP(6),rM=rP(7),rD=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,rH=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function rF(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let rU=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rZ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,rW=e=>{let t=tQ(e??":");return RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},rV=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,rq=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rG=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,rJ=/^[A-Za-z0-9_-]*$/,rQ=/^\+[1-9]\d{6,14}$/,rK="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",rY=RegExp(`^${rK}$`);function rX(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function r0(e){return RegExp(`^${rX(e)}$`)}function r1(e){let t=rX({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let n=`${t}(?:${r.join("|")})`;return RegExp(`^${rK}T(?:${n})$`)}let r2=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},r4=/^-?\d+n?$/,r5=/^-?\d+$/,r6=/^-?\d+(?:\.\d+)?$/,r3=/^(?:true|false)$/i,r9=/^null$/i,r8=/^undefined$/i,r7=/^[^A-Z]*$/,ne=/^[^a-z]*$/;function nt(e,t){return RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function nr(e){return RegExp(`^[A-Za-z0-9_-]{${e}}$`)}let nn=nt(22,"=="),ni=nr(22),ns=nt(27,"="),no=nr(27),na=nt(43,"="),nl=nr(43),nu=nt(64,""),nc=nr(64),nd=nt(86,"=="),nh=nr(86);e.s(["base64",0,rG,"base64url",0,rJ,"bigint",0,r4,"boolean",0,r3,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,rV,"cidrv6",0,rq,"cuid",0,rR,"cuid2",0,rI,"date",0,rY,"datetime",()=>r1,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,rN,"e164",0,rQ,"email",0,rD,"emoji",()=>rF,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,r$,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,rH,"integer",0,r5,"ipv4",0,rU,"ipv6",0,rZ,"ksuid",0,rj,"lowercase",0,r7,"mac",0,rW,"md5_base64",0,nn,"md5_base64url",0,ni,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,rA,"null",()=>r9,"number",0,r6,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,ns,"sha1_base64url",0,no,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,na,"sha256_base64url",0,nl,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,nu,"sha384_base64url",0,nc,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,nd,"sha512_base64url",0,nh,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,r2,"time",()=>r0,"ulid",0,rO,"undefined",()=>r8,"unicodeEmail",0,rH,"uppercase",0,ne,"uuid",0,rP,"uuid4",0,rL,"uuid6",0,rB,"uuid7",0,rM,"xid",0,rC],82358);let np=tf("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),nf={number:"number",bigint:"bigint",object:"date"},nm=tf("$ZodCheckLessThan",(e,t)=>{np.init(e,t);let r=nf[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.maximum:r.exclusiveMaximum)??1/0;t.value<n&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ng=tf("$ZodCheckGreaterThan",(e,t)=>{np.init(e,t);let r=nf[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.minimum:r.exclusiveMinimum)??-1/0;t.value>n&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ny=tf("$ZodCheckMultipleOf",(e,t)=>{np.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===tO(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),nv=tf("$ZodCheckNumberFormat",(e,t)=>{np.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),n=r?"int":"number",[i,s]=t2[t.format];e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,n.minimum=i,n.maximum=s,r&&(n.pattern=r5)}),e._zod.check=o=>{let a=o.value;if(r){if(!Number.isInteger(a))return void o.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});if(!Number.isSafeInteger(a))return void(a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}))}a<i&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:i,inclusive:!0,inst:e,continue:!t.abort}),a>s&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inclusive:!0,inst:e,continue:!t.abort})}}),nb=tf("$ZodCheckBigIntFormat",(e,t)=>{np.init(e,t);let[r,n]=t4[t.format];e._zod.onattach.push(e=>{let i=e._zod.bag;i.format=t.format,i.minimum=r,i.maximum=n}),e._zod.check=i=>{let s=i.value;s<r&&i.issues.push({origin:"bigint",input:s,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),s>n&&i.issues.push({origin:"bigint",input:s,code:"too_big",maximum:n,inclusive:!0,inst:e,continue:!t.abort})}}),nx=tf("$ZodCheckMaxSize",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;n.size<=t.maximum||r.issues.push({origin:rs(n),code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nw=tf("$ZodCheckMinSize",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;n.size>=t.minimum||r.issues.push({origin:rs(n),code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),n_=tf("$ZodCheckSizeEquals",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=r=>{let n=r.value,i=n.size;if(i===t.size)return;let s=i>t.size;r.issues.push({origin:rs(n),...s?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nT=tf("$ZodCheckMaxLength",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;if(n.length<=t.maximum)return;let i=ro(n);r.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nS=tf("$ZodCheckMinLength",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;if(n.length>=t.minimum)return;let i=ro(n);r.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nE=tf("$ZodCheckLengthEquals",(e,t)=>{var r;np.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tR(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let n=r.value,i=n.length;if(i===t.length)return;let s=ro(n),o=i>t.length;r.issues.push({origin:s,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nk=tf("$ZodCheckStringFormat",(e,t)=>{var r,n;np.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),nz=tf("$ZodCheckRegex",(e,t)=>{nk.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),nR=tf("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=r7),nk.init(e,t)}),nI=tf("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=ne),nk.init(e,t)}),nO=tf("$ZodCheckIncludes",(e,t)=>{np.init(e,t);let r=tQ(t.includes),n=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),nC=tf("$ZodCheckStartsWith",(e,t)=>{np.init(e,t);let r=RegExp(`^${tQ(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),nj=tf("$ZodCheckEndsWith",(e,t)=>{np.init(e,t);let r=RegExp(`.*${tQ(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}});(e,t)=>{np.init(e,t);let r=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:t.mime,input:n.value.type,inst:e,continue:!t.abort})}};let nA=tf("$ZodCheckOverwrite",(e,t)=>{np.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class nN{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}let n$={major:4,minor:3,patch:6},nP=tf("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=n$;let n=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&n.unshift(e),n))for(let r of t._zod.onattach)r(e);if(0===n.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let n,i=rt(e);for(let s of t){if(s._zod.def.when){if(!s._zod.def.when(e))continue}else if(i)continue;let t=e.issues.length,o=s._zod.check(e);if(o instanceof Promise&&r?.async===!1)throw new tm;if(n||o instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await o,e.issues.length!==t&&(i||(i=rt(e,t)))});else{if(e.issues.length===t)continue;i||(i=rt(e,t))}}return n?n.then(()=>e):e},r=(r,i,s)=>{if(rt(r))return r.aborted=!0,r;let o=t(i,n,s);if(o instanceof Promise){if(!1===s.async)throw new tm;return o.then(t=>e._zod.parse(t,s))}return e._zod.parse(o,s)};e._zod.run=(i,s)=>{if(s.skipChecks)return e._zod.parse(i,s);if("backward"===s.direction){let t=e._zod.parse({value:i.value,issues:[]},{...s,skipChecks:!0});return t instanceof Promise?t.then(e=>r(e,i,s)):r(t,i,s)}let o=e._zod.parse(i,s);if(o instanceof Promise){if(!1===s.async)throw new tm;return o.then(e=>t(e,n,s))}return t(o,n,s)}}tj(e,"~standard",()=>({validate:t=>{try{let r=rE(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return rz(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}))}),nL=tf("$ZodString",(e,t)=>{nP.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??r2(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),nB=tf("$ZodStringFormat",(e,t)=>{nk.init(e,t),nL.init(e,t)}),nM=tf("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=r$),nB.init(e,t)}),nD=tf("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=rP(e))}else t.pattern??(t.pattern=rP());nB.init(e,t)}),nH=tf("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=rD),nB.init(e,t)}),nF=tf("$ZodURL",(e,t)=>{nB.init(e,t),e._zod.check=r=>{try{let n=r.value.trim(),i=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=i.href:r.value=n;return}catch(n){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),nU=tf("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=rF()),nB.init(e,t)}),nZ=tf("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=rA),nB.init(e,t)}),nW=tf("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=rR),nB.init(e,t)}),nV=tf("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=rI),nB.init(e,t)}),nq=tf("$ZodULID",(e,t)=>{t.pattern??(t.pattern=rO),nB.init(e,t)}),nG=tf("$ZodXID",(e,t)=>{t.pattern??(t.pattern=rC),nB.init(e,t)}),nJ=tf("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=rj),nB.init(e,t)}),nQ=tf("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=r1(t)),nB.init(e,t)}),nK=tf("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=rY),nB.init(e,t)}),nY=tf("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=r0(t)),nB.init(e,t)}),nX=tf("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=rN),nB.init(e,t)}),n0=tf("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=rU),nB.init(e,t),e._zod.bag.format="ipv4"}),n1=tf("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=rZ),nB.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),n2=tf("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=rW(t.delimiter)),nB.init(e,t),e._zod.bag.format="mac"}),n4=tf("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=rV),nB.init(e,t)}),n5=tf("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=rq),nB.init(e,t),e._zod.check=r=>{let n=r.value.split("/");try{if(2!==n.length)throw Error();let[e,t]=n;if(!t)throw Error();let r=Number(t);if(`${r}`!==t||r<0||r>128)throw Error();new URL(`http://[${e}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function n6(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let n3=tf("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=rG),nB.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{n6(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function n9(e){if(!rJ.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return n6(t.padEnd(4*Math.ceil(t.length/4),"="))}let n8=tf("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=rJ),nB.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{n9(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),n7=tf("$ZodE164",(e,t)=>{t.pattern??(t.pattern=rQ),nB.init(e,t)});function ie(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[n]=r;if(!n)return!1;let i=JSON.parse(atob(n));if("typ"in i&&i?.typ!=="JWT"||!i.alg||t&&(!("alg"in i)||i.alg!==t))return!1;return!0}catch{return!1}}let it=tf("$ZodJWT",(e,t)=>{nB.init(e,t),e._zod.check=r=>{ie(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),ir=tf("$ZodCustomStringFormat",(e,t)=>{nB.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),ii=tf("$ZodNumber",(e,t)=>{nP.init(e,t),e._zod.pattern=e._zod.bag.pattern??r6,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let i=r.value;if("number"==typeof i&&!Number.isNaN(i)&&Number.isFinite(i))return r;let s="number"==typeof i?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...s?{received:s}:{}}),r}}),is=tf("$ZodNumberFormat",(e,t)=>{nv.init(e,t),ii.init(e,t)}),io=tf("$ZodBoolean",(e,t)=>{nP.init(e,t),e._zod.pattern=r3,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let i=r.value;return"boolean"==typeof i||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),r}}),ia=tf("$ZodBigInt",(e,t)=>{nP.init(e,t),e._zod.pattern=r4,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch(e){}return"bigint"==typeof r.value||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),il=tf("$ZodBigIntFormat",(e,t)=>{nb.init(e,t),ia.init(e,t)}),iu=tf("$ZodSymbol",(e,t)=>{nP.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return"symbol"==typeof n||t.issues.push({expected:"symbol",code:"invalid_type",input:n,inst:e}),t}}),ic=tf("$ZodUndefined",(e,t)=>{nP.init(e,t),e._zod.pattern=r8,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"undefined",code:"invalid_type",input:n,inst:e}),t}}),id=tf("$ZodNull",(e,t)=>{nP.init(e,t),e._zod.pattern=r9,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;return null===n||t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}}),ih=tf("$ZodAny",(e,t)=>{nP.init(e,t),e._zod.parse=e=>e}),ip=tf("$ZodUnknown",(e,t)=>{nP.init(e,t),e._zod.parse=e=>e}),im=tf("$ZodNever",(e,t)=>{nP.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),ig=tf("$ZodVoid",(e,t)=>{nP.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"void",code:"invalid_type",input:n,inst:e}),t}}),iy=tf("$ZodDate",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=new Date(r.value)}catch(e){}let i=r.value,s=i instanceof Date;return s&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...s?{received:"Invalid Date"}:{},inst:e}),r}});function iv(e,t,r){e.issues.length&&t.issues.push(...rr(r,e.issues)),t.value[r]=e.value}let ib=tf("$ZodArray",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),r;r.value=Array(i.length);let s=[];for(let e=0;e<i.length;e++){let o=i[e],a=t.element._zod.run({value:o,issues:[]},n);a instanceof Promise?s.push(a.then(t=>iv(t,r,e))):iv(a,r,e)}return s.length?Promise.all(s).then(()=>r):r}});function ix(e,t,r,n,i){if(e.issues.length){if(i&&!(r in n))return;t.issues.push(...rr(r,e.issues))}void 0===e.value?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function iw(e){let t=Object.keys(e.shape);for(let r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=t1(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function i_(e,t,r,n,i,s){let o=[],a=i.keySet,l=i.catchall._zod,u=l.def.type,c="optional"===l.optout;for(let i in t){if(a.has(i))continue;if("never"===u){o.push(i);continue}let s=l.run({value:t[i],issues:[]},n);s instanceof Promise?e.push(s.then(e=>ix(e,r,i,t,c))):ix(s,r,i,t,c)}return(o.length&&r.issues.push({code:"unrecognized_keys",keys:o,input:t,inst:s}),e.length)?Promise.all(e).then(()=>r):r}let iT=tf("$ZodObject",(e,t)=>{let r;nP.init(e,t);let n=Object.getOwnPropertyDescriptor(t,"shape");if(!n?.get){let e=t.shape;Object.defineProperty(t,"shape",{get:()=>{let r={...e};return Object.defineProperty(t,"shape",{value:r}),r}})}let i=tz(()=>iw(t));tj(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values)for(let e of(r[t]??(r[t]=new Set),n.values))r[t].add(e)}return r});let s=t.catchall;e._zod.parse=(t,n)=>{r??(r=i.value);let o=t.value;if(!tU(o))return t.issues.push({expected:"object",code:"invalid_type",input:o,inst:e}),t;t.value={};let a=[],l=r.shape;for(let e of r.keys){let r=l[e],i="optional"===r._zod.optout,s=r._zod.run({value:o[e],issues:[]},n);s instanceof Promise?a.push(s.then(r=>ix(r,t,e,o,i))):ix(s,t,e,o,i)}return s?i_(a,o,t,n,i.value,e):a.length?Promise.all(a).then(()=>t):t}}),iS=tf("$ZodObjectJIT",(e,t)=>{let r,n;iT.init(e,t);let i=e._zod.parse,s=tz(()=>iw(t)),o=!ty.jitless,a=o&&tZ.value,l=t.catchall;e._zod.parse=(u,c)=>{n??(n=s.value);let d=u.value;return tU(d)?o&&a&&c?.async===!1&&!0!==c.jitless?(r||(r=(e=>{let t=new nN(["shape","payload","ctx"]),r=s.value,n=e=>{let t=tD(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let i=Object.create(null),o=0;for(let e of r.keys)i[e]=`key_${o++}`;for(let s of(t.write("const newResult = {};"),r.keys)){let r=i[s],o=tD(s),a=e[s],l=a?._zod?.optout==="optional";t.write(`const ${r} = ${n(s)};`),l?t.write(`
        if (${r}.issues.length) {
          if (${o} in input) {
            payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${o}, ...iss.path] : [${o}]
            })));
          }
        }
        
        if (${r}.value === undefined) {
          if (${o} in input) {
            newResult[${o}] = undefined;
          }
        } else {
          newResult[${o}] = ${r}.value;
        }
        
      `):t.write(`
        if (${r}.issues.length) {
          payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${o}, ...iss.path] : [${o}]
          })));
        }
        
        if (${r}.value === undefined) {
          if (${o} in input) {
            newResult[${o}] = undefined;
          }
        } else {
          newResult[${o}] = ${r}.value;
        }
        
      `)}t.write("payload.value = newResult;"),t.write("return payload;");let a=t.compile();return(t,r)=>a(e,t,r)})(t.shape)),u=r(u,c),l)?i_([],d,u,c,n,e):u:i(u,c):(u.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),u)}});function iE(e,t,r,n){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;let i=e.filter(e=>!rt(e));return 1===i.length?(t.value=i[0].value,i[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>ri(e,n,tv())))}),t)}let ik=tf("$ZodUnion",(e,t)=>{nP.init(e,t),tj(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),tj(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),tj(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),tj(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>tI(e.source)).join("|")})$`)}});let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let o=!1,a=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);if(t instanceof Promise)a.push(t),o=!0;else{if(0===t.issues.length)return t;a.push(t)}}return o?Promise.all(a).then(t=>iE(t,i,e,s)):iE(a,i,e,s)}});function iz(e,t,r,n){let i=e.filter(e=>0===e.issues.length);return 1===i.length?t.value=i[0].value:0===i.length?t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>ri(e,n,tv())))}):t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:[],inclusive:!1}),t}let iR=tf("$ZodXor",(e,t)=>{ik.init(e,t),t.inclusive=!1;let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let o=!1,a=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);t instanceof Promise?(a.push(t),o=!0):a.push(t)}return o?Promise.all(a).then(t=>iz(t,i,e,s)):iz(a,i,e,s)}}),iI=tf("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,ik.init(e,t);let r=e._zod.parse;tj(e._zod,"propValues",()=>{let e={};for(let r of t.options){let n=r._zod.propValues;if(!n||0===Object.keys(n).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(n))for(let n of(e[t]||(e[t]=new Set),r))e[t].add(n)}return e});let n=tz(()=>{let e=t.options,r=new Map;for(let n of e){let e=n._zod.propValues?.[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,n)}}return r});e._zod.parse=(i,s)=>{let o=i.value;if(!tU(o))return i.issues.push({code:"invalid_type",expected:"object",input:o,inst:e}),i;let a=n.value.get(o?.[t.discriminator]);return a?a._zod.run(i,s):t.unionFallback?r(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:o,path:[t.discriminator],inst:e}),i)}}),iO=tf("$ZodIntersection",(e,t)=>{nP.init(e,t),e._zod.parse=(e,r)=>{let n=e.value,i=t.left._zod.run({value:n,issues:[]},r),s=t.right._zod.run({value:n,issues:[]},r);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([t,r])=>iC(e,t,r)):iC(e,i,s)}});function iC(e,t,r){let n,i=new Map;for(let r of t.issues)if("unrecognized_keys"===r.code)for(let e of(n??(n=r),r.keys))i.has(e)||i.set(e,{}),i.get(e).l=!0;else e.issues.push(r);for(let t of r.issues)if("unrecognized_keys"===t.code)for(let e of t.keys)i.has(e)||i.set(e,{}),i.get(e).r=!0;else e.issues.push(t);let s=[...i].filter(([,e])=>e.l&&e.r).map(([e])=>e);if(s.length&&n&&e.issues.push({...n,keys:s}),rt(e))return e;let o=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(tW(t)&&tW(r)){let n=Object.keys(r),i=Object.keys(t).filter(e=>-1!==n.indexOf(e)),s={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};s[n]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let i=0;i<t.length;i++){let s=e(t[i],r[i]);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!o.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return e.value=o.data,e}let ij=tf("$ZodTuple",(e,t)=>{nP.init(e,t);let r=t.items;e._zod.parse=(n,i)=>{let s=n.value;if(!Array.isArray(s))return n.issues.push({input:s,inst:e,expected:"tuple",code:"invalid_type"}),n;n.value=[];let o=[],a=[...r].reverse().findIndex(e=>"optional"!==e._zod.optin),l=-1===a?0:r.length-a;if(!t.rest){let t=s.length>r.length,i=s.length<l-1;if(t||i)return n.issues.push({...t?{code:"too_big",maximum:r.length,inclusive:!0}:{code:"too_small",minimum:r.length},input:s,inst:e,origin:"array"}),n}let u=-1;for(let e of r){if(++u>=s.length&&u>=l)continue;let t=e._zod.run({value:s[u],issues:[]},i);t instanceof Promise?o.push(t.then(e=>iA(e,n,u))):iA(t,n,u)}if(t.rest)for(let e of s.slice(r.length)){u++;let r=t.rest._zod.run({value:e,issues:[]},i);r instanceof Promise?o.push(r.then(e=>iA(e,n,u))):iA(r,n,u)}return o.length?Promise.all(o).then(()=>n):n}});function iA(e,t,r){e.issues.length&&t.issues.push(...rr(r,e.issues)),t.value[r]=e.value}let iN=tf("$ZodRecord",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!tW(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let s=[],o=t.keyType._zod.values;if(o){let a;r.value={};let l=new Set;for(let e of o)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){l.add("number"==typeof e?e.toString():e);let o=t.valueType._zod.run({value:i[e],issues:[]},n);o instanceof Promise?s.push(o.then(t=>{t.issues.length&&r.issues.push(...rr(e,t.issues)),r.value[e]=t.value})):(o.issues.length&&r.issues.push(...rr(e,o.issues)),r.value[e]=o.value)}for(let e in i)l.has(e)||(a=a??[]).push(e);a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:a})}else for(let o of(r.value={},Reflect.ownKeys(i))){if("__proto__"===o)continue;let a=t.keyType._zod.run({value:o,issues:[]},n);if(a instanceof Promise)throw Error("Async schemas not supported in object keys currently");if("string"==typeof o&&r6.test(o)&&a.issues.length){let e=t.keyType._zod.run({value:Number(o),issues:[]},n);if(e instanceof Promise)throw Error("Async schemas not supported in object keys currently");0===e.issues.length&&(a=e)}if(a.issues.length){"loose"===t.mode?r.value[o]=i[o]:r.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(e=>ri(e,n,tv())),input:o,path:[o],inst:e});continue}let l=t.valueType._zod.run({value:i[o],issues:[]},n);l instanceof Promise?s.push(l.then(e=>{e.issues.length&&r.issues.push(...rr(o,e.issues)),r.value[a.value]=e.value})):(l.issues.length&&r.issues.push(...rr(o,l.issues)),r.value[a.value]=l.value)}return s.length?Promise.all(s).then(()=>r):r}}),i$=tf("$ZodMap",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:i,inst:e}),r;let s=[];for(let[o,a]of(r.value=new Map,i)){let l=t.keyType._zod.run({value:o,issues:[]},n),u=t.valueType._zod.run({value:a,issues:[]},n);l instanceof Promise||u instanceof Promise?s.push(Promise.all([l,u]).then(([t,s])=>{iP(t,s,r,o,i,e,n)})):iP(l,u,r,o,i,e,n)}return s.length?Promise.all(s).then(()=>r):r}});function iP(e,t,r,n,i,s,o){e.issues.length&&(tG.has(typeof n)?r.issues.push(...rr(n,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:i,inst:s,issues:e.issues.map(e=>ri(e,o,tv()))})),t.issues.length&&(tG.has(typeof n)?r.issues.push(...rr(n,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:i,inst:s,key:n,issues:t.issues.map(e=>ri(e,o,tv()))})),r.value.set(e.value,t.value)}let iL=tf("$ZodSet",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Set))return r.issues.push({input:i,inst:e,expected:"set",code:"invalid_type"}),r;let s=[];for(let e of(r.value=new Set,i)){let i=t.valueType._zod.run({value:e,issues:[]},n);i instanceof Promise?s.push(i.then(e=>iB(e,r))):iB(i,r)}return s.length?Promise.all(s).then(()=>r):r}});function iB(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}let iM=tf("$ZodEnum",(e,t)=>{nP.init(e,t);let r=tS(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=RegExp(`^(${r.filter(e=>tG.has(typeof e)).map(e=>"string"==typeof e?tQ(e):e.toString()).join("|")})$`),e._zod.parse=(t,i)=>{let s=t.value;return n.has(s)||t.issues.push({code:"invalid_value",values:r,input:s,inst:e}),t}}),iD=tf("$ZodLiteral",(e,t)=>{if(nP.init(e,t),0===t.values.length)throw Error("Cannot create literal schema with no valid values");let r=new Set(t.values);e._zod.values=r,e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?tQ(e):e?tQ(e.toString()):String(e)).join("|")})$`),e._zod.parse=(n,i)=>{let s=n.value;return r.has(s)||n.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),n}}),iH=tf("$ZodFile",(e,t)=>{nP.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return n instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:n,inst:e}),t}}),iF=tf("$ZodTransform",(e,t)=>{nP.init(e,t),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new tg(e.constructor.name);let i=t.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(e=>(r.value=e,r));if(i instanceof Promise)throw new tm;return r.value=i,r}});function iU(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}let iZ=tf("$ZodOptional",(e,t)=>{nP.init(e,t),e._zod.optin="optional",e._zod.optout="optional",tj(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),tj(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tI(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>{if("optional"===t.innerType._zod.optin){let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>iU(t,e.value)):iU(n,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,r)}}),iW=tf("$ZodExactOptional",(e,t)=>{iZ.init(e,t),tj(e._zod,"values",()=>t.innerType._zod.values),tj(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(e,r)=>t.innerType._zod.run(e,r)}),iV=tf("$ZodNullable",(e,t)=>{nP.init(e,t),tj(e._zod,"optin",()=>t.innerType._zod.optin),tj(e._zod,"optout",()=>t.innerType._zod.optout),tj(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tI(e.source)}|null)$`):void 0}),tj(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),iq=tf("$ZodDefault",(e,t)=>{nP.init(e,t),e._zod.optin="optional",tj(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);if(void 0===e.value)return e.value=t.defaultValue,e;let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(e=>iG(e,t)):iG(n,t)}});function iG(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let iJ=tf("$ZodPrefault",(e,t)=>{nP.init(e,t),e._zod.optin="optional",tj(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>("backward"===r.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),iQ=tf("$ZodNonOptional",(e,t)=>{nP.init(e,t),tj(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,n)=>{let i=t.innerType._zod.run(r,n);return i instanceof Promise?i.then(t=>iK(t,e)):iK(i,e)}});function iK(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let iY=tf("$ZodSuccess",(e,t)=>{nP.init(e,t),e._zod.parse=(e,r)=>{if("backward"===r.direction)throw new tg("ZodSuccess");let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===n.issues.length,e)}}),iX=tf("$ZodCatch",(e,t)=>{nP.init(e,t),tj(e._zod,"optin",()=>t.innerType._zod.optin),tj(e._zod,"optout",()=>t.innerType._zod.optout),tj(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>ri(e,r,tv()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>ri(e,r,tv()))},input:e.value}),e.issues=[]),e)}}),i0=tf("$ZodNaN",(e,t)=>{nP.init(e,t),e._zod.parse=(t,r)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),i1=tf("$ZodPipe",(e,t)=>{nP.init(e,t),tj(e._zod,"values",()=>t.in._zod.values),tj(e._zod,"optin",()=>t.in._zod.optin),tj(e._zod,"optout",()=>t.out._zod.optout),tj(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("backward"===r.direction){let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>i2(e,t.in,r)):i2(n,t.in,r)}let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>i2(e,t.out,r)):i2(n,t.out,r)}});function i2(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}let i4=tf("$ZodCodec",(e,t)=>{nP.init(e,t),tj(e._zod,"values",()=>t.in._zod.values),tj(e._zod,"optin",()=>t.in._zod.optin),tj(e._zod,"optout",()=>t.out._zod.optout),tj(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("forward"===(r.direction||"forward")){let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>i5(e,t,r)):i5(n,t,r)}{let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>i5(e,t,r)):i5(n,t,r)}}});function i5(e,t,r){if(e.issues.length)return e.aborted=!0,e;if("forward"===(r.direction||"forward")){let n=t.transform(e.value,e);return n instanceof Promise?n.then(n=>i6(e,n,t.out,r)):i6(e,n,t.out,r)}{let n=t.reverseTransform(e.value,e);return n instanceof Promise?n.then(n=>i6(e,n,t.in,r)):i6(e,n,t.in,r)}}function i6(e,t,r,n){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},n)}let i3=tf("$ZodReadonly",(e,t)=>{nP.init(e,t),tj(e._zod,"propValues",()=>t.innerType._zod.propValues),tj(e._zod,"values",()=>t.innerType._zod.values),tj(e._zod,"optin",()=>t.innerType?._zod?.optin),tj(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(i9):i9(n)}});function i9(e){return e.value=Object.freeze(e.value),e}let i8=tf("$ZodTemplateLiteral",(e,t)=>{nP.init(e,t);let r=[];for(let e of t.parts)if("object"==typeof e&&null!==e){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let n=+!!t.startsWith("^"),i=t.endsWith("$")?t.length-1:t.length;r.push(t.slice(n,i))}else if(null===e||tJ.has(typeof e))r.push(tQ(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${r.join("")}$`),e._zod.parse=(r,n)=>("string"!=typeof r.value?r.issues.push({input:r.value,inst:e,expected:"string",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source})),r)}),i7=tf("$ZodFunction",(e,t)=>(nP.init(e,t),e._def=t,e._zod.def=t,e.implement=t=>{if("function"!=typeof t)throw Error("implement() must be called with a function");return function(...r){let n=Reflect.apply(t,this,e._def.input?rw(e._def.input,r):r);return e._def.output?rw(e._def.output,n):n}},e.implementAsync=t=>{if("function"!=typeof t)throw Error("implementAsync() must be called with a function");return async function(...r){let n=e._def.input?await rT(e._def.input,r):r,i=await Reflect.apply(t,this,n);return e._def.output?await rT(e._def.output,i):i}},e._zod.parse=(t,r)=>("function"!=typeof t.value?t.issues.push({code:"invalid_type",expected:"function",input:t.value,inst:e}):e._def.output&&"promise"===e._def.output._zod.def.type?t.value=e.implementAsync(t.value):t.value=e.implement(t.value),t),e.input=(...t)=>{let r=e.constructor;return new r(Array.isArray(t[0])?{type:"function",input:new ij({type:"tuple",items:t[0],rest:t[1]}),output:e._def.output}:{type:"function",input:t[0],output:e._def.output})},e.output=t=>new e.constructor({type:"function",input:e._def.input,output:t}),e)),se=tf("$ZodPromise",(e,t)=>{nP.init(e,t),e._zod.parse=(e,r)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},r))}),st=tf("$ZodLazy",(e,t)=>{nP.init(e,t),tj(e._zod,"innerType",()=>t.getter()),tj(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),tj(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),tj(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),tj(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),sr=tf("$ZodCustom",(e,t)=>{np.init(e,t),nP.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let n=r.value,i=t.fn(n);if(i instanceof Promise)return i.then(t=>sn(t,r,n,e));sn(i,r,n,e)}});function sn(e,t,r,n){if(!e){let e={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),t.issues.push(rl(e))}}e.s(["$ZodAny",0,ih,"$ZodArray",0,ib,"$ZodBase64",0,n3,"$ZodBase64URL",0,n8,"$ZodBigInt",0,ia,"$ZodBigIntFormat",0,il,"$ZodBoolean",0,io,"$ZodCIDRv4",0,n4,"$ZodCIDRv6",0,n5,"$ZodCUID",0,nW,"$ZodCUID2",0,nV,"$ZodCatch",0,iX,"$ZodCodec",0,i4,"$ZodCustom",0,sr,"$ZodCustomStringFormat",0,ir,"$ZodDate",0,iy,"$ZodDefault",0,iq,"$ZodDiscriminatedUnion",0,iI,"$ZodE164",0,n7,"$ZodEmail",0,nH,"$ZodEmoji",0,nU,"$ZodEnum",0,iM,"$ZodExactOptional",0,iW,"$ZodFile",0,iH,"$ZodFunction",0,i7,"$ZodGUID",0,nM,"$ZodIPv4",0,n0,"$ZodIPv6",0,n1,"$ZodISODate",0,nK,"$ZodISODateTime",0,nQ,"$ZodISODuration",0,nX,"$ZodISOTime",0,nY,"$ZodIntersection",0,iO,"$ZodJWT",0,it,"$ZodKSUID",0,nJ,"$ZodLazy",0,st,"$ZodLiteral",0,iD,"$ZodMAC",0,n2,"$ZodMap",0,i$,"$ZodNaN",0,i0,"$ZodNanoID",0,nZ,"$ZodNever",0,im,"$ZodNonOptional",0,iQ,"$ZodNull",0,id,"$ZodNullable",0,iV,"$ZodNumber",0,ii,"$ZodNumberFormat",0,is,"$ZodObject",0,iT,"$ZodObjectJIT",0,iS,"$ZodOptional",0,iZ,"$ZodPipe",0,i1,"$ZodPrefault",0,iJ,"$ZodPromise",0,se,"$ZodReadonly",0,i3,"$ZodRecord",0,iN,"$ZodSet",0,iL,"$ZodString",0,nL,"$ZodStringFormat",0,nB,"$ZodSuccess",0,iY,"$ZodSymbol",0,iu,"$ZodTemplateLiteral",0,i8,"$ZodTransform",0,iF,"$ZodTuple",0,ij,"$ZodType",0,nP,"$ZodULID",0,nq,"$ZodURL",0,nF,"$ZodUUID",0,nD,"$ZodUndefined",0,ic,"$ZodUnion",0,ik,"$ZodUnknown",0,ip,"$ZodVoid",0,ig,"$ZodXID",0,nG,"$ZodXor",0,iR,"isValidBase64",()=>n6,"isValidBase64URL",()=>n9,"isValidJWT",()=>ie],76094),Symbol("ZodOutput"),Symbol("ZodInput");(w=globalThis).__zod_globalRegistry??(w.__zod_globalRegistry=new class e{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){let r=t[0];return this._map.set(e,r),r&&"object"==typeof r&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};delete r.id;let n={...r,...this._map.get(e)};return Object.keys(n).length?n:void 0}return this._map.get(e)}has(e){return this._map.has(e)}});let si=globalThis.__zod_globalRegistry;function ss(e,t){return new nm({check:"less_than",...tY(t),value:e,inclusive:!1})}function so(e,t){return new nm({check:"less_than",...tY(t),value:e,inclusive:!0})}function sa(e,t){return new ng({check:"greater_than",...tY(t),value:e,inclusive:!1})}function sl(e,t){return new ng({check:"greater_than",...tY(t),value:e,inclusive:!0})}function su(e,t){return new ny({check:"multiple_of",...tY(t),value:e})}function sc(e,t){return new nT({check:"max_length",...tY(t),maximum:e})}function sd(e,t){return new nS({check:"min_length",...tY(t),minimum:e})}function sh(e,t){return new nE({check:"length_equals",...tY(t),length:e})}function sp(e){return new nA({check:"overwrite",tx:e})}function sf(e){let t=e?.target??"draft-2020-12";return"draft-4"===t&&(t="draft-04"),"draft-7"===t&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??si,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function sm(e,t,r={path:[],schemaPath:[]}){var n;let i=e._zod.def,s=t.seen.get(e);if(s)return s.count++,r.schemaPath.includes(e)&&(s.cycle=r.path),s.schema;let o={schema:{},count:1,cycle:void 0,path:r.path};t.seen.set(e,o);let a=e._zod.toJSONSchema?.();if(a)o.schema=a;else{let n={...r,schemaPath:[...r.schemaPath,e],path:r.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,o.schema,n);else{let r=o.schema,s=t.processors[i.type];if(!s)throw Error(`[toJSONSchema]: Non-representable type encountered: ${i.type}`);s(e,t,r,n)}let s=e._zod.parent;s&&(o.ref||(o.ref=s),sm(s,t,n),t.seen.get(s).isParent=!0)}let l=t.metadataRegistry.get(e);return l&&Object.assign(o.schema,l),"input"===t.io&&function e(t,r){let n=r??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);let i=t._zod.def;if("transform"===i.type)return!0;if("array"===i.type)return e(i.element,n);if("set"===i.type)return e(i.valueType,n);if("lazy"===i.type)return e(i.getter(),n);if("promise"===i.type||"optional"===i.type||"nonoptional"===i.type||"nullable"===i.type||"readonly"===i.type||"default"===i.type||"prefault"===i.type)return e(i.innerType,n);if("intersection"===i.type)return e(i.left,n)||e(i.right,n);if("record"===i.type||"map"===i.type)return e(i.keyType,n)||e(i.valueType,n);if("pipe"===i.type)return e(i.in,n)||e(i.out,n);if("object"===i.type){for(let t in i.shape)if(e(i.shape[t],n))return!0;return!1}if("union"===i.type){for(let t of i.options)if(e(t,n))return!0;return!1}if("tuple"===i.type){for(let t of i.items)if(e(t,n))return!0;if(i.rest&&e(i.rest,n))return!0}return!1}(e)&&(delete o.schema.examples,delete o.schema.default),"input"===t.io&&o.schema._prefault&&((n=o.schema).default??(n.default=o.schema._prefault)),delete o.schema._prefault,t.seen.get(e).schema}function sg(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=new Map;for(let t of e.seen.entries()){let r=e.metadataRegistry.get(t[0])?.id;if(r){let e=n.get(r);if(e&&e!==t[0])throw Error(`Duplicate schema id "${r}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);n.set(r,t[0])}}let i=t=>{if(t[1].schema.$ref)return;let n=t[1],{ref:i,defId:s}=(t=>{let n="draft-2020-12"===e.target?"$defs":"definitions";if(e.external){let r=e.external.registry.get(t[0])?.id,i=e.external.uri??(e=>e);if(r)return{ref:i(r)};let s=t[1].defId??t[1].schema.id??`schema${e.counter++}`;return t[1].defId=s,{defId:s,ref:`${i("__shared")}#/${n}/${s}`}}if(t[1]===r)return{ref:"#"};let i=`#/${n}/`,s=t[1].schema.id??`__schema${e.counter++}`;return{defId:s,ref:i+s}})(t);n.def={...n.schema},s&&(n.defId=s);let o=n.schema;for(let e in o)delete o[e];o.$ref=i};if("throw"===e.cycles)for(let t of e.seen.entries()){let e=t[1];if(e.cycle)throw Error(`Cycle detected: #/${e.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let r of e.seen.entries()){let n=r[1];if(t===r[0]){i(r);continue}if(e.external){let n=e.external.registry.get(r[0])?.id;if(t!==r[0]&&n){i(r);continue}}if(e.metadataRegistry.get(r[0])?.id||n.cycle||n.count>1&&"ref"===e.reused){i(r);continue}}}function sy(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=t=>{let r=e.seen.get(t);if(null===r.ref)return;let i=r.def??r.schema,s={...i},o=r.ref;if(r.ref=null,o){n(o);let r=e.seen.get(o),a=r.schema;if(a.$ref&&("draft-07"===e.target||"draft-04"===e.target||"openapi-3.0"===e.target)?(i.allOf=i.allOf??[],i.allOf.push(a)):Object.assign(i,a),Object.assign(i,s),t._zod.parent===o)for(let e in i)"$ref"!==e&&"allOf"!==e&&(e in s||delete i[e]);if(a.$ref&&r.def)for(let e in i)"$ref"!==e&&"allOf"!==e&&e in r.def&&JSON.stringify(i[e])===JSON.stringify(r.def[e])&&delete i[e]}let a=t._zod.parent;if(a&&a!==o){n(a);let t=e.seen.get(a);if(t?.schema.$ref&&(i.$ref=t.schema.$ref,t.def))for(let e in i)"$ref"!==e&&"allOf"!==e&&e in t.def&&JSON.stringify(i[e])===JSON.stringify(t.def[e])&&delete i[e]}e.override({zodSchema:t,jsonSchema:i,path:r.path??[]})};for(let t of[...e.seen.entries()].reverse())n(t[0]);let i={};if("draft-2020-12"===e.target?i.$schema="https://json-schema.org/draft/2020-12/schema":"draft-07"===e.target?i.$schema="http://json-schema.org/draft-07/schema#":"draft-04"===e.target?i.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){let r=e.external.registry.get(t)?.id;if(!r)throw Error("Schema is missing an `id` property");i.$id=e.external.uri(r)}Object.assign(i,r.def??r.schema);let s=e.external?.defs??{};for(let t of e.seen.entries()){let e=t[1];e.def&&e.defId&&(s[e.defId]=e.def)}e.external||Object.keys(s).length>0&&("draft-2020-12"===e.target?i.$defs=s:i.definitions=s);try{let r=JSON.parse(JSON.stringify(i));return Object.defineProperty(r,"~standard",{value:{...t["~standard"],jsonSchema:{input:sv(t,"input",e.processors),output:sv(t,"output",e.processors)}},enumerable:!1,writable:!1}),r}catch(e){throw Error("Error converting schema to JSON.")}}let sv=(e,t,r={})=>n=>{let{libraryOptions:i,target:s}=n??{},o=sf({...i??{},target:s,io:t,processors:r});return sm(e,o),sg(o,e),sy(o,e)},sb={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},sx=(e,t,r,n)=>{let i=e._zod.def;sm(i.innerType,t,n),t.seen.get(e).ref=i.innerType};e.i(76094),e.i(82358);var sw=e.i(22143),sw=sw;(e,t)=>{nQ.init(e,t),sL.init(e,t)},(e,t)=>{nX.init(e,t),sL.init(e,t)};let s_=tf("ZodError",(e,t)=>{rv.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>(function(e,t=e=>e.message){let r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code&&i.errors.length)i.errors.map(e=>n({issues:e}));else if("invalid_key"===i.code)n({issues:i.issues});else if("invalid_element"===i.code)n({issues:i.issues});else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(e),r})(e,t)},flatten:{value:t=>(function(e,t=e=>e.message){let r={},n=[];for(let i of e.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(t(i))):n.push(t(i));return{formErrors:n,fieldErrors:r}})(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,tk,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,tk,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),sT=rx(s_),sS=r_(s_),sE=rS(s_),sk=rk(s_),sz=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rx(s_)(e,t,n)},sR=(e,t,r)=>rx(s_)(e,t,r),sI=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return r_(s_)(e,t,n)},sO=async(e,t,r)=>r_(s_)(e,t,r),sC=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rS(s_)(e,t,n)},sj=(e,t,r)=>rS(s_)(e,t,r),sA=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rk(s_)(e,t,n)},sN=async(e,t,r)=>rk(s_)(e,t,r),s$=tf("ZodType",(e,t)=>(nP.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:sv(e,"input"),output:sv(e,"output")}}),e.toJSONSchema=((e,t={})=>r=>{let n=sf({...r,processors:t});return sm(e,n),sg(n,e),sy(n,e)})(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(sw.mergeDefs(t,{checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),{parent:!0}),e.with=e.check,e.clone=(t,r)=>tK(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>sT(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>sE(e,t,r),e.parseAsync=async(t,r)=>sS(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>sk(e,t,r),e.spa=e.safeParseAsync,e.encode=(t,r)=>sz(e,t,r),e.decode=(t,r)=>sR(e,t,r),e.encodeAsync=async(t,r)=>sI(e,t,r),e.decodeAsync=async(t,r)=>sO(e,t,r),e.safeEncode=(t,r)=>sC(e,t,r),e.safeDecode=(t,r)=>sj(e,t,r),e.safeEncodeAsync=async(t,r)=>sA(e,t,r),e.safeDecodeAsync=async(t,r)=>sN(e,t,r),e.refine=(t,r)=>e.check(function(e,t={}){return new s5({type:"custom",check:"custom",fn:e,...tY(t)})}(t,r)),e.superRefine=t=>e.check(function(e){var t;let r,n;return t=t=>(t.addIssue=e=>{"string"==typeof e?t.issues.push(rl(e,t.value,r._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=t.value),e.inst??(e.inst=r),e.continue??(e.continue=!r._zod.def.abort),t.issues.push(rl(e)))},e(t.value,t)),(n=new np({check:"custom",...tY(void 0)}))._zod.check=t,r=n}(t)),e.overwrite=t=>e.check(sp(t)),e.optional=()=>sq(e),e.exactOptional=()=>new sG({type:"optional",innerType:e}),e.nullable=()=>sQ(e),e.nullish=()=>sq(sQ(e)),e.nonoptional=t=>{var r,n;return r=e,n=t,new sX({type:"nonoptional",innerType:r,...sw.normalizeParams(n)})},e.array=()=>(function(e,t){return new sH({type:"array",element:e,...tY(void 0)})})(e),e.or=t=>new sF({type:"union",options:[e,t],...sw.normalizeParams(void 0)}),e.and=t=>new sU({type:"intersection",left:e,right:t}),e.transform=t=>s2(e,new sW({type:"transform",transform:t})),e.default=t=>{var r,n;return r=e,n=t,new sK({type:"default",innerType:r,get defaultValue(){return"function"==typeof n?n():sw.shallowClone(n)}})},e.prefault=t=>{var r,n;return r=e,n=t,new sY({type:"prefault",innerType:r,get defaultValue(){return"function"==typeof n?n():sw.shallowClone(n)}})},e.catch=t=>{var r;return new s0({type:"catch",innerType:e,catchValue:"function"==typeof(r=t)?r:()=>r})},e.pipe=t=>s2(e,t),e.readonly=()=>new s4({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return si.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>si.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return si.get(e);let r=e.clone();return si.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=t=>t(e),e)),sP=tf("_ZodString",(e,t)=>{nL.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{r.type="string";let{minimum:i,maximum:s,format:o,patterns:a,contentEncoding:l}=e._zod.bag;if("number"==typeof i&&(r.minLength=i),"number"==typeof s&&(r.maxLength=s),o&&(r.format=sb[o]??o,""===r.format&&delete r.format,"time"===o&&delete r.format),l&&(r.contentEncoding=l),a&&a.size>0){let e=[...a];1===e.length?r.pattern=e[0].source:e.length>1&&(r.allOf=[...e.map(e=>({..."draft-07"===t.target||"draft-04"===t.target||"openapi-3.0"===t.target?{type:"string"}:{},pattern:e.source}))])}})(e,t,r,0);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new nz({check:"string_format",format:"regex",...tY(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new nO({check:"string_format",format:"includes",...tY(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new nC({check:"string_format",format:"starts_with",...tY(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new nj({check:"string_format",format:"ends_with",...tY(t),suffix:e})}(...t)),e.min=(...t)=>e.check(sd(...t)),e.max=(...t)=>e.check(sc(...t)),e.length=(...t)=>e.check(sh(...t)),e.nonempty=(...t)=>e.check(sd(1,...t)),e.lowercase=t=>e.check(new nR({check:"string_format",format:"lowercase",...tY(t)})),e.uppercase=t=>e.check(new nI({check:"string_format",format:"uppercase",...tY(t)})),e.trim=()=>e.check(sp(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return sp(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(sp(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(sp(e=>e.toUpperCase())),e.slugify=()=>e.check(sp(e=>tH(e)))}),sL=tf("ZodStringFormat",(e,t)=>{nB.init(e,t),sP.init(e,t)}),sB=((e,t)=>{nH.init(e,t),sL.init(e,t)},tf("ZodNumber",(e,t)=>{ii.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let{minimum:i,maximum:s,format:o,multipleOf:a,exclusiveMaximum:l,exclusiveMinimum:u}=e._zod.bag;"string"==typeof o&&o.includes("int")?r.type="integer":r.type="number","number"==typeof u&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.minimum=u,r.exclusiveMinimum=!0):r.exclusiveMinimum=u),"number"==typeof i&&(r.minimum=i,"number"==typeof u&&"draft-04"!==t.target&&(u>=i?delete r.minimum:delete r.exclusiveMinimum)),"number"==typeof l&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.maximum=l,r.exclusiveMaximum=!0):r.exclusiveMaximum=l),"number"==typeof s&&(r.maximum=s,"number"==typeof l&&"draft-04"!==t.target&&(l<=s?delete r.maximum:delete r.exclusiveMaximum)),"number"==typeof a&&(r.multipleOf=a)})(e,t,r,0),e.gt=(t,r)=>e.check(sa(t,r)),e.gte=(t,r)=>e.check(sl(t,r)),e.min=(t,r)=>e.check(sl(t,r)),e.lt=(t,r)=>e.check(ss(t,r)),e.lte=(t,r)=>e.check(so(t,r)),e.max=(t,r)=>e.check(so(t,r)),e.int=t=>e.check(sD(t)),e.safe=t=>e.check(sD(t)),e.positive=t=>e.check(sa(0,t)),e.nonnegative=t=>e.check(sl(0,t)),e.negative=t=>e.check(ss(0,t)),e.nonpositive=t=>e.check(so(0,t)),e.multipleOf=(t,r)=>e.check(su(t,r)),e.step=(t,r)=>e.check(su(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??-1/0,r.exclusiveMinimum??-1/0)??null,e.maxValue=Math.min(r.maximum??1/0,r.exclusiveMaximum??1/0)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null})),sM=tf("ZodNumberFormat",(e,t)=>{is.init(e,t),sB.init(e,t)});function sD(e){return new sM({type:"number",check:"number_format",abort:!1,format:"safeint",...tY(e)})}(e,t)=>{ia.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema")})(0,e,0,0),e.gte=(t,r)=>e.check(sl(t,r)),e.min=(t,r)=>e.check(sl(t,r)),e.gt=(t,r)=>e.check(sa(t,r)),e.gte=(t,r)=>e.check(sl(t,r)),e.min=(t,r)=>e.check(sl(t,r)),e.lt=(t,r)=>e.check(ss(t,r)),e.lte=(t,r)=>e.check(so(t,r)),e.max=(t,r)=>e.check(so(t,r)),e.positive=t=>e.check(sa(BigInt(0),t)),e.negative=t=>e.check(ss(BigInt(0),t)),e.nonpositive=t=>e.check(so(BigInt(0),t)),e.nonnegative=t=>e.check(sl(BigInt(0),t)),e.multipleOf=(t,r)=>e.check(su(t,r));let r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null};(e,t)=>{ip.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{}};(e,t)=>{im.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{t.not={}}};let sH=tf("ZodArray",(e,t)=>{ib.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i=e._zod.def,{minimum:s,maximum:o}=e._zod.bag;"number"==typeof s&&(r.minItems=s),"number"==typeof o&&(r.maxItems=o),r.type="array",r.items=sm(i.element,t,{...n,path:[...n.path,"items"]})})(e,t,r,n),e.element=t.element,e.min=(t,r)=>e.check(sd(t,r)),e.nonempty=t=>e.check(sd(1,t)),e.max=(t,r)=>e.check(sc(t,r)),e.length=(t,r)=>e.check(sh(t,r)),e.unwrap=()=>e.element}),sF=tf("ZodUnion",(e,t)=>{ik.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{var i,s,o,a;let l,u,c;return i=e,s=t,o=r,a=n,u=!1===(l=i._zod.def).inclusive,c=l.options.map((e,t)=>sm(e,s,{...a,path:[...a.path,u?"oneOf":"anyOf",t]})),void(u?o.oneOf=c:o.anyOf=c)},e.options=t.options}),sU=tf("ZodIntersection",(e,t)=>{iO.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,o,a;return s=sm((i=e._zod.def).left,t,{...n,path:[...n.path,"allOf",0]}),o=sm(i.right,t,{...n,path:[...n.path,"allOf",1]}),void(r.allOf=[...(a=e=>"allOf"in e&&1===Object.keys(e).length)(s)?s.allOf:[s],...a(o)?o.allOf:[o]])}}),sZ=tf("ZodEnum",(e,t)=>{iM.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;(i=tS(e._zod.def.entries)).every(e=>"number"==typeof e)&&(r.type="number"),i.every(e=>"string"==typeof e)&&(r.type="string"),r.enum=i},e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,n)=>{let i={};for(let n of e)if(r.has(n))i[n]=t.entries[n];else throw Error(`Key ${n} not found in enum`);return new sZ({...t,checks:[],...sw.normalizeParams(n),entries:i})},e.exclude=(e,n)=>{let i={...t.entries};for(let t of e)if(r.has(t))delete i[t];else throw Error(`Key ${t} not found in enum`);return new sZ({...t,checks:[],...sw.normalizeParams(n),entries:i})}}),sW=tf("ZodTransform",(e,t)=>{iF.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema")})(0,e,0,0),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new tg(e.constructor.name);r.addIssue=n=>{"string"==typeof n?r.issues.push(sw.issue(n,r.value,t)):(n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=r.value),n.inst??(n.inst=e),r.issues.push(sw.issue(n)))};let i=t.transform(r.value,r);return i instanceof Promise?i.then(e=>(r.value=e,r)):(r.value=i,r)}}),sV=tf("ZodOptional",(e,t)=>{iZ.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>sx(e,t,r,n),e.unwrap=()=>e._zod.def.innerType});function sq(e){return new sV({type:"optional",innerType:e})}let sG=tf("ZodExactOptional",(e,t)=>{iW.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>sx(e,t,r,n),e.unwrap=()=>e._zod.def.innerType}),sJ=tf("ZodNullable",(e,t)=>{iV.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,o;return s=sm((i=e._zod.def).innerType,t,n),o=t.seen.get(e),void("openapi-3.0"===t.target?(o.ref=i.innerType,r.nullable=!0):r.anyOf=[s,{type:"null"}])},e.unwrap=()=>e._zod.def.innerType});function sQ(e){return new sJ({type:"nullable",innerType:e})}let sK=tf("ZodDefault",(e,t)=>{iq.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sm((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.default=JSON.parse(JSON.stringify(i.defaultValue))},e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),sY=tf("ZodPrefault",(e,t)=>{iJ.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sm((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,"input"===t.io&&(r._prefault=JSON.parse(JSON.stringify(i.defaultValue)))},e.unwrap=()=>e._zod.def.innerType}),sX=tf("ZodNonOptional",(e,t)=>{iQ.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sm((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType},e.unwrap=()=>e._zod.def.innerType}),s0=tf("ZodCatch",(e,t)=>{iX.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i,s=e._zod.def;sm(s.innerType,t,n),t.seen.get(e).ref=s.innerType;try{i=s.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}r.default=i})(e,t,r,n),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),s1=tf("ZodPipe",(e,t)=>{i1.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s;return i=e._zod.def,void(sm(s="input"===t.io?"transform"===i.in._zod.def.type?i.out:i.in:i.out,t,n),t.seen.get(e).ref=s)},e.in=t.in,e.out=t.out});function s2(e,t){return new s1({type:"pipe",in:e,out:t})}let s4=tf("ZodReadonly",(e,t)=>{i3.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sm((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.readOnly=!0},e.unwrap=()=>e._zod.def.innerType}),s5=tf("ZodCustom",(e,t)=>{sr.init(e,t),s$.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")})(0,e,0,0)});var s6=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};function s3(e,t="/api/auth"){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new s6(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof s6)throw t;throw new s6(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}if(function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new s6(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let s9={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},s8={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},s7=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,oe={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},ot=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,or=[],on=0,oi=0,os=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=on+4;t<or.length;)or[t]===e?or.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){oi++;let i=!or.length;for(let i of t)or.push(i,r.value,e,n);if(i){for(on=0;on<or.length;on+=4)or[on](or[on+1],or[on+2],or[on+3]);or.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},oo=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},oa=()=>"u"<typeof window,ol=(e,t,r,n)=>{let i=os({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>s(e)}),s=async e=>new Promise(s=>{let o="function"==typeof n?n({data:i.get().data,error:i.get().error,isPending:i.get().isPending}):n;r(t,{...o,query:{...o?.query,...e?.query},async onSuccess(e){i.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await o?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(i.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await o?.onError?.(e))},async onRequest(e){let t=i.get();i.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:i.value.refetch}),await o?.onRequest?.(e)}}).catch(e=>{i.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch})}).finally(()=>{s(void 0)})});e=Array.isArray(e)?e:[e];let o=!1;for(let t of e)t.subscribe(async()=>{oa()||(o?await s():oo(i,()=>{let e=setTimeout(async()=>{o||(await s(),o=!0)},0);return()=>{i.off(),t.off(),clearTimeout(e)}}))});return i},ou=Symbol.for("better-auth:broadcast-channel");var oc=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("u">typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:Math.floor(Date.now()/1e3)}))}catch{}}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function od(e="better-auth.message"){return globalThis[ou]||(globalThis[ou]=new oc(e)),globalThis[ou]}let oh=Symbol.for("better-auth:focus-manager");var op=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||"u"<typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function of(){return globalThis[oh]||(globalThis[oh]=new op),globalThis[oh]}let om=Symbol.for("better-auth:online-manager");var og=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function oy(){return globalThis[om]||(globalThis[om]=new og),globalThis[om]}let ov=()=>Math.floor(Date.now()/1e3);function ob(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e))}function ox(e){return(...t)=>t.reduce((t,r)=>(function e(t,r,n=".",i){if(!ob(r))return e(t,{},n,i);let s=Object.assign({},r);for(let r in t){if("__proto__"===r||"constructor"===r)continue;let o=t[r];null!=o&&(i&&i(s,r,o,n)||(Array.isArray(o)&&Array.isArray(s[r])?s[r]=[...o,...s[r]]:ob(o)&&ob(s[r])?s[r]=e(o,s[r],(n?`${n}.`:"")+r.toString(),i):s[r]=o))}return s})(t,r,"",e),{})}let ow=ox();ox((e,t,r)=>{if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0}),ox((e,t,r)=>{if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0});var o_=Object.defineProperty,oT=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,oE=Object.getOwnPropertySymbols,ok=Object.prototype.hasOwnProperty,oz=Object.prototype.propertyIsEnumerable,oR=(e,t,r)=>t in e?o_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oI=(e,t)=>{for(var r in t||(t={}))ok.call(t,r)&&oR(e,r,t[r]);if(oE)for(var r of oE(t))oz.call(t,r)&&oR(e,r,t[r]);return e},oO=(e,t)=>oT(e,oS(t)),oC=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},oj=async(e,t)=>{var r,n,i,s,o,a;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));l=n.options||l,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(i=c.hooks)?void 0:i.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(o=c.hooks)?void 0:o.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:l,hooks:u}},oA=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},oN=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},o$=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!n||!i)return t;t.authorization=`Basic ${btoa(`${n}:${i}`)}`}else if("Custom"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!i)return t;t.authorization=`${null!=n?n:""} ${i}`}}return t},oP=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function oL(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function oB(e){try{return JSON.parse(e)}catch(t){return e}}function oM(e){return"function"==typeof e}async function oD(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await o$(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=oL(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var oH=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function oF(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new oH(r.issues);return r.value}var oU=["get","post","put","patch","delete"],oZ=async(e,t)=>{var r,n,i,s,o,a,l,u;let c,{hooks:d,url:h,options:p}=await oj(e,t),f=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("u">typeof globalThis&&oM(globalThis.fetch))return globalThis.fetch;if("u">typeof window&&oM(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(p),m=new AbortController,g=null!=(r=p.signal)?r:m.signal,y=function(e,t){let{baseURL:r,params:n,query:i}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];oU.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[o,a]=e.replace(s,"").split("?"),l=new URLSearchParams(a);for(let[e,t]of Object.entries(i||{})){let r;if(null!=t){if("string"==typeof t)r=t;else if(Array.isArray(t)){for(let r of t)l.append(e,r);continue}else r=JSON.stringify(t);l.set(e,r)}}if(n)if(Array.isArray(n))for(let[e,t]of o.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];o=o.replace(t,r)}else for(let[e,t]of Object.entries(n))o=o.replace(`:${e}`,String(t));(o=o.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(o=o.slice(1));let u=l.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http"))?new URL(`${o}${u}`,s):`${s}${o}${u}`}(h,p),v=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(oL(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&oL(e.body)?new URLSearchParams(e.body).toString():e.body}(p),b=await oD(p),x=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return oU.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(h,p),w=oO(oI({},p),{url:y,headers:b,body:v,method:x,signal:g});for(let e of d.onRequest)if(e){let t=await e(w);"object"==typeof t&&null!==t&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:_}=(!(null==p?void 0:p.signal)&&(null==p?void 0:p.timeout)&&(c=setTimeout(()=>null==m?void 0:m.abort(),null==p?void 0:p.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),T=await f(w.url,w);_();let S={response:T,request:w};for(let e of d.onResponse)if(e){let r=await e(oO(oI({},S),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?T.clone():T}));r instanceof Response?T=r:"object"==typeof r&&null!==r&&(T=r.response)}if(T.ok){if("HEAD"===w.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return oP.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(T),r={data:null,response:T,request:w};if("json"===e||"text"===e){let e=await T.text(),t=null!=(s=w.jsonParser)?s:oB;r.data=await t(e)}else r.data=await T[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(r.data=await oF(w.output,r.data)),d.onSuccess))e&&await e(oO(oI({},r),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?T.clone():T}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let E=null!=(a=null==t?void 0:t.jsonParser)?a:oB,k=await T.text(),z=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(k),R=z?await E(k):null,I={response:T,responseText:k,request:w,error:oO(oI({},R),{status:T.status,statusText:T.statusText})};for(let e of d.onError)e&&await e(oO(oI({},I),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?T.clone():T}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new oA({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new oA(e);case"exponential":return new oN(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,T)){for(let e of d.onRetry)e&&await e(S);let i=r.getDelay(n);return await new Promise(e=>setTimeout(e,i)),await oZ(e,oO(oI({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new oC(T.status,T.statusText,z?R:k);return{data:null,error:oO(oI({},R),{status:T.status,statusText:T.statusText})}};function oW(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function oV(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t.padEnd(t.length+r,"=")),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return i}function oq(){return oG.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}let oG={stubThis:e=>e};function oJ(e){let{id:t}=e;return{...e,id:oV(t),transports:e.transports}}function oQ(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class oK extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=n??r.name,this.code=t}}let oY=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}},oX=["cross-platform","platform"];function o0(e){if(e&&!(0>oX.indexOf(e)))return e}async function o1(e){let t,r,n,i,s;!e.optionsJSON&&e.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:o,useAutoRegister:a=!1}=e;if(!oq())throw Error("WebAuthn is not supported in this browser");let l={...o,challenge:oV(o.challenge),user:{...o.user,id:oV(o.user.id)},excludeCredentials:o.excludeCredentials?.map(oJ)},u={};a&&(u.mediation="conditional"),u.publicKey=l,u.signal=oY.createNewAbortSignal();try{t=await navigator.credentials.create(u)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new oK({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new oK({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&r.authenticatorSelection?.userVerification==="required")return new oK({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if(r.authenticatorSelection?.userVerification==="required")return new oK({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new oK({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new oK({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new oK(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!oQ(t))return new oK({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new oK({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new oK({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new oK({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:u})}if(!t)throw Error("Registration was not completed");let{id:c,rawId:d,response:h,type:p}=t;if("function"==typeof h.getTransports&&(n=h.getTransports()),"function"==typeof h.getPublicKeyAlgorithm)try{i=h.getPublicKeyAlgorithm()}catch(e){o2("getPublicKeyAlgorithm()",e)}if("function"==typeof h.getPublicKey)try{let e=h.getPublicKey();null!==e&&(s=oW(e))}catch(e){o2("getPublicKey()",e)}if("function"==typeof h.getAuthenticatorData)try{r=oW(h.getAuthenticatorData())}catch(e){o2("getAuthenticatorData()",e)}return{id:c,rawId:oW(d),response:{attestationObject:oW(h.attestationObject),clientDataJSON:oW(h.clientDataJSON),transports:n,publicKeyAlgorithm:i,publicKey:s,authenticatorData:r},type:p,clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:o0(t.authenticatorAttachment)}}function o2(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}let o4=e=>e;async function o5(e){let t,r,n;!e.optionsJSON&&e.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:i,useBrowserAutofill:s=!1,verifyBrowserAutofillInput:o=!0}=e;if(!oq())throw Error("WebAuthn is not supported in this browser");i.allowCredentials?.length!==0&&(t=i.allowCredentials?.map(oJ));let a={...i,challenge:oV(i.challenge),allowCredentials:t},l={};if(s){if(!await function(){if(!oq())return o4(new Promise(e=>e(!1)));let e=globalThis.PublicKeyCredential;return e?.isConditionalMediationAvailable===void 0?o4(new Promise(e=>e(!1))):o4(e.isConditionalMediationAvailable())}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&o)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');l.mediation="conditional",a.allowCredentials=[]}l.publicKey=a,l.signal=oY.createNewAbortSignal();try{r=await navigator.credentials.get(l)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new oK({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new oK({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!oQ(t))return new oK({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new oK({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new oK({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:l})}if(!r)throw Error("Authentication was not completed");let{id:u,rawId:c,response:d,type:h}=r;return d.userHandle&&(n=oW(d.userHandle)),{id:u,rawId:oW(c),response:{authenticatorData:oW(d.authenticatorData),clientDataJSON:oW(d.clientDataJSON),signature:oW(d.signature),userHandle:n},type:h,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:o0(r.authenticatorAttachment)}}function o6(e){return{newRole:e=>{var t;return{authorize(e,r="AND"){let n=!1;for(let[i,s]of Object.entries(e)){let e=t[i];if(!e)return{success:!1,error:`You are not allowed to access resource: ${i}`};if(Array.isArray(s))n=s.every(t=>e.includes(t));else if("object"==typeof s)n="OR"===s.connector?s.actions.some(t=>e.includes(t)):s.actions.every(t=>e.includes(t));else throw new s6("Invalid access control request");if(n&&"OR"===r)return{success:n};if(!n&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${i}"`}}return n?{success:n}:{success:!1,error:"Not authorized"}},statements:t=e}},statements:e}}let o3=o6({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]});o3.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),o3.newRole({user:[],session:[]});let o9=o6({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]});o9.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),o9.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),o9.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]});let o8=function(e){var t;let{pluginPathMethods:r,pluginsActions:n,pluginsAtoms:i,$fetch:s,$store:o,atomListeners:a}=((e,t)=>{var r;let n,i,s="credentials"in Request.prototype,o=function(e,t,r,n,i){if(e)return s3(e,t);if(!1!==n){let e=tt.BETTER_AUTH_URL||tt.NEXT_PUBLIC_BETTER_AUTH_URL||tt.PUBLIC_BETTER_AUTH_URL||tt.NUXT_PUBLIC_BETTER_AUTH_URL||tt.NUXT_PUBLIC_AUTH_URL||("/"!==tt.BASE_URL?tt.BASE_URL:void 0);if(e)return s3(e,t)}r?.headers.get("x-forwarded-host"),r?.headers.get("x-forwarded-proto");if(r){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(r.url);if(!e)throw new s6("Could not get origin from request. Please provide a valid base URL.");return s3(e,t)}if("u">typeof window&&window.location)return s3(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",a=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],l={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:u,onError:c,onRequest:d,onResponse:h,...p}=e?.fetchOptions||{},f=(r={baseURL:o,...s?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:i,parseDates:s=!0}=t;if("string"!=typeof e)return e;let o=e.trim();if(o.length>0&&'"'===o[0]&&o.endsWith('"')&&!o.slice(1,-1).includes('"'))return o.slice(1,-1);let a=o.toLowerCase();if(a.length<=9&&a in oe)return oe[a];if(!s7.test(o)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(s8).some(([e,t])=>{let r=t.test(o);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(o,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=function(e){let t=ot.exec(e);if(!t)return null;let[,r,n,i,s,o,a,l,u,c,d]=t,h=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10),parseInt(s,10),parseInt(o,10),parseInt(a,10),l?parseInt(l.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(d,10))*("+"===u?-1:1);h.setUTCMinutes(h.getUTCMinutes()+e)}return h instanceof Date&&!isNaN(h.getTime())?h:null}(t);if(e)return e}return i?i(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...p,plugins:[l,...p.plugins||[],...e?.disableDefaultFetchPlugins?[]:[s9],...a]},async function(e,t){let n,i=oO(oI(oI({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,i,s,o;let a=(null==(i=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:i.schema)||n.schema;if(a){let r=e;(null==(s=a.config)?void 0:s.prefix)&&r.startsWith(a.config.prefix)&&(r=r.replace(a.config.prefix,""),a.config.baseURL&&(e=e.replace(a.config.prefix,a.config.baseURL))),(null==(o=a.config)?void 0:o.baseURL)&&r.startsWith(a.config.baseURL)&&(r=r.replace(a.config.baseURL,""));let n=a.schema[r];if(n){let r=oO(oI({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=oO(oI({},r),{body:n.input?await oF(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await oF(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await oF(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}}),...(null==t?void 0:t.plugins)||[]]});if(null==r?void 0:r.catchAllError)try{return await oZ(e,i)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await oZ(e,i)}),{$sessionSignal:m,session:g}=(oo(i=ol(n=os(!1),"/get-session",f,{method:"GET"}),()=>{let t=function(e){let{sessionAtom:t,sessionSignal:r,$fetch:n,options:i={}}=e,s=i.sessionOptions?.refetchInterval??0,o=i.sessionOptions?.refetchOnWindowFocus??!0,a=i.sessionOptions?.refetchWhenOffline??!1,l={lastSync:0,lastSessionRequest:0,cachedSession:void 0},u=e=>{if(!(a||oy().isOnline))return;if(e?.event==="storage"){l.lastSync=ov(),r.set(!r.get());return}let i=t.get();if(e?.event==="poll"){l.lastSessionRequest=ov(),n("/get-session").then(e=>{e.error?t.set({...i,data:null,error:e.error}):t.set({...i,data:e.data,error:null}),l.lastSync=ov(),r.set(!r.get())}).catch(()=>{});return}if(e?.event==="visibilitychange"){if(ov()-l.lastSessionRequest<5)return;l.lastSessionRequest=ov()}(i?.data===null||i?.data===void 0||e?.event==="visibilitychange")&&(l.lastSync=ov(),r.set(!r.get()))};return{init:()=>{s&&s>0&&(l.pollInterval=setInterval(()=>{t.get()?.data&&u({event:"poll"})},1e3*s)),l.unsubscribeBroadcast=od().subscribe(()=>{u({event:"storage"})}),o&&(l.unsubscribeFocus=of().subscribe(()=>{u({event:"visibilitychange"})})),l.unsubscribeOnline=oy().subscribe(e=>{e&&u({event:"visibilitychange"})}),od().setup(),of().setup(),oy().setup()},cleanup:()=>{l.pollInterval&&(clearInterval(l.pollInterval),l.pollInterval=void 0),l.unsubscribeBroadcast&&(l.unsubscribeBroadcast(),l.unsubscribeBroadcast=void 0),l.unsubscribeFocus&&(l.unsubscribeFocus(),l.unsubscribeFocus=void 0),l.unsubscribeOnline&&(l.unsubscribeOnline(),l.unsubscribeOnline=void 0),l.lastSync=0,l.lastSessionRequest=0,l.cachedSession=void 0},triggerRefetch:u,broadcastSessionUpdate:e=>{od().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:i,sessionSignal:n,$fetch:f,options:e});return t.init(),()=>{t.cleanup()}}),{session:i,$sessionSignal:n}),y=e?.plugins||[],v={},b={$sessionSignal:m,session:g},x={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},w=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of y)e.getAtoms&&Object.assign(b,e.getAtoms?.(f)),e.pathMethods&&Object.assign(x,e.pathMethods),e.atomListeners&&w.push(...e.atomListeners);let _={notify:e=>{b[e].set(!b[e].get())},listen:(e,t)=>{b[e].subscribe(t)},atoms:b};for(let t of y)t.getActions&&(v=ow(t.getActions?.(f,_,e)??{},v));return{get baseURL(){return o},pluginsActions:v,pluginsAtoms:b,pluginPathMethods:x,atomListeners:w,$fetch:f,$store:_}})(e),l={};for(let[e,t]of Object.entries(i))l[function(e){return`use${e.charAt(0).toUpperCase()+e.slice(1)}`}(e)]=()=>(function(e,t={}){let r=(0,T.useRef)(e.get()),{keys:n,deps:i=[e,n]}=t,s=(0,T.useCallback)(t=>{let i=e=>{r.current!==e&&(r.current=e,t())};if(i(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&i(e,r,n)})}return e.listen(i)},i),o=()=>r.current;return(0,T.useSyncExternalStore)(s,o,o)})(t);return t={...n,...l,$fetch:s,$store:o},function e(n=[]){return new Proxy(function(){},{get(r,i){var s;if("string"!=typeof i||"then"===i||"catch"===i||"finally"===i)return;let o=[...n,i],a=t;for(let e of o)if(a&&"object"==typeof a&&e in a)a=a[e];else{a=void 0;break}return"function"==typeof a?a:"object"==typeof(s=a)&&null!==s&&"get"in s&&"function"==typeof s.get&&"lc"in s&&"number"==typeof s.lc?a:e(o)},apply:async(e,t,o)=>{let l="/"+n.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=o[0]||{},c=o[1]||{},{query:d,fetchOptions:h,...p}=u,f={...c,...h},m=function(e,t,r){let n=t[e],{fetchOptions:i,query:s,...o}=r||{};return n||(i?.method?i.method:o&&Object.keys(o).length>0?"POST":"GET")}(l,r,u);return await s(l,{...f,body:"GET"===m?void 0:{...p,...f?.body||{}},query:d||f?.query,method:m,async onSuccess(e){if(await f?.onSuccess?.(e),!a||f.disableSignal)return;let t=a.filter(e=>e.matcher(l));if(!t.length)return;let r=new Set;for(let e of t){let t=i[e.signal];if(!t)return;if(r.has(e.signal))continue;r.add(e.signal);let n=t.get();setTimeout(()=>{t.set(!n)},10)}}})}})}()}({baseURL:window.location.origin,plugins:[(l=os(),{id:"passkey",$InferServerPlugin:{},getActions:(e,t)=>((e,{$listPasskeys:t,$store:r})=>({signIn:{passkey:async(n,i)=>{let s=await e("/passkey/generate-authenticate-options",{method:"GET",throw:!1});if(!s.data)return s;try{let o=await e("/passkey/verify-authentication",{body:{response:await o5({optionsJSON:s.data,useBrowserAutofill:n?.autoFill})},...n?.fetchOptions,...i,method:"POST",throw:!1});return t.set(Math.random()),r.notify("$sessionSignal"),o}catch(e){return console.error("[Better Auth] Error verifying passkey",e),{data:null,error:{code:"AUTH_CANCELLED",message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(r,n)=>{let i=await e("/passkey/generate-register-options",{method:"GET",query:{...r?.authenticatorAttachment&&{authenticatorAttachment:r.authenticatorAttachment},...r?.name&&{name:r.name}},throw:!1});if(!i.data)return i;try{let s=await o1({optionsJSON:i.data,useAutoRegister:r?.useAutoRegister}),o=await e("/passkey/verify-registration",{...r?.fetchOptions,...n,body:{response:s,name:r?.name},method:"POST",throw:!1});if(!o.data)return o;return t.set(Math.random()),o}catch(e){if(e instanceof oK){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===e.code)return{data:null,error:{code:e.code,message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===e.code)return{data:null,error:{code:e.code,message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{code:e.code,message:e.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{code:"UNKNOWN_ERROR",message:e instanceof Error?e.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}))(e,{$listPasskeys:l,$store:t}),getAtoms:e=>({listPasskeys:ol(l,"/passkey/list-user-passkeys",e,{method:"GET"}),$listPasskeys:l}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:e=>"/passkey/verify-registration"===e||"/passkey/delete-passkey"===e||"/passkey/update-passkey"===e||"/sign-out"===e,signal:"$listPasskeys"},{matcher:e=>"/passkey/verify-authentication"===e,signal:"$sessionSignal"}]}),{id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST","/delete-anonymous-user":"POST"},atomListeners:[{matcher:e=>"/sign-in/anonymous"===e,signal:"$sessionSignal"}]}]}),{signIn:o7,signUp:ae,useSession:at,signOut:ar}=o8,an=({onLogin:e,tenantName:t})=>{let[r,n]=(0,T.useState)("choice"),[i,s]=(0,T.useState)(""),[o,a]=(0,T.useState)("male"),[l,u]=(0,T.useState)(""),[c,d]=(0,T.useState)(null),h=async()=>{d(null),n("loading");try{console.log("[Passkey] Starting authentication...");let{data:e,error:t}=await o8.signIn.passkey();t&&(console.error("[Passkey] Login error:",t),404===t.status||"PASSKEY_NOT_FOUND"===t.code?d("Nessuna Passkey trovata per questo dispositivo. Registrati prima!"):d(t.message||"Errore durante l'accesso"),n("choice"))}catch(e){console.error("[Passkey] Unexpected login error:",e),"NotAllowedError"===e.name?d("L'operazione non  permessa in questo contesto. Assicurati di usare 'localhost' o HTTPS per accedere alla chat."):d(e.message||"Errore inaspettato"),n("choice")}},p=async e=>{if(e.preventDefault(),i.trim()&&l.trim()){d(null),n("loading");try{localStorage.setItem("waiting_for_passkey","true");let{data:e,error:t}=await o8.signIn.anonymous();if(t){localStorage.removeItem("waiting_for_passkey"),d(t.message||"Errore durante l'inizializzazione"),n("passkey_reg");return}let{error:r}=await o8.updateUser({name:i.trim(),phoneNumber:l.trim(),gender:o});r&&console.warn("Profile update failed, continuing with passkey",r),console.log("[Passkey] Starting biometric registration...");let{data:s,error:a}=await o8.passkey.addPasskey({name:"Passkey Principale"});a?(console.error("[Passkey] Registration error:",a),localStorage.removeItem("waiting_for_passkey"),d(a.message||"Errore durante la registrazione biometrica"),n("passkey_reg")):(console.log("[Passkey] Registration successful!"),await o8.updateUser({isAnonymous:!1}),localStorage.removeItem("waiting_for_passkey"),setTimeout(()=>{window.location.reload()},500))}catch(e){console.error("[Passkey] Unexpected error:",e),localStorage.removeItem("waiting_for_passkey"),"NotAllowedError"===e.name?d("L'operazione non  permessa in questo contesto. Assicurati di usare 'localhost' o HTTPS per accedere alla chat."):d(e.message||"Errore inaspettato"),n("passkey_reg")}}},f={male:"Maschio",female:"Femmina",other:"Altro"};return"loading"===r?(0,_.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col items-center justify-center",children:[(0,_.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mb-4"}),(0,_.jsx)("p",{className:"text-gray-500",children:"In attesa..."})]}):(0,_.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col justify-center",children:[(0,_.jsxs)("div",{className:"text-center mb-8",children:[(0,_.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 flex items-center justify-center",children:(0,_.jsx)("img",{src:"/local_logo.svg",alt:"Local Logo",className:"w-full h-full object-contain"})}),(0,_.jsx)("h1",{className:"text-2xl font-bold text-gray-800 tracking-tight",children:t}),"choice"===r&&(0,_.jsx)("p",{className:"text-gray-500 mt-2 text-sm",children:"chatta in modo anonimo o crea un profilo sicuro"})]}),c&&(0,_.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-100 text-red-600 text-sm rounded-xl text-center",children:c}),"choice"===r&&(0,_.jsxs)("div",{className:"space-y-4",children:[(0,_.jsx)("button",{onClick:()=>n("anonymous"),className:"w-full bg-white hover:bg-gray-50 text-gray-700 font-semibold py-4 rounded-xl border border-gray-200 transition-all flex items-center justify-center gap-2",children:"Accesso anonimo"}),(0,_.jsxs)("div",{className:"relative py-2",children:[(0,_.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,_.jsx)("div",{className:"w-full border-t border-gray-100"})}),(0,_.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,_.jsx)("span",{className:"bg-white px-2 text-gray-400",children:"Oppure"})})]}),(0,_.jsx)("button",{onClick:h,className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2",children:"Accedi con Passkey"}),(0,_.jsx)("button",{onClick:()=>n("passkey_reg"),className:"w-full text-emerald-600 font-semibold text-sm hover:underline py-2",children:"Non hai un account? Registrati con Passkey"})]}),"anonymous"===r&&(0,_.jsxs)("form",{onSubmit:t=>{t.preventDefault(),i.trim()&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),e({id:`guest_${Math.random().toString(36).substr(2,9)}`,alias:i.trim(),gender:o,joinedAt:Date.now()}))},className:"space-y-6",children:[(0,_.jsx)("button",{onClick:()=>n("choice"),className:"text-gray-400 text-sm flex items-center gap-1 hover:text-gray-600 mb-2",children:" Torna indietro"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Alias"}),(0,_.jsx)("input",{type:"text",required:!0,maxLength:20,value:i,onChange:e=>s(e.target.value),placeholder:"es. ShadowHunter",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Identit di Genere"}),(0,_.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(e=>(0,_.jsx)("button",{type:"button",onClick:()=>a(e),className:`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${o===e?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"}`,children:f[e]},e))})]}),(0,_.jsx)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200",children:"Entra nella Stanza"})]}),"passkey_reg"===r&&(0,_.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,_.jsx)("button",{onClick:()=>n("choice"),className:"text-gray-400 text-sm flex items-center gap-1 hover:text-gray-600 mb-2",children:" Torna indietro"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Scegli un Alias"}),(0,_.jsx)("input",{type:"text",required:!0,maxLength:20,value:i,onChange:e=>s(e.target.value),placeholder:"es. MarcoPass",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cellulare (per il recupero)"}),(0,_.jsx)("input",{type:"tel",required:!0,value:l,onChange:e=>u(e.target.value),placeholder:"+39 333 1234567",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,_.jsx)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2",children:"Crea Account con Passkey"}),(0,_.jsx)("p",{className:"text-[11px] text-gray-400 leading-relaxed",children:"Il tuo numero verr utilizzato esclusivamente per permetterti di recuperare l'accesso in caso di smarrimento del dispositivo."})]}),(0,_.jsx)("p",{className:"text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest",children:"Powered by Local - Copyright 2025"})]})};var ai=e.i(74080);function as(e){e()}function ao(e,t){return r=>e(t(r))}function aa(e){return void 0!==e}function al(){}function au(e,t){return t(e)}function ac(...e){return e}function ad(e){e(2)}function ah(e){return e(4)}function ap(e,t){return e(1,e=>t(0,e))}function af(e,t){let r=e(1,e=>{r(),t(e)});return r}function am(e){let t,r;return n=>i=>{t=i,r&&clearTimeout(r),r=setTimeout(()=>{n(t)},e)}}function ag(e,t){return e===t}function ay(e=ag){let t;return r=>n=>{e(t,n)||(t=n,r(n))}}function av(e){return t=>r=>{e(r)&&t(r)}}function ab(e){return t=>ao(t,e)}function ax(e){return t=>()=>{t(e)}}function aw(e,...t){let r=function(...e){return t=>e.reduceRight(au,t)}(...t);return(t,n)=>{switch(t){case 2:ad(e);return;case 1:return e(1,r(n))}}}function a_(e,t){return r=>n=>{r(t=e(t,n))}}function aT(e){return t=>r=>{e>0?e--:t(r)}}function aS(e){let t=null,r;return n=>i=>{t=i,r||(r=setTimeout(()=>{r=void 0,n(t)},e))}}function aE(...e){let t=Array(e.length),r=0,n=null,i=Math.pow(2,e.length)-1;return e.forEach((e,s)=>{let o=Math.pow(2,s);e(1,e=>{let a=r;r|=o,t[s]=e,a!==i&&r===i&&n&&(n(),n=null)})}),e=>s=>{let o=()=>{e([s].concat(t))};r===i?o():n=o}}function ak(e){let t=e,r=aR();return(e,n)=>{switch(e){case 0:t=n;break;case 1:n(t);break;case 4:return t}return r(e,n)}}function az(e,t){var r;return r=ak(t),ap(e,r),r}function aR(){let e=[];return(t,r)=>{switch(t){case 0:e.slice().forEach(e=>{e(r)});return;case 2:e.splice(0,e.length);return;case 1:return e.push(r),()=>{let t=e.indexOf(r);t>-1&&e.splice(t,1)}}}}function aI(e){var t;return t=aR(),ap(e,t),t}function aO(e,t=[],{singleton:r}={singleton:!0}){return{constructor:e,dependencies:t,id:aC(),singleton:r}}let aC=()=>Symbol();function aj(...e){let t=aR(),r=Array(e.length),n=0,i=Math.pow(2,e.length)-1;return e.forEach((e,s)=>{let o=Math.pow(2,s);e(1,e=>{r[s]=e,(n|=o)===i&&t(0,r)})}),function(e,s){switch(e){case 2:return void ad(t);case 1:return n===i&&s(r),t(1,s)}}}function aA(e,t=ag){return aw(e,ay(t))}function aN(...e){return function(t,r){switch(t){case 2:return;case 1:return function(...e){return()=>{e.map(as)}}(...e.map(e=>e(1,r)))}}}var a$=((u=a$||{})[u.DEBUG=0]="DEBUG",u[u.INFO=1]="INFO",u[u.WARN=2]="WARN",u[u.ERROR=3]="ERROR",u);let aP={0:"debug",3:"error",1:"log",2:"warn"},aL=aO(()=>{let e=ak(3);return{log:ak((t,r,n=1)=>{var i;n>=(null!=(i=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?i:ah(e))&&console[aP[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,r)}),logLevel:e}},[],{singleton:!0});function aB(e,t,r){return aM(e,t,r).callbackRef}function aM(e,t,r){let n=T.default.useRef(null),i=T.default.useMemo(()=>"u">typeof ResizeObserver?new ResizeObserver(t=>{let n=()=>{let r=t[0].target;null!==r.offsetParent&&e(r)};r?n():requestAnimationFrame(n)}):null,[e,r]);return{callbackRef:e=>{e&&t?(null==i||i.observe(e),n.current=e):(n.current&&(null==i||i.unobserve(n.current)),n.current=null)},ref:n}}function aD(e,t,r,n,i,s,o,a,l){return aM(T.default.useCallback(r=>{let l,u=function(e,t,r,n){let i=e.length;if(0===i)return null;let s=[];for(let o=0;o<i;o++){let i=e.item(o);if(void 0===i.dataset.index)continue;let a=parseInt(i.dataset.index),l=parseFloat(i.dataset.knownSize),u=t(i,r);if(0===u&&n("Zero-sized element, this should not happen",{child:i},a$.ERROR),u===l)continue;let c=s[s.length-1];0===s.length||c.size!==u||c.endIndex!==a-1?s.push({endIndex:a,size:u,startIndex:a}):s[s.length-1].endIndex++}return s}(r.children,t,a?"offsetWidth":"offsetHeight",i),c=r.parentElement;for(;!c.dataset.virtuosoScroller;)c=c.parentElement;let d="window"===c.lastElementChild.dataset.viewportType;d&&(l=c.ownerDocument.defaultView);let h=o?a?o.scrollLeft:o.scrollTop:d?a?l.scrollX||l.document.documentElement.scrollLeft:l.scrollY||l.document.documentElement.scrollTop:a?c.scrollLeft:c.scrollTop;n({scrollHeight:o?a?o.scrollWidth:o.scrollHeight:d?a?l.document.documentElement.scrollWidth:l.document.documentElement.scrollHeight:a?c.scrollWidth:c.scrollHeight,scrollTop:Math.max(h,0),viewportHeight:o?a?o.offsetWidth:o.offsetHeight:d?a?l.innerWidth:l.innerHeight:a?c.offsetWidth:c.offsetHeight}),null==s||s(a?aH("column-gap",getComputedStyle(r).columnGap,i):aH("row-gap",getComputedStyle(r).rowGap,i)),null!==u&&e(u)},[e,t,i,s,o,n,a]),r,l)}function aH(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,a$.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}function aF(e,t,r){let n=T.default.useRef(null),i=T.default.useCallback(r=>{let i,s;if(!(null!=r&&r.offsetParent))return;let a=r.getBoundingClientRect(),l=a.width;if(t){let e=t.getBoundingClientRect(),r=a.top-e.top;s=e.height-Math.max(0,r),i=r+t.scrollTop}else{let e=o.current.ownerDocument.defaultView;s=e.innerHeight-Math.max(0,a.top),i=a.top+e.scrollY}n.current={offsetTop:i,visibleHeight:s,visibleWidth:l},e(n.current)},[e,t]),{callbackRef:s,ref:o}=aM(i,!0,r),a=T.default.useCallback(()=>{i(o.current)},[i,o]);return T.default.useEffect(()=>{var e;if(t){t.addEventListener("scroll",a);let e=new ResizeObserver(()=>{requestAnimationFrame(a)});return e.observe(t),()=>{t.removeEventListener("scroll",a),e.unobserve(t)}}{let t=null==(e=o.current)?void 0:e.ownerDocument.defaultView;return null==t||t.addEventListener("scroll",a),null==t||t.addEventListener("resize",a),()=>{null==t||t.removeEventListener("scroll",a),null==t||t.removeEventListener("resize",a)}}},[a,t,o]),s}let aU=aO(()=>{let e=aR(),t=aR(),r=ak(0),n=aR(),i=ak(0),s=aR(),o=aR(),a=ak(0),l=ak(0),u=ak(0),c=ak(0),d=aR(),h=aR(),p=ak(!1),f=ak(!1),m=ak(!1);return ap(aw(e,ab(({scrollTop:e})=>e)),t),ap(aw(e,ab(({scrollHeight:e})=>e)),o),ap(t,i),{deviation:r,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:c,headerHeight:a,horizontalDirection:f,scrollBy:h,scrollContainerState:e,scrollHeight:o,scrollingInProgress:p,scrollTo:d,scrollTop:t,skipAnimationFrameInResizeObserver:m,smoothScrollTargetReached:n,statefulScrollTop:i,viewportHeight:s}},[],{singleton:!0}),aZ={lvl:0};function aW(e,t){let r=e.length;if(0===r)return[];let{index:n,value:i}=t(e[0]),s=[];for(let o=1;o<r;o++){let{index:r,value:a}=t(e[o]);s.push({end:r-1,start:n,value:i}),n=r,i=a}return s.push({end:1/0,start:n,value:i}),s}function aV(e){return e===aZ}function aq(e,t){if(!aV(e))return t===e.k?e.v:t<e.k?aq(e.l,t):aq(e.r,t)}function aG(e,t,r="k"){if(aV(e))return[-1/0,void 0];if(Number(e[r])===t)return[e.k,e.v];if(Number(e[r])<t){let n=aG(e.r,t,r);return n[0]===-1/0?[e.k,e.v]:n}return aG(e.l,t,r)}function aJ(e,t,r){return aV(e)?a1(t,r,1):t===e.k?aX(e,{k:t,v:r}):t<e.k?a4(a2(aX(e,{l:aJ(e.l,t,r)}))):a4(a2(aX(e,{r:aJ(e.r,t,r)})))}function aQ(e,t,r){if(aV(e))return[];let n=aG(e,t)[0];return aW(function e(t,r,n){if(aV(t))return[];let{k:i,l:s,r:o,v:a}=t,l=[];return i>r&&(l=l.concat(e(s,r,n))),i>=r&&i<=n&&l.push({k:i,v:a}),i<=n&&(l=l.concat(e(o,r,n))),l}(e,n,r),({k:e,v:t})=>({index:e,value:t}))}function aK(e){return aV(e)?[]:[...aK(e.l),{k:e.k,v:e.v},...aK(e.r)]}function aY(e){let{l:t,lvl:r,r:n}=e;if(n.lvl>=r-1&&t.lvl>=r-1)return e;if(r>n.lvl+1){if(a0(t))return a2(aX(e,{lvl:r-1}));if(!aV(t)&&!aV(t.r))return aX(t.r,{l:aX(t,{r:t.r.l}),lvl:r,r:aX(e,{l:t.r.r,lvl:r-1})});throw Error("Unexpected empty nodes")}if(a0(e))return a4(aX(e,{lvl:r-1}));if(aV(n)||aV(n.l))throw Error("Unexpected empty nodes");{let t=n.l,i=a0(t)?n.lvl-1:n.lvl;return aX(t,{l:aX(e,{lvl:r-1,r:t.l}),lvl:t.lvl+1,r:a4(aX(n,{l:t.r,lvl:i}))})}}function aX(e,t){return a1(void 0!==t.k?t.k:e.k,void 0!==t.v?t.v:e.v,void 0!==t.lvl?t.lvl:e.lvl,void 0!==t.l?t.l:e.l,void 0!==t.r?t.r:e.r)}function a0(e){return aV(e)||e.lvl>e.r.lvl}function a1(e,t,r,n=aZ,i=aZ){return{k:e,l:n,lvl:r,r:i,v:t}}function a2(e){let{l:t}=e;return aV(t)||t.lvl!==e.lvl?e:aX(t,{r:aX(e,{l:t.r})})}function a4(e){let{lvl:t,r:r}=e;return aV(r)||aV(r.r)||r.lvl!==t||r.r.lvl!==t?e:aX(r,{l:aX(e,{r:r.l}),lvl:t+1})}function a5(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}function a6(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}let a3=aO(()=>({recalcInProgress:ak(!1)}),[],{singleton:!0});function a9(e,t,r,n=0){let i=e.length-1;for(;n<=i;){let s=Math.floor((n+i)/2),o=r(e[s],t);if(0===o)return s;if(-1===o){if(i-n<2)return s-1;i=s-1}else{if(i===n)return s;n=s+1}}throw Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function a8(e,t){return Math.round(e.getBoundingClientRect()[t])}function a7(e){return!aV(e.groupOffsetTree)}function le({index:e},t){return t===e?0:t<e?-1:1}function lt({offset:e},t){return t===e?0:t<e?-1:1}function lr(e,t,r){if(0===t.length)return 0;let{index:n,offset:i,size:s}=t[a9(t,e,le)],o=e-n,a=s*o+(o-1)*r+i;return a>0?a+r:a}function ln(e,t){if(!a7(t))return e;let r=0;for(;t.groupIndices[r]<=e+r;)r++;return e+r}function li(e,t,r){if("u">typeof e.groupIndex)return t.groupIndices[e.groupIndex]+1;{let n=ln("LAST"===e.index?r:e.index,t);return Math.max(0,n,Math.min(r,n))}}function ls(e,[t,r,n,i]){t.length>0&&n("received item sizes",t,a$.DEBUG);let s=e.sizeTree,o=s,a=0;if(r.length>0&&aV(s)&&2===t.length){let e=t[0].size,n=t[1].size;o=r.reduce((t,r)=>aJ(aJ(t,r,e),r+1,n),o)}else[o,a]=function(e,t){let r=aV(e)?0:1/0;for(let n of t){let{endIndex:t,size:i,startIndex:s}=n;if(r=Math.min(r,s),aV(e)){e=aJ(e,0,i);continue}let o=aQ(e,s-1,t+1);if(o.some(function(e){let{endIndex:t,size:r,startIndex:n}=e;return e=>e.start===n&&(e.end===t||e.end===1/0)&&e.value===r}(n)))continue;let a=!1,l=!1;for(let{end:r,start:n,value:s}of o)a?(t>=n||i===s)&&(e=function e(t,r){if(aV(t))return aZ;let{k:n,l:i,r:s}=t;if(r!==n)return r<n?aY(aX(t,{l:e(i,r)})):aY(aX(t,{r:e(s,r)}));if(aV(i))return s;if(aV(s))return i;{let[e,r]=function e(t){return aV(t.r)?[t.k,t.v]:e(t.r)}(i);return aY(aX(t,{k:e,l:function e(t){return aV(t.r)?t.l:aY(aX(t,{r:e(t.r)}))}(i),v:r}))}}(e,n)):(l=s!==i,a=!0),r>t&&t>=n&&s!==i&&(e=aJ(e,t+1,s));l&&(e=aJ(e,s,i))}return[e,r]}(o,t);if(o===s)return e;let{lastIndex:l,lastOffset:u,lastSize:c,offsetTree:d}=la(e.offsetTree,a,o,i);return{groupIndices:r,groupOffsetTree:r.reduce((e,t)=>aJ(e,t,lr(t,d,i)),aZ),lastIndex:l,lastOffset:u,lastSize:c,offsetTree:d,sizeTree:o}}function lo(e,t){let r=0,n=0;for(;r<e;)r+=t[n+1]-t[n]-1,n++;return n-(r!==e)}function la(e,t,r,n){let i=e,s=0,o=0,a=0,l=0;if(0!==t){l=a9(i,t-1,le),a=i[l].offset;let e=aG(r,t-1);s=e[0],o=e[1],i.length&&i[l].size===aG(r,t)[1]&&(l-=1),i=i.slice(0,l+1)}else i=[];for(let{start:e,value:l}of aQ(r,t,1/0)){let t=e-s,r=t*o+a+t*n;i.push({index:e,offset:r,size:l}),s=e,a=r,o=l}return{lastIndex:s,lastOffset:a,lastSize:o,offsetTree:i}}function ll(e){return{index:e.index,value:e}}let lu={offsetHeight:"height",offsetWidth:"width"},lc=aO(([{log:e},{recalcInProgress:t}])=>{let r=aR(),n=aR(),i=az(n,0),s=aR(),o=aR(),a=ak(0),l=ak([]),u=ak(void 0),c=ak(void 0),d=ak(void 0),h=ak(void 0),p=ak((e,t)=>a8(e,lu[t])),f=ak(void 0),m=ak(0),g={groupIndices:[],groupOffsetTree:aZ,lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:aZ},y=az(aw(r,aE(l,e,m),a_(ls,g),ay()),g),v=az(aw(l,ay(),a_((e,t)=>({current:t,prev:e.current}),{current:[],prev:[]}),ab(({prev:e})=>e)),[]);ap(aw(l,av(e=>e.length>0),aE(y,m),ab(([e,t,r])=>{let n=e.reduce((e,n,i)=>aJ(e,n,lr(n,t.offsetTree,r)||i),aZ);return{...t,groupIndices:e,groupOffsetTree:n}})),y),ap(aw(n,aE(y),av(([e,{lastIndex:t}])=>e<t),ab(([e,{lastIndex:t,lastSize:r}])=>[{endIndex:t,size:r,startIndex:e}])),r),ap(u,c);let b=az(aw(u,ab(e=>void 0===e)),!0);ap(aw(c,av(e=>void 0!==e&&aV(ah(y).sizeTree)),ab(e=>{let t=ah(d),r=ah(l).length>0;return t?r?[{endIndex:0,size:t,startIndex:0},{endIndex:1,size:e,startIndex:1}]:[]:[{endIndex:0,size:e,startIndex:0}]})),r),ap(aw(h,av(e=>void 0!==e&&e.length>0&&aV(ah(y).sizeTree)),ab(e=>{let t=[],r=e[0],n=0;for(let i=1;i<e.length;i++){let s=e[i];s!==r&&(t.push({endIndex:i-1,size:r,startIndex:n}),r=s,n=i)}return t.push({endIndex:e.length-1,size:r,startIndex:n}),t})),r),ap(aw(l,aE(d,c),av(([,e,t])=>void 0!==e&&void 0!==t),ab(([e,t,r])=>{let n=[];for(let i=0;i<e.length;i++){let s=e[i],o=e[i+1];n.push({startIndex:s,endIndex:s,size:t}),void 0!==o&&n.push({startIndex:s+1,endIndex:o-1,size:r})}return n})),r);let x=aI(aw(r,aE(y),a_(({sizes:e},[t,r])=>({changed:r!==e,sizes:r}),{changed:!1,sizes:g}),ab(e=>e.changed)));aw(a,a_((e,t)=>({diff:e.prev-t,prev:t}),{diff:0,prev:0}),ab(e=>e.diff))(1,e=>{let{groupIndices:r}=ah(y);if(e>0)t(0,!0),s(0,e+lo(e,r));else if(e<0){let t=ah(v);t.length>0&&(e-=lo(-e,t)),o(0,e)}}),aw(a,aE(e))(1,([e,t])=>{e<0&&t("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},a$.ERROR)});let w=aI(s);ap(aw(s,aE(y),ab(([e,t])=>{let r=t.groupIndices.length>0,n=[],i=t.lastSize;if(r){let r=aq(t.sizeTree,0),s=0,o=0;for(;s<e;){let e=t.groupIndices[o],a=t.groupIndices.length===o+1?1/0:t.groupIndices[o+1]-e-1;n.push({endIndex:e,size:r,startIndex:e}),n.push({endIndex:e+1+a-1,size:i,startIndex:e+1}),o++,s+=a+1}let a=aK(t.sizeTree);return s!==e&&a.shift(),a.reduce((t,{k:r,v:n})=>{let i=t.ranges;return 0!==t.prevSize&&(i=[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]),{prevIndex:r+e,prevSize:n,ranges:i}},{prevIndex:e,prevSize:0,ranges:n}).ranges}return aK(t.sizeTree).reduce((t,{k:r,v:n})=>({prevIndex:r+e,prevSize:n,ranges:[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]}),{prevIndex:0,prevSize:i,ranges:[]}).ranges})),r);let _=aI(aw(o,aE(y,m),ab(([e,{offsetTree:t},r])=>lr(-e,t,r))));return ap(aw(o,aE(y,m),ab(([e,t,r])=>{if(t.groupIndices.length>0){if(aV(t.sizeTree))return t;let n=aZ,i=ah(v),s=0,o=0,a=0;for(;s<-e;){a=i[o];let e=i[o+1]-a-1;o++,s+=e+1}return n=aK(t.sizeTree).reduce((t,{k:r,v:n})=>aJ(t,Math.max(0,r+e),n),n),s!==-e&&(n=aJ(n,0,aq(t.sizeTree,a)),n=aJ(n,1,aG(t.sizeTree,-e+1)[1])),{...t,sizeTree:n,...la(t.offsetTree,0,n,r)}}{let n=aK(t.sizeTree).reduce((t,{k:r,v:n})=>aJ(t,Math.max(0,r+e),n),aZ);return{...t,sizeTree:n,...la(t.offsetTree,0,n,r)}}})),y),{beforeUnshiftWith:w,data:f,defaultItemSize:c,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:d,gap:m,groupIndices:l,heightEstimates:h,itemSize:p,listRefresh:x,shiftWith:o,shiftWithOffset:_,sizeRanges:r,sizes:y,statefulTotalCount:i,totalCount:n,trackItemSizes:b,unshiftWith:s}},ac(aL,a3),{singleton:!0});function ld(e){return e.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{groupIndices:[],totalCount:0})}let lh=aO(([{groupIndices:e,sizes:t,totalCount:r},{headerHeight:n,scrollTop:i}])=>{let s=aR(),o=aR(),a=aI(aw(s,ab(ld)));return ap(aw(a,ab(e=>e.totalCount)),r),ap(aw(a,ab(e=>e.groupIndices)),e),ap(aw(aj(i,t,n),av(([e,t])=>a7(t)),ab(([e,t,r])=>aG(t.groupOffsetTree,Math.max(e-r,0),"v")[0]),ay(),ab(e=>[e])),o),{groupCounts:s,topItemsIndexes:o}},ac(lc,aU)),lp=aO(([{log:e}])=>{let t=ak(!1),r=aI(aw(t,av(e=>e),ay()));return t(1,t=>{t&&ah(e)("props updated",{},a$.DEBUG)}),{didMount:r,propsReady:t}},ac(aL),{singleton:!0}),lf="u">typeof document&&"scrollBehavior"in document.documentElement.style;function lm(e){let t="number"==typeof e?{index:e}:e;return t.align||(t.align="start"),t.behavior&&lf||(t.behavior="auto"),t.offset||(t.offset=0),t}let lg=aO(([{gap:e,listRefresh:t,sizes:r,totalCount:n},{fixedFooterHeight:i,fixedHeaderHeight:s,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:c,viewportHeight:d},{log:h}])=>{let p=aR(),f=aR(),m=ak(0),g=null,y=null,v=null;function b(){g&&(g(),g=null),v&&(v(),v=null),y&&(clearTimeout(y),y=null),l(0,!1)}return ap(aw(p,aE(r,d,n,m,a,o,h),aE(e,s,i),ab(([[e,r,n,i,s,o,a,u],d,h,m])=>{let x=lm(e),{align:w,behavior:_,offset:T}=x,S=i-1,E=li(x,r,S),k=lr(E,r.offsetTree,d)+o;"end"===w?(k+=h+aG(r.sizeTree,E)[1]-n+m,E===S&&(k+=a)):"center"===w?k+=(h+aG(r.sizeTree,E)[1]-n+m)/2:k-=s,T&&(k+=T);let z=t=>{b(),t?(u("retrying to scroll to",{location:e},a$.DEBUG),p(0,e)):(f(0,!0),u("list did not change, scroll successful",{},a$.DEBUG))};if(b(),"smooth"===_){let e=!1;v=t(1,t=>{e=e||t}),g=af(c,()=>{z(e)})}else g=af(aw(t,e=>{let t=setTimeout(()=>{e(!1)},150);return r=>{r&&(e(!0),clearTimeout(t))}}),z);return y=setTimeout(()=>{b()},1200),l(0,!0),u("scrolling from index to",{behavior:_,index:E,top:k},a$.DEBUG),{behavior:_,top:k}})),u),{scrollTargetReached:f,scrollToIndex:p,topListHeight:m}},ac(lc,aU,aL),{singleton:!0});function ly(e,t){0==e?t():requestAnimationFrame(()=>{ly(e-1,t)})}function lv(e,t){return"number"==typeof e?e:"LAST"===e.index?t-1:e.index}let lb=aO(([{defaultItemSize:e,listRefresh:t,sizes:r},{scrollTop:n},{scrollTargetReached:i,scrollToIndex:s},{didMount:o}])=>{let a=ak(!0),l=ak(0),u=ak(!0);return ap(aw(o,aE(l),av(([e,t])=>!!t),ax(!1)),a),ap(aw(o,aE(l),av(([e,t])=>!!t),ax(!1)),u),aw(aj(t,o),aE(a,r,e,u),av(([[,e],t,{sizeTree:r},n,i])=>e&&(!aV(r)||aa(n))&&!t&&!i),aE(l))(1,([,e])=>{af(i,()=>{u(0,!0)}),ly(4,()=>{af(n,()=>{a(0,!0)}),s(0,e)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},ac(lc,aU,lg,lp),{singleton:!0});function lx(e,t){return 1.01>Math.abs(e-t)}let lw="down",l_={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},lT=aO(([{footerHeight:e,headerHeight:t,scrollBy:r,scrollContainerState:n,scrollTop:i,viewportHeight:s}])=>{let o=ak(!1),a=ak(!0),l=aR(),u=aR(),c=ak(4),d=ak(0),h=az(aw(aN(aw(aA(i),aT(1),ax(!0)),aw(aA(i),aT(1),ax(!1),am(100))),ay()),!1),p=az(aw(aN(aw(r,ax(!0)),aw(r,ax(!1),am(200))),ay()),!1);ap(aw(aj(aA(i),aA(d)),ab(([e,t])=>e<=t),ay()),a),ap(aw(a,aS(50)),u);let f=aI(aw(aj(n,aA(s),aA(t),aA(e),aA(c)),a_((e,[{scrollHeight:t,scrollTop:r},n,i,s,o])=>{let a={scrollHeight:t,scrollTop:r,viewportHeight:n};if(r+n-t>-o){let t,n;return r>e.state.scrollTop?(t="SCROLLED_DOWN",n=e.state.scrollTop-r):(t="SIZE_DECREASED",n=e.state.scrollTop-r||e.scrollTopDelta),{atBottom:!0,atBottomBecause:t,scrollTopDelta:n,state:a}}return{atBottom:!1,notAtBottomBecause:a.scrollHeight>e.state.scrollHeight?"SIZE_INCREASED":n<e.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":r<e.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:a}},l_),ay((e,t)=>e&&e.atBottom===t.atBottom))),m=az(aw(n,a_((e,{scrollHeight:t,scrollTop:r,viewportHeight:n})=>{if(lx(e.scrollHeight,t))return{changed:!1,jump:0,scrollHeight:t,scrollTop:r};{let i=t-(r+n)<1;return e.scrollTop!==r&&i?{changed:!0,jump:e.scrollTop-r,scrollHeight:t,scrollTop:r}:{changed:!0,jump:0,scrollHeight:t,scrollTop:r}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),av(e=>e.changed),ab(e=>e.jump)),0);ap(aw(f,ab(e=>e.atBottom)),o),ap(aw(o,aS(50)),l);let g=ak(lw);ap(aw(n,ab(({scrollTop:e})=>e),ay(),a_((e,t)=>ah(p)?{direction:e.direction,prevScrollTop:t}:{direction:t<e.prevScrollTop?"up":lw,prevScrollTop:t},{direction:lw,prevScrollTop:0}),ab(e=>e.direction)),g),ap(aw(n,aS(50),ax("none")),g);let y=ak(0);return ap(aw(h,av(e=>!e),ax(0)),y),ap(aw(i,aS(100),aE(h),av(([e,t])=>t),a_(([e,t],[r])=>[t,r],[0,0]),ab(([e,t])=>t-e)),y),{atBottomState:f,atBottomStateChange:l,atBottomThreshold:c,atTopStateChange:u,atTopThreshold:d,isAtBottom:o,isAtTop:a,isScrolling:h,lastJumpDueToItemResize:m,scrollDirection:g,scrollVelocity:y}},ac(aU)),lS="bottom",lE="none";function lk(e,t,r){return"number"==typeof e?"up"===r&&"top"===t||r===lw&&t===lS?e:0:"up"===r?"top"===t?e.main:e.reverse:t===lS?e.main:e.reverse}function lz(e,t){var r;return"number"==typeof e?e:null!=(r=e[t])?r:0}let lR=aO(([{deviation:e,fixedHeaderHeight:t,headerHeight:r,scrollTop:n,viewportHeight:i}])=>{let s=aR(),o=ak(0),a=ak(0),l=ak(0),u=az(aw(aj(aA(n),aA(i),aA(r),aA(s,a6),aA(l),aA(o),aA(t),aA(e),aA(a)),ab(([e,t,r,[n,i],s,o,a,l,u])=>{let c=e-l,d=Math.max(r-c,0),h=lE,p=lz(u,"top"),f=lz(u,lS);return n-=l,n+=r+a,i+=r+a,n>e+(o+a)-p&&(h="up"),(i-=l)<e-d+t+f&&(h=lw),h!==lE?[Math.max(c-r-lk(s,"top",h)-p,0),c-d-a+t+lk(s,lS,h)+f]:null}),av(e=>null!=e),ay(a6)),[0,0]);return{increaseViewportBy:a,listBoundary:s,overscan:l,topListHeight:o,visibleRange:u}},ac(aU),{singleton:!0}),lI={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function lO(e,t,r,n,i,s){let{lastIndex:o,lastOffset:a,lastSize:l}=i,u=0,c=0;if(e.length>0){u=e[0].offset;let t=e[e.length-1];c=t.offset+t.size}let d=r-o,h=u,p=a+d*l+(d-1)*n-c;return{bottom:c,firstItemIndex:s,items:lj(e,i,s),offsetBottom:p,offsetTop:u,top:h,topItems:lj(t,i,s),topListHeight:t.reduce((e,t)=>t.size+e,0),totalCount:r}}function lC(e,t,r,n,i,s){let o=0;if(r.groupIndices.length>0)for(let t of r.groupIndices){if(t-o>=e)break;o++}let a=e+o,l=lv(t,a);return lO(Array.from({length:a}).map((e,t)=>({data:s[t+l],index:t+l,offset:0,size:0})),[],a,i,r,n)}function lj(e,t,r){if(0===e.length)return[];if(!a7(t))return e.map(e=>({...e,index:e.index+r,originalIndex:e.index}));let n=e[0].index,i=e[e.length-1].index,s=[],o=aQ(t.groupOffsetTree,n,i),a,l=0;for(let n of e){let e;(!a||a.end<n.index)&&(a=o.shift(),l=t.groupIndices.indexOf(a.start)),e=n.index===a.start?{index:l,type:"group"}:{groupIndex:l,index:n.index-(l+1)+r},s.push({...e,data:n.data,offset:n.offset,originalIndex:n.index,size:n.size})}return s}function lA(e,t){var r;return void 0===e?0:"number"==typeof e?e:null!=(r=e[t])?r:0}let lN=aO(([{data:e,firstItemIndex:t,gap:r,sizes:n,totalCount:i},s,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:c},{topListHeight:d},h,{didMount:p},{recalcInProgress:f}])=>{let m=ak([]),g=ak(0),y=aR(),v=ak(0);ap(s.topItemsIndexes,m);let b=az(aw(aj(p,f,aA(l,a6),aA(i),aA(n),aA(u),c,aA(m),aA(t),aA(r),aA(v),e),av(([e,t,,r,,,,,,,,n])=>{let i=n&&n.length!==r;return e&&!t&&!i}),ab(([,,[e,t],r,n,i,s,o,a,l,u,c])=>{var d,h,p,f,m;let{offsetTree:y,sizeTree:v}=n,b=ah(g);if(0===r)return{...lI,totalCount:r};if(0===e&&0===t)return 0===b?{...lI,totalCount:r}:lC(b,i,n,a,l,c||[]);if(aV(v))return b>0?null:lO(function(e,t,r){if(a7(t)){let n=ln(e,t);return[{index:aG(t.groupOffsetTree,n)[0],offset:0,size:0},{data:null==r?void 0:r[0],index:n,offset:0,size:0}]}return[{data:null==r?void 0:r[0],index:e,offset:0,size:0}]}(lv(i,r),n,c),[],r,l,n,a);let x=[];if(o.length>0){let e=o[0],t=o[o.length-1],r=0;for(let n of aQ(v,e,t)){let i=n.value,s=Math.max(n.start,e),o=Math.min(n.end,t);for(let e=s;e<=o;e++)x.push({data:null==c?void 0:c[e],index:e,offset:r,size:i}),r+=i}}if(!s)return lO([],x,r,l,n,a);let w=o.length>0?o[o.length-1]+1:0,_=function(e,t,r,n=0){let i,s;return n>0&&(t=Math.max(t,e[a9(e,n,le)].offset)),aW((i=a9(e,t,lt),s=a9(e,r,lt,i),e.slice(i,s+1)),ll)}(y,e,t,w);if(0===_.length)return null;let T=r-1,S=((r=>{for(let n of _){let i=n.value,s=i.offset,o=n.start,a=i.size;if(i.offset<e){let t=(o+=Math.floor((e-i.offset+l)/(a+l)))-n.start;s+=t*a+t*l}o<w&&(s+=(w-o)*a,o=w);let u=Math.min(n.end,T);for(let e=o;e<=u&&!(s>=t);e++)r.push({data:null==c?void 0:c[e],index:e,offset:s,size:a}),s+=a+l}})(m=[]),m),E=lA(u,"top"),k=lA(u,lS);if(S.length>0&&(E>0||k>0)){let e=S[0],t=S[S.length-1];if(E>0&&e.index>w){let t=Math.min(E,e.index-w),r=[],n=e.offset;for(let i=e.index-1;i>=e.index-t;i--){let t=null!=(h=null==(d=aQ(v,i,i)[0])?void 0:d.value)?h:e.size;n-=t+l,r.unshift({data:null==c?void 0:c[i],index:i,offset:n,size:t})}S.unshift(...r)}if(k>0&&t.index<T){let e=Math.min(k,T-t.index),r=t.offset+t.size+l;for(let n=t.index+1;n<=t.index+e;n++){let e=null!=(f=null==(p=aQ(v,n,n)[0])?void 0:p.value)?f:t.size;S.push({data:null==c?void 0:c[n],index:n,offset:r,size:e}),r+=e+l}}}return lO(S,x,r,l,n,a)}),av(e=>null!==e),ay()),lI);ap(aw(e,av(aa),ab(e=>null==e?void 0:e.length)),i),ap(aw(b,ab(e=>e.topListHeight)),d),ap(d,a),ap(aw(b,ab(e=>[e.top,e.bottom])),o),ap(aw(b,ab(e=>e.items)),y);let x=aI(aw(b,av(({items:e})=>e.length>0),aE(i,e),av(([{items:e},t])=>e[e.length-1].originalIndex===t-1),ab(([,e,t])=>[e-1,t]),ay(a6),ab(([e])=>e))),w=aI(aw(b,aS(200),av(({items:e,topItems:t})=>e.length>0&&e[0].originalIndex===t.length),ab(({items:e})=>e[0].index),ay())),_=aI(aw(b,av(({items:e})=>e.length>0),ab(({items:e})=>{let t=0,r=e.length-1;for(;"group"===e[t].type&&t<r;)t++;for(;"group"===e[r].type&&r>t;)r--;return{endIndex:e[r].index,startIndex:e[t].index}}),ay(a5)));return{endReached:x,initialItemCount:g,itemsRendered:y,listState:b,minOverscanItemCount:v,rangeChanged:_,startReached:w,topItemsIndexes:m,...h}},ac(lc,lh,lR,lb,lg,lT,lp,a3),{singleton:!0}),l$=aO(([{fixedFooterHeight:e,fixedHeaderHeight:t,footerHeight:r,headerHeight:n},{listState:i}])=>{let s=aR(),o=az(aw(aj(r,e,n,t,i),ab(([e,t,r,n,i])=>e+t+r+n+i.offsetBottom+i.bottom)),0);return ap(aA(o),s),{totalListHeight:o,totalListHeightChanged:s}},ac(aU,lN),{singleton:!0}),lP=aO(([{viewportHeight:e},{totalListHeight:t}])=>{let r=ak(!1),n=az(aw(aj(r,e,t),av(([e])=>e),ab(([,e,t])=>Math.max(0,e-t)),aS(0),ay()),0);return{alignToBottom:r,paddingTopAddition:n}},ac(aU,l$),{singleton:!0}),lL=aO(()=>({context:ak(null)})),lB=({itemBottom:e,itemTop:t,locationParams:{align:r,behavior:n,...i},viewportBottom:s,viewportTop:o})=>t<o?{...i,align:null!=r?r:"start",behavior:n}:e>s?{...i,align:null!=r?r:"end",behavior:n}:null,lM=aO(([{gap:e,sizes:t,totalCount:r},{fixedFooterHeight:n,fixedHeaderHeight:i,headerHeight:s,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{let c=aR();return ap(aw(c,aE(t,l,r,s,i,n,a),aE(e),ab(([[e,t,r,n,i,s,a,l],u])=>{let{align:c,behavior:d,calculateViewLocation:h=lB,done:p,...f}=e,m=li(e,t,n-1),g=lr(m,t.offsetTree,u)+i+s,y=h({itemBottom:g+aG(t.sizeTree,m)[1],itemTop:g,locationParams:{align:c,behavior:d,...f},viewportBottom:l+r-a,viewportTop:l+s});return y?p&&af(aw(o,av(e=>!e),aT(ah(o)?1:2)),p):null==p||p(),y}),av(e=>null!==e)),u),{scrollIntoView:c}},ac(lc,aU,lg,lN,aL),{singleton:!0});function lD(e){return!!e&&("smooth"===e?"smooth":"auto")}let lH=aO(([{listRefresh:e,totalCount:t,fixedItemSize:r,data:n},{atBottomState:i,isAtBottom:s},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:c},{scrollingInProgress:d},{context:h},{scrollIntoView:p}])=>{let f=ak(!1),m=aR(),g=null;function y(e){o(0,{align:"end",behavior:e,index:"LAST"})}function v(e){setTimeout(af(i,t=>{!e||t.atBottom||"SIZE_INCREASED"!==t.notAtBottomBecause||g||(ah(c)("scrolling to bottom due to increased size",{},a$.DEBUG),y("auto"))}),100)}aw(aj(aw(aA(t),aT(1)),l),aE(aA(f),s,a,d),ab(([[e,t],r,n,i,s])=>{let o,a=t&&i,l="auto";return a&&(o=n||s,l="function"==typeof r?lD(r(o)):o&&lD(r),a=a&&!!l),{followOutputBehavior:l,shouldFollow:a,totalCount:e}}),av(({shouldFollow:e})=>e))(1,({followOutputBehavior:t,totalCount:n})=>{g&&(g(),g=null),ah(r)?requestAnimationFrame(()=>{ah(c)("following output to ",{totalCount:n},a$.DEBUG),y(t)}):g=af(e,()=>{ah(c)("following output to ",{totalCount:n},a$.DEBUG),y(t),g=null})}),aw(aj(aA(f),t,u),av(([e,,t])=>e&&t),a_(({value:e},[,t])=>({refreshed:e===t,value:t}),{refreshed:!1,value:0}),av(({refreshed:e})=>e),aE(f,t))(1,([,e])=>{ah(a)&&v(!1!==e)}),m(1,()=>{v(!1!==ah(f))}),aj(aA(f),i)(1,([e,t])=>{e&&!t.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===t.notAtBottomBecause&&y("auto")});let b=ak(null),x=aR();return ap(aN(aw(aA(n),ab(e=>{var t;return null!=(t=null==e?void 0:e.length)?t:0})),aw(aA(t))),x),aw(aj(aw(x,aT(1)),l),aE(aA(b),a,d,h),ab(([[e,t],r,n,i,s])=>t&&n&&(null==r?void 0:r({context:s,totalCount:e,scrollingInProgress:i}))),av(e=>!!e),aS(0))(1,t=>{g&&(g(),g=null),ah(r)?requestAnimationFrame(()=>{ah(c)("scrolling into view",{}),p(0,t)}):g=af(e,()=>{ah(c)("scrolling into view",{}),p(0,t),g=null})}),{autoscrollToBottom:m,followOutput:f,scrollIntoViewOnChange:b}},ac(lc,lT,lg,lb,lp,aL,aU,lL,lM)),lF=aO(([{data:e,firstItemIndex:t,gap:r,sizes:n},{initialTopMostItemIndex:i},{initialItemCount:s,listState:o},{didMount:a}])=>(ap(aw(a,aE(s),av(([,e])=>0!==e),aE(i,n,t,r,e),ab(([[,e],t,r,n,i,s=[]])=>lC(e,t,r,n,i,s))),o),{}),ac(lc,lb,lN,lp),{singleton:!0}),lU=aO(([{didMount:e},{scrollTo:t},{listState:r}])=>{let n=ak(0);return aw(e,aE(n),av(([,e])=>0!==e),ab(([,e])=>({top:e})))(1,e=>{af(aw(r,aT(1),av(e=>e.items.length>1)),()=>{requestAnimationFrame(()=>{t(0,e)})})}),{initialScrollTop:n}},ac(lp,aU,lN),{singleton:!0}),lZ=aO(([{scrollVelocity:e}])=>{let t=ak(!1),r=aR(),n=ak(!1);return ap(aw(e,aE(n,t,r),av(([e,t])=>!!t),ab(([e,t,r,n])=>{let{enter:i,exit:s}=t;if(r){if(s(e,n))return!1}else if(i(e,n))return!0;return r}),ay()),t),aw(aj(t,e,r),aE(n))(1,([[e,t,r],n])=>{e&&n&&n.change&&n.change(t,r)}),{isSeeking:t,scrollSeekConfiguration:n,scrollSeekRangeChanged:r,scrollVelocity:e}},ac(lT),{singleton:!0}),lW=aO(([{scrollContainerState:e,scrollTo:t}])=>{let r=aR(),n=aR(),i=aR(),s=ak(!1),o=ak(void 0);return ap(aw(aj(r,n),ab(([{scrollHeight:e,scrollTop:t,viewportHeight:r},{offsetTop:n}])=>({scrollHeight:e,scrollTop:Math.max(0,t-n),viewportHeight:r}))),e),ap(aw(t,aE(n),ab(([e,{offsetTop:t}])=>({...e,top:e.top+t}))),i),{customScrollParent:o,useWindowScroll:s,windowScrollContainerState:r,windowScrollTo:i,windowViewportRect:n}},ac(aU)),lV=aO(([{sizeRanges:e,sizes:t},{headerHeight:r,scrollTop:n},{initialTopMostItemIndex:i},{didMount:s},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{let u=aR(),c=ak(void 0),d=ak(null),h=ak(null);return ap(a,d),ap(l,h),aw(u,aE(t,n,o,d,h,r))(1,([e,t,r,n,i,s,o])=>{let a=aK(t.sizeTree).map(({k:e,v:t},r,n)=>{let i=n[r+1];return{endIndex:i?i.k-1:1/0,size:t,startIndex:e}});n&&null!==i&&null!==s&&(r=i.scrollTop-s.offsetTop),e({ranges:a,scrollTop:r-=o})}),ap(aw(c,av(aa),ab(lq)),i),ap(aw(s,aE(c),av(([,e])=>void 0!==e),ay(),ab(([,e])=>e.ranges)),e),{getState:u,restoreStateFrom:c}},ac(lc,aU,lb,lp,lW));function lq(e){return{align:"start",index:0,offset:e.scrollTop}}let lG=aO(([{topItemsIndexes:e}])=>{let t=ak(0);return ap(aw(t,av(e=>e>=0),ab(e=>Array.from({length:e}).map((e,t)=>t))),e),{topItemCount:t}},ac(lN));function lJ(e){let t=!1,r;return()=>(t||(t=!0,r=e()),r)}let lQ=lJ(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),lK=aO(([{deviation:e,scrollBy:t,scrollingInProgress:r,scrollTop:n},{isAtBottom:i,isScrolling:s,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:c,shiftWithOffset:d,sizes:h},{log:p},{recalcInProgress:f}])=>{let m=aI(aw(l,aE(o),a_(([,e,t,r],[{bottom:n,items:i,offsetBottom:s,totalCount:o},a])=>{let l=n+s,u=0;return t===o&&e.length>0&&i.length>0&&(0===i[0].originalIndex&&0===e[0].originalIndex||0!=(u=l-r)&&(u+=a)),[u,i,o,l]},[0,[],0,0]),av(([e])=>0!==e),aE(n,a,r,i,p,f),av(([,e,t,r,,,n])=>!n&&!r&&0!==e&&"up"===t),ab(([[e],,,,,t])=>(t("Upward scrolling compensation",{amount:e},a$.DEBUG),e))));function g(r){r>0?(t(0,{behavior:"auto",top:-r}),e(0,0)):(e(0,0),t(0,{behavior:"auto",top:-r}))}return aw(m,aE(e,s))(1,([t,r,n])=>{n&&lQ()?e(0,r-t):g(-t)}),aw(aj(az(s,!1),e,f),av(([e,t,r])=>!e&&!r&&0!==t),ab(([e,t])=>t),aS(1))(1,g),ap(aw(d,ab(e=>({top:-e}))),t),aw(u,aE(h,c),ab(([e,{groupIndices:t,lastSize:r,sizeTree:n},i])=>{if(0===t.length)return e*(r+i);{let s=0,o=aq(n,0),a=0,l=0;for(;a<e;){a++,s+=o;let n=t.length===l+1?1/0:t[l+1]-t[l]-1;a+n>e&&(s-=o,n=e-a+1),a+=n,s+=n*(r+i),l++}return s}}))(1,r=>{e(0,r),requestAnimationFrame(()=>{t(0,{top:r}),requestAnimationFrame(()=>{e(0,0),f(0,!1)})})}),{deviation:e}},ac(aU,lT,lN,lc,aL,a3)),lY=aO(([e,t,r,n,i,s,o,a,l,u,c])=>({...e,...t,...r,...n,...i,...s,...o,...a,...l,...u,...c}),ac(lR,lF,lp,lZ,l$,lU,lP,lW,lM,aL,lL)),lX=aO(([{data:e,defaultItemSize:t,firstItemIndex:r,fixedItemSize:n,fixedGroupSize:i,gap:s,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:c,statefulTotalCount:d,totalCount:h,trackItemSizes:p},{initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g},y,v,b,x,{scrollToIndex:w},_,{topItemCount:T},{groupCounts:S},E])=>{let{listState:k,minOverscanItemCount:z,topItemsIndexes:R,rangeChanged:I,...O}=x;return ap(I,E.scrollSeekRangeChanged),ap(aw(E.windowViewportRect,ab(e=>e.visibleHeight)),y.viewportHeight),{data:e,defaultItemHeight:t,firstItemIndex:r,fixedItemHeight:n,fixedGroupHeight:i,gap:s,groupCounts:S,heightEstimates:a,initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g,sizeRanges:u,topItemCount:T,topItemsIndexes:R,totalCount:h,...b,groupIndices:o,itemSize:l,listState:k,minOverscanItemCount:z,scrollToIndex:w,statefulTotalCount:d,trackItemSizes:p,rangeChanged:I,...O,...E,...y,sizes:c,...v}},ac(lc,lb,aU,lV,lH,lN,lg,lK,lG,lh,lY)),l0="u">typeof document?T.default.useLayoutEffect:T.default.useEffect;function l1(e,t,r){let n=Object.keys(t.required||{}),i=Object.keys(t.optional||{}),s=Object.keys(t.methods||{}),o=Object.keys(t.events||{}),a=T.default.createContext({});function l(e,r){for(let i of(e.propsReady&&(0,e.propsReady)(0,!1),n))(0,e[t.required[i]])(0,r[i]);for(let n of i)n in r&&(0,e[t.optional[n]])(0,r[n]);e.propsReady&&(0,e.propsReady)(0,!0)}function u(e){return o.reduce((r,n)=>{var i;let s,o,a;return r[n]=(i=e[t.events[n]],a=()=>null==s?void 0:s(),function(e,t){switch(e){case 1:return t?o===t?void 0:(a(),o=t,s=i(1,t)):(a(),al);case 2:a(),o=null;return}}),r},{})}return{Component:T.default.forwardRef((c,d)=>{var h;let{children:p,...f}=c,[m]=T.default.useState(()=>{var t;let r,n;return r=new Map,l(t=(n=({constructor:e,dependencies:t,id:i,singleton:s})=>{if(s&&r.has(i))return r.get(i);let o=e(t.map(e=>n(e)));return s&&r.set(i,o),o})(e),f),t}),[g]=T.default.useState(()=>u(m));return l0(()=>{for(let e of o)e in f&&(0,g[e])(1,f[e]);return()=>{Object.values(g).map(ad)}},[f,g,m]),l0(()=>{l(m,f)}),T.default.useImperativeHandle(d,(h=s.reduce((e,r)=>(e[r]=e=>{(0,m[t.methods[r]])(0,e)},e),{}),()=>h)),(0,_.jsx)(a.Provider,{value:m,children:r?(0,_.jsx)(r,{...function(e,t){let r={},n={},i=0,s=e.length;for(;i<s;)n[e[i]]=1,i+=1;for(let e in t)Object.hasOwn(n,e)||(r[e]=t[e]);return r}([...n,...i,...o],f),children:p}):p})}),useEmitter:(e,t)=>{let r=T.default.useContext(a)[e];l0(()=>r(1,t),[t,r])},useEmitterValue:T.default.version.startsWith("18")?e=>{let t=T.default.useContext(a)[e],r=T.default.useCallback(e=>t(1,e),[t]);return T.default.useSyncExternalStore(r,()=>ah(t),()=>ah(t))}:e=>{let t=T.default.useContext(a)[e],[r,n]=T.default.useState(()=>ah(t));return l0(()=>t(1,e=>{e!==r&&n(()=>e)}),[t,r]),r},usePublisher:e=>{let t=T.default.useContext(a);return T.default.useCallback(r=>{(0,t[e])(0,r)},[t,e])}}}let l2=T.default.createContext(void 0),l4=T.default.createContext(void 0),l5="u">typeof document?T.default.useLayoutEffect:T.default.useEffect;function l6(e){return"self"in e}function l3(e,t,r,n=al,i,s){let o=T.default.useRef(null),a=T.default.useRef(null),l=T.default.useRef(null),u=T.default.useCallback(r=>{let n,i,o,u=r.target;if("body"in u||l6(u)){let e=l6(u)?u:u.defaultView;o=s?e.scrollX:e.scrollY,n=s?e.document.documentElement.scrollWidth:e.document.documentElement.scrollHeight,i=s?e.innerWidth:e.innerHeight}else o=s?u.scrollLeft:u.scrollTop,n=s?u.scrollWidth:u.scrollHeight,i=s?u.offsetWidth:u.offsetHeight;let c=()=>{e({scrollHeight:n,scrollTop:Math.max(o,0),viewportHeight:i})};r.suppressFlushSync?c():ai.default.flushSync(c),null!==a.current&&(o===a.current||o<=0||o===n-i)&&(a.current=null,t(!0),l.current&&(clearTimeout(l.current),l.current=null))},[e,t,s]);return T.default.useEffect(()=>{let e=i||o.current;return n(i||o.current),u({suppressFlushSync:!0,target:e}),e.addEventListener("scroll",u,{passive:!0}),()=>{n(null),e.removeEventListener("scroll",u)}},[o,u,r,n,i]),{scrollByCallback:function(e){s&&(e={behavior:e.behavior,left:e.top}),o.current.scrollBy(e)},scrollerRef:o,scrollToCallback:function(r){let n,i,u,c=o.current;if(!c||(s?"offsetWidth"in c&&0===c.offsetWidth:"offsetHeight"in c&&0===c.offsetHeight))return;let d="smooth"===r.behavior;l6(c)?(i=Math.max(a8(c.document.documentElement,s?"width":"height"),s?c.document.documentElement.scrollWidth:c.document.documentElement.scrollHeight),n=s?c.innerWidth:c.innerHeight,u=s?window.scrollX:window.scrollY):(i=c[s?"scrollWidth":"scrollHeight"],n=a8(c,s?"width":"height"),u=c[s?"scrollLeft":"scrollTop"]);let h=i-n;if(r.top=Math.ceil(Math.max(Math.min(h,r.top),0)),lx(n,i)||r.top===u){e({scrollHeight:i,scrollTop:u,viewportHeight:n}),d&&t(!0);return}d?(a.current=r.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,t(!0)},1e3)):a.current=null,s&&(r={behavior:r.behavior,left:r.top}),c.scrollTo(r)}}}let l9="-webkit-sticky",l8="sticky",l7=lJ(()=>{if(typeof document>"u")return l8;let e=document.createElement("div");return e.style.position=l9,e.style.position===l9?l9:l8});function ue(e){return e}let ut=aO(()=>{let e=ak(e=>`Item ${e}`),t=ak(e=>`Group ${e}`),r=ak({}),n=ak(ue),i=ak("div"),s=ak(al),o=(e,t=null)=>az(aw(r,ab(t=>t[e]),ay()),t);return{components:r,computeItemKey:n,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:t,HeaderComponent:o("Header"),HeaderFooterTag:i,ItemComponent:o("Item","div"),itemContent:e,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:s,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),ur=aO(([e,t])=>({...e,...t}),ac(lX,ut)),un=({height:e})=>(0,_.jsx)("div",{style:{height:e}}),ui={overflowAnchor:"none",position:l7(),zIndex:1},us={overflowAnchor:"none"},uo={...us,display:"inline-block",height:"100%"},ua=T.default.memo(function({showTopList:e=!1}){let t=uT("listState"),r=uS("sizeRanges"),n=uT("useWindowScroll"),i=uT("customScrollParent"),s=uS("windowScrollContainerState"),o=uS("scrollContainerState"),a=uT("itemContent"),l=uT("context"),u=uT("groupContent"),c=uT("trackItemSizes"),d=uT("itemSize"),h=uT("log"),p=uS("gap"),f=uT("horizontalDirection"),{callbackRef:m}=aD(r,d,c,e?al:i||n?s:o,h,p,i,f,uT("skipAnimationFrameInResizeObserver")),[g,y]=T.default.useState(0);u_("deviation",e=>{g!==e&&y(e)});let v=uT("EmptyPlaceholder"),b=uT("ScrollSeekPlaceholder")||un,x=uT("ListComponent"),w=uT("ItemComponent"),S=uT("GroupComponent"),E=uT("computeItemKey"),k=uT("isSeeking"),z=uT("groupIndices").length>0,R=uT("alignToBottom"),I=uT("initialItemFinalLocationReached"),O=e?{}:{boxSizing:"border-box",...f?{display:"inline-block",height:"100%",marginLeft:0!==g?g:R?"auto":0,paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,whiteSpace:"nowrap"}:{marginTop:0!==g?g:R?"auto":0,paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},...I?{}:{visibility:"hidden"}};return!e&&0===t.totalCount&&v?(0,_.jsx)(v,{...uh(v,l)}):(0,_.jsx)(x,{...uh(x,l),"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",ref:m,style:O,children:(e?t.topItems:t.items).map(e=>{let r=e.originalIndex,n=E(r+t.firstItemIndex,e.data,l);return k?(0,T.createElement)(b,{...uh(b,l),height:e.size,index:e.index,key:n,type:e.type||"item",..."group"===e.type?{}:{groupIndex:e.groupIndex}}):"group"===e.type?(0,T.createElement)(S,{...uh(S,l),"data-index":r,"data-item-index":e.index,"data-known-size":e.size,key:n,style:ui},u(e.index,l)):(0,T.createElement)(w,{...uh(w,l),...up(w,e.data),"data-index":r,"data-item-group-index":e.groupIndex,"data-item-index":e.index,"data-known-size":e.size,key:n,style:f?uo:us},z?a(e.index,e.groupIndex,e.data,l):a(e.index,e.data,l))})})}),ul={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},uu={outline:"none",overflowX:"auto",position:"relative"},uc=e=>({height:"100%",position:"absolute",top:0,width:"100%",...e?{display:"flex",flexDirection:"column"}:{}}),ud={position:l7(),top:0,width:"100%",zIndex:1};function uh(e,t){if("string"!=typeof e)return{context:t}}function up(e,t){return{item:"string"==typeof e?void 0:t}}let uf=T.default.memo(function(){let e=uT("HeaderComponent"),t=uS("headerHeight"),r=uT("HeaderFooterTag"),n=aB(T.default.useMemo(()=>e=>{t(a8(e,"height"))},[t]),!0,uT("skipAnimationFrameInResizeObserver")),i=uT("context");return e?(0,_.jsx)(r,{ref:n,children:(0,_.jsx)(e,{...uh(e,i)})}):null}),um=T.default.memo(function(){let e=uT("FooterComponent"),t=uS("footerHeight"),r=uT("HeaderFooterTag"),n=aB(T.default.useMemo(()=>e=>{t(a8(e,"height"))},[t]),!0,uT("skipAnimationFrameInResizeObserver")),i=uT("context");return e?(0,_.jsx)(r,{ref:n,children:(0,_.jsx)(e,{...uh(e,i)})}):null});function ug({useEmitter:e,useEmitterValue:t,usePublisher:r}){return T.default.memo(function({children:n,style:i,context:s,...o}){let a=r("scrollContainerState"),l=t("ScrollerComponent"),u=r("smoothScrollTargetReached"),c=t("scrollerRef"),d=t("horizontalDirection")||!1,{scrollByCallback:h,scrollerRef:p,scrollToCallback:f}=l3(a,u,l,c,void 0,d);return e("scrollTo",f),e("scrollBy",h),(0,_.jsx)(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...d?uu:ul,...i},tabIndex:0,...o,...uh(l,s),children:n})})}function uy({useEmitter:e,useEmitterValue:t,usePublisher:r}){return T.default.memo(function({children:n,style:i,context:s,...o}){let a=r("windowScrollContainerState"),l=t("ScrollerComponent"),u=r("smoothScrollTargetReached"),c=t("totalListHeight"),d=t("deviation"),h=t("customScrollParent"),p=T.default.useRef(null),{scrollByCallback:f,scrollerRef:m,scrollToCallback:g}=l3(a,u,l,t("scrollerRef"),h);return l5(()=>{var e;return m.current=h||(null==(e=p.current)?void 0:e.ownerDocument.defaultView),()=>{m.current=null}},[m,h]),e("windowScrollTo",g),e("scrollBy",f),(0,_.jsx)(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...i,...0!==c?{height:c+d}:{}},...o,...uh(l,s),children:n})})}let uv=({children:e})=>{let t=T.default.useContext(l2),r=uS("viewportHeight"),n=uS("fixedItemHeight"),i=uT("alignToBottom"),s=uT("horizontalDirection"),o=aB(T.default.useMemo(()=>ao(r,e=>a8(e,s?"width":"height")),[r,s]),!0,uT("skipAnimationFrameInResizeObserver"));return T.default.useEffect(()=>{t&&(r(t.viewportHeight),n(t.itemHeight))},[t,r,n]),(0,_.jsx)("div",{"data-viewport-type":"element",ref:o,style:uc(i),children:e})},ub=({children:e})=>{let t=T.default.useContext(l2),r=uS("windowViewportRect"),n=uS("fixedItemHeight"),i=aF(r,uT("customScrollParent"),uT("skipAnimationFrameInResizeObserver")),s=uT("alignToBottom");return T.default.useEffect(()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,n]),(0,_.jsx)("div",{"data-viewport-type":"window",ref:i,style:uc(s),children:e})},ux=({children:e})=>{let t=uT("TopItemListComponent")||"div",r=uT("headerHeight"),n={...ud,marginTop:`${r}px`},i=uT("context");return(0,_.jsx)(t,{style:n,...uh(t,i),children:e})},{Component:uw,useEmitter:u_,useEmitterValue:uT,usePublisher:uS}=l1(ur,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},T.default.memo(function(e){let t=uT("useWindowScroll"),r=uT("topItemsIndexes").length>0,n=uT("customScrollParent"),i=uT("context");return(0,_.jsxs)(n||t?uk:uE,{...e,context:i,children:[r&&(0,_.jsx)(ux,{children:(0,_.jsx)(ua,{showTopList:!0})}),(0,_.jsxs)(n||t?ub:uv,{children:[(0,_.jsx)(uf,{}),(0,_.jsx)(ua,{}),(0,_.jsx)(um,{})]})]})})),uE=ug({useEmitter:u_,useEmitterValue:uT,usePublisher:uS}),uk=uy({useEmitter:u_,useEmitterValue:uT,usePublisher:uS}),uz=aO(()=>{let e=ak(e=>(0,_.jsxs)("td",{children:["Item $",e]})),t=ak(null),r=ak(e=>(0,_.jsxs)("td",{colSpan:1e3,children:["Group ",e]})),n=ak(null),i=ak(null),s=ak({}),o=ak(ue),a=ak(al),l=(e,t=null)=>az(aw(s,ab(t=>t[e]),ay()),t);return{components:s,computeItemKey:o,context:t,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:i,fixedHeaderContent:n,itemContent:e,groupContent:r,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}}),uR=aO(([e,t])=>({...e,...t}),ac(lX,uz)),uI=({height:e})=>(0,_.jsx)("tr",{children:(0,_.jsx)("td",{style:{height:e}})}),uO=({height:e})=>(0,_.jsx)("tr",{children:(0,_.jsx)("td",{style:{border:0,height:e,padding:0}})}),uC={overflowAnchor:"none"},uj={position:l7(),zIndex:2,overflowAnchor:"none"},uA=T.default.memo(function({showTopList:e=!1}){let t=uB("listState"),r=uB("computeItemKey"),n=uB("firstItemIndex"),i=uB("context"),s=uB("isSeeking"),o=uB("fixedHeaderHeight"),a=uB("groupIndices").length>0,l=uB("itemContent"),u=uB("groupContent"),c=uB("ScrollSeekPlaceholder")||uI,d=uB("GroupComponent"),h=uB("TableRowComponent"),p=(e?t.topItems:[]).reduce((e,t,r)=>(0===r?e.push(t.size):e.push(e[r-1]+t.size),e),[]),f=(e?t.topItems:t.items).map(t=>{let f=t.originalIndex,m=r(f+n,t.data,i),g=e?0===f?0:p[f-1]:0;return s?(0,T.createElement)(c,{...uh(c,i),height:t.size,index:t.index,key:m,type:t.type||"item"}):"group"===t.type?(0,T.createElement)(d,{...uh(d,i),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,key:m,style:{...uj,top:o}},u(t.index,i)):(0,T.createElement)(h,{...uh(h,i),...up(h,t.data),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,"data-item-group-index":t.groupIndex,key:m,style:e?{...uj,top:o+g}:uC},a?l(t.index,t.groupIndex,t.data,i):l(t.index,t.data,i))});return(0,_.jsx)(_.Fragment,{children:f})}),uN=T.default.memo(function(){let e=uB("listState"),t=uB("topItemsIndexes").length>0,r=uM("sizeRanges"),n=uB("useWindowScroll"),i=uB("customScrollParent"),s=uM("windowScrollContainerState"),o=uM("scrollContainerState"),a=uB("trackItemSizes"),{callbackRef:l,ref:u}=aD(r,uB("itemSize"),a,i||n?s:o,uB("log"),void 0,i,!1,uB("skipAnimationFrameInResizeObserver")),[c,d]=T.default.useState(0);uL("deviation",e=>{c!==e&&(u.current.style.marginTop=`${e}px`,d(e))});let h=uB("EmptyPlaceholder"),p=uB("FillerRow")||uO,f=uB("TableBodyComponent"),m=uB("paddingTopAddition"),g=uB("statefulTotalCount"),y=uB("context");if(0===g&&h)return(0,_.jsx)(h,{...uh(h,y)});let v=(t?e.topItems:[]).reduce((e,t)=>e+t.size,0),b=e.offsetTop+m+c-v,x=e.offsetBottom,w=b>0?(0,_.jsx)(p,{context:y,height:b},"padding-top"):null,S=x>0?(0,_.jsx)(p,{context:y,height:x},"padding-bottom"):null;return(0,_.jsxs)(f,{"data-testid":"virtuoso-item-list",ref:l,...uh(f,y),children:[w,t&&(0,_.jsx)(uA,{showTopList:!0}),(0,_.jsx)(uA,{}),S]})}),u$=({children:e})=>{let t=T.default.useContext(l2),r=uM("viewportHeight"),n=uM("fixedItemHeight"),i=aB(T.default.useMemo(()=>ao(r,e=>a8(e,"height")),[r]),!0,uB("skipAnimationFrameInResizeObserver"));return T.default.useEffect(()=>{t&&(r(t.viewportHeight),n(t.itemHeight))},[t,r,n]),(0,_.jsx)("div",{"data-viewport-type":"element",ref:i,style:uc(!1),children:e})},uP=({children:e})=>{let t=T.default.useContext(l2),r=uM("windowViewportRect"),n=uM("fixedItemHeight"),i=aF(r,uB("customScrollParent"),uB("skipAnimationFrameInResizeObserver"));return T.default.useEffect(()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,n]),(0,_.jsx)("div",{"data-viewport-type":"window",ref:i,style:uc(!1),children:e})},{useEmitter:uL,useEmitterValue:uB,usePublisher:uM}=l1(uR,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},T.default.memo(function(e){let t=uB("useWindowScroll"),r=uB("customScrollParent"),n=uM("fixedHeaderHeight"),i=uM("fixedFooterHeight"),s=uB("fixedHeaderContent"),o=uB("fixedFooterContent"),a=uB("context"),l=aB(T.default.useMemo(()=>ao(n,e=>a8(e,"height")),[n]),!0,uB("skipAnimationFrameInResizeObserver")),u=aB(T.default.useMemo(()=>ao(i,e=>a8(e,"height")),[i]),!0,uB("skipAnimationFrameInResizeObserver")),c=r||t?uH:uD,d=r||t?uP:u$,h=uB("TableComponent"),p=uB("TableHeadComponent"),f=uB("TableFooterComponent"),m=s?(0,_.jsx)(p,{ref:l,style:{position:"sticky",top:0,zIndex:2},...uh(p,a),children:s()},"TableHead"):null,g=o?(0,_.jsx)(f,{ref:u,style:{bottom:0,position:"sticky",zIndex:1},...uh(f,a),children:o()},"TableFoot"):null;return(0,_.jsx)(c,{...e,...uh(c,a),children:(0,_.jsx)(d,{children:(0,_.jsxs)(h,{style:{borderSpacing:0,overflowAnchor:"none"},...uh(h,a),children:[m,(0,_.jsx)(uN,{},"TableBody"),g]})})})})),uD=ug({useEmitter:uL,useEmitterValue:uB,usePublisher:uM}),uH=uy({useEmitter:uL,useEmitterValue:uB,usePublisher:uM}),uF={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},uU={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:uZ,floor:uW,max:uV,min:uq,round:uG}=Math;function uJ(e,t,r){return Array.from({length:t-e+1}).map((t,n)=>({data:null===r?null:r[n+e],index:n+e}))}function uQ(e,t){return e&&e.width===t.width&&e.height===t.height}function uK(e,t){return e&&e.column===t.column&&e.row===t.row}let uY=aO(([{increaseViewportBy:e,listBoundary:t,overscan:r,visibleRange:n},{footerHeight:i,headerHeight:s,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:c,viewportHeight:d},h,p,{didMount:f,propsReady:m},{customScrollParent:g,useWindowScroll:y,windowScrollContainerState:v,windowScrollTo:b,windowViewportRect:x},w])=>{let _=ak(0),T=ak(0),S=ak(uF),E=ak({height:0,width:0}),k=ak({height:0,width:0}),z=aR(),R=aR(),I=ak(0),O=ak(null),C=ak({column:0,row:0}),j=aR(),A=aR(),N=ak(!1),$=ak(0),P=ak(!0),L=ak(!1),B=ak(!1);aw(f,aE($),av(([e,t])=>!!t))(1,()=>{P(0,!1)}),aw(aj(f,P,k,E,$,L),av(([e,t,r,n,,i])=>e&&!t&&0!==r.height&&0!==n.height&&!i))(1,([,,,,e])=>{L(0,!0),ly(1,()=>{z(0,e)}),af(aw(u),()=>{t(0,[0,0]),P(0,!0)})}),ap(aw(A,av(e=>null!=e&&e.scrollTop>0),ax(0)),T),aw(f,aE(A),av(([,e])=>null!=e))(1,([,e])=>{e&&(E(0,e.viewport),k(0,e.item),C(0,e.gap),e.scrollTop>0&&(N(0,!0),af(aw(u,aT(1)),e=>{N(0,!1)}),l(0,{top:e.scrollTop})))}),ap(aw(E,ab(({height:e})=>e)),d),ap(aw(aj(aA(E,uQ),aA(k,uQ),aA(C,(e,t)=>e&&e.column===t.column&&e.row===t.row),aA(u)),ab(([e,t,r,n])=>({gap:r,item:t,scrollTop:n,viewport:e}))),j),ap(aw(aj(aA(_),n,aA(C,uK),aA(k,uQ),aA(E,uQ),aA(O),aA(T),aA(N),aA(P),aA($)),av(([,,,,,,,e])=>!e),ab(([e,[t,r],n,i,s,o,a,,l,u])=>{let c,d,{column:h,row:p}=n,{height:f,width:m}=i,{width:g}=s;if(0===a&&(0===e||0===g))return uF;if(0===m){var y;let t=lv(u,e),r=t+Math.max(a-1,0);return y=uJ(t,r,o),{...uU,items:y}}let v=uX(g,m,h);l?0===t&&0===r&&a>0?(c=0,d=a-1):(c=v*uW((t+p)/(f+p)),d=uq(e-1,uV(d=v*uZ((r+p)/(f+p))-1,v-1)),c=uq(d,uV(0,c))):(c=0,d=-1);let b=uJ(c,d,o),{bottom:x,top:w}=u0(s,n,i,b),_=uZ(e/v);return{bottom:x,itemHeight:f,items:b,itemWidth:m,offsetBottom:_*f+(_-1)*p-x,offsetTop:w,top:w}})),S),ap(aw(O,av(e=>null!==e),ab(e=>e.length)),_),ap(aw(aj(E,k,S,C),av(([e,t,{items:r}])=>r.length>0&&0!==t.height&&0!==e.height),ab(([e,t,{items:r},n])=>{let{bottom:i,top:s}=u0(e,n,t,r);return[s,i]}),ay(a6)),t);let M=ak(!1);ap(aw(u,aE(M),ab(([e,t])=>t||0!==e)),M);let D=aI(aw(aj(S,_),av(([{items:e}])=>e.length>0),aE(M),av(([[e,t],r])=>{let n=e.items[e.items.length-1].index===t-1;return(r||e.bottom>0&&e.itemHeight>0&&0===e.offsetBottom&&e.items.length===t)&&n}),ab(([[,e]])=>e-1),ay())),H=aI(aw(aA(S),av(({items:e})=>e.length>0&&0===e[0].index),ax(0),ay())),F=aI(aw(aA(S),aE(N),av(([{items:e},t])=>e.length>0&&!t),ab(([{items:e}])=>({endIndex:e[e.length-1].index,startIndex:e[0].index})),ay(a5),aS(0)));ap(F,p.scrollSeekRangeChanged),ap(aw(z,aE(E,k,_,C),ab(([e,t,r,n,i])=>{let s=lm(e),{align:o,behavior:a,offset:l}=s,u=s.index;"LAST"===u&&(u=n-1);let c=u1(t,i,r,u=uV(0,u,uq(n-1,u)));return"end"===o?c=uG(c-t.height+r.height):"center"===o&&(c=uG(c-t.height/2+r.height/2)),l&&(c+=l),{behavior:a,top:c}})),l);let U=az(aw(S,ab(e=>e.offsetBottom+e.bottom)),0);return ap(aw(x,ab(e=>({height:e.visibleHeight,width:e.visibleWidth}))),E),{customScrollParent:g,data:O,deviation:I,footerHeight:i,gap:C,headerHeight:s,increaseViewportBy:e,initialItemCount:T,itemDimensions:k,overscan:r,restoreStateFrom:A,scrollBy:o,scrollContainerState:a,scrollHeight:R,scrollTo:l,scrollToIndex:z,scrollTop:u,smoothScrollTargetReached:c,totalCount:_,useWindowScroll:y,viewportDimensions:E,windowScrollContainerState:v,windowScrollTo:b,windowViewportRect:x,...p,gridState:S,horizontalDirection:B,initialTopMostItemIndex:$,totalListHeight:U,...h,endReached:D,propsReady:m,rangeChanged:F,startReached:H,stateChanged:j,stateRestoreInProgress:N,...w}},ac(lR,aU,lT,lZ,lp,lW,aL));function uX(e,t,r){return uV(1,uW((e+r)/(uW(t)+r)))}function u0(e,t,r,n){let{height:i}=r;if(void 0===i||0===n.length)return{bottom:0,top:0};let s=u1(e,t,r,n[0].index);return{bottom:u1(e,t,r,n[n.length-1].index)+i,top:s}}function u1(e,t,r,n){let i=uW(n/uX(e.width,r.width,t.column)),s=i*r.height+uV(0,i-1)*t.row;return s>0?s+t.row:s}let u2=aO(()=>{let e=ak(e=>`Item ${e}`),t=ak({}),r=ak(null),n=ak("virtuoso-grid-item"),i=ak("virtuoso-grid-list"),s=ak(ue),o=ak("div"),a=ak(al),l=(e,r=null)=>az(aw(t,ab(t=>t[e]),ay()),r),u=ak(!1),c=ak(!1);return ap(aA(c),u),{components:t,computeItemKey:s,context:r,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:n,ItemComponent:l("Item","div"),itemContent:e,listClassName:i,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:c,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),u4=aO(([e,t])=>({...e,...t}),ac(uY,u2)),u5=T.default.memo(function(){let e=ce("gridState"),t=ce("listClassName"),r=ce("itemClassName"),n=ce("itemContent"),i=ce("computeItemKey"),s=ce("isSeeking"),o=ct("scrollHeight"),a=ce("ItemComponent"),l=ce("ListComponent"),u=ce("ScrollSeekPlaceholder"),c=ce("context"),d=ct("itemDimensions"),h=ct("gap"),p=ce("log"),f=ce("stateRestoreInProgress"),m=ct("reportReadyState"),g=aB(T.default.useMemo(()=>e=>{o(e.parentElement.parentElement.scrollHeight);let t=e.firstChild;if(t){let{height:e,width:r}=t.getBoundingClientRect();d({height:e,width:r})}h({column:ci("column-gap",getComputedStyle(e).columnGap,p),row:ci("row-gap",getComputedStyle(e).rowGap,p)})},[o,d,h,p]),!0,!1);return l5(()=>{e.itemHeight>0&&e.itemWidth>0&&m(!0)},[e]),f?null:(0,_.jsx)(l,{className:t,ref:g,...uh(l,c),"data-testid":"virtuoso-item-list",style:{paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},children:e.items.map(t=>{let o=i(t.index,t.data,c);return s?(0,_.jsx)(u,{...uh(u,c),height:e.itemHeight,index:t.index,width:e.itemWidth},o):(0,T.createElement)(a,{...uh(a,c),className:r,"data-index":t.index,key:o},n(t.index,t.data,c))})})}),u6=T.default.memo(function(){let e=ce("HeaderComponent"),t=ct("headerHeight"),r=ce("headerFooterTag"),n=aB(T.default.useMemo(()=>e=>{t(a8(e,"height"))},[t]),!0,!1),i=ce("context");return e?(0,_.jsx)(r,{ref:n,children:(0,_.jsx)(e,{...uh(e,i)})}):null}),u3=T.default.memo(function(){let e=ce("FooterComponent"),t=ct("footerHeight"),r=ce("headerFooterTag"),n=aB(T.default.useMemo(()=>e=>{t(a8(e,"height"))},[t]),!0,!1),i=ce("context");return e?(0,_.jsx)(r,{ref:n,children:(0,_.jsx)(e,{...uh(e,i)})}):null}),u9=({children:e})=>{let t=T.default.useContext(l4),r=ct("itemDimensions"),n=ct("viewportDimensions"),i=aB(T.default.useMemo(()=>e=>{n(e.getBoundingClientRect())},[n]),!0,!1);return T.default.useEffect(()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),r({height:t.itemHeight,width:t.itemWidth}))},[t,n,r]),(0,_.jsx)("div",{ref:i,style:uc(!1),children:e})},u8=({children:e})=>{let t=T.default.useContext(l4),r=ct("windowViewportRect"),n=ct("itemDimensions"),i=aF(r,ce("customScrollParent"),!1);return T.default.useEffect(()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,r,n]),(0,_.jsx)("div",{ref:i,style:uc(!1),children:e})},{useEmitter:u7,useEmitterValue:ce,usePublisher:ct}=l1(u4,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},T.default.memo(function({...e}){let t=ce("useWindowScroll"),r=ce("customScrollParent"),n=r||t?cn:cr,i=r||t?u8:u9,s=ce("context");return(0,_.jsx)(n,{...e,...uh(n,s),children:(0,_.jsxs)(i,{children:[(0,_.jsx)(u6,{}),(0,_.jsx)(u5,{}),(0,_.jsx)(u3,{})]})})})),cr=ug({useEmitter:u7,useEmitterValue:ce,usePublisher:ct}),cn=uy({useEmitter:u7,useEmitterValue:ce,usePublisher:ct});function ci(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,a$.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}let cs=(0,T.memo)(({gender:e,className:t})=>"male"===e?(0,_.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,_.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,_.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):"female"===e?(0,_.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,_.jsx)("path",{d:"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"}),(0,_.jsx)("path",{d:"M18 22H6c0-4 4-3 6-3s6-1 6 3Z"})]}):(0,_.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,_.jsx)("circle",{cx:"12",cy:"10",r:"3"}),(0,_.jsx)("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]})),co=(0,T.memo)(({onSendMessage:e,showBottomNavPadding:t,onFocusChange:r,isFocused:n})=>{let[i,s]=(0,T.useState)(""),o=(0,T.useRef)(null);return(0,_.jsx)("footer",{className:`px-3 py-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${n?"pb-4 pt-3":t?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[90px] pt-4":"py-4"}`,children:(0,_.jsxs)("form",{onSubmit:t=>{t.preventDefault(),i.trim()&&(e(i.trim()),s(""),o.current?.blur())},className:"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto",children:[(0,_.jsx)("input",{ref:o,type:"text",value:i,onChange:e=>s(e.target.value),onFocus:()=>r?.(!0),onBlur:()=>r?.(!1),placeholder:"Messaggio alla stanza...",className:"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400",style:{fontSize:"16px"}}),(0,_.jsx)("button",{type:"submit",className:"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform",onMouseDown:e=>e.preventDefault(),children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 rotate-45",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})}),ca=({user:e,messages:t,onSendMessage:r,onlineCount:n,isOnline:i,hideHeader:s,headerTitle:o,showBottomNavPadding:a,onInputFocusChange:l,isFocused:u,isSyncing:c})=>{let d=(0,T.useRef)(null),h=(0,T.useCallback)((r,n)=>{let i=n.senderId===e.id,s=0===r||t[r-1].senderId!==n.senderId;return(0,_.jsx)("div",{className:`flex ${i?"justify-end":"justify-start"} animate-message pb-4 px-4`,children:(0,_.jsxs)("div",{className:`flex flex-col max-w-[85%] ${i?"items-end":"items-start"}`,children:[s&&(0,_.jsxs)("span",{className:`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${i?"text-emerald-700":"text-gray-600"}`,children:[!i&&(0,_.jsx)("div",{className:`w-3.5 h-3.5 rounded-full flex items-center justify-center ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(n.senderGender)}`,children:(0,_.jsx)(cs,{gender:n.senderGender,className:"w-2 h-2 text-white"})}),i?"Tu":n.senderAlias]}),(0,_.jsx)("div",{className:`px-3 py-2 rounded-2xl shadow-sm ${i?"bg-emerald-500 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:(0,_.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed text-[15px]",children:n.text})}),(0,_.jsx)("span",{className:"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70",children:new Date(n.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},[e.id,t]);return(0,_.jsxs)("div",{className:"w-full h-full flex flex-col bg-white",children:[!s&&(0,_.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 shrink-0",children:(0,_.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,_.jsxs)("div",{className:"flex items-center gap-3",children:[(0,_.jsx)("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h2",{className:"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight",children:o||"Stanza"}),(0,_.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,_.jsx)("span",{className:`w-2 h-2 rounded-full ${i?"bg-emerald-500":"bg-red-500"}`}),(0,_.jsx)("p",{className:"text-[11px] font-bold text-emerald-600 uppercase tracking-wide",children:i?`${n} persone qui`:"Disconnesso"})]})]})]}),c&&(0,_.jsxs)("div",{className:"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse",children:[(0,_.jsxs)("svg",{className:"animate-spin h-3 w-3 text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,_.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,_.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,_.jsx)("span",{className:"text-[10px] font-bold text-emerald-700 tracking-wide uppercase",children:"Sincronizzazione"})]})]})}),(0,_.jsx)("div",{className:"flex-1 overflow-hidden relative chat-bg",children:(0,_.jsx)(uw,{ref:d,data:t,initialTopMostItemIndex:t.length-1,itemContent:h,followOutput:"smooth",className:"h-full w-full",alignToBottom:!0})}),(0,_.jsx)(co,{onSendMessage:r,showBottomNavPadding:a,onFocusChange:l,isFocused:u})]})},cl=({activeTab:e,onTabChange:t,usersCount:r,unreadChatsCount:n})=>(0,_.jsxs)("nav",{className:"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]",children:[(0,_.jsxs)("button",{onClick:()=>t("room"),className:`flex flex-col items-center justify-center w-full relative ${"room"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"room"===e?2.6:2.2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r>0&&(0,_.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:r})]}),(0,_.jsx)("span",{className:`text-[10px] mt-1 ${"room"===e?"font-bold":"font-semibold"}`,children:"Stanza"})]}),(0,_.jsxs)("button",{onClick:()=>t("users"),className:`flex flex-col items-center justify-center w-full relative ${"users"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"users"===e?2.6:2.2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,_.jsx)("span",{className:`text-[10px] mt-1 ${"users"===e?"font-bold":"font-semibold"}`,children:"Utenti"})]}),(0,_.jsxs)("button",{onClick:()=>t("chats"),className:`flex flex-col items-center justify-center w-full relative ${"chats"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"chats"===e?2.6:2.2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),n>0&&(0,_.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:n})]}),(0,_.jsx)("span",{className:`text-[10px] mt-1 ${"chats"===e?"font-bold":"font-semibold"}`,children:"Chats"})]}),(0,_.jsxs)("button",{onClick:()=>t("settings"),className:`flex flex-col items-center justify-center w-full relative ${"settings"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"settings"===e?2.6:2.2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,_.jsx)("span",{className:`text-[10px] mt-1 ${"settings"===e?"font-bold":"font-semibold"}`,children:"Me"})]})]}),cu=({currentUser:e,users:t,onStartChat:r})=>{let[n,i]=(0,T.useState)(""),s=t.filter(t=>t.id!==e.id&&t.alias.toLowerCase().includes(n.toLowerCase()));return(0,_.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,_.jsxs)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 transition-all",children:[(0,_.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,_.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Utenti"}),(0,_.jsxs)("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide",children:[t.length," Online"]})]}),(0,_.jsx)("div",{className:"px-4 pb-3",children:(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,_.jsx)("input",{type:"text",placeholder:"Cerca utente per nome...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm"}),n&&(0,_.jsx)("button",{onClick:()=>i(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),(0,_.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===s.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,_.jsx)("p",{className:"text-center font-medium",children:n?"Nessun utente trovato.":"Nessun altro utente online al momento."})]}):(0,_.jsx)("ul",{className:"space-y-4",children:s.map(e=>(0,_.jsxs)("li",{className:"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0",children:[(0,_.jsxs)("div",{className:`w-12 h-12 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:[(0,_.jsx)("span",{className:"font-bold text-lg uppercase",children:e.alias.charAt(0)}),(0,_.jsx)("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"})]}),(0,_.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,_.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.alias}),(0,_.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.status||(0,_.jsx)("span",{className:"capitalize",children:e.gender})})]}),(0,_.jsx)("button",{onClick:()=>r(e),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]},e.id))})})]})},cc=({chats:e,onSelectChat:t,onDeleteChat:r})=>(0,_.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,_.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,_.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,_.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Chat private"})})}),(0,_.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===e.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,_.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,_.jsxs)("p",{className:"text-center font-medium",children:["Nessuna chat attiva.",(0,_.jsx)("br",{}),"Cerca utenti nella scheda Utenti."]})]}):(0,_.jsx)("ul",{className:"space-y-4",children:e.map(e=>{var n;return(0,_.jsxs)("li",{onClick:()=>t(e.peer.id),className:"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0",children:[(0,_.jsx)("div",{className:`w-14 h-14 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:(0,_.jsx)("span",{className:"font-bold text-xl uppercase",children:e.peer.alias.charAt(0)})}),(0,_.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,_.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,_.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.peer.alias}),(0,_.jsx)("span",{className:"text-[11px] text-gray-400 font-medium",children:(e=>{if(0===e.length)return"";let t=new Date(e[e.length-1].timestamp),r=new Date;return t.toDateString()===r.toDateString()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{day:"2-digit",month:"2-digit"})})(e.messages)})]}),(0,_.jsx)("p",{className:"text-sm text-gray-500 truncate",children:0===(n=e.messages).length?"Inizia la conversazione...":n[n.length-1].text})]}),(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[e.unreadCount>0&&(0,_.jsx)("div",{className:"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center",children:(0,_.jsx)("span",{className:"text-[10px] font-bold text-white",children:e.unreadCount})}),(0,_.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e.peer.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},e.peer.id)})})})]}),cd=({user:e,onLogout:t,onUpdateAlias:r,onUpdateStatus:n})=>{let[i,s]=(0,T.useState)(!1),[o,a]=(0,T.useState)(!1),[l,u]=(0,T.useState)(e.alias),[c,d]=(0,T.useState)(e.status||""),h=()=>{l.trim()&&l!==e.alias&&r(l.trim()),s(!1)},p=()=>{c.trim()!==(e.status||"")&&n(c.trim()),a(!1)};return(0,_.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,_.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,_.jsx)("div",{className:"h-[60px] px-4 flex items-center",children:(0,_.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Profilo"})})}),(0,_.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,_.jsxs)("div",{className:"pb-32",children:[(0,_.jsx)("div",{className:"py-8 flex flex-col items-center bg-white border-b border-gray-100",children:(0,_.jsx)("div",{className:"relative group",children:(0,_.jsx)("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden",children:e.alias.charAt(0).toUpperCase()})})}),(0,_.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stato"}),(0,_.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,_.jsxs)("button",{onClick:()=>a(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,_.jsx)("div",{className:"flex flex-col items-start truncate overflow-hidden",children:o?(0,_.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onBlur:p,onKeyDown:e=>"Enter"===e.key&&p(),maxLength:50,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,_.jsx)("span",{className:"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left",children:e.status||"Disponibile"})}),(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alias"}),(0,_.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,_.jsxs)("button",{onClick:()=>s(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,_.jsx)("div",{className:"flex flex-col items-start",children:i?(0,_.jsx)("input",{type:"text",value:l,onChange:e=>u(e.target.value),onBlur:h,onKeyDown:e=>"Enter"===e.key&&h(),maxLength:20,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,_.jsx)("span",{className:"text-[17px] text-gray-900",children:e.alias})}),(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Informazioni"}),(0,_.jsxs)("div",{className:"bg-white border-y border-gray-100 divide-y divide-gray-50",children:[(0,_.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,_.jsx)("span",{className:"text-[17px] text-gray-400",children:"Sesso"}),(0,_.jsx)("span",{className:"text-[17px] text-gray-900 capitalize",children:{male:"maschio",female:"femmina",other:"altro"}[e.gender]||e.gender})]}),(0,_.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,_.jsx)("span",{className:"text-[17px] text-gray-400",children:"User ID"}),(0,_.jsx)("span",{className:"text-xs font-mono text-gray-400 uppercase tracking-wider",children:e.id})]})]})]}),(0,_.jsx)("div",{className:"pt-4",children:(0,_.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,_.jsx)("button",{onClick:t,className:"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors",children:"Esci"})})})]})]})})]})};function ch({tenant:e,initialMessages:t}){let[r,n]=(0,T.useState)(null),[i,s]=(0,T.useState)(null),{data:o,isPending:a}=at(),[l,u]=(0,T.useState)("room"),[c,d]=(0,T.useState)(null),[h,p]=(0,T.useState)(!1),[f,m]=(0,T.useState)([]),[g,y]=(0,T.useState)({}),[x,w]=(0,T.useState)(!1),S=(0,eX.useQueryClient)(),{data:E=t,isFetching:k}=function(e,t,r){let n,i=T.useContext(e1),s=T.useContext(e0),o=(0,eX.useQueryClient)(r),a=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a);let l=o.getQueryCache().get(a.queryHash);if(a._optimisticResults=i?"isRestoring":"optimistic",a.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=a.staleTime;a.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof a.gcTime&&(a.gcTime=Math.max(a.gcTime,1e3))}n=l?.state.error&&"function"==typeof a.throwOnError?(0,eW.shouldThrowError)(a.throwOnError,[l.state.error,l]):a.throwOnError,(a.suspense||a.experimental_prefetchInRender||n)&&!s.isReset()&&(a.retryOnMount=!1),T.useEffect(()=>{s.clearReset()},[s]);let u=!o.getQueryCache().get(a.queryHash),[c]=T.useState(()=>new t(o,a)),d=c.getOptimisticResult(a),h=!i&&!1!==e.subscribed;if(T.useSyncExternalStore(T.useCallback(e=>{let t=h?c.subscribe(eH.notifyManager.batchCalls(e)):eW.noop;return c.updateResult(),t},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),T.useEffect(()=>{c.setOptions(a)},[a,c]),a?.suspense&&d.isPending)throw e2(a,c,s);if((({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&void 0===e.data||(0,eW.shouldThrowError)(r,[e.error,n])))({result:d,errorResetBoundary:s,throwOnError:a.throwOnError,query:l,suspense:a.suspense}))throw d.error;if(o.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!eW.isServer&&d.isLoading&&d.isFetching&&!i){let e=u?e2(a,c,s):l?.promise;e?.catch(eW.noop).finally(()=>{c.updateResult()})}return a.notifyOnChangeProps?d:c.trackResult(d)}({queryKey:["messages","global",e.slug],queryFn:async()=>{let r=await e5.getMessages(!0);try{let t=await fetch(`${eM.API_BASE_URL}/api/messages?tenant=${e.slug}`);if(t.ok){let e=await t.json();for(let t of e)await e5.saveMessage(t,!0);return e}}catch(e){console.warn("Failed to fetch from server, using local data",e)}return r.length>0?r:t},initialData:t},eq,void 0);(0,T.useEffect)(()=>{if(console.log(`[Session] Loading: ${a}, User: ${o?.user?.id}, Name: ${o?.user?.name}`),!a&&o?.user){let e="true"===localStorage.getItem("waiting_for_passkey");if(console.log(`[Session] Waiting for passkey: ${e}`),e)return;let t={id:o.user.id,alias:o.user.name||"User",gender:o.user.gender||"other",status:o.user.status||"",phoneNumber:o.user.phoneNumber,joinedAt:new Date(o.user.createdAt).getTime()};console.log("[Session] Setting authenticated user:",t),n(t),localStorage.setItem("chat_user",JSON.stringify(t))}},[o,a]),(0,T.useEffect)(()=>{{let e=localStorage.getItem("chat_user"),t="true"===localStorage.getItem("waiting_for_passkey");if(e&&!o&&!a&&!t)try{let t=JSON.parse(e);n(t),e4.Capacitor.isNativePlatform()&&e5.getPrivateChats(t.id).then(e=>{if(e.length>0){let r={};for(let n of e){let e=n.messages[n.messages.length-1];r[n.peerId]={peer:{id:n.peerId,alias:e.senderId===t.id?"Chat":e.senderAlias,gender:e.senderId===t.id?"other":e.senderGender,joinedAt:Date.now()},messages:n.messages,unread:0}}y(r),console.log(`Restored ${e.length} private chats from SQLite`)}}).catch(e=>console.error("Error restoring private chats:",e))}catch(e){console.error("Invalid saved user",e)}let r=e4.Capacitor.getPlatform();if(document.documentElement.classList.add(`platform-${r}`),e4.Capacitor.isNativePlatform()){let e,t;return e6.setResizeMode({mode:v.Body}).catch(e=>{console.error("Error setting keyboard resize mode",e)}),e8.setOverlaysWebView({overlay:!1}).catch(e=>{console.error("Error setting StatusBar overlay",e)}),e8.setBackgroundColor({color:"#ffffff"}).catch(e=>{console.warn("StatusBar background color not supported on this platform",e)}),e8.setStyle({style:b.Light}).catch(e=>{console.error("Error setting StatusBar style",e)}),(async()=>{e=await e6.addListener("keyboardWillShow",()=>{p(!0)}),t=await e6.addListener("keyboardWillHide",()=>{p(!1)})})(),()=>{e&&e.remove(),t&&t.remove()}}}},[e.slug]),(0,T.useEffect)(()=>{if(!r)return;let t=eB(eM.API_BASE_URL||void 0,{query:{tenantSlug:e.slug,userId:r.id},transports:["websocket"],reconnectionAttempts:5,timeout:1e4});return s(t),t.on("connect_error",e=>{console.error("[Socket] Connect Error:",e.message,e)}),t.on("error",e=>{console.error("[Socket] General Error:",e)}),t.on("connect",()=>{console.log("Socket connected"),w(!0),t.emit("join",{user:r,tenantSlug:e.slug})}),t.on("disconnect",()=>{w(!1)}),t.on("presenceUpdate",e=>{m(e)}),t.on("newMessage",async t=>{await e5.saveMessage(t,!0),S.invalidateQueries({queryKey:["messages","global",e.slug]})}),t.on("privateMessage",async e=>{let t=e.senderId===r.id,n=t?e.recipientId:e.senderId;await e5.saveMessage(e,!1),!t&&e4.Capacitor.isNativePlatform()&&e9.impact({style:e3.ImpactStyle.Light}).catch(()=>{}),y(r=>{let i=r[n]||{peer:{id:n,alias:t?"Unknown":e.senderAlias,gender:t?"male":e.senderGender,joinedAt:Date.now()},messages:[],unread:0};return i.messages.some(t=>t.id===e.id)?r:{...r,[n]:{...i,messages:[...i.messages,e],unread:i.unread+1}}})}),()=>{t.disconnect()}},[r,e.slug,S]),(0,T.useEffect)(()=>{"chats"===l&&c&&g[c]?.unread>0&&y(e=>({...e,[c]:{...e[c],unread:0}}))},[l,c,g]);let z=async()=>{o&&await ar(),n(null),s(null),localStorage.removeItem("chat_user"),y({}),e5.clearMessages(),S.setQueryData(["messages","global",e.slug],t),d(null),u("room")},R=async t=>{if(!r||!i)return;let n={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString()};e4.Capacitor.isNativePlatform()&&e9.impact({style:e3.ImpactStyle.Light}).catch(()=>{}),await e5.saveMessage(n,!0),S.setQueryData(["messages","global",e.slug],e=>[...e||[],n]),i.emit("sendMessage",{...n,tenantSlug:e.slug})},I=async t=>{if(!r||!i||!c)return;let n={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString(),recipientId:c};e4.Capacitor.isNativePlatform()&&e9.impact({style:e3.ImpactStyle.Light}).catch(()=>{}),await e5.saveMessage(n,!1),y(e=>({...e,[c]:{...e[c],messages:[...e[c].messages,n]}})),i.emit("sendMessage",{...n,tenantSlug:e.slug,isPrivate:!0})},{swipeHandlers:O,swipeStyle:C,isDragging:j}=function({onSwipeBack:e,edgeWidth:t=30,threshold:r=100,enabled:n=!0}){let[i,s]=(0,T.useState)({isDragging:!1,translateX:0,opacity:1}),o=(0,T.useRef)(0),a=(0,T.useRef)(0),l=(0,T.useRef)(!1),u=(0,T.useRef)(!1);return{swipeHandlers:{onTouchStart:(0,T.useCallback)(e=>{if(!n)return;let r=e.touches[0];o.current=r.clientX,a.current=r.clientY,l.current=r.clientX<=t,u.current=!1,l.current&&s({isDragging:!0,translateX:0,opacity:1})},[n,t]),onTouchMove:(0,T.useCallback)(e=>{if(!n||!l.current||u.current)return;let t=e.touches[0],r=t.clientX-o.current;if(Math.abs(t.clientY-a.current)>30&&r<30){l.current=!1,s({isDragging:!1,translateX:0,opacity:1});return}if(r>0){let t=Math.min(.8*r,window.innerWidth),n=1-t/window.innerWidth*.3;s({isDragging:!0,translateX:t,opacity:n}),e.preventDefault()}},[n]),onTouchEnd:(0,T.useCallback)(()=>{if(!n||!l.current||u.current)return void s({isDragging:!1,translateX:0,opacity:1});let{translateX:t}=i;t>=r?(u.current=!0,s({isDragging:!1,translateX:window.innerWidth,opacity:0}),setTimeout(()=>{e(),s({isDragging:!1,translateX:0,opacity:1})},150)):s({isDragging:!1,translateX:0,opacity:1}),l.current=!1},[n,i,r,e])},swipeStyle:{transform:`translateX(${i.translateX}px)`,transition:i.isDragging?"none":"transform 0.2s ease-out, opacity 0.2s ease-out",opacity:i.opacity},isDragging:i.isDragging,translateX:i.translateX}}({onSwipeBack:()=>d(null),enabled:e4.Capacitor.isNativePlatform()&&null!==c});if(!r)return(0,_.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col",children:(0,_.jsx)(an,{onLogin:e=>{n(e),localStorage.setItem("chat_user",JSON.stringify(e))},tenantName:e.name})});if(c&&"chats"===l){let e=g[c];return e?(0,_.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",style:C,...O,children:[j&&(0,_.jsx)("div",{className:"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none"}),(0,_.jsx)("header",{className:"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0",children:(0,_.jsxs)("div",{className:"h-[60px] px-4 flex items-center gap-3",children:[(0,_.jsx)("button",{onClick:()=>d(null),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,_.jsxs)("div",{className:"flex flex-col",children:[(0,_.jsx)("h2",{className:"font-bold text-lg leading-tight",children:e.peer.alias}),f.some(e=>e.id===c)&&(0,_.jsx)("span",{className:"text-xs text-emerald-500 font-medium",children:"Online"})]})]})}),(0,_.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,_.jsx)(ca,{user:r,messages:e.messages,onSendMessage:I,onlineCount:0,isOnline:!0,hideHeader:!0,showBottomNavPadding:!1,onInputFocusChange:p,isFocused:h,isSyncing:!1})})]}):(d(null),null)}let A=Object.values(g).reduce((e,t)=>e+t.unread,0);return(0,_.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",children:[(0,_.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:["room"===l&&(0,_.jsx)(ca,{user:r,messages:E,onSendMessage:R,onlineCount:f.length,isOnline:x,headerTitle:e.name,showBottomNavPadding:!0,onInputFocusChange:p,isFocused:h,isSyncing:k}),"users"===l&&(0,_.jsx)(cu,{currentUser:r,users:f,onStartChat:e=>{g[e.id]||y(t=>({...t,[e.id]:{peer:e,messages:[],unread:0}})),d(e.id),u("chats")}}),"chats"===l&&(0,_.jsx)(cc,{chats:Object.values(g).map(e=>({...e,unreadCount:e.unread})).sort((e,t)=>{let r=e.messages.length?new Date(e.messages[e.messages.length-1].timestamp).getTime():0;return(t.messages.length?new Date(t.messages[t.messages.length-1].timestamp).getTime():0)-r}),onSelectChat:d,onDeleteChat:e=>{y(t=>{let r={...t};return delete r[e],r}),c===e&&d(null)}}),"settings"===l&&(0,_.jsx)(cd,{user:r,onLogout:z,onUpdateAlias:t=>{if(!r||!i)return;let s={...r,alias:t};n(s),localStorage.setItem("chat_user",JSON.stringify(s)),i.emit("join",{user:s,tenantSlug:e.slug})},onUpdateStatus:t=>{if(!r||!i)return;let s={...r,status:t};n(s),localStorage.setItem("chat_user",JSON.stringify(s)),i.emit("join",{user:s,tenantSlug:e.slug})}})]}),(0,_.jsx)("div",{className:`transition-all duration-300 ease-in-out border-t border-gray-100 bg-white z-20 overflow-hidden ${h?"opacity-0 pointer-events-none h-0":"opacity-100 h-auto"}`,children:(0,_.jsx)(cl,{activeTab:l,onTabChange:e=>{u(e),d(null)},usersCount:f.length,unreadChatsCount:A})})]})}var cp=e.i(1647);function cf(){let e=(0,S.useParams)().tenantSlug,[t,r]=(0,T.useState)(null),[n,i]=(0,T.useState)([]),[s,o]=(0,T.useState)(!0),[a,l]=(0,T.useState)(!1);return((0,T.useEffect)(()=>{!async function(){try{let t=await (0,cp.clientGetTenantBySlug)(e);if(!t){l(!0),o(!1);return}r(t);let n=(await (0,cp.clientGetMessages)(e)).map(e=>({id:e.id,text:e.text,senderId:e.senderId||e.userId,senderAlias:e.senderAlias||e.user?.name||"Anonymous",senderGender:e.senderGender||"other",timestamp:new Date(e.timestamp||e.createdAt).toISOString()}));i(n),o(!1)}catch(e){console.error("Error loading chat data",e),l(!0),o(!1)}}()},[e]),s)?(0,_.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,_.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Caricamento chat..."})}):((a||!t)&&(0,S.notFound)(),(0,_.jsx)("main",{className:"flex h-full flex-col items-center justify-between",children:(0,_.jsx)(ch,{tenant:t,initialMessages:n})}))}e.s(["default",()=>cf],68689)}]);