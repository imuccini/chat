(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68689,e=>{"use strict";let t,r,s,n,i;var o,l,a,c,u,h,d,p,f,m,g=e.i(43476),x=e.i(71645),y=e.i(18566);let v=Object.create(null);v.open="0",v.close="1",v.ping="2",v.pong="3",v.message="4",v.upgrade="5",v.noop="6";let b=Object.create(null);Object.keys(v).forEach(e=>{b[v[e]]=e});let w={type:"error",data:"parser error"},I="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),T="function"==typeof ArrayBuffer,C=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,S=({type:e,data:t},r,s)=>{if(I&&t instanceof Blob)if(r)return s(t);else return k(t,s);if(T&&(t instanceof ArrayBuffer||C(t)))if(r)return s(t);else return k(new Blob([t]),s);return s(v[e]+(t||""))},k=(e,t)=>{let r=new FileReader;return r.onload=function(){t("b"+(r.result.split(",")[1]||""))},r.readAsDataURL(e)};function j(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E="u"<typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<R.length;e++)E[R.charCodeAt(e)]=e;let _="function"==typeof ArrayBuffer,N=(e,t)=>{if("string"!=typeof e)return{type:"message",data:B(e,t)};let r=e.charAt(0);return"b"===r?{type:"message",data:O(e.substring(1),t)}:b[r]?e.length>1?{type:b[r],data:e.substring(1)}:{type:b[r]}:w},O=(e,t)=>_?B((e=>{let t=.75*e.length,r=e.length,s,n=0,i,o,l,a;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let c=new ArrayBuffer(t),u=new Uint8Array(c);for(s=0;s<r;s+=4)i=E[e.charCodeAt(s)],o=E[e.charCodeAt(s+1)],l=E[e.charCodeAt(s+2)],a=E[e.charCodeAt(s+3)],u[n++]=i<<2|o>>4,u[n++]=(15&o)<<4|l>>2,u[n++]=(3&l)<<6|63&a;return c})(e),t):{base64:!0,data:e},B=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer;function L(e){return e.reduce((e,t)=>e+t.length,0)}function A(e,t){if(e[0].length===t)return e.shift();let r=new Uint8Array(t),s=0;for(let n=0;n<t;n++)r[n]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function H(e){if(e){var t=e;for(var r in H.prototype)t[r]=H.prototype[r];return t}}H.prototype.on=H.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},H.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},H.prototype.off=H.prototype.removeListener=H.prototype.removeAllListeners=H.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,s=this._callbacks["$"+e];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n=0;n<s.length;n++)if((r=s[n])===t||r.fn===t){s.splice(n,1);break}return 0===s.length&&delete this._callbacks["$"+e],this},H.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,n=r.length;s<n;++s)r[s].apply(this,t)}return this},H.prototype.emitReserved=H.prototype.emit,H.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},H.prototype.hasListeners=function(e){return!!this.listeners(e).length};let z="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),M="u">typeof self?self:"u">typeof window?window:Function("return this")();function D(e,...t){return t.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}let P=M.setTimeout,F=M.clearTimeout;function W(e,t){t.useNativeTimers?(e.setTimeoutFn=P.bind(M),e.clearTimeoutFn=F.bind(M)):(e.setTimeoutFn=M.setTimeout.bind(M),e.clearTimeoutFn=M.clearTimeout.bind(M))}function q(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class U extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class V extends H{constructor(e){super(),this.writable=!1,W(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new U(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=N(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return -1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){let t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}class Q extends V{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};((e,t)=>{let r=e.split("\x1e"),s=[];for(let e=0;e<r.length;e++){let n=N(r[e],t);if(s.push(n),"error"===n.type)break}return s})(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){let e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){var t;let r,s,n;this.writable=!1,t=e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})},s=Array(r=e.length),n=0,e.forEach((e,i)=>{S(e,!1,e=>{s[i]=e,++n===r&&t(s.join("\x1e"))})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=q()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let G=!1;try{G="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}let $=G;function K(){}class Y extends Q{constructor(e){if(super(e),"u">typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="u">typeof location&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class X extends H{constructor(e,t,r){super(),this.createRequest=e,W(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var e;let t=D(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let e in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this._opts.extraHeaders[e])}catch(e){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}null==(e=this._opts.cookieJar)||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null==(e=this._opts.cookieJar)||e.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof r.status?r.status:0)},0))},r.send(this._data)}catch(e){this.setTimeoutFn(()=>{this._onError(e)},0);return}"u">typeof document&&(this._index=X.requestsCount++,X.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=K,e)try{this._xhr.abort()}catch(e){}"u">typeof document&&delete X.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function J(){for(let e in X.requests)X.requests.hasOwnProperty(e)&&X.requests[e].abort()}X.requestsCount=0,X.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",J):"function"==typeof addEventListener&&addEventListener("onpagehide"in M?"pagehide":"unload",J,!1));let Z=(s=ee({xdomain:!1}))&&null!==s.responseType;function ee(e){let t=e.xdomain;try{if("u">typeof XMLHttpRequest&&(!t||$))return new XMLHttpRequest}catch(e){}if(!t)try{return new M[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}let et="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class er extends V{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,r=et?{}:D(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],s=t===e.length-1;S(r,this.supportsBinary,e=>{try{this.doWrite(r,e)}catch(e){}s&&z(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=q()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}let es=M.WebSocket||M.MozWebSocket,en={websocket:class extends er{createSocket(e,t,r){return et?new es(e,t,r):t?new es(e,t):new es(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends V{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{var s,n;let i,o,l,a,c=(s=Number.MAX_SAFE_INTEGER,n=this.socket.binaryType,r||(r=new TextDecoder),i=[],o=0,l=-1,a=!1,new TransformStream({transform(e,t){for(i.push(e);;){if(0===o){if(1>L(i))break;let e=A(i,1);a=(128&e[0])==128,o=(l=127&e[0])<126?3:126===l?1:2}else if(1===o){if(2>L(i))break;let e=A(i,2);l=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),o=3}else if(2===o){if(8>L(i))break;let e=A(i,8),r=new DataView(e.buffer,e.byteOffset,e.length),s=r.getUint32(0);if(s>2097151){t.enqueue(w);break}l=0x100000000*s+r.getUint32(4),o=3}else{if(L(i)<l)break;let e=A(i,l);t.enqueue(N(a?e:r.decode(e),n)),o=0}if(0===l||l>s){t.enqueue(w);break}}}})),u=e.readable.pipeThrough(c).getReader(),h=new TransformStream({transform(e,r){var s;s=t=>{let s,n=t.length;if(n<126)new DataView((s=new Uint8Array(1)).buffer).setUint8(0,n);else if(n<65536){let e=new DataView((s=new Uint8Array(3)).buffer);e.setUint8(0,126),e.setUint16(1,n)}else{let e=new DataView((s=new Uint8Array(9)).buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(n))}e.data&&"string"!=typeof e.data&&(s[0]|=128),r.enqueue(s),r.enqueue(t)},I&&e.data instanceof Blob?e.data.arrayBuffer().then(j).then(s):T&&(e.data instanceof ArrayBuffer||C(e.data))?s(j(e.data)):S(e,!1,e=>{t||(t=new TextEncoder),s(t.encode(e))})}});h.readable.pipeTo(e.writable),this._writer=h.writable.getWriter();let d=()=>{u.read().then(({done:e,value:t})=>{e||(this.onPacket(t),d())}).catch(e=>{})};d();let p={type:"open"};this.query.sid&&(p.data=`{"sid":"${this.query.sid}"}`),this._writer.write(p).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],s=t===e.length-1;this._writer.write(r).then(()=>{s&&z(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null==(e=this._transport)||e.close()}},polling:class extends Y{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Z&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new X(ee,this.uri(),e)}}},ei=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function el(e){var t,r;let s,n;if(e.length>8e3)throw"URI too long";let i=e,o=e.indexOf("["),l=e.indexOf("]");-1!=o&&-1!=l&&(e=e.substring(0,o)+e.substring(o,l).replace(/:/g,";")+e.substring(l,e.length));let a=ei.exec(e||""),c={},u=14;for(;u--;)c[eo[u]]=a[u]||"";return -1!=o&&-1!=l&&(c.source=i,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),s=(t=c.path).replace(/\/{2,9}/g,"/").split("/"),("/"==t.slice(0,1)||0===t.length)&&s.splice(0,1),"/"==t.slice(-1)&&s.splice(s.length-1,1),c.pathNames=s,r=c.query,n={},r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n[t]=r)}),c.queryKey=n,c}let ea="function"==typeof addEventListener&&"function"==typeof removeEventListener,ec=[];ea&&addEventListener("offline",()=>{ec.forEach(e=>e())},!1);class eu extends H{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const r=el(e);t.hostname=r.host,t.secure="https"===r.protocol||"wss"===r.protocol,t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=el(t.host).host);W(this,t),this.secure=null!=t.secure?t.secure:"u">typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("u">typeof location?location.hostname:"localhost"),this.port=t.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{let t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,s=r.length;e<s;e++){let s=r[e].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}(this.opts.query)),ea&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ec.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);let e=this.opts.rememberUpgrade&&eu.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",eu.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r&&(e+="string"==typeof r?function(e){let t=0,r=0;for(let s=0,n=e.length;s<n;s++)(t=e.charCodeAt(s))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}(r):Math.ceil(1.33*(r.byteLength||r.size))),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,z(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,s){if("function"==typeof t&&(s=t,t=void 0),"function"==typeof r&&(s=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let n={type:e,data:t,options:r};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),s&&this.once("flush",s),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(eu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ea&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let e=ec.indexOf(this._offlineEventListener);-1!==e&&ec.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}eu.protocol=4;class eh extends eu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;eu.priorWebsocketSuccess=!1;let s=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;eu.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{r||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{let e=Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function n(){r||(r=!0,c(),t.close(),t=null)}let i=e=>{let r=Error("probe error: "+e);r.transport=t.name,n(),this.emitReserved("upgradeError",r)};function o(){i("transport closed")}function l(){i("socket closed")}function a(e){t&&e.name!==t.name&&n()}let c=()=>{t.removeListener("open",s),t.removeListener("error",i),t.removeListener("close",o),this.off("close",l),this.off("upgrading",a)};t.once("open",s),t.once("error",i),t.once("close",o),this.once("close",l),this.once("upgrading",a),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}class ed extends eh{constructor(e,t={}){const r="object"==typeof e?e:t;(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(e=>en[e]).filter(e=>!!e)),super(e,r)}}ed.protocol;let ep="function"==typeof ArrayBuffer,ef=Object.prototype.toString,em="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===ef.call(Blob),eg="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===ef.call(File);function ex(e){return ep&&(e instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer))||em&&e instanceof Blob||eg&&e instanceof File}let ey=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];(o=h||(h={}))[o.CONNECT=0]="CONNECT",o[o.DISCONNECT=1]="DISCONNECT",o[o.EVENT=2]="EVENT",o[o.ACK=3]="ACK",o[o.CONNECT_ERROR=4]="CONNECT_ERROR",o[o.BINARY_EVENT=5]="BINARY_EVENT",o[o.BINARY_ACK=6]="BINARY_ACK";class ev{constructor(e){this.replacer=e}encode(e){return(e.type===h.EVENT||e.type===h.ACK)&&function e(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let r=0,s=t.length;r<s;r++)if(e(t[r]))return!0;return!1}if(ex(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)?this.encodeAsBinary({type:e.type===h.EVENT?h.BINARY_EVENT:h.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===h.BINARY_EVENT||e.type===h.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t,r,s=(t=[],r=e.data,e.data=function e(t,r){if(!t)return t;if(ex(t)){let e={_placeholder:!0,num:r.length};return r.push(t),e}if(Array.isArray(t)){let s=Array(t.length);for(let n=0;n<t.length;n++)s[n]=e(t[n],r);return s}if("object"==typeof t&&!(t instanceof Date)){let s={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=e(t[n],r));return s}return t}(r,t),e.attachments=t.length,{packet:e,buffers:t}),n=this.encodeAsString(s.packet),i=s.buffers;return i.unshift(n),i}}class eb extends H{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let r=(t=this.decodeString(e)).type===h.BINARY_EVENT;r||t.type===h.BINARY_ACK?(t.type=r?h.EVENT:h.ACK,this.reconstructor=new ew(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(ex(e)||e.base64)if(this.reconstructor)(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(void 0===h[r.type])throw Error("unknown packet type "+r.type);if(r.type===h.BINARY_EVENT||r.type===h.BINARY_ACK){let s=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);let n=e.substring(s,t);if(n!=Number(n)||"-"!==e.charAt(t))throw Error("Illegal attachments");r.attachments=Number(n)}if("/"===e.charAt(t+1)){let s=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(s,t)}else r.nsp="/";let s=e.charAt(t+1);if(""!==s&&Number(s)==s){let s=t+1;for(;++t;){let r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=this.tryParse(e.substr(t));if(eb.isPayloadValid(r.type,s))r.data=s;else throw Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case h.CONNECT:return eT(t);case h.DISCONNECT:return void 0===t;case h.CONNECT_ERROR:return"string"==typeof t||eT(t);case h.EVENT:case h.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ey.indexOf(t[0]));case h.ACK:case h.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ew{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t,r;let e=(t=this.reconPack,r=this.buffers,t.data=function e(t,r){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<r.length)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=e(t[s],r);else if("object"==typeof t)for(let s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=e(t[s],r));return t}(t.data,r),delete t.attachments,t);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}let eI=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function eT(e){return"[object Object]"===Object.prototype.toString.call(e)}function eC(e){var t;return"string"==typeof e.nsp&&(void 0===(t=e.id)||eI(t))&&function(e,t){switch(e){case h.CONNECT:return void 0===t||eT(t);case h.DISCONNECT:return void 0===t;case h.EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ey.indexOf(t[0]));case h.ACK:return Array.isArray(t);case h.CONNECT_ERROR:return"string"==typeof t||eT(t);default:return!1}}(e.type,e.data)}function eS(e,t,r){return e.on(t,r),function(){e.off(t,r)}}e.s(["Decoder",()=>eb,"Encoder",()=>ev,"PacketType",()=>h,"isPacketValid",()=>eC,"protocol",0,5],51890);let ek=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ej extends H{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[eS(e,"open",this.onopen.bind(this)),eS(e,"packet",this.onpacket.bind(this)),eS(e,"error",this.onerror.bind(this)),eS(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,s,n;if(ek.hasOwnProperty(e))throw Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let i={type:h.EVENT,data:t};if(i.options={},i.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){let e=this.ids++,r=t.pop();this._registerAckCallback(e,r),i.id=e}let o=null==(s=null==(r=this.io.engine)?void 0:r.transport)?void 0:s.writable,l=this.connected&&!(null==(n=this.io.engine)?void 0:n._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var r;let s=null!=(r=this.flags.timeout)?r:this._opts.ackTimeout;if(void 0===s){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,Error("operation has timed out"))},s),i=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,e)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...t){return new Promise((r,s)=>{let n=(e,t)=>e?s(e):r(t);n.withError=!0,t.push(n),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...s)=>(this._queue[0],null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;let t=this._queue[0];(!t.pending||e)&&(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:h.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case h.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case h.EVENT:case h.BINARY_EVENT:this.onevent(e);break;case h.ACK:case h.BINARY_ACK:this.onack(e);break;case h.DISCONNECT:this.ondisconnect();break;case h.CONNECT_ERROR:this.destroy();let t=Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){let t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(let t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...s){r||(r=!0,t.packet({type:h.ACK,id:e,data:s}))}}onack(e){let t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:h.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}var eR=e.i(51890);function eE(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}eE.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(1&Math.floor(10*t))==0?e-r:e+r}return 0|Math.min(e,this.max)},eE.prototype.reset=function(){this.attempts=0},eE.prototype.setMin=function(e){this.ms=e},eE.prototype.setMax=function(e){this.max=e},eE.prototype.setJitter=function(e){this.jitter=e};class e_ extends H{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,W(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(r=t.randomizationFactor)?r:.5),this.backoff=new eE({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const s=t.parser||eR;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null==(t=this.backoff)||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null==(t=this.backoff)||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null==(t=this.backoff)||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ed(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let s=eS(t,"open",function(){r.onopen(),e&&e()}),n=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},i=eS(t,"error",n);if(!1!==this._timeout){let e=this._timeout,r=this.setTimeoutFn(()=>{s(),n(Error("timeout")),t.close()},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(s),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(eS(e,"ping",this.onping.bind(this)),eS(e,"data",this.ondata.bind(this)),eS(e,"error",this.onerror.bind(this)),eS(e,"close",this.onclose.bind(this)),eS(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){z(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new ej(this,e,t),this.nsps[e]=r),r}_destroy(e){for(let e of Object.keys(this.nsps))if(this.nsps[e].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),null==(r=this.engine)||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}let eN={};function eO(e,t){let r;"object"==typeof e&&(t=e,e=void 0);let s=function(e,t="",r){let s=e;r=r||"u">typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),s=el(e)),!s.port&&(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";let n=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+n+":"+s.port+t,s.href=s.protocol+"://"+n+(r&&r.port===s.port?"":":"+s.port),s}(e,(t=t||{}).path||"/socket.io"),n=s.source,i=s.id,o=s.path,l=eN[i]&&o in eN[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?r=new e_(n,t):(eN[i]||(eN[i]=new e_(n,t)),r=eN[i]),s.query&&!t.query&&(t.query=s.queryKey),r.socket(s.path,t)}Object.assign(eO,{Manager:e_,Socket:ej,io:eO,connect:eO});var eB=e.i(41533),eL=e.i(75555),eA=e.i(40143),eH=e.i(86491),ez=e.i(15823),eM=e.i(93803),eD=e.i(19273),eP=e.i(80166),eF=class extends ez.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,eM.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#s=void 0;#n=void 0;#i=void 0;#o;#l;#r;#t;#a;#c;#u;#h;#d;#p;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#s.addObserver(this),eW(this.#s,this.options)?this.#m():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return eq(this.#s,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return eq(this.#s,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#y(),this.#s.removeObserver(this)}setOptions(e){let t=this.options,r=this.#s;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,eD.resolveEnabled)(this.options.enabled,this.#s))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#v(),this.#s.setOptions(this.options),t._defaulted&&!(0,eD.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#s,observer:this});let s=this.hasListeners();s&&eU(this.#s,r,this.options,t)&&this.#m(),this.updateResult(),s&&(this.#s!==r||(0,eD.resolveEnabled)(this.options.enabled,this.#s)!==(0,eD.resolveEnabled)(t.enabled,this.#s)||(0,eD.resolveStaleTime)(this.options.staleTime,this.#s)!==(0,eD.resolveStaleTime)(t.staleTime,this.#s))&&this.#b();let n=this.#w();s&&(this.#s!==r||(0,eD.resolveEnabled)(this.options.enabled,this.#s)!==(0,eD.resolveEnabled)(t.enabled,this.#s)||n!==this.#p)&&this.#I(n)}getOptimisticResult(e){var t,r;let s=this.#e.getQueryCache().build(this.#e,e),n=this.createResult(s,e);return t=this,r=n,(0,eD.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#i=n,this.#l=this.options,this.#o=this.#s.state),n}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#s}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#m(e){this.#v();let t=this.#s.fetch(this.options,e);return e?.throwOnError||(t=t.catch(eD.noop)),t}#b(){this.#x();let e=(0,eD.resolveStaleTime)(this.options.staleTime,this.#s);if(eD.isServer||this.#i.isStale||!(0,eD.isValidTimeout)(e))return;let t=(0,eD.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#h=eP.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#s):this.options.refetchInterval)??!1}#I(e){this.#y(),this.#p=e,!eD.isServer&&!1!==(0,eD.resolveEnabled)(this.options.enabled,this.#s)&&(0,eD.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#d=eP.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||eL.focusManager.isFocused())&&this.#m()},this.#p))}#g(){this.#b(),this.#I(this.#w())}#x(){this.#h&&(eP.timeoutManager.clearTimeout(this.#h),this.#h=void 0)}#y(){this.#d&&(eP.timeoutManager.clearInterval(this.#d),this.#d=void 0)}createResult(e,t){let r,s=this.#s,n=this.options,i=this.#i,o=this.#o,l=this.#l,a=e!==s?e.state:this.#n,{state:c}=e,u={...c},h=!1;if(t._optimisticResults){let r=this.hasListeners(),i=!r&&eW(e,t),o=r&&eU(e,s,t,n);(i||o)&&(u={...u,...(0,eH.fetchState)(c.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:d,errorUpdatedAt:p,status:f}=u;r=u.data;let m=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===f){let e;i?.isPlaceholderData&&t.placeholderData===l?.placeholderData?(e=i.data,m=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,void 0!==e&&(f="success",r=(0,eD.replaceData)(i?.data,e,t),h=!0)}if(t.select&&void 0!==r&&!m)if(i&&r===o?.data&&t.select===this.#a)r=this.#c;else try{this.#a=t.select,r=t.select(r),r=(0,eD.replaceData)(i?.data,r,t),this.#c=r,this.#t=null}catch(e){this.#t=e}this.#t&&(d=this.#t,r=this.#c,p=Date.now(),f="error");let g="fetching"===u.fetchStatus,x="pending"===f,y="error"===f,v=x&&g,b=void 0!==r,w={status:f,fetchStatus:u.fetchStatus,isPending:x,isSuccess:"success"===f,isError:y,isInitialLoading:v,isLoading:v,data:r,dataUpdatedAt:u.dataUpdatedAt,error:d,errorUpdatedAt:p,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>a.dataUpdateCount||u.errorUpdateCount>a.errorUpdateCount,isFetching:g,isRefetching:g&&!x,isLoadingError:y&&!b,isPaused:"paused"===u.fetchStatus,isPlaceholderData:h,isRefetchError:y&&b,isStale:eV(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,eD.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==w.data,r="error"===w.status&&!t,n=e=>{r?e.reject(w.error):t&&e.resolve(w.data)},i=()=>{n(this.#r=w.promise=(0,eM.pendingThenable)())},o=this.#r;switch(o.status){case"pending":e.queryHash===s.queryHash&&n(o);break;case"fulfilled":(r||w.data!==o.value)&&i();break;case"rejected":r&&w.error===o.reason||i()}}return w}updateResult(){let e=this.#i,t=this.createResult(this.#s,this.options);if(this.#o=this.#s.state,this.#l=this.options,void 0!==this.#o.data&&(this.#u=this.#s),(0,eD.shallowEqualObjects)(t,e))return;this.#i=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;let s=new Set(r??this.#f);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&s.has(t))};this.#T({listeners:r()})}#v(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#s)return;let t=this.#s;this.#s=e,this.#n=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#T(e){eA.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#s,type:"observerResultsUpdated"})})}};function eW(e,t){return!1!==(0,eD.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&eq(e,t,t.refetchOnMount)}function eq(e,t,r){if(!1!==(0,eD.resolveEnabled)(t.enabled,e)&&"static"!==(0,eD.resolveStaleTime)(t.staleTime,e)){let s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&eV(e,t)}return!1}function eU(e,t,r,s){return(e!==t||!1===(0,eD.resolveEnabled)(s.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&eV(e,r)}function eV(e,t){return!1!==(0,eD.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,eD.resolveStaleTime)(t.staleTime,e))}e.i(47167);var eQ=e.i(12598),eG=x.createContext((n=!1,{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n})),e$=x.createContext(!1);e$.Provider;var eK=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()}),eY=e.i(82568);(0,eY.registerPlugin)("CapacitorSQLite",{web:()=>e.A(29126).then(e=>new e.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite});let eX=new class{sqlite=null;db=null;dbName="chat_cache";async initialize(){console.log("SQLite: Disabled for debugging.")}async saveMessage(e,t=!0){if(this.db||await this.initialize(),!this.db)return;let r=`
            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, isGlobal)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?);
        `,s=[e.id,e.text,e.senderId,e.senderAlias,e.senderGender,e.timestamp,e.recipientId||null,+!!t];try{await this.db.run(r,s)}catch(e){console.error("Error saving message to SQLite:",e)}}async getMessages(e=!0,t){if(this.db||await this.initialize(),!this.db)return[];let r="",s=[];e?r="SELECT * FROM messages WHERE isGlobal = 1 ORDER BY timestamp ASC LIMIT 100;":(r="SELECT * FROM messages WHERE isGlobal = 0 AND (recipientId = ? OR senderId = ?) ORDER BY timestamp ASC LIMIT 100;",s=[t,t]);try{return((await this.db.query(r,s)).values||[]).map(e=>({...e,isGlobal:void 0}))}catch(e){return console.error("Error fetching messages from SQLite:",e),[]}}async clearMessages(){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages;",[])}catch(e){console.error("Error clearing messages from SQLite:",e)}}async getPrivateChats(e){if(this.db||await this.initialize(),!this.db)return[];try{let t=((await this.db.query("SELECT * FROM messages WHERE isGlobal = 0 ORDER BY timestamp ASC;",[])).values||[]).map(e=>({id:e.id,text:e.text,senderId:e.senderId,senderAlias:e.senderAlias,senderGender:e.senderGender,timestamp:e.timestamp,recipientId:e.recipientId})),r=new Map;for(let s of t){let t=s.senderId===e?s.recipientId:s.senderId;r.has(t)||r.set(t,[]),r.get(t).push(s)}return Array.from(r.entries()).map(([e,t])=>({peerId:e,messages:t}))}catch(e){return console.error("Error loading private chats from SQLite:",e),[]}}};(l=d||(d={})).Dark="DARK",l.Light="LIGHT",l.Default="DEFAULT",(a=p||(p={})).Body="body",a.Ionic="ionic",a.Native="native",a.None="none";let eJ=(0,eY.registerPlugin)("Keyboard");var eZ=e.i(67065);let e0=(0,eY.registerPlugin)("Haptics",{web:()=>e.A(19924).then(e=>new e.HapticsWeb)});(c=f||(f={})).Dark="DARK",c.Light="LIGHT",c.Default="DEFAULT",(u=m||(m={})).None="NONE",u.Slide="SLIDE",u.Fade="FADE";let e1=(0,eY.registerPlugin)("StatusBar"),e2=({onLogin:e,tenantName:t})=>{let[r,s]=(0,x.useState)(""),[n,i]=(0,x.useState)("male"),o={male:"Maschio",female:"Femmina",other:"Altro"};return(0,g.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col justify-center",children:[(0,g.jsxs)("div",{className:"text-center mb-8",children:[(0,g.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 flex items-center justify-center",children:(0,g.jsx)("img",{src:"/local_logo.svg",alt:"Local Logo",className:"w-full h-full object-contain"})}),(0,g.jsx)("h1",{className:"text-2xl font-bold text-gray-800 tracking-tight",children:t}),(0,g.jsx)("p",{className:"text-gray-500 mt-2 text-sm",children:"chatta in modo anonimo con le persone intorno a te"})]}),(0,g.jsxs)("form",{onSubmit:t=>{t.preventDefault(),r.trim()&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),e({id:Math.random().toString(36).substr(2,9),alias:r.trim(),gender:n,joinedAt:Date.now()}))},className:"space-y-6",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Alias"}),(0,g.jsx)("input",{type:"text",required:!0,maxLength:20,value:r,onChange:e=>s(e.target.value),placeholder:"es. ShadowHunter",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800 placeholder-gray-300"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Identit di Genere"}),(0,g.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(e=>(0,g.jsx)("button",{type:"button",onClick:()=>i(e),className:`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${n===e?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"}`,children:o[e]},e))})]}),(0,g.jsxs)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2 group",children:["Entra nella Stanza",(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),(0,g.jsx)("p",{className:"text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest",children:"Powered by Local - Copyright 2025"})]})};var e4=e.i(74080);function e5(e){e()}function e3(e,t){return r=>e(t(r))}function e6(e){return void 0!==e}function e8(){}function e7(e,t){return t(e)}function e9(...e){return e}function te(e){e(2)}function tt(e){return e(4)}function tr(e,t){return e(1,e=>t(0,e))}function ts(e,t){let r=e(1,e=>{r(),t(e)});return r}function tn(e){let t,r;return s=>n=>{t=n,r&&clearTimeout(r),r=setTimeout(()=>{s(t)},e)}}function ti(e,t){return e===t}function to(e=ti){let t;return r=>s=>{e(t,s)||(t=s,r(s))}}function tl(e){return t=>r=>{e(r)&&t(r)}}function ta(e){return t=>e3(t,e)}function tc(e){return t=>()=>{t(e)}}function tu(e,...t){let r=function(...e){return t=>e.reduceRight(e7,t)}(...t);return(t,s)=>{switch(t){case 2:te(e);return;case 1:return e(1,r(s))}}}function th(e,t){return r=>s=>{r(t=e(t,s))}}function td(e){return t=>r=>{e>0?e--:t(r)}}function tp(e){let t=null,r;return s=>n=>{t=n,r||(r=setTimeout(()=>{r=void 0,s(t)},e))}}function tf(...e){let t=Array(e.length),r=0,s=null,n=Math.pow(2,e.length)-1;return e.forEach((e,i)=>{let o=Math.pow(2,i);e(1,e=>{let l=r;r|=o,t[i]=e,l!==n&&r===n&&s&&(s(),s=null)})}),e=>i=>{let o=()=>{e([i].concat(t))};r===n?o():s=o}}function tm(e){let t=e,r=tx();return(e,s)=>{switch(e){case 0:t=s;break;case 1:s(t);break;case 4:return t}return r(e,s)}}function tg(e,t){var r;return r=tm(t),tr(e,r),r}function tx(){let e=[];return(t,r)=>{switch(t){case 0:e.slice().forEach(e=>{e(r)});return;case 2:e.splice(0,e.length);return;case 1:return e.push(r),()=>{let t=e.indexOf(r);t>-1&&e.splice(t,1)}}}}function ty(e){var t;return t=tx(),tr(e,t),t}function tv(e,t=[],{singleton:r}={singleton:!0}){return{constructor:e,dependencies:t,id:tb(),singleton:r}}let tb=()=>Symbol();function tw(...e){let t=tx(),r=Array(e.length),s=0,n=Math.pow(2,e.length)-1;return e.forEach((e,i)=>{let o=Math.pow(2,i);e(1,e=>{r[i]=e,(s|=o)===n&&t(0,r)})}),function(e,i){switch(e){case 2:return void te(t);case 1:return s===n&&i(r),t(1,i)}}}function tI(e,t=ti){return tu(e,to(t))}function tT(...e){return function(t,r){switch(t){case 2:return;case 1:return function(...e){return()=>{e.map(e5)}}(...e.map(e=>e(1,r)))}}}var tC=((i=tC||{})[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=3]="ERROR",i);let tS={0:"debug",3:"error",1:"log",2:"warn"},tk=tv(()=>{let e=tm(3);return{log:tm((t,r,s=1)=>{var n;s>=(null!=(n=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?n:tt(e))&&console[tS[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,r)}),logLevel:e}},[],{singleton:!0});function tj(e,t,r){return tR(e,t,r).callbackRef}function tR(e,t,r){let s=x.default.useRef(null),n=x.default.useMemo(()=>"u">typeof ResizeObserver?new ResizeObserver(t=>{let s=()=>{let r=t[0].target;null!==r.offsetParent&&e(r)};r?s():requestAnimationFrame(s)}):null,[e,r]);return{callbackRef:e=>{e&&t?(null==n||n.observe(e),s.current=e):(s.current&&(null==n||n.unobserve(s.current)),s.current=null)},ref:s}}function tE(e,t,r,s,n,i,o,l,a){return tR(x.default.useCallback(r=>{let a,c=function(e,t,r,s){let n=e.length;if(0===n)return null;let i=[];for(let o=0;o<n;o++){let n=e.item(o);if(void 0===n.dataset.index)continue;let l=parseInt(n.dataset.index),a=parseFloat(n.dataset.knownSize),c=t(n,r);if(0===c&&s("Zero-sized element, this should not happen",{child:n},tC.ERROR),c===a)continue;let u=i[i.length-1];0===i.length||u.size!==c||u.endIndex!==l-1?i.push({endIndex:l,size:c,startIndex:l}):i[i.length-1].endIndex++}return i}(r.children,t,l?"offsetWidth":"offsetHeight",n),u=r.parentElement;for(;!u.dataset.virtuosoScroller;)u=u.parentElement;let h="window"===u.lastElementChild.dataset.viewportType;h&&(a=u.ownerDocument.defaultView);let d=o?l?o.scrollLeft:o.scrollTop:h?l?a.scrollX||a.document.documentElement.scrollLeft:a.scrollY||a.document.documentElement.scrollTop:l?u.scrollLeft:u.scrollTop;s({scrollHeight:o?l?o.scrollWidth:o.scrollHeight:h?l?a.document.documentElement.scrollWidth:a.document.documentElement.scrollHeight:l?u.scrollWidth:u.scrollHeight,scrollTop:Math.max(d,0),viewportHeight:o?l?o.offsetWidth:o.offsetHeight:h?l?a.innerWidth:a.innerHeight:l?u.offsetWidth:u.offsetHeight}),null==i||i(l?t_("column-gap",getComputedStyle(r).columnGap,n):t_("row-gap",getComputedStyle(r).rowGap,n)),null!==c&&e(c)},[e,t,n,i,o,s,l]),r,a)}function t_(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,tC.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}function tN(e,t,r){let s=x.default.useRef(null),n=x.default.useCallback(r=>{let n,i;if(!(null!=r&&r.offsetParent))return;let l=r.getBoundingClientRect(),a=l.width;if(t){let e=t.getBoundingClientRect(),r=l.top-e.top;i=e.height-Math.max(0,r),n=r+t.scrollTop}else{let e=o.current.ownerDocument.defaultView;i=e.innerHeight-Math.max(0,l.top),n=l.top+e.scrollY}s.current={offsetTop:n,visibleHeight:i,visibleWidth:a},e(s.current)},[e,t]),{callbackRef:i,ref:o}=tR(n,!0,r),l=x.default.useCallback(()=>{n(o.current)},[n,o]);return x.default.useEffect(()=>{var e;if(t){t.addEventListener("scroll",l);let e=new ResizeObserver(()=>{requestAnimationFrame(l)});return e.observe(t),()=>{t.removeEventListener("scroll",l),e.unobserve(t)}}{let t=null==(e=o.current)?void 0:e.ownerDocument.defaultView;return null==t||t.addEventListener("scroll",l),null==t||t.addEventListener("resize",l),()=>{null==t||t.removeEventListener("scroll",l),null==t||t.removeEventListener("resize",l)}}},[l,t,o]),i}let tO=tv(()=>{let e=tx(),t=tx(),r=tm(0),s=tx(),n=tm(0),i=tx(),o=tx(),l=tm(0),a=tm(0),c=tm(0),u=tm(0),h=tx(),d=tx(),p=tm(!1),f=tm(!1),m=tm(!1);return tr(tu(e,ta(({scrollTop:e})=>e)),t),tr(tu(e,ta(({scrollHeight:e})=>e)),o),tr(t,n),{deviation:r,fixedFooterHeight:c,fixedHeaderHeight:a,footerHeight:u,headerHeight:l,horizontalDirection:f,scrollBy:d,scrollContainerState:e,scrollHeight:o,scrollingInProgress:p,scrollTo:h,scrollTop:t,skipAnimationFrameInResizeObserver:m,smoothScrollTargetReached:s,statefulScrollTop:n,viewportHeight:i}},[],{singleton:!0}),tB={lvl:0};function tL(e,t){let r=e.length;if(0===r)return[];let{index:s,value:n}=t(e[0]),i=[];for(let o=1;o<r;o++){let{index:r,value:l}=t(e[o]);i.push({end:r-1,start:s,value:n}),s=r,n=l}return i.push({end:1/0,start:s,value:n}),i}function tA(e){return e===tB}function tH(e,t){if(!tA(e))return t===e.k?e.v:t<e.k?tH(e.l,t):tH(e.r,t)}function tz(e,t,r="k"){if(tA(e))return[-1/0,void 0];if(Number(e[r])===t)return[e.k,e.v];if(Number(e[r])<t){let s=tz(e.r,t,r);return s[0]===-1/0?[e.k,e.v]:s}return tz(e.l,t,r)}function tM(e,t,r){return tA(e)?tU(t,r,1):t===e.k?tW(e,{k:t,v:r}):t<e.k?tQ(tV(tW(e,{l:tM(e.l,t,r)}))):tQ(tV(tW(e,{r:tM(e.r,t,r)})))}function tD(e,t,r){if(tA(e))return[];let s=tz(e,t)[0];return tL(function e(t,r,s){if(tA(t))return[];let{k:n,l:i,r:o,v:l}=t,a=[];return n>r&&(a=a.concat(e(i,r,s))),n>=r&&n<=s&&a.push({k:n,v:l}),n<=s&&(a=a.concat(e(o,r,s))),a}(e,s,r),({k:e,v:t})=>({index:e,value:t}))}function tP(e){return tA(e)?[]:[...tP(e.l),{k:e.k,v:e.v},...tP(e.r)]}function tF(e){let{l:t,lvl:r,r:s}=e;if(s.lvl>=r-1&&t.lvl>=r-1)return e;if(r>s.lvl+1){if(tq(t))return tV(tW(e,{lvl:r-1}));if(!tA(t)&&!tA(t.r))return tW(t.r,{l:tW(t,{r:t.r.l}),lvl:r,r:tW(e,{l:t.r.r,lvl:r-1})});throw Error("Unexpected empty nodes")}if(tq(e))return tQ(tW(e,{lvl:r-1}));if(tA(s)||tA(s.l))throw Error("Unexpected empty nodes");{let t=s.l,n=tq(t)?s.lvl-1:s.lvl;return tW(t,{l:tW(e,{lvl:r-1,r:t.l}),lvl:t.lvl+1,r:tQ(tW(s,{l:t.r,lvl:n}))})}}function tW(e,t){return tU(void 0!==t.k?t.k:e.k,void 0!==t.v?t.v:e.v,void 0!==t.lvl?t.lvl:e.lvl,void 0!==t.l?t.l:e.l,void 0!==t.r?t.r:e.r)}function tq(e){return tA(e)||e.lvl>e.r.lvl}function tU(e,t,r,s=tB,n=tB){return{k:e,l:s,lvl:r,r:n,v:t}}function tV(e){let{l:t}=e;return tA(t)||t.lvl!==e.lvl?e:tW(t,{r:tW(e,{l:t.r})})}function tQ(e){let{lvl:t,r:r}=e;return tA(r)||tA(r.r)||r.lvl!==t||r.r.lvl!==t?e:tW(r,{l:tW(e,{r:r.l}),lvl:t+1})}function tG(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}function t$(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}let tK=tv(()=>({recalcInProgress:tm(!1)}),[],{singleton:!0});function tY(e,t,r,s=0){let n=e.length-1;for(;s<=n;){let i=Math.floor((s+n)/2),o=r(e[i],t);if(0===o)return i;if(-1===o){if(n-s<2)return i-1;n=i-1}else{if(n===s)return i;s=i+1}}throw Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function tX(e,t){return Math.round(e.getBoundingClientRect()[t])}function tJ(e){return!tA(e.groupOffsetTree)}function tZ({index:e},t){return t===e?0:t<e?-1:1}function t0({offset:e},t){return t===e?0:t<e?-1:1}function t1(e,t,r){if(0===t.length)return 0;let{index:s,offset:n,size:i}=t[tY(t,e,tZ)],o=e-s,l=i*o+(o-1)*r+n;return l>0?l+r:l}function t2(e,t){if(!tJ(t))return e;let r=0;for(;t.groupIndices[r]<=e+r;)r++;return e+r}function t4(e,t,r){if("u">typeof e.groupIndex)return t.groupIndices[e.groupIndex]+1;{let s=t2("LAST"===e.index?r:e.index,t);return Math.max(0,s,Math.min(r,s))}}function t5(e,[t,r,s,n]){t.length>0&&s("received item sizes",t,tC.DEBUG);let i=e.sizeTree,o=i,l=0;if(r.length>0&&tA(i)&&2===t.length){let e=t[0].size,s=t[1].size;o=r.reduce((t,r)=>tM(tM(t,r,e),r+1,s),o)}else[o,l]=function(e,t){let r=tA(e)?0:1/0;for(let s of t){let{endIndex:t,size:n,startIndex:i}=s;if(r=Math.min(r,i),tA(e)){e=tM(e,0,n);continue}let o=tD(e,i-1,t+1);if(o.some(function(e){let{endIndex:t,size:r,startIndex:s}=e;return e=>e.start===s&&(e.end===t||e.end===1/0)&&e.value===r}(s)))continue;let l=!1,a=!1;for(let{end:r,start:s,value:i}of o)l?(t>=s||n===i)&&(e=function e(t,r){if(tA(t))return tB;let{k:s,l:n,r:i}=t;if(r!==s)return r<s?tF(tW(t,{l:e(n,r)})):tF(tW(t,{r:e(i,r)}));if(tA(n))return i;if(tA(i))return n;{let[e,r]=function e(t){return tA(t.r)?[t.k,t.v]:e(t.r)}(n);return tF(tW(t,{k:e,l:function e(t){return tA(t.r)?t.l:tF(tW(t,{r:e(t.r)}))}(n),v:r}))}}(e,s)):(a=i!==n,l=!0),r>t&&t>=s&&i!==n&&(e=tM(e,t+1,i));a&&(e=tM(e,i,n))}return[e,r]}(o,t);if(o===i)return e;let{lastIndex:a,lastOffset:c,lastSize:u,offsetTree:h}=t6(e.offsetTree,l,o,n);return{groupIndices:r,groupOffsetTree:r.reduce((e,t)=>tM(e,t,t1(t,h,n)),tB),lastIndex:a,lastOffset:c,lastSize:u,offsetTree:h,sizeTree:o}}function t3(e,t){let r=0,s=0;for(;r<e;)r+=t[s+1]-t[s]-1,s++;return s-(r!==e)}function t6(e,t,r,s){let n=e,i=0,o=0,l=0,a=0;if(0!==t){a=tY(n,t-1,tZ),l=n[a].offset;let e=tz(r,t-1);i=e[0],o=e[1],n.length&&n[a].size===tz(r,t)[1]&&(a-=1),n=n.slice(0,a+1)}else n=[];for(let{start:e,value:a}of tD(r,t,1/0)){let t=e-i,r=t*o+l+t*s;n.push({index:e,offset:r,size:a}),i=e,l=r,o=a}return{lastIndex:i,lastOffset:l,lastSize:o,offsetTree:n}}function t8(e){return{index:e.index,value:e}}let t7={offsetHeight:"height",offsetWidth:"width"},t9=tv(([{log:e},{recalcInProgress:t}])=>{let r=tx(),s=tx(),n=tg(s,0),i=tx(),o=tx(),l=tm(0),a=tm([]),c=tm(void 0),u=tm(void 0),h=tm(void 0),d=tm(void 0),p=tm((e,t)=>tX(e,t7[t])),f=tm(void 0),m=tm(0),g={groupIndices:[],groupOffsetTree:tB,lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:tB},x=tg(tu(r,tf(a,e,m),th(t5,g),to()),g),y=tg(tu(a,to(),th((e,t)=>({current:t,prev:e.current}),{current:[],prev:[]}),ta(({prev:e})=>e)),[]);tr(tu(a,tl(e=>e.length>0),tf(x,m),ta(([e,t,r])=>{let s=e.reduce((e,s,n)=>tM(e,s,t1(s,t.offsetTree,r)||n),tB);return{...t,groupIndices:e,groupOffsetTree:s}})),x),tr(tu(s,tf(x),tl(([e,{lastIndex:t}])=>e<t),ta(([e,{lastIndex:t,lastSize:r}])=>[{endIndex:t,size:r,startIndex:e}])),r),tr(c,u);let v=tg(tu(c,ta(e=>void 0===e)),!0);tr(tu(u,tl(e=>void 0!==e&&tA(tt(x).sizeTree)),ta(e=>{let t=tt(h),r=tt(a).length>0;return t?r?[{endIndex:0,size:t,startIndex:0},{endIndex:1,size:e,startIndex:1}]:[]:[{endIndex:0,size:e,startIndex:0}]})),r),tr(tu(d,tl(e=>void 0!==e&&e.length>0&&tA(tt(x).sizeTree)),ta(e=>{let t=[],r=e[0],s=0;for(let n=1;n<e.length;n++){let i=e[n];i!==r&&(t.push({endIndex:n-1,size:r,startIndex:s}),r=i,s=n)}return t.push({endIndex:e.length-1,size:r,startIndex:s}),t})),r),tr(tu(a,tf(h,u),tl(([,e,t])=>void 0!==e&&void 0!==t),ta(([e,t,r])=>{let s=[];for(let n=0;n<e.length;n++){let i=e[n],o=e[n+1];s.push({startIndex:i,endIndex:i,size:t}),void 0!==o&&s.push({startIndex:i+1,endIndex:o-1,size:r})}return s})),r);let b=ty(tu(r,tf(x),th(({sizes:e},[t,r])=>({changed:r!==e,sizes:r}),{changed:!1,sizes:g}),ta(e=>e.changed)));tu(l,th((e,t)=>({diff:e.prev-t,prev:t}),{diff:0,prev:0}),ta(e=>e.diff))(1,e=>{let{groupIndices:r}=tt(x);if(e>0)t(0,!0),i(0,e+t3(e,r));else if(e<0){let t=tt(y);t.length>0&&(e-=t3(-e,t)),o(0,e)}}),tu(l,tf(e))(1,([e,t])=>{e<0&&t("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:l},tC.ERROR)});let w=ty(i);tr(tu(i,tf(x),ta(([e,t])=>{let r=t.groupIndices.length>0,s=[],n=t.lastSize;if(r){let r=tH(t.sizeTree,0),i=0,o=0;for(;i<e;){let e=t.groupIndices[o],l=t.groupIndices.length===o+1?1/0:t.groupIndices[o+1]-e-1;s.push({endIndex:e,size:r,startIndex:e}),s.push({endIndex:e+1+l-1,size:n,startIndex:e+1}),o++,i+=l+1}let l=tP(t.sizeTree);return i!==e&&l.shift(),l.reduce((t,{k:r,v:s})=>{let n=t.ranges;return 0!==t.prevSize&&(n=[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]),{prevIndex:r+e,prevSize:s,ranges:n}},{prevIndex:e,prevSize:0,ranges:s}).ranges}return tP(t.sizeTree).reduce((t,{k:r,v:s})=>({prevIndex:r+e,prevSize:s,ranges:[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]}),{prevIndex:0,prevSize:n,ranges:[]}).ranges})),r);let I=ty(tu(o,tf(x,m),ta(([e,{offsetTree:t},r])=>t1(-e,t,r))));return tr(tu(o,tf(x,m),ta(([e,t,r])=>{if(t.groupIndices.length>0){if(tA(t.sizeTree))return t;let s=tB,n=tt(y),i=0,o=0,l=0;for(;i<-e;){l=n[o];let e=n[o+1]-l-1;o++,i+=e+1}return s=tP(t.sizeTree).reduce((t,{k:r,v:s})=>tM(t,Math.max(0,r+e),s),s),i!==-e&&(s=tM(s,0,tH(t.sizeTree,l)),s=tM(s,1,tz(t.sizeTree,-e+1)[1])),{...t,sizeTree:s,...t6(t.offsetTree,0,s,r)}}{let s=tP(t.sizeTree).reduce((t,{k:r,v:s})=>tM(t,Math.max(0,r+e),s),tB);return{...t,sizeTree:s,...t6(t.offsetTree,0,s,r)}}})),x),{beforeUnshiftWith:w,data:f,defaultItemSize:u,firstItemIndex:l,fixedItemSize:c,fixedGroupSize:h,gap:m,groupIndices:a,heightEstimates:d,itemSize:p,listRefresh:b,shiftWith:o,shiftWithOffset:I,sizeRanges:r,sizes:x,statefulTotalCount:n,totalCount:s,trackItemSizes:v,unshiftWith:i}},e9(tk,tK),{singleton:!0});function re(e){return e.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{groupIndices:[],totalCount:0})}let rt=tv(([{groupIndices:e,sizes:t,totalCount:r},{headerHeight:s,scrollTop:n}])=>{let i=tx(),o=tx(),l=ty(tu(i,ta(re)));return tr(tu(l,ta(e=>e.totalCount)),r),tr(tu(l,ta(e=>e.groupIndices)),e),tr(tu(tw(n,t,s),tl(([e,t])=>tJ(t)),ta(([e,t,r])=>tz(t.groupOffsetTree,Math.max(e-r,0),"v")[0]),to(),ta(e=>[e])),o),{groupCounts:i,topItemsIndexes:o}},e9(t9,tO)),rr=tv(([{log:e}])=>{let t=tm(!1),r=ty(tu(t,tl(e=>e),to()));return t(1,t=>{t&&tt(e)("props updated",{},tC.DEBUG)}),{didMount:r,propsReady:t}},e9(tk),{singleton:!0}),rs="u">typeof document&&"scrollBehavior"in document.documentElement.style;function rn(e){let t="number"==typeof e?{index:e}:e;return t.align||(t.align="start"),t.behavior&&rs||(t.behavior="auto"),t.offset||(t.offset=0),t}let ri=tv(([{gap:e,listRefresh:t,sizes:r,totalCount:s},{fixedFooterHeight:n,fixedHeaderHeight:i,footerHeight:o,headerHeight:l,scrollingInProgress:a,scrollTo:c,smoothScrollTargetReached:u,viewportHeight:h},{log:d}])=>{let p=tx(),f=tx(),m=tm(0),g=null,x=null,y=null;function v(){g&&(g(),g=null),y&&(y(),y=null),x&&(clearTimeout(x),x=null),a(0,!1)}return tr(tu(p,tf(r,h,s,m,l,o,d),tf(e,i,n),ta(([[e,r,s,n,i,o,l,c],h,d,m])=>{let b=rn(e),{align:w,behavior:I,offset:T}=b,C=n-1,S=t4(b,r,C),k=t1(S,r.offsetTree,h)+o;"end"===w?(k+=d+tz(r.sizeTree,S)[1]-s+m,S===C&&(k+=l)):"center"===w?k+=(d+tz(r.sizeTree,S)[1]-s+m)/2:k-=i,T&&(k+=T);let j=t=>{v(),t?(c("retrying to scroll to",{location:e},tC.DEBUG),p(0,e)):(f(0,!0),c("list did not change, scroll successful",{},tC.DEBUG))};if(v(),"smooth"===I){let e=!1;y=t(1,t=>{e=e||t}),g=ts(u,()=>{j(e)})}else g=ts(tu(t,e=>{let t=setTimeout(()=>{e(!1)},150);return r=>{r&&(e(!0),clearTimeout(t))}}),j);return x=setTimeout(()=>{v()},1200),a(0,!0),c("scrolling from index to",{behavior:I,index:S,top:k},tC.DEBUG),{behavior:I,top:k}})),c),{scrollTargetReached:f,scrollToIndex:p,topListHeight:m}},e9(t9,tO,tk),{singleton:!0});function ro(e,t){0==e?t():requestAnimationFrame(()=>{ro(e-1,t)})}function rl(e,t){return"number"==typeof e?e:"LAST"===e.index?t-1:e.index}let ra=tv(([{defaultItemSize:e,listRefresh:t,sizes:r},{scrollTop:s},{scrollTargetReached:n,scrollToIndex:i},{didMount:o}])=>{let l=tm(!0),a=tm(0),c=tm(!0);return tr(tu(o,tf(a),tl(([e,t])=>!!t),tc(!1)),l),tr(tu(o,tf(a),tl(([e,t])=>!!t),tc(!1)),c),tu(tw(t,o),tf(l,r,e,c),tl(([[,e],t,{sizeTree:r},s,n])=>e&&(!tA(r)||e6(s))&&!t&&!n),tf(a))(1,([,e])=>{ts(n,()=>{c(0,!0)}),ro(4,()=>{ts(s,()=>{l(0,!0)}),i(0,e)})}),{initialItemFinalLocationReached:c,initialTopMostItemIndex:a,scrolledToInitialItem:l}},e9(t9,tO,ri,rr),{singleton:!0});function rc(e,t){return 1.01>Math.abs(e-t)}let ru="down",rh={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},rd=tv(([{footerHeight:e,headerHeight:t,scrollBy:r,scrollContainerState:s,scrollTop:n,viewportHeight:i}])=>{let o=tm(!1),l=tm(!0),a=tx(),c=tx(),u=tm(4),h=tm(0),d=tg(tu(tT(tu(tI(n),td(1),tc(!0)),tu(tI(n),td(1),tc(!1),tn(100))),to()),!1),p=tg(tu(tT(tu(r,tc(!0)),tu(r,tc(!1),tn(200))),to()),!1);tr(tu(tw(tI(n),tI(h)),ta(([e,t])=>e<=t),to()),l),tr(tu(l,tp(50)),c);let f=ty(tu(tw(s,tI(i),tI(t),tI(e),tI(u)),th((e,[{scrollHeight:t,scrollTop:r},s,n,i,o])=>{let l={scrollHeight:t,scrollTop:r,viewportHeight:s};if(r+s-t>-o){let t,s;return r>e.state.scrollTop?(t="SCROLLED_DOWN",s=e.state.scrollTop-r):(t="SIZE_DECREASED",s=e.state.scrollTop-r||e.scrollTopDelta),{atBottom:!0,atBottomBecause:t,scrollTopDelta:s,state:l}}return{atBottom:!1,notAtBottomBecause:l.scrollHeight>e.state.scrollHeight?"SIZE_INCREASED":s<e.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":r<e.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:l}},rh),to((e,t)=>e&&e.atBottom===t.atBottom))),m=tg(tu(s,th((e,{scrollHeight:t,scrollTop:r,viewportHeight:s})=>{if(rc(e.scrollHeight,t))return{changed:!1,jump:0,scrollHeight:t,scrollTop:r};{let n=t-(r+s)<1;return e.scrollTop!==r&&n?{changed:!0,jump:e.scrollTop-r,scrollHeight:t,scrollTop:r}:{changed:!0,jump:0,scrollHeight:t,scrollTop:r}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),tl(e=>e.changed),ta(e=>e.jump)),0);tr(tu(f,ta(e=>e.atBottom)),o),tr(tu(o,tp(50)),a);let g=tm(ru);tr(tu(s,ta(({scrollTop:e})=>e),to(),th((e,t)=>tt(p)?{direction:e.direction,prevScrollTop:t}:{direction:t<e.prevScrollTop?"up":ru,prevScrollTop:t},{direction:ru,prevScrollTop:0}),ta(e=>e.direction)),g),tr(tu(s,tp(50),tc("none")),g);let x=tm(0);return tr(tu(d,tl(e=>!e),tc(0)),x),tr(tu(n,tp(100),tf(d),tl(([e,t])=>t),th(([e,t],[r])=>[t,r],[0,0]),ta(([e,t])=>t-e)),x),{atBottomState:f,atBottomStateChange:a,atBottomThreshold:u,atTopStateChange:c,atTopThreshold:h,isAtBottom:o,isAtTop:l,isScrolling:d,lastJumpDueToItemResize:m,scrollDirection:g,scrollVelocity:x}},e9(tO)),rp="bottom",rf="none";function rm(e,t,r){return"number"==typeof e?"up"===r&&"top"===t||r===ru&&t===rp?e:0:"up"===r?"top"===t?e.main:e.reverse:t===rp?e.main:e.reverse}function rg(e,t){var r;return"number"==typeof e?e:null!=(r=e[t])?r:0}let rx=tv(([{deviation:e,fixedHeaderHeight:t,headerHeight:r,scrollTop:s,viewportHeight:n}])=>{let i=tx(),o=tm(0),l=tm(0),a=tm(0),c=tg(tu(tw(tI(s),tI(n),tI(r),tI(i,t$),tI(a),tI(o),tI(t),tI(e),tI(l)),ta(([e,t,r,[s,n],i,o,l,a,c])=>{let u=e-a,h=Math.max(r-u,0),d=rf,p=rg(c,"top"),f=rg(c,rp);return s-=a,s+=r+l,n+=r+l,s>e+(o+l)-p&&(d="up"),(n-=a)<e-h+t+f&&(d=ru),d!==rf?[Math.max(u-r-rm(i,"top",d)-p,0),u-h-l+t+rm(i,rp,d)+f]:null}),tl(e=>null!=e),to(t$)),[0,0]);return{increaseViewportBy:l,listBoundary:i,overscan:a,topListHeight:o,visibleRange:c}},e9(tO),{singleton:!0}),ry={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function rv(e,t,r,s,n,i){let{lastIndex:o,lastOffset:l,lastSize:a}=n,c=0,u=0;if(e.length>0){c=e[0].offset;let t=e[e.length-1];u=t.offset+t.size}let h=r-o,d=c,p=l+h*a+(h-1)*s-u;return{bottom:u,firstItemIndex:i,items:rw(e,n,i),offsetBottom:p,offsetTop:c,top:d,topItems:rw(t,n,i),topListHeight:t.reduce((e,t)=>t.size+e,0),totalCount:r}}function rb(e,t,r,s,n,i){let o=0;if(r.groupIndices.length>0)for(let t of r.groupIndices){if(t-o>=e)break;o++}let l=e+o,a=rl(t,l);return rv(Array.from({length:l}).map((e,t)=>({data:i[t+a],index:t+a,offset:0,size:0})),[],l,n,r,s)}function rw(e,t,r){if(0===e.length)return[];if(!tJ(t))return e.map(e=>({...e,index:e.index+r,originalIndex:e.index}));let s=e[0].index,n=e[e.length-1].index,i=[],o=tD(t.groupOffsetTree,s,n),l,a=0;for(let s of e){let e;(!l||l.end<s.index)&&(l=o.shift(),a=t.groupIndices.indexOf(l.start)),e=s.index===l.start?{index:a,type:"group"}:{groupIndex:a,index:s.index-(a+1)+r},i.push({...e,data:s.data,offset:s.offset,originalIndex:s.index,size:s.size})}return i}function rI(e,t){var r;return void 0===e?0:"number"==typeof e?e:null!=(r=e[t])?r:0}let rT=tv(([{data:e,firstItemIndex:t,gap:r,sizes:s,totalCount:n},i,{listBoundary:o,topListHeight:l,visibleRange:a},{initialTopMostItemIndex:c,scrolledToInitialItem:u},{topListHeight:h},d,{didMount:p},{recalcInProgress:f}])=>{let m=tm([]),g=tm(0),x=tx(),y=tm(0);tr(i.topItemsIndexes,m);let v=tg(tu(tw(p,f,tI(a,t$),tI(n),tI(s),tI(c),u,tI(m),tI(t),tI(r),tI(y),e),tl(([e,t,,r,,,,,,,,s])=>{let n=s&&s.length!==r;return e&&!t&&!n}),ta(([,,[e,t],r,s,n,i,o,l,a,c,u])=>{var h,d,p,f,m;let{offsetTree:x,sizeTree:y}=s,v=tt(g);if(0===r)return{...ry,totalCount:r};if(0===e&&0===t)return 0===v?{...ry,totalCount:r}:rb(v,n,s,l,a,u||[]);if(tA(y))return v>0?null:rv(function(e,t,r){if(tJ(t)){let s=t2(e,t);return[{index:tz(t.groupOffsetTree,s)[0],offset:0,size:0},{data:null==r?void 0:r[0],index:s,offset:0,size:0}]}return[{data:null==r?void 0:r[0],index:e,offset:0,size:0}]}(rl(n,r),s,u),[],r,a,s,l);let b=[];if(o.length>0){let e=o[0],t=o[o.length-1],r=0;for(let s of tD(y,e,t)){let n=s.value,i=Math.max(s.start,e),o=Math.min(s.end,t);for(let e=i;e<=o;e++)b.push({data:null==u?void 0:u[e],index:e,offset:r,size:n}),r+=n}}if(!i)return rv([],b,r,a,s,l);let w=o.length>0?o[o.length-1]+1:0,I=function(e,t,r,s=0){let n,i;return s>0&&(t=Math.max(t,e[tY(e,s,tZ)].offset)),tL((n=tY(e,t,t0),i=tY(e,r,t0,n),e.slice(n,i+1)),t8)}(x,e,t,w);if(0===I.length)return null;let T=r-1,C=((r=>{for(let s of I){let n=s.value,i=n.offset,o=s.start,l=n.size;if(n.offset<e){let t=(o+=Math.floor((e-n.offset+a)/(l+a)))-s.start;i+=t*l+t*a}o<w&&(i+=(w-o)*l,o=w);let c=Math.min(s.end,T);for(let e=o;e<=c&&!(i>=t);e++)r.push({data:null==u?void 0:u[e],index:e,offset:i,size:l}),i+=l+a}})(m=[]),m),S=rI(c,"top"),k=rI(c,rp);if(C.length>0&&(S>0||k>0)){let e=C[0],t=C[C.length-1];if(S>0&&e.index>w){let t=Math.min(S,e.index-w),r=[],s=e.offset;for(let n=e.index-1;n>=e.index-t;n--){let t=null!=(d=null==(h=tD(y,n,n)[0])?void 0:h.value)?d:e.size;s-=t+a,r.unshift({data:null==u?void 0:u[n],index:n,offset:s,size:t})}C.unshift(...r)}if(k>0&&t.index<T){let e=Math.min(k,T-t.index),r=t.offset+t.size+a;for(let s=t.index+1;s<=t.index+e;s++){let e=null!=(f=null==(p=tD(y,s,s)[0])?void 0:p.value)?f:t.size;C.push({data:null==u?void 0:u[s],index:s,offset:r,size:e}),r+=e+a}}}return rv(C,b,r,a,s,l)}),tl(e=>null!==e),to()),ry);tr(tu(e,tl(e6),ta(e=>null==e?void 0:e.length)),n),tr(tu(v,ta(e=>e.topListHeight)),h),tr(h,l),tr(tu(v,ta(e=>[e.top,e.bottom])),o),tr(tu(v,ta(e=>e.items)),x);let b=ty(tu(v,tl(({items:e})=>e.length>0),tf(n,e),tl(([{items:e},t])=>e[e.length-1].originalIndex===t-1),ta(([,e,t])=>[e-1,t]),to(t$),ta(([e])=>e))),w=ty(tu(v,tp(200),tl(({items:e,topItems:t})=>e.length>0&&e[0].originalIndex===t.length),ta(({items:e})=>e[0].index),to())),I=ty(tu(v,tl(({items:e})=>e.length>0),ta(({items:e})=>{let t=0,r=e.length-1;for(;"group"===e[t].type&&t<r;)t++;for(;"group"===e[r].type&&r>t;)r--;return{endIndex:e[r].index,startIndex:e[t].index}}),to(tG)));return{endReached:b,initialItemCount:g,itemsRendered:x,listState:v,minOverscanItemCount:y,rangeChanged:I,startReached:w,topItemsIndexes:m,...d}},e9(t9,rt,rx,ra,ri,rd,rr,tK),{singleton:!0}),rC=tv(([{fixedFooterHeight:e,fixedHeaderHeight:t,footerHeight:r,headerHeight:s},{listState:n}])=>{let i=tx(),o=tg(tu(tw(r,e,s,t,n),ta(([e,t,r,s,n])=>e+t+r+s+n.offsetBottom+n.bottom)),0);return tr(tI(o),i),{totalListHeight:o,totalListHeightChanged:i}},e9(tO,rT),{singleton:!0}),rS=tv(([{viewportHeight:e},{totalListHeight:t}])=>{let r=tm(!1),s=tg(tu(tw(r,e,t),tl(([e])=>e),ta(([,e,t])=>Math.max(0,e-t)),tp(0),to()),0);return{alignToBottom:r,paddingTopAddition:s}},e9(tO,rC),{singleton:!0}),rk=tv(()=>({context:tm(null)})),rj=({itemBottom:e,itemTop:t,locationParams:{align:r,behavior:s,...n},viewportBottom:i,viewportTop:o})=>t<o?{...n,align:null!=r?r:"start",behavior:s}:e>i?{...n,align:null!=r?r:"end",behavior:s}:null,rR=tv(([{gap:e,sizes:t,totalCount:r},{fixedFooterHeight:s,fixedHeaderHeight:n,headerHeight:i,scrollingInProgress:o,scrollTop:l,viewportHeight:a},{scrollToIndex:c}])=>{let u=tx();return tr(tu(u,tf(t,a,r,i,n,s,l),tf(e),ta(([[e,t,r,s,n,i,l,a],c])=>{let{align:u,behavior:h,calculateViewLocation:d=rj,done:p,...f}=e,m=t4(e,t,s-1),g=t1(m,t.offsetTree,c)+n+i,x=d({itemBottom:g+tz(t.sizeTree,m)[1],itemTop:g,locationParams:{align:u,behavior:h,...f},viewportBottom:a+r-l,viewportTop:a+i});return x?p&&ts(tu(o,tl(e=>!e),td(tt(o)?1:2)),p):null==p||p(),x}),tl(e=>null!==e)),c),{scrollIntoView:u}},e9(t9,tO,ri,rT,tk),{singleton:!0});function rE(e){return!!e&&("smooth"===e?"smooth":"auto")}let r_=tv(([{listRefresh:e,totalCount:t,fixedItemSize:r,data:s},{atBottomState:n,isAtBottom:i},{scrollToIndex:o},{scrolledToInitialItem:l},{didMount:a,propsReady:c},{log:u},{scrollingInProgress:h},{context:d},{scrollIntoView:p}])=>{let f=tm(!1),m=tx(),g=null;function x(e){o(0,{align:"end",behavior:e,index:"LAST"})}function y(e){setTimeout(ts(n,t=>{!e||t.atBottom||"SIZE_INCREASED"!==t.notAtBottomBecause||g||(tt(u)("scrolling to bottom due to increased size",{},tC.DEBUG),x("auto"))}),100)}tu(tw(tu(tI(t),td(1)),a),tf(tI(f),i,l,h),ta(([[e,t],r,s,n,i])=>{let o,l=t&&n,a="auto";return l&&(o=s||i,a="function"==typeof r?rE(r(o)):o&&rE(r),l=l&&!!a),{followOutputBehavior:a,shouldFollow:l,totalCount:e}}),tl(({shouldFollow:e})=>e))(1,({followOutputBehavior:t,totalCount:s})=>{g&&(g(),g=null),tt(r)?requestAnimationFrame(()=>{tt(u)("following output to ",{totalCount:s},tC.DEBUG),x(t)}):g=ts(e,()=>{tt(u)("following output to ",{totalCount:s},tC.DEBUG),x(t),g=null})}),tu(tw(tI(f),t,c),tl(([e,,t])=>e&&t),th(({value:e},[,t])=>({refreshed:e===t,value:t}),{refreshed:!1,value:0}),tl(({refreshed:e})=>e),tf(f,t))(1,([,e])=>{tt(l)&&y(!1!==e)}),m(1,()=>{y(!1!==tt(f))}),tw(tI(f),n)(1,([e,t])=>{e&&!t.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===t.notAtBottomBecause&&x("auto")});let v=tm(null),b=tx();return tr(tT(tu(tI(s),ta(e=>{var t;return null!=(t=null==e?void 0:e.length)?t:0})),tu(tI(t))),b),tu(tw(tu(b,td(1)),a),tf(tI(v),l,h,d),ta(([[e,t],r,s,n,i])=>t&&s&&(null==r?void 0:r({context:i,totalCount:e,scrollingInProgress:n}))),tl(e=>!!e),tp(0))(1,t=>{g&&(g(),g=null),tt(r)?requestAnimationFrame(()=>{tt(u)("scrolling into view",{}),p(0,t)}):g=ts(e,()=>{tt(u)("scrolling into view",{}),p(0,t),g=null})}),{autoscrollToBottom:m,followOutput:f,scrollIntoViewOnChange:v}},e9(t9,rd,ri,ra,rr,tk,tO,rk,rR)),rN=tv(([{data:e,firstItemIndex:t,gap:r,sizes:s},{initialTopMostItemIndex:n},{initialItemCount:i,listState:o},{didMount:l}])=>(tr(tu(l,tf(i),tl(([,e])=>0!==e),tf(n,s,t,r,e),ta(([[,e],t,r,s,n,i=[]])=>rb(e,t,r,s,n,i))),o),{}),e9(t9,ra,rT,rr),{singleton:!0}),rO=tv(([{didMount:e},{scrollTo:t},{listState:r}])=>{let s=tm(0);return tu(e,tf(s),tl(([,e])=>0!==e),ta(([,e])=>({top:e})))(1,e=>{ts(tu(r,td(1),tl(e=>e.items.length>1)),()=>{requestAnimationFrame(()=>{t(0,e)})})}),{initialScrollTop:s}},e9(rr,tO,rT),{singleton:!0}),rB=tv(([{scrollVelocity:e}])=>{let t=tm(!1),r=tx(),s=tm(!1);return tr(tu(e,tf(s,t,r),tl(([e,t])=>!!t),ta(([e,t,r,s])=>{let{enter:n,exit:i}=t;if(r){if(i(e,s))return!1}else if(n(e,s))return!0;return r}),to()),t),tu(tw(t,e,r),tf(s))(1,([[e,t,r],s])=>{e&&s&&s.change&&s.change(t,r)}),{isSeeking:t,scrollSeekConfiguration:s,scrollSeekRangeChanged:r,scrollVelocity:e}},e9(rd),{singleton:!0}),rL=tv(([{scrollContainerState:e,scrollTo:t}])=>{let r=tx(),s=tx(),n=tx(),i=tm(!1),o=tm(void 0);return tr(tu(tw(r,s),ta(([{scrollHeight:e,scrollTop:t,viewportHeight:r},{offsetTop:s}])=>({scrollHeight:e,scrollTop:Math.max(0,t-s),viewportHeight:r}))),e),tr(tu(t,tf(s),ta(([e,{offsetTop:t}])=>({...e,top:e.top+t}))),n),{customScrollParent:o,useWindowScroll:i,windowScrollContainerState:r,windowScrollTo:n,windowViewportRect:s}},e9(tO)),rA=tv(([{sizeRanges:e,sizes:t},{headerHeight:r,scrollTop:s},{initialTopMostItemIndex:n},{didMount:i},{useWindowScroll:o,windowScrollContainerState:l,windowViewportRect:a}])=>{let c=tx(),u=tm(void 0),h=tm(null),d=tm(null);return tr(l,h),tr(a,d),tu(c,tf(t,s,o,h,d,r))(1,([e,t,r,s,n,i,o])=>{let l=tP(t.sizeTree).map(({k:e,v:t},r,s)=>{let n=s[r+1];return{endIndex:n?n.k-1:1/0,size:t,startIndex:e}});s&&null!==n&&null!==i&&(r=n.scrollTop-i.offsetTop),e({ranges:l,scrollTop:r-=o})}),tr(tu(u,tl(e6),ta(rH)),n),tr(tu(i,tf(u),tl(([,e])=>void 0!==e),to(),ta(([,e])=>e.ranges)),e),{getState:c,restoreStateFrom:u}},e9(t9,tO,ra,rr,rL));function rH(e){return{align:"start",index:0,offset:e.scrollTop}}let rz=tv(([{topItemsIndexes:e}])=>{let t=tm(0);return tr(tu(t,tl(e=>e>=0),ta(e=>Array.from({length:e}).map((e,t)=>t))),e),{topItemCount:t}},e9(rT));function rM(e){let t=!1,r;return()=>(t||(t=!0,r=e()),r)}let rD=rM(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),rP=tv(([{deviation:e,scrollBy:t,scrollingInProgress:r,scrollTop:s},{isAtBottom:n,isScrolling:i,lastJumpDueToItemResize:o,scrollDirection:l},{listState:a},{beforeUnshiftWith:c,gap:u,shiftWithOffset:h,sizes:d},{log:p},{recalcInProgress:f}])=>{let m=ty(tu(a,tf(o),th(([,e,t,r],[{bottom:s,items:n,offsetBottom:i,totalCount:o},l])=>{let a=s+i,c=0;return t===o&&e.length>0&&n.length>0&&(0===n[0].originalIndex&&0===e[0].originalIndex||0!=(c=a-r)&&(c+=l)),[c,n,o,a]},[0,[],0,0]),tl(([e])=>0!==e),tf(s,l,r,n,p,f),tl(([,e,t,r,,,s])=>!s&&!r&&0!==e&&"up"===t),ta(([[e],,,,,t])=>(t("Upward scrolling compensation",{amount:e},tC.DEBUG),e))));function g(r){r>0?(t(0,{behavior:"auto",top:-r}),e(0,0)):(e(0,0),t(0,{behavior:"auto",top:-r}))}return tu(m,tf(e,i))(1,([t,r,s])=>{s&&rD()?e(0,r-t):g(-t)}),tu(tw(tg(i,!1),e,f),tl(([e,t,r])=>!e&&!r&&0!==t),ta(([e,t])=>t),tp(1))(1,g),tr(tu(h,ta(e=>({top:-e}))),t),tu(c,tf(d,u),ta(([e,{groupIndices:t,lastSize:r,sizeTree:s},n])=>{if(0===t.length)return e*(r+n);{let i=0,o=tH(s,0),l=0,a=0;for(;l<e;){l++,i+=o;let s=t.length===a+1?1/0:t[a+1]-t[a]-1;l+s>e&&(i-=o,s=e-l+1),l+=s,i+=s*(r+n),a++}return i}}))(1,r=>{e(0,r),requestAnimationFrame(()=>{t(0,{top:r}),requestAnimationFrame(()=>{e(0,0),f(0,!1)})})}),{deviation:e}},e9(tO,rd,rT,t9,tk,tK)),rF=tv(([e,t,r,s,n,i,o,l,a,c,u])=>({...e,...t,...r,...s,...n,...i,...o,...l,...a,...c,...u}),e9(rx,rN,rr,rB,rC,rO,rS,rL,rR,tk,rk)),rW=tv(([{data:e,defaultItemSize:t,firstItemIndex:r,fixedItemSize:s,fixedGroupSize:n,gap:i,groupIndices:o,heightEstimates:l,itemSize:a,sizeRanges:c,sizes:u,statefulTotalCount:h,totalCount:d,trackItemSizes:p},{initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g},x,y,v,b,{scrollToIndex:w},I,{topItemCount:T},{groupCounts:C},S])=>{let{listState:k,minOverscanItemCount:j,topItemsIndexes:R,rangeChanged:E,..._}=b;return tr(E,S.scrollSeekRangeChanged),tr(tu(S.windowViewportRect,ta(e=>e.visibleHeight)),x.viewportHeight),{data:e,defaultItemHeight:t,firstItemIndex:r,fixedItemHeight:s,fixedGroupHeight:n,gap:i,groupCounts:C,heightEstimates:l,initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g,sizeRanges:c,topItemCount:T,topItemsIndexes:R,totalCount:d,...v,groupIndices:o,itemSize:a,listState:k,minOverscanItemCount:j,scrollToIndex:w,statefulTotalCount:h,trackItemSizes:p,rangeChanged:E,..._,...S,...x,sizes:u,...y}},e9(t9,ra,tO,rA,r_,rT,ri,rP,rz,rt,rF)),rq="u">typeof document?x.default.useLayoutEffect:x.default.useEffect;function rU(e,t,r){let s=Object.keys(t.required||{}),n=Object.keys(t.optional||{}),i=Object.keys(t.methods||{}),o=Object.keys(t.events||{}),l=x.default.createContext({});function a(e,r){for(let n of(e.propsReady&&(0,e.propsReady)(0,!1),s))(0,e[t.required[n]])(0,r[n]);for(let s of n)s in r&&(0,e[t.optional[s]])(0,r[s]);e.propsReady&&(0,e.propsReady)(0,!0)}function c(e){return o.reduce((r,s)=>{var n;let i,o,l;return r[s]=(n=e[t.events[s]],l=()=>null==i?void 0:i(),function(e,t){switch(e){case 1:return t?o===t?void 0:(l(),o=t,i=n(1,t)):(l(),e8);case 2:l(),o=null;return}}),r},{})}return{Component:x.default.forwardRef((u,h)=>{var d;let{children:p,...f}=u,[m]=x.default.useState(()=>{var t;let r,s;return r=new Map,a(t=(s=({constructor:e,dependencies:t,id:n,singleton:i})=>{if(i&&r.has(n))return r.get(n);let o=e(t.map(e=>s(e)));return i&&r.set(n,o),o})(e),f),t}),[y]=x.default.useState(()=>c(m));return rq(()=>{for(let e of o)e in f&&(0,y[e])(1,f[e]);return()=>{Object.values(y).map(te)}},[f,y,m]),rq(()=>{a(m,f)}),x.default.useImperativeHandle(h,(d=i.reduce((e,r)=>(e[r]=e=>{(0,m[t.methods[r]])(0,e)},e),{}),()=>d)),(0,g.jsx)(l.Provider,{value:m,children:r?(0,g.jsx)(r,{...function(e,t){let r={},s={},n=0,i=e.length;for(;n<i;)s[e[n]]=1,n+=1;for(let e in t)Object.hasOwn(s,e)||(r[e]=t[e]);return r}([...s,...n,...o],f),children:p}):p})}),useEmitter:(e,t)=>{let r=x.default.useContext(l)[e];rq(()=>r(1,t),[t,r])},useEmitterValue:x.default.version.startsWith("18")?e=>{let t=x.default.useContext(l)[e],r=x.default.useCallback(e=>t(1,e),[t]);return x.default.useSyncExternalStore(r,()=>tt(t),()=>tt(t))}:e=>{let t=x.default.useContext(l)[e],[r,s]=x.default.useState(()=>tt(t));return rq(()=>t(1,e=>{e!==r&&s(()=>e)}),[t,r]),r},usePublisher:e=>{let t=x.default.useContext(l);return x.default.useCallback(r=>{(0,t[e])(0,r)},[t,e])}}}let rV=x.default.createContext(void 0),rQ=x.default.createContext(void 0),rG="u">typeof document?x.default.useLayoutEffect:x.default.useEffect;function r$(e){return"self"in e}function rK(e,t,r,s=e8,n,i){let o=x.default.useRef(null),l=x.default.useRef(null),a=x.default.useRef(null),c=x.default.useCallback(r=>{let s,n,o,c=r.target;if("body"in c||r$(c)){let e=r$(c)?c:c.defaultView;o=i?e.scrollX:e.scrollY,s=i?e.document.documentElement.scrollWidth:e.document.documentElement.scrollHeight,n=i?e.innerWidth:e.innerHeight}else o=i?c.scrollLeft:c.scrollTop,s=i?c.scrollWidth:c.scrollHeight,n=i?c.offsetWidth:c.offsetHeight;let u=()=>{e({scrollHeight:s,scrollTop:Math.max(o,0),viewportHeight:n})};r.suppressFlushSync?u():e4.default.flushSync(u),null!==l.current&&(o===l.current||o<=0||o===s-n)&&(l.current=null,t(!0),a.current&&(clearTimeout(a.current),a.current=null))},[e,t,i]);return x.default.useEffect(()=>{let e=n||o.current;return s(n||o.current),c({suppressFlushSync:!0,target:e}),e.addEventListener("scroll",c,{passive:!0}),()=>{s(null),e.removeEventListener("scroll",c)}},[o,c,r,s,n]),{scrollByCallback:function(e){i&&(e={behavior:e.behavior,left:e.top}),o.current.scrollBy(e)},scrollerRef:o,scrollToCallback:function(r){let s,n,c,u=o.current;if(!u||(i?"offsetWidth"in u&&0===u.offsetWidth:"offsetHeight"in u&&0===u.offsetHeight))return;let h="smooth"===r.behavior;r$(u)?(n=Math.max(tX(u.document.documentElement,i?"width":"height"),i?u.document.documentElement.scrollWidth:u.document.documentElement.scrollHeight),s=i?u.innerWidth:u.innerHeight,c=i?window.scrollX:window.scrollY):(n=u[i?"scrollWidth":"scrollHeight"],s=tX(u,i?"width":"height"),c=u[i?"scrollLeft":"scrollTop"]);let d=n-s;if(r.top=Math.ceil(Math.max(Math.min(d,r.top),0)),rc(s,n)||r.top===c){e({scrollHeight:n,scrollTop:c,viewportHeight:s}),h&&t(!0);return}h?(l.current=r.top,a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{a.current=null,l.current=null,t(!0)},1e3)):l.current=null,i&&(r={behavior:r.behavior,left:r.top}),u.scrollTo(r)}}}let rY="-webkit-sticky",rX="sticky",rJ=rM(()=>{if(typeof document>"u")return rX;let e=document.createElement("div");return e.style.position=rY,e.style.position===rY?rY:rX});function rZ(e){return e}let r0=tv(()=>{let e=tm(e=>`Item ${e}`),t=tm(e=>`Group ${e}`),r=tm({}),s=tm(rZ),n=tm("div"),i=tm(e8),o=(e,t=null)=>tg(tu(r,ta(t=>t[e]),to()),t);return{components:r,computeItemKey:s,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:t,HeaderComponent:o("Header"),HeaderFooterTag:n,ItemComponent:o("Item","div"),itemContent:e,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:i,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),r1=tv(([e,t])=>({...e,...t}),e9(rW,r0)),r2=({height:e})=>(0,g.jsx)("div",{style:{height:e}}),r4={overflowAnchor:"none",position:rJ(),zIndex:1},r5={overflowAnchor:"none"},r3={...r5,display:"inline-block",height:"100%"},r6=x.default.memo(function({showTopList:e=!1}){let t=sd("listState"),r=sp("sizeRanges"),s=sd("useWindowScroll"),n=sd("customScrollParent"),i=sp("windowScrollContainerState"),o=sp("scrollContainerState"),l=sd("itemContent"),a=sd("context"),c=sd("groupContent"),u=sd("trackItemSizes"),h=sd("itemSize"),d=sd("log"),p=sp("gap"),f=sd("horizontalDirection"),{callbackRef:m}=tE(r,h,u,e?e8:n||s?i:o,d,p,n,f,sd("skipAnimationFrameInResizeObserver")),[y,v]=x.default.useState(0);sh("deviation",e=>{y!==e&&v(e)});let b=sd("EmptyPlaceholder"),w=sd("ScrollSeekPlaceholder")||r2,I=sd("ListComponent"),T=sd("ItemComponent"),C=sd("GroupComponent"),S=sd("computeItemKey"),k=sd("isSeeking"),j=sd("groupIndices").length>0,R=sd("alignToBottom"),E=sd("initialItemFinalLocationReached"),_=e?{}:{boxSizing:"border-box",...f?{display:"inline-block",height:"100%",marginLeft:0!==y?y:R?"auto":0,paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,whiteSpace:"nowrap"}:{marginTop:0!==y?y:R?"auto":0,paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},...E?{}:{visibility:"hidden"}};return!e&&0===t.totalCount&&b?(0,g.jsx)(b,{...st(b,a)}):(0,g.jsx)(I,{...st(I,a),"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",ref:m,style:_,children:(e?t.topItems:t.items).map(e=>{let r=e.originalIndex,s=S(r+t.firstItemIndex,e.data,a);return k?(0,x.createElement)(w,{...st(w,a),height:e.size,index:e.index,key:s,type:e.type||"item",..."group"===e.type?{}:{groupIndex:e.groupIndex}}):"group"===e.type?(0,x.createElement)(C,{...st(C,a),"data-index":r,"data-item-index":e.index,"data-known-size":e.size,key:s,style:r4},c(e.index,a)):(0,x.createElement)(T,{...st(T,a),...sr(T,e.data),"data-index":r,"data-item-group-index":e.groupIndex,"data-item-index":e.index,"data-known-size":e.size,key:s,style:f?r3:r5},j?l(e.index,e.groupIndex,e.data,a):l(e.index,e.data,a))})})}),r8={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r7={outline:"none",overflowX:"auto",position:"relative"},r9=e=>({height:"100%",position:"absolute",top:0,width:"100%",...e?{display:"flex",flexDirection:"column"}:{}}),se={position:rJ(),top:0,width:"100%",zIndex:1};function st(e,t){if("string"!=typeof e)return{context:t}}function sr(e,t){return{item:"string"==typeof e?void 0:t}}let ss=x.default.memo(function(){let e=sd("HeaderComponent"),t=sp("headerHeight"),r=sd("HeaderFooterTag"),s=tj(x.default.useMemo(()=>e=>{t(tX(e,"height"))},[t]),!0,sd("skipAnimationFrameInResizeObserver")),n=sd("context");return e?(0,g.jsx)(r,{ref:s,children:(0,g.jsx)(e,{...st(e,n)})}):null}),sn=x.default.memo(function(){let e=sd("FooterComponent"),t=sp("footerHeight"),r=sd("HeaderFooterTag"),s=tj(x.default.useMemo(()=>e=>{t(tX(e,"height"))},[t]),!0,sd("skipAnimationFrameInResizeObserver")),n=sd("context");return e?(0,g.jsx)(r,{ref:s,children:(0,g.jsx)(e,{...st(e,n)})}):null});function si({useEmitter:e,useEmitterValue:t,usePublisher:r}){return x.default.memo(function({children:s,style:n,context:i,...o}){let l=r("scrollContainerState"),a=t("ScrollerComponent"),c=r("smoothScrollTargetReached"),u=t("scrollerRef"),h=t("horizontalDirection")||!1,{scrollByCallback:d,scrollerRef:p,scrollToCallback:f}=rK(l,c,a,u,void 0,h);return e("scrollTo",f),e("scrollBy",d),(0,g.jsx)(a,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...h?r7:r8,...n},tabIndex:0,...o,...st(a,i),children:s})})}function so({useEmitter:e,useEmitterValue:t,usePublisher:r}){return x.default.memo(function({children:s,style:n,context:i,...o}){let l=r("windowScrollContainerState"),a=t("ScrollerComponent"),c=r("smoothScrollTargetReached"),u=t("totalListHeight"),h=t("deviation"),d=t("customScrollParent"),p=x.default.useRef(null),{scrollByCallback:f,scrollerRef:m,scrollToCallback:y}=rK(l,c,a,t("scrollerRef"),d);return rG(()=>{var e;return m.current=d||(null==(e=p.current)?void 0:e.ownerDocument.defaultView),()=>{m.current=null}},[m,d]),e("windowScrollTo",y),e("scrollBy",f),(0,g.jsx)(a,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...n,...0!==u?{height:u+h}:{}},...o,...st(a,i),children:s})})}let sl=({children:e})=>{let t=x.default.useContext(rV),r=sp("viewportHeight"),s=sp("fixedItemHeight"),n=sd("alignToBottom"),i=sd("horizontalDirection"),o=tj(x.default.useMemo(()=>e3(r,e=>tX(e,i?"width":"height")),[r,i]),!0,sd("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{t&&(r(t.viewportHeight),s(t.itemHeight))},[t,r,s]),(0,g.jsx)("div",{"data-viewport-type":"element",ref:o,style:r9(n),children:e})},sa=({children:e})=>{let t=x.default.useContext(rV),r=sp("windowViewportRect"),s=sp("fixedItemHeight"),n=tN(r,sd("customScrollParent"),sd("skipAnimationFrameInResizeObserver")),i=sd("alignToBottom");return x.default.useEffect(()=>{t&&(s(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,s]),(0,g.jsx)("div",{"data-viewport-type":"window",ref:n,style:r9(i),children:e})},sc=({children:e})=>{let t=sd("TopItemListComponent")||"div",r=sd("headerHeight"),s={...se,marginTop:`${r}px`},n=sd("context");return(0,g.jsx)(t,{style:s,...st(t,n),children:e})},{Component:su,useEmitter:sh,useEmitterValue:sd,usePublisher:sp}=rU(r1,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},x.default.memo(function(e){let t=sd("useWindowScroll"),r=sd("topItemsIndexes").length>0,s=sd("customScrollParent"),n=sd("context");return(0,g.jsxs)(s||t?sm:sf,{...e,context:n,children:[r&&(0,g.jsx)(sc,{children:(0,g.jsx)(r6,{showTopList:!0})}),(0,g.jsxs)(s||t?sa:sl,{children:[(0,g.jsx)(ss,{}),(0,g.jsx)(r6,{}),(0,g.jsx)(sn,{})]})]})})),sf=si({useEmitter:sh,useEmitterValue:sd,usePublisher:sp}),sm=so({useEmitter:sh,useEmitterValue:sd,usePublisher:sp}),sg=tv(()=>{let e=tm(e=>(0,g.jsxs)("td",{children:["Item $",e]})),t=tm(null),r=tm(e=>(0,g.jsxs)("td",{colSpan:1e3,children:["Group ",e]})),s=tm(null),n=tm(null),i=tm({}),o=tm(rZ),l=tm(e8),a=(e,t=null)=>tg(tu(i,ta(t=>t[e]),to()),t);return{components:i,computeItemKey:o,context:t,EmptyPlaceholder:a("EmptyPlaceholder"),FillerRow:a("FillerRow"),fixedFooterContent:n,fixedHeaderContent:s,itemContent:e,groupContent:r,ScrollerComponent:a("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:a("ScrollSeekPlaceholder"),TableBodyComponent:a("TableBody","tbody"),TableComponent:a("Table","table"),TableFooterComponent:a("TableFoot","tfoot"),TableHeadComponent:a("TableHead","thead"),TableRowComponent:a("TableRow","tr"),GroupComponent:a("Group","tr")}}),sx=tv(([e,t])=>({...e,...t}),e9(rW,sg)),sy=({height:e})=>(0,g.jsx)("tr",{children:(0,g.jsx)("td",{style:{height:e}})}),sv=({height:e})=>(0,g.jsx)("tr",{children:(0,g.jsx)("td",{style:{border:0,height:e,padding:0}})}),sb={overflowAnchor:"none"},sw={position:rJ(),zIndex:2,overflowAnchor:"none"},sI=x.default.memo(function({showTopList:e=!1}){let t=sj("listState"),r=sj("computeItemKey"),s=sj("firstItemIndex"),n=sj("context"),i=sj("isSeeking"),o=sj("fixedHeaderHeight"),l=sj("groupIndices").length>0,a=sj("itemContent"),c=sj("groupContent"),u=sj("ScrollSeekPlaceholder")||sy,h=sj("GroupComponent"),d=sj("TableRowComponent"),p=(e?t.topItems:[]).reduce((e,t,r)=>(0===r?e.push(t.size):e.push(e[r-1]+t.size),e),[]),f=(e?t.topItems:t.items).map(t=>{let f=t.originalIndex,m=r(f+s,t.data,n),g=e?0===f?0:p[f-1]:0;return i?(0,x.createElement)(u,{...st(u,n),height:t.size,index:t.index,key:m,type:t.type||"item"}):"group"===t.type?(0,x.createElement)(h,{...st(h,n),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,key:m,style:{...sw,top:o}},c(t.index,n)):(0,x.createElement)(d,{...st(d,n),...sr(d,t.data),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,"data-item-group-index":t.groupIndex,key:m,style:e?{...sw,top:o+g}:sb},l?a(t.index,t.groupIndex,t.data,n):a(t.index,t.data,n))});return(0,g.jsx)(g.Fragment,{children:f})}),sT=x.default.memo(function(){let e=sj("listState"),t=sj("topItemsIndexes").length>0,r=sR("sizeRanges"),s=sj("useWindowScroll"),n=sj("customScrollParent"),i=sR("windowScrollContainerState"),o=sR("scrollContainerState"),l=sj("trackItemSizes"),{callbackRef:a,ref:c}=tE(r,sj("itemSize"),l,n||s?i:o,sj("log"),void 0,n,!1,sj("skipAnimationFrameInResizeObserver")),[u,h]=x.default.useState(0);sk("deviation",e=>{u!==e&&(c.current.style.marginTop=`${e}px`,h(e))});let d=sj("EmptyPlaceholder"),p=sj("FillerRow")||sv,f=sj("TableBodyComponent"),m=sj("paddingTopAddition"),y=sj("statefulTotalCount"),v=sj("context");if(0===y&&d)return(0,g.jsx)(d,{...st(d,v)});let b=(t?e.topItems:[]).reduce((e,t)=>e+t.size,0),w=e.offsetTop+m+u-b,I=e.offsetBottom,T=w>0?(0,g.jsx)(p,{context:v,height:w},"padding-top"):null,C=I>0?(0,g.jsx)(p,{context:v,height:I},"padding-bottom"):null;return(0,g.jsxs)(f,{"data-testid":"virtuoso-item-list",ref:a,...st(f,v),children:[T,t&&(0,g.jsx)(sI,{showTopList:!0}),(0,g.jsx)(sI,{}),C]})}),sC=({children:e})=>{let t=x.default.useContext(rV),r=sR("viewportHeight"),s=sR("fixedItemHeight"),n=tj(x.default.useMemo(()=>e3(r,e=>tX(e,"height")),[r]),!0,sj("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{t&&(r(t.viewportHeight),s(t.itemHeight))},[t,r,s]),(0,g.jsx)("div",{"data-viewport-type":"element",ref:n,style:r9(!1),children:e})},sS=({children:e})=>{let t=x.default.useContext(rV),r=sR("windowViewportRect"),s=sR("fixedItemHeight"),n=tN(r,sj("customScrollParent"),sj("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{t&&(s(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,s]),(0,g.jsx)("div",{"data-viewport-type":"window",ref:n,style:r9(!1),children:e})},{useEmitter:sk,useEmitterValue:sj,usePublisher:sR}=rU(sx,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},x.default.memo(function(e){let t=sj("useWindowScroll"),r=sj("customScrollParent"),s=sR("fixedHeaderHeight"),n=sR("fixedFooterHeight"),i=sj("fixedHeaderContent"),o=sj("fixedFooterContent"),l=sj("context"),a=tj(x.default.useMemo(()=>e3(s,e=>tX(e,"height")),[s]),!0,sj("skipAnimationFrameInResizeObserver")),c=tj(x.default.useMemo(()=>e3(n,e=>tX(e,"height")),[n]),!0,sj("skipAnimationFrameInResizeObserver")),u=r||t?s_:sE,h=r||t?sS:sC,d=sj("TableComponent"),p=sj("TableHeadComponent"),f=sj("TableFooterComponent"),m=i?(0,g.jsx)(p,{ref:a,style:{position:"sticky",top:0,zIndex:2},...st(p,l),children:i()},"TableHead"):null,y=o?(0,g.jsx)(f,{ref:c,style:{bottom:0,position:"sticky",zIndex:1},...st(f,l),children:o()},"TableFoot"):null;return(0,g.jsx)(u,{...e,...st(u,l),children:(0,g.jsx)(h,{children:(0,g.jsxs)(d,{style:{borderSpacing:0,overflowAnchor:"none"},...st(d,l),children:[m,(0,g.jsx)(sT,{},"TableBody"),y]})})})})),sE=si({useEmitter:sk,useEmitterValue:sj,usePublisher:sR}),s_=so({useEmitter:sk,useEmitterValue:sj,usePublisher:sR}),sN={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},sO={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:sB,floor:sL,max:sA,min:sH,round:sz}=Math;function sM(e,t,r){return Array.from({length:t-e+1}).map((t,s)=>({data:null===r?null:r[s+e],index:s+e}))}function sD(e,t){return e&&e.width===t.width&&e.height===t.height}function sP(e,t){return e&&e.column===t.column&&e.row===t.row}let sF=tv(([{increaseViewportBy:e,listBoundary:t,overscan:r,visibleRange:s},{footerHeight:n,headerHeight:i,scrollBy:o,scrollContainerState:l,scrollTo:a,scrollTop:c,smoothScrollTargetReached:u,viewportHeight:h},d,p,{didMount:f,propsReady:m},{customScrollParent:g,useWindowScroll:x,windowScrollContainerState:y,windowScrollTo:v,windowViewportRect:b},w])=>{let I=tm(0),T=tm(0),C=tm(sN),S=tm({height:0,width:0}),k=tm({height:0,width:0}),j=tx(),R=tx(),E=tm(0),_=tm(null),N=tm({column:0,row:0}),O=tx(),B=tx(),L=tm(!1),A=tm(0),H=tm(!0),z=tm(!1),M=tm(!1);tu(f,tf(A),tl(([e,t])=>!!t))(1,()=>{H(0,!1)}),tu(tw(f,H,k,S,A,z),tl(([e,t,r,s,,n])=>e&&!t&&0!==r.height&&0!==s.height&&!n))(1,([,,,,e])=>{z(0,!0),ro(1,()=>{j(0,e)}),ts(tu(c),()=>{t(0,[0,0]),H(0,!0)})}),tr(tu(B,tl(e=>null!=e&&e.scrollTop>0),tc(0)),T),tu(f,tf(B),tl(([,e])=>null!=e))(1,([,e])=>{e&&(S(0,e.viewport),k(0,e.item),N(0,e.gap),e.scrollTop>0&&(L(0,!0),ts(tu(c,td(1)),e=>{L(0,!1)}),a(0,{top:e.scrollTop})))}),tr(tu(S,ta(({height:e})=>e)),h),tr(tu(tw(tI(S,sD),tI(k,sD),tI(N,(e,t)=>e&&e.column===t.column&&e.row===t.row),tI(c)),ta(([e,t,r,s])=>({gap:r,item:t,scrollTop:s,viewport:e}))),O),tr(tu(tw(tI(I),s,tI(N,sP),tI(k,sD),tI(S,sD),tI(_),tI(T),tI(L),tI(H),tI(A)),tl(([,,,,,,,e])=>!e),ta(([e,[t,r],s,n,i,o,l,,a,c])=>{let u,h,{column:d,row:p}=s,{height:f,width:m}=n,{width:g}=i;if(0===l&&(0===e||0===g))return sN;if(0===m){var x;let t=rl(c,e),r=t+Math.max(l-1,0);return x=sM(t,r,o),{...sO,items:x}}let y=sW(g,m,d);a?0===t&&0===r&&l>0?(u=0,h=l-1):(u=y*sL((t+p)/(f+p)),h=sH(e-1,sA(h=y*sB((r+p)/(f+p))-1,y-1)),u=sH(h,sA(0,u))):(u=0,h=-1);let v=sM(u,h,o),{bottom:b,top:w}=sq(i,s,n,v),I=sB(e/y);return{bottom:b,itemHeight:f,items:v,itemWidth:m,offsetBottom:I*f+(I-1)*p-b,offsetTop:w,top:w}})),C),tr(tu(_,tl(e=>null!==e),ta(e=>e.length)),I),tr(tu(tw(S,k,C,N),tl(([e,t,{items:r}])=>r.length>0&&0!==t.height&&0!==e.height),ta(([e,t,{items:r},s])=>{let{bottom:n,top:i}=sq(e,s,t,r);return[i,n]}),to(t$)),t);let D=tm(!1);tr(tu(c,tf(D),ta(([e,t])=>t||0!==e)),D);let P=ty(tu(tw(C,I),tl(([{items:e}])=>e.length>0),tf(D),tl(([[e,t],r])=>{let s=e.items[e.items.length-1].index===t-1;return(r||e.bottom>0&&e.itemHeight>0&&0===e.offsetBottom&&e.items.length===t)&&s}),ta(([[,e]])=>e-1),to())),F=ty(tu(tI(C),tl(({items:e})=>e.length>0&&0===e[0].index),tc(0),to())),W=ty(tu(tI(C),tf(L),tl(([{items:e},t])=>e.length>0&&!t),ta(([{items:e}])=>({endIndex:e[e.length-1].index,startIndex:e[0].index})),to(tG),tp(0)));tr(W,p.scrollSeekRangeChanged),tr(tu(j,tf(S,k,I,N),ta(([e,t,r,s,n])=>{let i=rn(e),{align:o,behavior:l,offset:a}=i,c=i.index;"LAST"===c&&(c=s-1);let u=sU(t,n,r,c=sA(0,c,sH(s-1,c)));return"end"===o?u=sz(u-t.height+r.height):"center"===o&&(u=sz(u-t.height/2+r.height/2)),a&&(u+=a),{behavior:l,top:u}})),a);let q=tg(tu(C,ta(e=>e.offsetBottom+e.bottom)),0);return tr(tu(b,ta(e=>({height:e.visibleHeight,width:e.visibleWidth}))),S),{customScrollParent:g,data:_,deviation:E,footerHeight:n,gap:N,headerHeight:i,increaseViewportBy:e,initialItemCount:T,itemDimensions:k,overscan:r,restoreStateFrom:B,scrollBy:o,scrollContainerState:l,scrollHeight:R,scrollTo:a,scrollToIndex:j,scrollTop:c,smoothScrollTargetReached:u,totalCount:I,useWindowScroll:x,viewportDimensions:S,windowScrollContainerState:y,windowScrollTo:v,windowViewportRect:b,...p,gridState:C,horizontalDirection:M,initialTopMostItemIndex:A,totalListHeight:q,...d,endReached:P,propsReady:m,rangeChanged:W,startReached:F,stateChanged:O,stateRestoreInProgress:L,...w}},e9(rx,tO,rd,rB,rr,rL,tk));function sW(e,t,r){return sA(1,sL((e+r)/(sL(t)+r)))}function sq(e,t,r,s){let{height:n}=r;if(void 0===n||0===s.length)return{bottom:0,top:0};let i=sU(e,t,r,s[0].index);return{bottom:sU(e,t,r,s[s.length-1].index)+n,top:i}}function sU(e,t,r,s){let n=sL(s/sW(e.width,r.width,t.column)),i=n*r.height+sA(0,n-1)*t.row;return i>0?i+t.row:i}let sV=tv(()=>{let e=tm(e=>`Item ${e}`),t=tm({}),r=tm(null),s=tm("virtuoso-grid-item"),n=tm("virtuoso-grid-list"),i=tm(rZ),o=tm("div"),l=tm(e8),a=(e,r=null)=>tg(tu(t,ta(t=>t[e]),to()),r),c=tm(!1),u=tm(!1);return tr(tI(u),c),{components:t,computeItemKey:i,context:r,FooterComponent:a("Footer"),HeaderComponent:a("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:a("Item","div"),itemContent:e,listClassName:n,ListComponent:a("List","div"),readyStateChanged:c,reportReadyState:u,ScrollerComponent:a("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:a("ScrollSeekPlaceholder","div")}}),sQ=tv(([e,t])=>({...e,...t}),e9(sF,sV)),sG=x.default.memo(function(){let e=sZ("gridState"),t=sZ("listClassName"),r=sZ("itemClassName"),s=sZ("itemContent"),n=sZ("computeItemKey"),i=sZ("isSeeking"),o=s0("scrollHeight"),l=sZ("ItemComponent"),a=sZ("ListComponent"),c=sZ("ScrollSeekPlaceholder"),u=sZ("context"),h=s0("itemDimensions"),d=s0("gap"),p=sZ("log"),f=sZ("stateRestoreInProgress"),m=s0("reportReadyState"),y=tj(x.default.useMemo(()=>e=>{o(e.parentElement.parentElement.scrollHeight);let t=e.firstChild;if(t){let{height:e,width:r}=t.getBoundingClientRect();h({height:e,width:r})}d({column:s4("column-gap",getComputedStyle(e).columnGap,p),row:s4("row-gap",getComputedStyle(e).rowGap,p)})},[o,h,d,p]),!0,!1);return rG(()=>{e.itemHeight>0&&e.itemWidth>0&&m(!0)},[e]),f?null:(0,g.jsx)(a,{className:t,ref:y,...st(a,u),"data-testid":"virtuoso-item-list",style:{paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},children:e.items.map(t=>{let o=n(t.index,t.data,u);return i?(0,g.jsx)(c,{...st(c,u),height:e.itemHeight,index:t.index,width:e.itemWidth},o):(0,x.createElement)(l,{...st(l,u),className:r,"data-index":t.index,key:o},s(t.index,t.data,u))})})}),s$=x.default.memo(function(){let e=sZ("HeaderComponent"),t=s0("headerHeight"),r=sZ("headerFooterTag"),s=tj(x.default.useMemo(()=>e=>{t(tX(e,"height"))},[t]),!0,!1),n=sZ("context");return e?(0,g.jsx)(r,{ref:s,children:(0,g.jsx)(e,{...st(e,n)})}):null}),sK=x.default.memo(function(){let e=sZ("FooterComponent"),t=s0("footerHeight"),r=sZ("headerFooterTag"),s=tj(x.default.useMemo(()=>e=>{t(tX(e,"height"))},[t]),!0,!1),n=sZ("context");return e?(0,g.jsx)(r,{ref:s,children:(0,g.jsx)(e,{...st(e,n)})}):null}),sY=({children:e})=>{let t=x.default.useContext(rQ),r=s0("itemDimensions"),s=s0("viewportDimensions"),n=tj(x.default.useMemo(()=>e=>{s(e.getBoundingClientRect())},[s]),!0,!1);return x.default.useEffect(()=>{t&&(s({height:t.viewportHeight,width:t.viewportWidth}),r({height:t.itemHeight,width:t.itemWidth}))},[t,s,r]),(0,g.jsx)("div",{ref:n,style:r9(!1),children:e})},sX=({children:e})=>{let t=x.default.useContext(rQ),r=s0("windowViewportRect"),s=s0("itemDimensions"),n=tN(r,sZ("customScrollParent"),!1);return x.default.useEffect(()=>{t&&(s({height:t.itemHeight,width:t.itemWidth}),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,r,s]),(0,g.jsx)("div",{ref:n,style:r9(!1),children:e})},{useEmitter:sJ,useEmitterValue:sZ,usePublisher:s0}=rU(sQ,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},x.default.memo(function({...e}){let t=sZ("useWindowScroll"),r=sZ("customScrollParent"),s=r||t?s2:s1,n=r||t?sX:sY,i=sZ("context");return(0,g.jsx)(s,{...e,...st(s,i),children:(0,g.jsxs)(n,{children:[(0,g.jsx)(s$,{}),(0,g.jsx)(sG,{}),(0,g.jsx)(sK,{})]})})})),s1=si({useEmitter:sJ,useEmitterValue:sZ,usePublisher:s0}),s2=so({useEmitter:sJ,useEmitterValue:sZ,usePublisher:s0});function s4(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,tC.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}let s5=(0,x.memo)(({gender:e,className:t})=>"male"===e?(0,g.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,g.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,g.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):"female"===e?(0,g.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,g.jsx)("path",{d:"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"}),(0,g.jsx)("path",{d:"M18 22H6c0-4 4-3 6-3s6-1 6 3Z"})]}):(0,g.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,g.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,g.jsx)("circle",{cx:"12",cy:"10",r:"3"}),(0,g.jsx)("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]})),s3=(0,x.memo)(({onSendMessage:e,showBottomNavPadding:t,onFocusChange:r,isFocused:s})=>{let[n,i]=(0,x.useState)(""),o=(0,x.useRef)(null);return(0,g.jsx)("footer",{className:`px-3 py-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${s?"pb-4 pt-3":t?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[90px] pt-4":"py-4"}`,children:(0,g.jsxs)("form",{onSubmit:t=>{t.preventDefault(),n.trim()&&(e(n.trim()),i(""),o.current?.blur())},className:"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto",children:[(0,g.jsx)("input",{ref:o,type:"text",value:n,onChange:e=>i(e.target.value),onFocus:()=>r?.(!0),onBlur:()=>r?.(!1),placeholder:"Messaggio alla stanza...",className:"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400",style:{fontSize:"16px"}}),(0,g.jsx)("button",{type:"submit",className:"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform",onMouseDown:e=>e.preventDefault(),children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 rotate-45",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})}),s6=({user:e,messages:t,onSendMessage:r,onlineCount:s,isOnline:n,hideHeader:i,headerTitle:o,showBottomNavPadding:l,onInputFocusChange:a,isFocused:c,isSyncing:u})=>{let h=(0,x.useRef)(null),d=(0,x.useCallback)((r,s)=>{let n=s.senderId===e.id,i=0===r||t[r-1].senderId!==s.senderId;return(0,g.jsx)("div",{className:`flex ${n?"justify-end":"justify-start"} animate-message pb-4 px-4`,children:(0,g.jsxs)("div",{className:`flex flex-col max-w-[85%] ${n?"items-end":"items-start"}`,children:[i&&(0,g.jsxs)("span",{className:`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${n?"text-emerald-700":"text-gray-600"}`,children:[!n&&(0,g.jsx)("div",{className:`w-3.5 h-3.5 rounded-full flex items-center justify-center ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(s.senderGender)}`,children:(0,g.jsx)(s5,{gender:s.senderGender,className:"w-2 h-2 text-white"})}),n?"Tu":s.senderAlias]}),(0,g.jsx)("div",{className:`px-3 py-2 rounded-2xl shadow-sm ${n?"bg-emerald-500 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:(0,g.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed text-[15px]",children:s.text})}),(0,g.jsx)("span",{className:"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70",children:new Date(s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},[e.id,t]);return(0,g.jsxs)("div",{className:"w-full h-full flex flex-col bg-white",children:[!i&&(0,g.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 shrink-0",children:(0,g.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight",children:o||"Stanza"}),(0,g.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,g.jsx)("span",{className:`w-2 h-2 rounded-full ${n?"bg-emerald-500":"bg-red-500"}`}),(0,g.jsx)("p",{className:"text-[11px] font-bold text-emerald-600 uppercase tracking-wide",children:n?`${s} persone qui`:"Disconnesso"})]})]})]}),u&&(0,g.jsxs)("div",{className:"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse",children:[(0,g.jsxs)("svg",{className:"animate-spin h-3 w-3 text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,g.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,g.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,g.jsx)("span",{className:"text-[10px] font-bold text-emerald-700 tracking-wide uppercase",children:"Sincronizzazione"})]})]})}),(0,g.jsx)("div",{className:"flex-1 overflow-hidden relative chat-bg",children:(0,g.jsx)(su,{ref:h,data:t,initialTopMostItemIndex:t.length-1,itemContent:d,followOutput:"smooth",className:"h-full w-full",alignToBottom:!0})}),(0,g.jsx)(s3,{onSendMessage:r,showBottomNavPadding:l,onFocusChange:a,isFocused:c})]})},s8=({activeTab:e,onTabChange:t,usersCount:r,unreadChatsCount:s})=>(0,g.jsxs)("nav",{className:"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]",children:[(0,g.jsxs)("button",{onClick:()=>t("room"),className:`flex flex-col items-center justify-center w-full relative ${"room"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"room"===e?2.6:2.2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r>0&&(0,g.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:r})]}),(0,g.jsx)("span",{className:`text-[10px] mt-1 ${"room"===e?"font-bold":"font-semibold"}`,children:"Stanza"})]}),(0,g.jsxs)("button",{onClick:()=>t("users"),className:`flex flex-col items-center justify-center w-full relative ${"users"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"users"===e?2.6:2.2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,g.jsx)("span",{className:`text-[10px] mt-1 ${"users"===e?"font-bold":"font-semibold"}`,children:"Utenti"})]}),(0,g.jsxs)("button",{onClick:()=>t("chats"),className:`flex flex-col items-center justify-center w-full relative ${"chats"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"chats"===e?2.6:2.2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),s>0&&(0,g.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:s})]}),(0,g.jsx)("span",{className:`text-[10px] mt-1 ${"chats"===e?"font-bold":"font-semibold"}`,children:"Chats"})]}),(0,g.jsxs)("button",{onClick:()=>t("settings"),className:`flex flex-col items-center justify-center w-full relative ${"settings"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"settings"===e?2.6:2.2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,g.jsx)("span",{className:`text-[10px] mt-1 ${"settings"===e?"font-bold":"font-semibold"}`,children:"Me"})]})]}),s7=({currentUser:e,users:t,onStartChat:r})=>{let[s,n]=(0,x.useState)(""),i=t.filter(t=>t.id!==e.id&&t.alias.toLowerCase().includes(s.toLowerCase()));return(0,g.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,g.jsxs)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 transition-all",children:[(0,g.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,g.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Utenti"}),(0,g.jsxs)("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide",children:[t.length," Online"]})]}),(0,g.jsx)("div",{className:"px-4 pb-3",children:(0,g.jsxs)("div",{className:"relative group",children:[(0,g.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,g.jsx)("input",{type:"text",placeholder:"Cerca utente per nome...",value:s,onChange:e=>n(e.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm"}),s&&(0,g.jsx)("button",{onClick:()=>n(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),(0,g.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===i.length?(0,g.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,g.jsx)("p",{className:"text-center font-medium",children:s?"Nessun utente trovato.":"Nessun altro utente online al momento."})]}):(0,g.jsx)("ul",{className:"space-y-4",children:i.map(e=>(0,g.jsxs)("li",{className:"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0",children:[(0,g.jsxs)("div",{className:`w-12 h-12 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:[(0,g.jsx)("span",{className:"font-bold text-lg uppercase",children:e.alias.charAt(0)}),(0,g.jsx)("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"})]}),(0,g.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,g.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.alias}),(0,g.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.status||(0,g.jsx)("span",{className:"capitalize",children:e.gender})})]}),(0,g.jsx)("button",{onClick:()=>r(e),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]},e.id))})})]})},s9=({chats:e,onSelectChat:t,onDeleteChat:r})=>(0,g.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,g.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,g.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,g.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Chat private"})})}),(0,g.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===e.length?(0,g.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,g.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,g.jsxs)("p",{className:"text-center font-medium",children:["Nessuna chat attiva.",(0,g.jsx)("br",{}),"Cerca utenti nella scheda Utenti."]})]}):(0,g.jsx)("ul",{className:"space-y-4",children:e.map(e=>{var s;return(0,g.jsxs)("li",{onClick:()=>t(e.peer.id),className:"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0",children:[(0,g.jsx)("div",{className:`w-14 h-14 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:(0,g.jsx)("span",{className:"font-bold text-xl uppercase",children:e.peer.alias.charAt(0)})}),(0,g.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,g.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,g.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.peer.alias}),(0,g.jsx)("span",{className:"text-[11px] text-gray-400 font-medium",children:(e=>{if(0===e.length)return"";let t=new Date(e[e.length-1].timestamp),r=new Date;return t.toDateString()===r.toDateString()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{day:"2-digit",month:"2-digit"})})(e.messages)})]}),(0,g.jsx)("p",{className:"text-sm text-gray-500 truncate",children:0===(s=e.messages).length?"Inizia la conversazione...":s[s.length-1].text})]}),(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[e.unreadCount>0&&(0,g.jsx)("div",{className:"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center",children:(0,g.jsx)("span",{className:"text-[10px] font-bold text-white",children:e.unreadCount})}),(0,g.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e.peer.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},e.peer.id)})})})]}),ne=({user:e,onLogout:t,onUpdateAlias:r,onUpdateStatus:s})=>{let[n,i]=(0,x.useState)(!1),[o,l]=(0,x.useState)(!1),[a,c]=(0,x.useState)(e.alias),[u,h]=(0,x.useState)(e.status||""),d=()=>{a.trim()&&a!==e.alias&&r(a.trim()),i(!1)},p=()=>{u.trim()!==(e.status||"")&&s(u.trim()),l(!1)};return(0,g.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,g.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,g.jsx)("div",{className:"h-[60px] px-4 flex items-center",children:(0,g.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Profilo"})})}),(0,g.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,g.jsxs)("div",{className:"pb-32",children:[(0,g.jsxs)("div",{className:"py-8 flex flex-col items-center bg-white border-b border-gray-100",children:[(0,g.jsxs)("div",{className:"relative group",children:[(0,g.jsx)("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden",children:e.alias.charAt(0).toUpperCase()}),(0,g.jsx)("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-md flex items-center justify-center border border-gray-100",children:(0,g.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,g.jsx)("button",{className:"mt-4 text-emerald-600 font-medium text-sm hover:opacity-75",children:"Edit"})]}),(0,g.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"About"}),(0,g.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,g.jsxs)("button",{onClick:()=>l(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,g.jsx)("div",{className:"flex flex-col items-start truncate overflow-hidden",children:o?(0,g.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:p,onKeyDown:e=>"Enter"===e.key&&p(),maxLength:50,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,g.jsx)("span",{className:"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left",children:e.status||"Available"})}),(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,g.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,g.jsxs)("button",{onClick:()=>i(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,g.jsx)("div",{className:"flex flex-col items-start",children:n?(0,g.jsx)("input",{type:"text",value:a,onChange:e=>c(e.target.value),onBlur:d,onKeyDown:e=>"Enter"===e.key&&d(),maxLength:20,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,g.jsx)("span",{className:"text-[17px] text-gray-900",children:e.alias})}),(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),(0,g.jsxs)("div",{className:"bg-white border-y border-gray-100 divide-y divide-gray-50",children:[(0,g.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,g.jsx)("span",{className:"text-[17px] text-gray-400 capitalize",children:"Gender"}),(0,g.jsx)("span",{className:"text-[17px] text-gray-900",children:e.gender})]}),(0,g.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,g.jsx)("span",{className:"text-[17px] text-gray-400",children:"User ID"}),(0,g.jsx)("span",{className:"text-xs font-mono text-gray-400 uppercase tracking-wider",children:e.id})]})]})]}),(0,g.jsx)("div",{className:"pt-4",children:(0,g.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,g.jsx)("button",{onClick:t,className:"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors",children:"Log Out"})})})]})]})})]})};function nt({tenant:e,initialMessages:t}){let[r,s]=(0,x.useState)(null),[n,i]=(0,x.useState)(null),[o,l]=(0,x.useState)("room"),[a,c]=(0,x.useState)(null),[u,h]=(0,x.useState)(!1),[d,m]=(0,x.useState)([]),[y,v]=(0,x.useState)({}),[b,w]=(0,x.useState)(!1),I=(0,eQ.useQueryClient)(),{data:T=t,isFetching:C}=function(e,t,r){let s,n=x.useContext(e$),i=x.useContext(eG),o=(0,eQ.useQueryClient)(r),l=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(l);let a=o.getQueryCache().get(l.queryHash);if(l._optimisticResults=n?"isRestoring":"optimistic",l.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=l.staleTime;l.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof l.gcTime&&(l.gcTime=Math.max(l.gcTime,1e3))}s=a?.state.error&&"function"==typeof l.throwOnError?(0,eD.shouldThrowError)(l.throwOnError,[a.state.error,a]):l.throwOnError,(l.suspense||l.experimental_prefetchInRender||s)&&!i.isReset()&&(l.retryOnMount=!1),x.useEffect(()=>{i.clearReset()},[i]);let c=!o.getQueryCache().get(l.queryHash),[u]=x.useState(()=>new t(o,l)),h=u.getOptimisticResult(l),d=!n&&!1!==e.subscribed;if(x.useSyncExternalStore(x.useCallback(e=>{let t=d?u.subscribe(eA.notifyManager.batchCalls(e)):eD.noop;return u.updateResult(),t},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),x.useEffect(()=>{u.setOptions(l)},[l,u]),l?.suspense&&h.isPending)throw eK(l,u,i);if((({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(n&&void 0===e.data||(0,eD.shouldThrowError)(r,[e.error,s])))({result:h,errorResetBoundary:i,throwOnError:l.throwOnError,query:a,suspense:l.suspense}))throw h.error;if(o.getDefaultOptions().queries?._experimental_afterQuery?.(l,h),l.experimental_prefetchInRender&&!eD.isServer&&h.isLoading&&h.isFetching&&!n){let e=c?eK(l,u,i):a?.promise;e?.catch(eD.noop).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?h:u.trackResult(h)}({queryKey:["messages","global",e.slug],queryFn:async()=>{let r=await eX.getMessages(!0);try{let t=await fetch(`${eB.API_BASE_URL}/api/messages?tenant=${e.slug}`);if(t.ok){let e=await t.json();for(let t of e)await eX.saveMessage(t,!0);return e}}catch(e){console.warn("Failed to fetch from server, using local data",e)}return r.length>0?r:t},initialData:t},eF,void 0);(0,x.useEffect)(()=>{{let e=localStorage.getItem("chat_user");if(e)try{let t=JSON.parse(e);s(t),eY.Capacitor.isNativePlatform()&&eX.getPrivateChats(t.id).then(e=>{if(e.length>0){let r={};for(let s of e){let e=s.messages[s.messages.length-1];r[s.peerId]={peer:{id:s.peerId,alias:e.senderId===t.id?"Chat":e.senderAlias,gender:e.senderId===t.id?"other":e.senderGender,joinedAt:Date.now()},messages:s.messages,unread:0}}v(r),console.log(`Restored ${e.length} private chats from SQLite`)}}).catch(e=>console.error("Error restoring private chats:",e))}catch(e){console.error("Invalid saved user",e)}let t=eY.Capacitor.getPlatform();if(document.documentElement.classList.add(`platform-${t}`),eY.Capacitor.isNativePlatform()){let e,t;return eJ.setResizeMode({mode:p.Body}).catch(e=>{console.error("Error setting keyboard resize mode",e)}),e1.setOverlaysWebView({overlay:!1}).catch(e=>{console.error("Error setting StatusBar overlay",e)}),e1.setBackgroundColor({color:"#ffffff"}).catch(e=>{console.warn("StatusBar background color not supported on this platform",e)}),e1.setStyle({style:f.Light}).catch(e=>{console.error("Error setting StatusBar style",e)}),(async()=>{e=await eJ.addListener("keyboardWillShow",()=>{h(!0)}),t=await eJ.addListener("keyboardWillHide",()=>{h(!1)})})(),()=>{e&&e.remove(),t&&t.remove()}}}},[e.slug]),(0,x.useEffect)(()=>{if(!r)return;let t=eO(eB.API_BASE_URL||void 0,{query:{tenantSlug:e.slug,userId:r.id},transports:["websocket"],reconnectionAttempts:5,timeout:1e4});return i(t),t.on("connect_error",e=>{console.error("[Socket] Connect Error:",e.message,e)}),t.on("error",e=>{console.error("[Socket] General Error:",e)}),t.on("connect",()=>{console.log("Socket connected"),w(!0),t.emit("join",{user:r,tenantSlug:e.slug})}),t.on("disconnect",()=>{w(!1)}),t.on("presenceUpdate",e=>{m(e)}),t.on("newMessage",async t=>{await eX.saveMessage(t,!0),I.invalidateQueries({queryKey:["messages","global",e.slug]})}),t.on("privateMessage",async e=>{let t=e.senderId===r.id,s=t?e.recipientId:e.senderId;await eX.saveMessage(e,!1),!t&&eY.Capacitor.isNativePlatform()&&e0.impact({style:eZ.ImpactStyle.Light}).catch(()=>{}),v(r=>{let n=r[s]||{peer:{id:s,alias:t?"Unknown":e.senderAlias,gender:t?"male":e.senderGender,joinedAt:Date.now()},messages:[],unread:0};return n.messages.some(t=>t.id===e.id)?r:{...r,[s]:{...n,messages:[...n.messages,e],unread:n.unread+1}}})}),()=>{t.disconnect()}},[r,e.slug,I]),(0,x.useEffect)(()=>{"chats"===o&&a&&y[a]?.unread>0&&v(e=>({...e,[a]:{...e[a],unread:0}}))},[o,a,y]);let S=async t=>{if(!r||!n)return;let s={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString()};eY.Capacitor.isNativePlatform()&&e0.impact({style:eZ.ImpactStyle.Light}).catch(()=>{}),await eX.saveMessage(s,!0),I.setQueryData(["messages","global",e.slug],e=>[...e||[],s]),n.emit("sendMessage",{...s,tenantSlug:e.slug})},k=async t=>{if(!r||!n||!a)return;let s={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString(),recipientId:a};eY.Capacitor.isNativePlatform()&&e0.impact({style:eZ.ImpactStyle.Light}).catch(()=>{}),await eX.saveMessage(s,!1),v(e=>({...e,[a]:{...e[a],messages:[...e[a].messages,s]}})),n.emit("sendMessage",{...s,tenantSlug:e.slug,isPrivate:!0})},{swipeHandlers:j,swipeStyle:R,isDragging:E}=function({onSwipeBack:e,edgeWidth:t=30,threshold:r=100,enabled:s=!0}){let[n,i]=(0,x.useState)({isDragging:!1,translateX:0,opacity:1}),o=(0,x.useRef)(0),l=(0,x.useRef)(0),a=(0,x.useRef)(!1),c=(0,x.useRef)(!1);return{swipeHandlers:{onTouchStart:(0,x.useCallback)(e=>{if(!s)return;let r=e.touches[0];o.current=r.clientX,l.current=r.clientY,a.current=r.clientX<=t,c.current=!1,a.current&&i({isDragging:!0,translateX:0,opacity:1})},[s,t]),onTouchMove:(0,x.useCallback)(e=>{if(!s||!a.current||c.current)return;let t=e.touches[0],r=t.clientX-o.current;if(Math.abs(t.clientY-l.current)>30&&r<30){a.current=!1,i({isDragging:!1,translateX:0,opacity:1});return}if(r>0){let t=Math.min(.8*r,window.innerWidth),s=1-t/window.innerWidth*.3;i({isDragging:!0,translateX:t,opacity:s}),e.preventDefault()}},[s]),onTouchEnd:(0,x.useCallback)(()=>{if(!s||!a.current||c.current)return void i({isDragging:!1,translateX:0,opacity:1});let{translateX:t}=n;t>=r?(c.current=!0,i({isDragging:!1,translateX:window.innerWidth,opacity:0}),setTimeout(()=>{e(),i({isDragging:!1,translateX:0,opacity:1})},150)):i({isDragging:!1,translateX:0,opacity:1}),a.current=!1},[s,n,r,e])},swipeStyle:{transform:`translateX(${n.translateX}px)`,transition:n.isDragging?"none":"transform 0.2s ease-out, opacity 0.2s ease-out",opacity:n.opacity},isDragging:n.isDragging,translateX:n.translateX}}({onSwipeBack:()=>c(null),enabled:eY.Capacitor.isNativePlatform()&&null!==a});if(!r)return(0,g.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col",children:(0,g.jsx)(e2,{onLogin:e=>{s(e),localStorage.setItem("chat_user",JSON.stringify(e))},tenantName:e.name})});if(a&&"chats"===o){let e=y[a];return e?(0,g.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",style:R,...j,children:[E&&(0,g.jsx)("div",{className:"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none"}),(0,g.jsx)("header",{className:"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0",children:(0,g.jsxs)("div",{className:"h-[60px] px-4 flex items-center gap-3",children:[(0,g.jsx)("button",{onClick:()=>c(null),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,g.jsxs)("div",{className:"flex flex-col",children:[(0,g.jsx)("h2",{className:"font-bold text-lg leading-tight",children:e.peer.alias}),d.some(e=>e.id===a)&&(0,g.jsx)("span",{className:"text-xs text-emerald-500 font-medium",children:"Online"})]})]})}),(0,g.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,g.jsx)(s6,{user:r,messages:e.messages,onSendMessage:k,onlineCount:0,isOnline:!0,hideHeader:!0,showBottomNavPadding:!1,onInputFocusChange:h,isFocused:u,isSyncing:!1})})]}):(c(null),null)}let _=Object.values(y).reduce((e,t)=>e+t.unread,0);return(0,g.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",children:[(0,g.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:["room"===o&&(0,g.jsx)(s6,{user:r,messages:T,onSendMessage:S,onlineCount:d.length,isOnline:b,headerTitle:e.name,showBottomNavPadding:!0,onInputFocusChange:h,isFocused:u,isSyncing:C}),"users"===o&&(0,g.jsx)(s7,{currentUser:r,users:d,onStartChat:e=>{y[e.id]||v(t=>({...t,[e.id]:{peer:e,messages:[],unread:0}})),c(e.id),l("chats")}}),"chats"===o&&(0,g.jsx)(s9,{chats:Object.values(y).map(e=>({...e,unreadCount:e.unread})).sort((e,t)=>{let r=e.messages.length?new Date(e.messages[e.messages.length-1].timestamp).getTime():0;return(t.messages.length?new Date(t.messages[t.messages.length-1].timestamp).getTime():0)-r}),onSelectChat:c,onDeleteChat:e=>{v(t=>{let r={...t};return delete r[e],r}),a===e&&c(null)}}),"settings"===o&&(0,g.jsx)(ne,{user:r,onLogout:()=>{s(null),i(null),localStorage.removeItem("chat_user"),v({}),eX.clearMessages(),I.setQueryData(["messages","global",e.slug],t),c(null),l("room")},onUpdateAlias:t=>{if(!r||!n)return;let i={...r,alias:t};s(i),localStorage.setItem("chat_user",JSON.stringify(i)),n.emit("join",{user:i,tenantSlug:e.slug})},onUpdateStatus:t=>{if(!r||!n)return;let i={...r,status:t};s(i),localStorage.setItem("chat_user",JSON.stringify(i)),n.emit("join",{user:i,tenantSlug:e.slug})}})]}),(0,g.jsx)("div",{className:`transition-all duration-300 ease-in-out border-t border-gray-100 bg-white z-20 overflow-hidden ${u?"opacity-0 pointer-events-none h-0":"opacity-100 h-auto"}`,children:(0,g.jsx)(s8,{activeTab:o,onTabChange:e=>{l(e),c(null)},usersCount:d.length,unreadChatsCount:_})})]})}var nr=e.i(1647);function ns(){let e=(0,y.useParams)().tenantSlug,[t,r]=(0,x.useState)(null),[s,n]=(0,x.useState)([]),[i,o]=(0,x.useState)(!0),[l,a]=(0,x.useState)(!1);return((0,x.useEffect)(()=>{!async function(){try{let t=await (0,nr.clientGetTenantBySlug)(e);if(!t){a(!0),o(!1);return}r(t);let s=(await (0,nr.clientGetMessages)(e)).map(e=>({id:e.id,text:e.text,senderId:e.senderId||e.userId,senderAlias:e.senderAlias||e.user?.name||"Anonymous",senderGender:e.senderGender||"other",timestamp:new Date(e.timestamp||e.createdAt).toISOString()}));n(s),o(!1)}catch(e){console.error("Error loading chat data",e),a(!0),o(!1)}}()},[e]),i)?(0,g.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,g.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Caricamento chat..."})}):((l||!t)&&(0,y.notFound)(),(0,g.jsx)("main",{className:"flex h-full flex-col items-center justify-between",children:(0,g.jsx)(nt,{tenant:t,initialMessages:s})}))}e.s(["default",()=>ns],68689)}]);