{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/config.ts"],"sourcesContent":["import { Capacitor } from '@capacitor/core';\n\n// Detect if running natively (iOS or Android)\nconst isNative = Capacitor.isNativePlatform();\n\n// Use env variable or fallback\n// Set NEXT_PUBLIC_SERVER_URL in .env to your local IP (e.g. http://192.168.1.x:3000)\nexport const API_BASE_URL = isNative\n    ? (process.env.NEXT_PUBLIC_SERVER_URL || 'http://localhost:3000')\n    : '';\n\nif (isNative) {\n    console.log(\"[ChatConfig] Native Platform Detected. API_BASE_URL:\", API_BASE_URL);\n}\n"],"names":[],"mappings":";;;;AAQO;AARP;;AAEA,8CAA8C;AAC9C,MAAM,WAAW,oKAAS,CAAC,gBAAgB;AAIpC,MAAM,eAAe,WACrB,iEAAsC,0BACvC;AAEN,IAAI,UAAU;IACV,QAAQ,GAAG,CAAC,wDAAwD;AACxE"}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/lib/sqlite.ts"],"sourcesContent":["import { CapacitorSQLite, SQLiteConnection, SQLiteDBConnection } from '@capacitor-community/sqlite';\nimport { Capacitor } from '@capacitor/core';\nimport { Message } from '../types';\n\nclass SQLiteService {\n    private sqlite: SQLiteConnection | null = null;\n    private db: SQLiteDBConnection | null = null;\n    private dbName: string = 'chat_cache';\n\n    async initialize() {\n        console.log(\"SQLite: Disabled for debugging.\");\n        return;\n\n        if (!Capacitor.isNativePlatform()) {\n            console.log(\"SQLite: Skipping initialization on non-native platform (Web).\");\n            return;\n        }\n        if (this.db) return;\n\n        this.sqlite = new SQLiteConnection(CapacitorSQLite);\n\n        try {\n            // Check if connection exists and close it if necessary (for hot-reload)\n            const isConn = await this.sqlite.isConnection(this.dbName, false);\n            if (isConn.result) {\n                await this.sqlite.retrieveConnection(this.dbName, false);\n            }\n\n            this.db = await this.sqlite.createConnection(this.dbName, false, 'no-encryption', 1, false);\n            await this.db.open();\n\n            const schema = `\n                CREATE TABLE IF NOT EXISTS messages (\n                    id TEXT PRIMARY KEY,\n                    text TEXT,\n                    senderId TEXT,\n                    senderAlias TEXT,\n                    senderGender TEXT,\n                    timestamp TEXT,\n                    recipientId TEXT,\n                    isGlobal INTEGER DEFAULT 1\n                );\n            `;\n            await this.db.execute(schema);\n            console.log(\"SQLite DB Initialized with schema\");\n        } catch (err) {\n            console.error('SQLite initialization error:', err);\n        }\n    }\n\n    async saveMessage(msg: Message, isGlobal: boolean = true) {\n        if (!this.db) await this.initialize();\n        if (!this.db) return;\n\n        const query = `\n            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, isGlobal)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?);\n        `;\n        const params = [\n            msg.id,\n            msg.text,\n            msg.senderId,\n            msg.senderAlias,\n            msg.senderGender,\n            msg.timestamp,\n            msg.recipientId || null,\n            isGlobal ? 1 : 0\n        ];\n\n        try {\n            await this.db.run(query, params);\n        } catch (err) {\n            console.error('Error saving message to SQLite:', err);\n        }\n    }\n\n    async getMessages(isGlobal: boolean = true, recipientId?: string): Promise<Message[]> {\n        if (!this.db) await this.initialize();\n        if (!this.db) return [];\n\n        let query = '';\n        let params: any[] = [];\n\n        if (isGlobal) {\n            query = `SELECT * FROM messages WHERE isGlobal = 1 ORDER BY timestamp ASC LIMIT 100;`;\n        } else {\n            query = `SELECT * FROM messages WHERE isGlobal = 0 AND (recipientId = ? OR senderId = ?) ORDER BY timestamp ASC LIMIT 100;`;\n            params = [recipientId, recipientId];\n        }\n\n        try {\n            const res = await this.db.query(query, params);\n            return (res.values || []).map((m: any) => ({\n                ...m,\n                isGlobal: undefined // Clean up type for app\n            }));\n        } catch (err) {\n            console.error('Error fetching messages from SQLite:', err);\n            return [];\n        }\n    }\n\n    async clearMessages() {\n        if (!this.db) await this.initialize();\n        if (!this.db) return;\n\n        try {\n            await this.db.run('DELETE FROM messages;', []);\n        } catch (err) {\n            console.error('Error clearing messages from SQLite:', err);\n        }\n    }\n\n    async getPrivateChats(currentUserId: string): Promise<{ peerId: string; messages: Message[] }[]> {\n        if (!this.db) await this.initialize();\n        if (!this.db) return [];\n\n        try {\n            const res = await this.db.query(\n                `SELECT * FROM messages WHERE isGlobal = 0 ORDER BY timestamp ASC;`,\n                []\n            );\n\n            const messages = (res.values || []).map((m: any) => ({\n                id: m.id,\n                text: m.text,\n                senderId: m.senderId,\n                senderAlias: m.senderAlias,\n                senderGender: m.senderGender,\n                timestamp: m.timestamp,\n                recipientId: m.recipientId\n            })) as Message[];\n\n            // Group by peer ID\n            const chatMap = new Map<string, Message[]>();\n            for (const msg of messages) {\n                const peerId = msg.senderId === currentUserId ? msg.recipientId! : msg.senderId;\n                if (!chatMap.has(peerId)) {\n                    chatMap.set(peerId, []);\n                }\n                chatMap.get(peerId)!.push(msg);\n            }\n\n            return Array.from(chatMap.entries()).map(([peerId, msgs]) => ({\n                peerId,\n                messages: msgs\n            }));\n        } catch (err) {\n            console.error('Error loading private chats from SQLite:', err);\n            return [];\n        }\n    }\n}\n\nexport const sqliteService = new SQLiteService();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/GlobalChat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, memo, useCallback } from 'react';\nimport { User, Message, Gender } from '@/types';\nimport { Virtuoso, VirtuosoHandle } from 'react-virtuoso';\n\ninterface GlobalChatProps {\n  user: User;\n  messages: Message[];\n  onSendMessage: (text: string) => void;\n  onlineCount: number;\n  isOnline: boolean;\n  hideHeader?: boolean;\n  headerTitle?: string;\n  showBottomNavPadding?: boolean;\n  isFocused?: boolean;\n  onInputFocusChange?: (isFocused: boolean) => void;\n  isSyncing?: boolean;\n}\n\nconst GenderIcon = memo(({ gender, className }: { gender: Gender; className?: string }) => {\n  if (gender === 'male') {\n    return (\n      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n        <path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"></path>\n        <circle cx=\"12\" cy=\"7\" r=\"4\"></circle>\n      </svg>\n    );\n  }\n  if (gender === 'female') {\n    return (\n      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n        <path d=\"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z\"></path>\n        <path d=\"M18 22H6c0-4 4-3 6-3s6-1 6 3Z\"></path>\n      </svg>\n    );\n  }\n  return (\n    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n      <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n      <circle cx=\"12\" cy=\"10\" r=\"3\"></circle>\n      <path d=\"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662\"></path>\n    </svg>\n  );\n});\n\nconst ChatInput = memo(({ onSendMessage, showBottomNavPadding, onFocusChange, isFocused }: {\n  onSendMessage: (text: string) => void,\n  showBottomNavPadding?: boolean,\n  onFocusChange?: (isFocused: boolean) => void,\n  isFocused?: boolean\n}) => {\n  const [text, setText] = useState('');\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Removed unnecessary blur on mount that could interfere with initial user interaction\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (text.trim()) {\n      onSendMessage(text.trim());\n      setText('');\n      inputRef.current?.blur();\n    }\n  };\n\n  // Stabilized padding calculation to prevent the input from jumping and cancelling taps\n  const footerPadding = isFocused\n    ? 'pb-4 pt-3'\n    : showBottomNavPadding\n      ? 'pb-[calc(70px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[90px] pt-4'\n      : 'py-4';\n\n  return (\n    <footer className={`px-3 py-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${footerPadding}`}>\n      <form onSubmit={handleSubmit} className=\"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto\">\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          onFocus={() => onFocusChange?.(true)}\n          onBlur={() => onFocusChange?.(false)}\n          placeholder=\"Messaggio alla stanza...\"\n          className=\"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400\"\n          style={{ fontSize: '16px' }}\n        />\n        <button\n          type=\"submit\"\n          className=\"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform\"\n          onMouseDown={(e) => e.preventDefault()}\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 rotate-45\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n          </svg>\n        </button>\n      </form>\n    </footer>\n  );\n});\n\nconst GlobalChat: React.FC<GlobalChatProps> = ({\n  user,\n  messages,\n  onSendMessage,\n  onlineCount,\n  isOnline,\n  hideHeader,\n  headerTitle,\n  showBottomNavPadding,\n  onInputFocusChange,\n  isFocused,\n  isSyncing\n}) => {\n  const virtuosoRef = useRef<VirtuosoHandle>(null);\n\n  const getAvatarColor = (gender: string) => {\n    switch (gender) {\n      case 'male': return 'bg-blue-500';\n      case 'female': return 'bg-pink-500';\n      default: return 'bg-purple-500';\n    }\n  };\n\n  const renderMessage = useCallback((index: number, msg: Message) => {\n    const isMe = msg.senderId === user.id;\n    const showSenderInfo = index === 0 || messages[index - 1].senderId !== msg.senderId;\n\n    return (\n      <div className={`flex ${isMe ? 'justify-end' : 'justify-start'} animate-message pb-4 px-4`}>\n        <div className={`flex flex-col max-w-[85%] ${isMe ? 'items-end' : 'items-start'}`}>\n          {showSenderInfo && (\n            <span className={`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${isMe ? 'text-emerald-700' : 'text-gray-600'}`}>\n              {!isMe && (\n                <div className={`w-3.5 h-3.5 rounded-full flex items-center justify-center ${getAvatarColor(msg.senderGender)}`}>\n                  <GenderIcon gender={msg.senderGender} className=\"w-2 h-2 text-white\" />\n                </div>\n              )}\n              {isMe ? 'Tu' : msg.senderAlias}\n            </span>\n          )}\n          <div className={`px-3 py-2 rounded-2xl shadow-sm ${isMe ? 'bg-emerald-500 text-white rounded-tr-none' : 'bg-white text-gray-800 rounded-tl-none border border-gray-100'}`}>\n            <p className=\"whitespace-pre-wrap break-words leading-relaxed text-[15px]\">{msg.text}</p>\n          </div>\n          <span className=\"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70\">\n            {new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n          </span>\n        </div>\n      </div>\n    );\n  }, [user.id, messages]);\n\n  return (\n    <div className=\"w-full h-full flex flex-col bg-white\">\n      {!hideHeader && (\n        <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 shrink-0\">\n          <div className=\"h-[60px] px-4 flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 text-emerald-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n                </svg>\n              </div>\n              <div>\n                <h2 className=\"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight\">{headerTitle || 'Stanza'}</h2>\n                <div className=\"flex items-center gap-1.5\">\n                  <span className={`w-2 h-2 rounded-full ${isOnline ? 'bg-emerald-500' : 'bg-red-500'}`}></span>\n                  <p className=\"text-[11px] font-bold text-emerald-600 uppercase tracking-wide\">\n                    {isOnline ? `${onlineCount} persone qui` : 'Disconnesso'}\n                  </p>\n                </div>\n              </div>\n            </div>\n            {isSyncing && (\n              <div className=\"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse\">\n                <svg className=\"animate-spin h-3 w-3 text-emerald-600\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                <span className=\"text-[10px] font-bold text-emerald-700 tracking-wide uppercase\">Sincronizzazione</span>\n              </div>\n            )}\n          </div>\n        </header>\n      )}\n\n      <div className=\"flex-1 overflow-hidden relative chat-bg\">\n        <Virtuoso\n          ref={virtuosoRef}\n          data={messages}\n          initialTopMostItemIndex={messages.length - 1}\n          itemContent={renderMessage}\n          followOutput=\"smooth\"\n          className=\"h-full w-full\"\n          alignToBottom={true}\n        />\n      </div>\n\n      <ChatInput\n        onSendMessage={onSendMessage}\n        showBottomNavPadding={showBottomNavPadding}\n        onFocusChange={onInputFocusChange}\n        isFocused={isFocused}\n      />\n    </div>\n  );\n};\n\nexport default GlobalChat;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 631, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/BottomNav.tsx"],"sourcesContent":["import React from 'react';\n\ntype Tab = 'room' | 'users' | 'chats' | 'settings';\n\ninterface BottomNavProps {\n    activeTab: Tab;\n    onTabChange: (tab: Tab) => void;\n    usersCount: number;\n    unreadChatsCount: number;\n}\n\nconst BottomNav: React.FC<BottomNavProps> = ({ activeTab, onTabChange, usersCount, unreadChatsCount }) => {\n    return (\n        <nav className=\"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]\">\n\n            {/* Tab 1: Room */}\n            <button\n                onClick={() => onTabChange('room')}\n                className={`flex flex-col items-center justify-center w-full relative ${activeTab === 'room' ? 'text-emerald-700' : 'text-gray-500'}`}\n            >\n                <div className=\"relative\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'room' ? 2.6 : 2.2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n                    </svg>\n                    {usersCount > 0 && (\n                        <span className=\"absolute -top-0.5 -right-1.5 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white\">\n                            {usersCount}\n                        </span>\n                    )}\n                </div>\n                <span className={`text-[10px] mt-1 ${activeTab === 'room' ? 'font-bold' : 'font-semibold'}`}>Stanza</span>\n            </button>\n\n            {/* Tab 2: Users */}\n            <button\n                onClick={() => onTabChange('users')}\n                className={`flex flex-col items-center justify-center w-full relative ${activeTab === 'users' ? 'text-emerald-700' : 'text-gray-500'}`}\n            >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'users' ? 2.6 : 2.2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" />\n                </svg>\n                <span className={`text-[10px] mt-1 ${activeTab === 'users' ? 'font-bold' : 'font-semibold'}`}>Utenti</span>\n            </button>\n\n            {/* Tab 3: Chats */}\n            <button\n                onClick={() => onTabChange('chats')}\n                className={`flex flex-col items-center justify-center w-full relative ${activeTab === 'chats' ? 'text-emerald-700' : 'text-gray-500'}`}\n            >\n                <div className=\"relative\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'chats' ? 2.6 : 2.2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n                    </svg>\n                    {unreadChatsCount > 0 && (\n                        <span className=\"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white\">\n                            {unreadChatsCount}\n                        </span>\n                    )}\n                </div>\n                <span className={`text-[10px] mt-1 ${activeTab === 'chats' ? 'font-bold' : 'font-semibold'}`}>Chats</span>\n            </button>\n\n            {/* Tab 4: Settings */}\n            <button\n                onClick={() => onTabChange('settings')}\n                className={`flex flex-col items-center justify-center w-full relative ${activeTab === 'settings' ? 'text-emerald-700' : 'text-gray-500'}`}\n            >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'settings' ? 2.6 : 2.2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                </svg>\n                <span className={`text-[10px] mt-1 ${activeTab === 'settings' ? 'font-bold' : 'font-semibold'}`}>Me</span>\n            </button>\n        </nav>\n    );\n};\n\nexport default BottomNav;\n\n"],"names":[],"mappings":";;;;;;AAWA,MAAM,YAAsC,CAAC,EAAE,SAAS,EAAE,WAAW,EAAE,UAAU,EAAE,gBAAgB,EAAE;IACjG,qBACI,6LAAC;QAAI,WAAU;;0BAGX,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,0DAA0D,EAAE,cAAc,SAAS,qBAAqB,iBAAiB;;kCAErI,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa,cAAc,SAAS,MAAM;oCAAK,GAAE;;;;;;;;;;;4BAEvG,aAAa,mBACV,6LAAC;gCAAK,WAAU;0CACX;;;;;;;;;;;;kCAIb,6LAAC;wBAAK,WAAW,CAAC,iBAAiB,EAAE,cAAc,SAAS,cAAc,iBAAiB;kCAAE;;;;;;;;;;;;0BAIjG,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,0DAA0D,EAAE,cAAc,UAAU,qBAAqB,iBAAiB;;kCAEtI,6LAAC;wBAAI,OAAM;wBAA6B,WAAU;wBAAwB,MAAK;wBAAO,SAAQ;wBAAY,QAAO;kCAC7G,cAAA,6LAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,aAAa,cAAc,UAAU,MAAM;4BAAK,GAAE;;;;;;;;;;;kCAEzG,6LAAC;wBAAK,WAAW,CAAC,iBAAiB,EAAE,cAAc,UAAU,cAAc,iBAAiB;kCAAE;;;;;;;;;;;;0BAIlG,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,0DAA0D,EAAE,cAAc,UAAU,qBAAqB,iBAAiB;;kCAEtI,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa,cAAc,UAAU,MAAM;oCAAK,GAAE;;;;;;;;;;;4BAExG,mBAAmB,mBAChB,6LAAC;gCAAK,WAAU;0CACX;;;;;;;;;;;;kCAIb,6LAAC;wBAAK,WAAW,CAAC,iBAAiB,EAAE,cAAc,UAAU,cAAc,iBAAiB;kCAAE;;;;;;;;;;;;0BAIlG,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,0DAA0D,EAAE,cAAc,aAAa,qBAAqB,iBAAiB;;kCAEzI,6LAAC;wBAAI,OAAM;wBAA6B,WAAU;wBAAwB,MAAK;wBAAO,SAAQ;wBAAY,QAAO;kCAC7G,cAAA,6LAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,aAAa,cAAc,aAAa,MAAM;4BAAK,GAAE;;;;;;;;;;;kCAE5G,6LAAC;wBAAK,WAAW,CAAC,iBAAiB,EAAE,cAAc,aAAa,cAAc,iBAAiB;kCAAE;;;;;;;;;;;;;;;;;;AAIjH;KA/DM;uCAiES"}},
    {"offset": {"line": 849, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/UserList.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { User, Gender } from '@/types';\n\ninterface UserListProps {\n    currentUser: User;\n    users: (User & { socketId: string })[];\n    onStartChat: (targetUser: User) => void;\n}\n\nconst UserList: React.FC<UserListProps> = ({ currentUser, users, onStartChat }) => {\n    const [searchQuery, setSearchQuery] = useState('');\n\n    // Filter out self and apply search query\n    const otherUsers = users.filter(u =>\n        u.id !== currentUser.id &&\n        u.alias.toLowerCase().includes(searchQuery.toLowerCase())\n    );\n\n    const getAvatarColor = (gender: Gender) => {\n        switch (gender) {\n            case 'male': return 'bg-blue-500';\n            case 'female': return 'bg-pink-500';\n            default: return 'bg-purple-500';\n        }\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 transition-all\">\n                <div className=\"h-[60px] px-4 flex items-center justify-between\">\n                    <h1 className=\"text-2xl font-extrabold text-gray-900 tracking-tight\">Utenti</h1>\n                    <span className=\"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide\">\n                        {users.length} Online\n                    </span>\n                </div>\n\n                {/* Search Bar */}\n                <div className=\"px-4 pb-3\">\n                    <div className=\"relative group\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                            </svg>\n                        </div>\n                        <input\n                            type=\"text\"\n                            placeholder=\"Cerca utente per nome...\"\n                            value={searchQuery}\n                            onChange={(e) => setSearchQuery(e.target.value)}\n                            className=\"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm\"\n                        />\n                        {searchQuery && (\n                            <button\n                                onClick={() => setSearchQuery('')}\n                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors\"\n                            >\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M6 18L18 6M6 6l12 12\" />\n                                </svg>\n                            </button>\n                        )}\n                    </div>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto p-4 pb-[80px]\">\n                {otherUsers.length === 0 ? (\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400 space-y-4\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 opacity-20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" />\n                        </svg>\n                        <p className=\"text-center font-medium\">\n                            {searchQuery ? 'Nessun utente trovato.' : 'Nessun altro utente online al momento.'}\n                        </p>\n                    </div>\n                ) : (\n                    <ul className=\"space-y-4\">\n                        {otherUsers.map(user => (\n                            <li key={user.id} className=\"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0\">\n                                <div className={`w-12 h-12 rounded-full ${getAvatarColor(user.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`}>\n                                    <span className=\"font-bold text-lg uppercase\">{user.alias.charAt(0)}</span>\n                                    <div className=\"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full\"></div>\n                                </div>\n                                <div className=\"flex-1 min-w-0\">\n                                    <h3 className=\"font-bold text-gray-900 truncate text-base\">{user.alias}</h3>\n                                    <p className=\"text-sm text-gray-500 truncate\">\n                                        {user.status || <span className=\"capitalize\">{user.gender}</span>}\n                                    </p>\n                                </div>\n                                <button\n                                    onClick={() => onStartChat(user)}\n                                    className=\"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors\"\n                                >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                                    </svg>\n                                </button>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n            </main>\n        </div>\n    );\n};\n\nexport default UserList;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1161, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/ChatList.tsx"],"sourcesContent":["import React from 'react';\nimport { User, Message, Gender } from '@/types';\n\ninterface PrivateChatSession {\n    peer: User;\n    messages: Message[];\n    unreadCount: number;\n}\n\ninterface ChatListProps {\n    chats: PrivateChatSession[];\n    onSelectChat: (peerId: string) => void;\n    onDeleteChat: (peerId: string) => void;\n}\n\nconst ChatList: React.FC<ChatListProps> = ({ chats, onSelectChat, onDeleteChat }) => {\n    const getAvatarColor = (gender: Gender) => {\n        switch (gender) {\n            case 'male': return 'bg-blue-500';\n            case 'female': return 'bg-pink-500';\n            default: return 'bg-purple-500';\n        }\n    };\n\n    const getLastMessage = (msgs: Message[]) => {\n        if (msgs.length === 0) return 'Inizia la conversazione...';\n        return msgs[msgs.length - 1].text;\n    };\n\n    const getLastTime = (msgs: Message[]) => {\n        if (msgs.length === 0) return '';\n        const date = new Date(msgs[msgs.length - 1].timestamp);\n        // Se oggi mostra l'ora, altrimenti data\n        const now = new Date();\n        if (date.toDateString() === now.toDateString()) {\n            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n        }\n        return date.toLocaleDateString([], { day: '2-digit', month: '2-digit' });\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10\">\n                <div className=\"h-[60px] px-4 flex items-center justify-between\">\n                    <h1 className=\"text-2xl font-extrabold text-gray-900 tracking-tight\">Chat private</h1>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto p-4 pb-[80px]\">\n                {chats.length === 0 ? (\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400 space-y-4\">\n                        <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                            </svg>\n                        </div>\n                        <p className=\"text-center font-medium\">Nessuna chat attiva.<br />Cerca utenti nella scheda Utenti.</p>\n                    </div>\n                ) : (\n                    <ul className=\"space-y-4\">\n                        {chats.map((chat) => (\n                            <li\n                                key={chat.peer.id}\n                                onClick={() => onSelectChat(chat.peer.id)}\n                                className=\"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0\"\n                            >\n                                <div className={`w-14 h-14 rounded-full ${getAvatarColor(chat.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`}>\n                                    <span className=\"font-bold text-xl uppercase\">{chat.peer.alias.charAt(0)}</span>\n                                </div>\n\n                                <div className=\"flex-1 min-w-0\">\n                                    <div className=\"flex justify-between items-baseline mb-1\">\n                                        <h3 className=\"font-bold text-gray-900 truncate text-base\">{chat.peer.alias}</h3>\n                                        <span className=\"text-[11px] text-gray-400 font-medium\">{getLastTime(chat.messages)}</span>\n                                    </div>\n                                    <p className=\"text-sm text-gray-500 truncate\">{getLastMessage(chat.messages)}</p>\n                                </div>\n\n                                <div className=\"flex items-center gap-2\">\n                                    {chat.unreadCount > 0 && (\n                                        <div className=\"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center\">\n                                            <span className=\"text-[10px] font-bold text-white\">{chat.unreadCount}</span>\n                                        </div>\n                                    )}\n\n                                    <button\n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            onDeleteChat(chat.peer.id);\n                                        }}\n                                        className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                                        </svg>\n                                    </button>\n                                </div>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n            </main>\n        </div>\n    );\n};\n\nexport default ChatList;\n"],"names":[],"mappings":";;;;;;AAeA,MAAM,WAAoC,CAAC,EAAE,KAAK,EAAE,YAAY,EAAE,YAAY,EAAE;IAC5E,MAAM,iBAAiB,CAAC;QACpB,OAAQ;YACJ,KAAK;gBAAQ,OAAO;YACpB,KAAK;gBAAU,OAAO;YACtB;gBAAS,OAAO;QACpB;IACJ;IAEA,MAAM,iBAAiB,CAAC;QACpB,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAC9B,OAAO,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,CAAC,IAAI;IACrC;IAEA,MAAM,cAAc,CAAC;QACjB,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAC9B,MAAM,OAAO,IAAI,KAAK,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,CAAC,SAAS;QACrD,wCAAwC;QACxC,MAAM,MAAM,IAAI;QAChB,IAAI,KAAK,YAAY,OAAO,IAAI,YAAY,IAAI;YAC5C,OAAO,KAAK,kBAAkB,CAAC,EAAE,EAAE;gBAAE,MAAM;gBAAW,QAAQ;YAAU;QAC5E;QACA,OAAO,KAAK,kBAAkB,CAAC,EAAE,EAAE;YAAE,KAAK;YAAW,OAAO;QAAU;IAC1E;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAG,WAAU;kCAAuD;;;;;;;;;;;;;;;;0BAI7E,6LAAC;gBAAK,WAAU;0BACX,MAAM,MAAM,KAAK,kBACd,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa;oCAAG,GAAE;;;;;;;;;;;;;;;;sCAG7E,6LAAC;4BAAE,WAAU;;gCAA0B;8CAAoB,6LAAC;;;;;gCAAK;;;;;;;;;;;;6EAGrE,6LAAC;oBAAG,WAAU;8BACT,MAAM,GAAG,CAAC,CAAC,qBACR,6LAAC;4BAEG,SAAS,IAAM,aAAa,KAAK,IAAI,CAAC,EAAE;4BACxC,WAAU;;8CAEV,6LAAC;oCAAI,WAAW,CAAC,uBAAuB,EAAE,eAAe,KAAK,IAAI,CAAC,MAAM,EAAE,wEAAwE,CAAC;8CAChJ,cAAA,6LAAC;wCAAK,WAAU;kDAA+B,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;;;;;;;;;;;8CAG1E,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDAAG,WAAU;8DAA8C,KAAK,IAAI,CAAC,KAAK;;;;;;8DAC3E,6LAAC;oDAAK,WAAU;8DAAyC,YAAY,KAAK,QAAQ;;;;;;;;;;;;sDAEtF,6LAAC;4CAAE,WAAU;sDAAkC,eAAe,KAAK,QAAQ;;;;;;;;;;;;8CAG/E,6LAAC;oCAAI,WAAU;;wCACV,KAAK,WAAW,GAAG,mBAChB,6LAAC;4CAAI,WAAU;sDACX,cAAA,6LAAC;gDAAK,WAAU;0DAAoC,KAAK,WAAW;;;;;;;;;;;sDAI5E,6LAAC;4CACG,SAAS,CAAC;gDACN,EAAE,eAAe;gDACjB,aAAa,KAAK,IAAI,CAAC,EAAE;4CAC7B;4CACA,WAAU;sDAEV,cAAA,6LAAC;gDAAI,OAAM;gDAA6B,WAAU;gDAAU,MAAK;gDAAO,SAAQ;gDAAY,QAAO;0DAC/F,cAAA,6LAAC;oDAAK,eAAc;oDAAQ,gBAAe;oDAAQ,aAAa;oDAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;;2BA/B5E,KAAK,IAAI,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;AA0CjD;KAzFM;uCA2FS"}},
    {"offset": {"line": 1430, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/Settings.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { User } from '@/types';\n\ninterface SettingsProps {\n    user: User;\n    onLogout: () => void;\n    onUpdateAlias: (newAlias: string) => void;\n    onUpdateStatus: (newStatus: string) => void;\n}\n\nconst Settings: React.FC<SettingsProps> = ({ user, onLogout, onUpdateAlias, onUpdateStatus }) => {\n    const [isEditingAlias, setIsEditingAlias] = useState(false);\n    const [isEditingStatus, setIsEditingStatus] = useState(false);\n    const [newAlias, setNewAlias] = useState(user.alias);\n    const [newStatus, setNewStatus] = useState(user.status || '');\n\n    const handleSaveAlias = () => {\n        if (newAlias.trim() && newAlias !== user.alias) {\n            onUpdateAlias(newAlias.trim());\n        }\n        setIsEditingAlias(false);\n    };\n\n    const handleSaveStatus = () => {\n        if (newStatus.trim() !== (user.status || '')) {\n            onUpdateStatus(newStatus.trim());\n        }\n        setIsEditingStatus(false);\n    };\n\n    const genderLabels: Record<string, string> = {\n        male: 'maschio',\n        female: 'femmina',\n        other: 'altro'\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-gray-50\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10\">\n                <div className=\"h-[60px] px-4 flex items-center\">\n                    <h1 className=\"text-2xl font-extrabold text-gray-900 tracking-tight\">Profilo</h1>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto\">\n                <div className=\"pb-32\">\n\n                    {/* Avatar Section - Photo edit removed as requested */}\n                    <div className=\"py-8 flex flex-col items-center bg-white border-b border-gray-100\">\n                        <div className=\"relative group\">\n                            <div className=\"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden\">\n                                {user.alias.charAt(0).toUpperCase()}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Info Groups */}\n                    <div className=\"mt-6 space-y-6\">\n                        {/* About Section */}\n                        <div>\n                            <h3 className=\"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider\">Stato</h3>\n                            <div className=\"bg-white border-y border-gray-100\">\n                                <button\n                                    onClick={() => setIsEditingStatus(true)}\n                                    className=\"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors\"\n                                >\n                                    <div className=\"flex flex-col items-start truncate overflow-hidden\">\n                                        {isEditingStatus ? (\n                                            <input\n                                                type=\"text\"\n                                                value={newStatus}\n                                                onChange={(e) => setNewStatus(e.target.value)}\n                                                onBlur={handleSaveStatus}\n                                                onKeyDown={(e) => e.key === 'Enter' && handleSaveStatus()}\n                                                maxLength={50}\n                                                className=\"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent\"\n                                                autoFocus\n                                            />\n                                        ) : (\n                                            <span className=\"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left\">\n                                                {user.status || 'Disponibile'}\n                                            </span>\n                                        )}\n                                    </div>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 text-gray-300 shrink-0 ml-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5l7 7-7 7\" />\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Name Section */}\n                        <div>\n                            <h3 className=\"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider\">Alias</h3>\n                            <div className=\"bg-white border-y border-gray-100\">\n                                <button\n                                    onClick={() => setIsEditingAlias(true)}\n                                    className=\"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors\"\n                                >\n                                    <div className=\"flex flex-col items-start\">\n                                        {isEditingAlias ? (\n                                            <input\n                                                type=\"text\"\n                                                value={newAlias}\n                                                onChange={(e) => setNewAlias(e.target.value)}\n                                                onBlur={handleSaveAlias}\n                                                onKeyDown={(e) => e.key === 'Enter' && handleSaveAlias()}\n                                                maxLength={20}\n                                                className=\"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent\"\n                                                autoFocus\n                                            />\n                                        ) : (\n                                            <span className=\"text-[17px] text-gray-900\">\n                                                {user.alias}\n                                            </span>\n                                        )}\n                                    </div>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 text-gray-300 shrink-0 ml-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5l7 7-7 7\" />\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Account Info Section */}\n                        <div>\n                            <h3 className=\"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider\">Informazioni</h3>\n                            <div className=\"bg-white border-y border-gray-100 divide-y divide-gray-50\">\n                                <div className=\"px-4 py-3.5 flex items-center justify-between\">\n                                    <span className=\"text-[17px] text-gray-400\">Sesso</span>\n                                    <span className=\"text-[17px] text-gray-900 capitalize\">{genderLabels[user.gender] || user.gender}</span>\n                                </div>\n                                <div className=\"px-4 py-3.5 flex items-center justify-between\">\n                                    <span className=\"text-[17px] text-gray-400\">User ID</span>\n                                    <span className=\"text-xs font-mono text-gray-400 uppercase tracking-wider\">{user.id}</span>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Actions Section */}\n                        <div className=\"pt-4\">\n                            <div className=\"bg-white border-y border-gray-100\">\n                                <button\n                                    onClick={onLogout}\n                                    className=\"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors\"\n                                >\n                                    Esci\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </main>\n        </div>\n    );\n};\n\nexport default Settings;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1815, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/hooks/useSwipeBack.ts"],"sourcesContent":["import { useState, useRef, useCallback, TouchEvent } from 'react';\n\ninterface UseSwipeBackOptions {\n    onSwipeBack: () => void;\n    edgeWidth?: number;      // How far from left edge to start gesture (default: 30px)\n    threshold?: number;      // Min swipe distance to trigger back (default: 100px)\n    enabled?: boolean;       // Enable/disable the gesture\n}\n\ninterface SwipeBackState {\n    isDragging: boolean;\n    translateX: number;\n    opacity: number;\n}\n\nexport function useSwipeBack({\n    onSwipeBack,\n    edgeWidth = 30,\n    threshold = 100,\n    enabled = true\n}: UseSwipeBackOptions) {\n    const [state, setState] = useState<SwipeBackState>({\n        isDragging: false,\n        translateX: 0,\n        opacity: 1\n    });\n\n    const startX = useRef(0);\n    const startY = useRef(0);\n    const isEdgeSwipe = useRef(false);\n    const hasTriggered = useRef(false);\n\n    const handleTouchStart = useCallback((e: TouchEvent) => {\n        if (!enabled) return;\n\n        const touch = e.touches[0];\n        startX.current = touch.clientX;\n        startY.current = touch.clientY;\n\n        // Check if touch started from left edge\n        isEdgeSwipe.current = touch.clientX <= edgeWidth;\n        hasTriggered.current = false;\n\n        if (isEdgeSwipe.current) {\n            setState({ isDragging: true, translateX: 0, opacity: 1 });\n        }\n    }, [enabled, edgeWidth]);\n\n    const handleTouchMove = useCallback((e: TouchEvent) => {\n        if (!enabled || !isEdgeSwipe.current || hasTriggered.current) return;\n\n        const touch = e.touches[0];\n        const deltaX = touch.clientX - startX.current;\n        const deltaY = Math.abs(touch.clientY - startY.current);\n\n        // If vertical movement is greater, it's a scroll - cancel swipe\n        if (deltaY > 30 && deltaX < 30) {\n            isEdgeSwipe.current = false;\n            setState({ isDragging: false, translateX: 0, opacity: 1 });\n            return;\n        }\n\n        // Only allow right-to-left swipe (positive deltaX)\n        if (deltaX > 0) {\n            // Calculate translateX with some resistance\n            const translateX = Math.min(deltaX * 0.8, window.innerWidth);\n            const opacity = 1 - (translateX / window.innerWidth) * 0.3;\n\n            setState({ isDragging: true, translateX, opacity });\n\n            // Prevent scroll while swiping\n            e.preventDefault();\n        }\n    }, [enabled]);\n\n    const handleTouchEnd = useCallback(() => {\n        if (!enabled || !isEdgeSwipe.current || hasTriggered.current) {\n            setState({ isDragging: false, translateX: 0, opacity: 1 });\n            return;\n        }\n\n        const { translateX } = state;\n\n        if (translateX >= threshold) {\n            // Trigger back navigation\n            hasTriggered.current = true;\n            setState({ isDragging: false, translateX: window.innerWidth, opacity: 0 });\n\n            // Delay callback to allow animation\n            setTimeout(() => {\n                onSwipeBack();\n                setState({ isDragging: false, translateX: 0, opacity: 1 });\n            }, 150);\n        } else {\n            // Spring back to original position\n            setState({ isDragging: false, translateX: 0, opacity: 1 });\n        }\n\n        isEdgeSwipe.current = false;\n    }, [enabled, state, threshold, onSwipeBack]);\n\n    const swipeHandlers = {\n        onTouchStart: handleTouchStart,\n        onTouchMove: handleTouchMove,\n        onTouchEnd: handleTouchEnd,\n    };\n\n    const swipeStyle = {\n        transform: `translateX(${state.translateX}px)`,\n        transition: state.isDragging ? 'none' : 'transform 0.2s ease-out, opacity 0.2s ease-out',\n        opacity: state.opacity,\n    };\n\n    return {\n        swipeHandlers,\n        swipeStyle,\n        isDragging: state.isDragging,\n        translateX: state.translateX\n    };\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAeO,SAAS,aAAa,EACzB,WAAW,EACX,YAAY,EAAE,EACd,YAAY,GAAG,EACf,UAAU,IAAI,EACI;;IAClB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAiB;QAC/C,YAAY;QACZ,YAAY;QACZ,SAAS;IACb;IAEA,MAAM,SAAS,IAAA,uKAAM,EAAC;IACtB,MAAM,SAAS,IAAA,uKAAM,EAAC;IACtB,MAAM,cAAc,IAAA,uKAAM,EAAC;IAC3B,MAAM,eAAe,IAAA,uKAAM,EAAC;IAE5B,MAAM,mBAAmB,IAAA,4KAAW;sDAAC,CAAC;YAClC,IAAI,CAAC,SAAS;YAEd,MAAM,QAAQ,EAAE,OAAO,CAAC,EAAE;YAC1B,OAAO,OAAO,GAAG,MAAM,OAAO;YAC9B,OAAO,OAAO,GAAG,MAAM,OAAO;YAE9B,wCAAwC;YACxC,YAAY,OAAO,GAAG,MAAM,OAAO,IAAI;YACvC,aAAa,OAAO,GAAG;YAEvB,IAAI,YAAY,OAAO,EAAE;gBACrB,SAAS;oBAAE,YAAY;oBAAM,YAAY;oBAAG,SAAS;gBAAE;YAC3D;QACJ;qDAAG;QAAC;QAAS;KAAU;IAEvB,MAAM,kBAAkB,IAAA,4KAAW;qDAAC,CAAC;YACjC,IAAI,CAAC,WAAW,CAAC,YAAY,OAAO,IAAI,aAAa,OAAO,EAAE;YAE9D,MAAM,QAAQ,EAAE,OAAO,CAAC,EAAE;YAC1B,MAAM,SAAS,MAAM,OAAO,GAAG,OAAO,OAAO;YAC7C,MAAM,SAAS,KAAK,GAAG,CAAC,MAAM,OAAO,GAAG,OAAO,OAAO;YAEtD,gEAAgE;YAChE,IAAI,SAAS,MAAM,SAAS,IAAI;gBAC5B,YAAY,OAAO,GAAG;gBACtB,SAAS;oBAAE,YAAY;oBAAO,YAAY;oBAAG,SAAS;gBAAE;gBACxD;YACJ;YAEA,mDAAmD;YACnD,IAAI,SAAS,GAAG;gBACZ,4CAA4C;gBAC5C,MAAM,aAAa,KAAK,GAAG,CAAC,SAAS,KAAK,OAAO,UAAU;gBAC3D,MAAM,UAAU,IAAI,AAAC,aAAa,OAAO,UAAU,GAAI;gBAEvD,SAAS;oBAAE,YAAY;oBAAM;oBAAY;gBAAQ;gBAEjD,+BAA+B;gBAC/B,EAAE,cAAc;YACpB;QACJ;oDAAG;QAAC;KAAQ;IAEZ,MAAM,iBAAiB,IAAA,4KAAW;oDAAC;YAC/B,IAAI,CAAC,WAAW,CAAC,YAAY,OAAO,IAAI,aAAa,OAAO,EAAE;gBAC1D,SAAS;oBAAE,YAAY;oBAAO,YAAY;oBAAG,SAAS;gBAAE;gBACxD;YACJ;YAEA,MAAM,EAAE,UAAU,EAAE,GAAG;YAEvB,IAAI,cAAc,WAAW;gBACzB,0BAA0B;gBAC1B,aAAa,OAAO,GAAG;gBACvB,SAAS;oBAAE,YAAY;oBAAO,YAAY,OAAO,UAAU;oBAAE,SAAS;gBAAE;gBAExE,oCAAoC;gBACpC;gEAAW;wBACP;wBACA,SAAS;4BAAE,YAAY;4BAAO,YAAY;4BAAG,SAAS;wBAAE;oBAC5D;+DAAG;YACP,OAAO;gBACH,mCAAmC;gBACnC,SAAS;oBAAE,YAAY;oBAAO,YAAY;oBAAG,SAAS;gBAAE;YAC5D;YAEA,YAAY,OAAO,GAAG;QAC1B;mDAAG;QAAC;QAAS;QAAO;QAAW;KAAY;IAE3C,MAAM,gBAAgB;QAClB,cAAc;QACd,aAAa;QACb,YAAY;IAChB;IAEA,MAAM,aAAa;QACf,WAAW,CAAC,WAAW,EAAE,MAAM,UAAU,CAAC,GAAG,CAAC;QAC9C,YAAY,MAAM,UAAU,GAAG,SAAS;QACxC,SAAS,MAAM,OAAO;IAC1B;IAEA,OAAO;QACH;QACA;QACA,YAAY,MAAM,UAAU;QAC5B,YAAY,MAAM,UAAU;IAChC;AACJ;GAxGgB"}},
    {"offset": {"line": 1958, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/lib/auth-client.ts"],"sourcesContent":["import { createAuthClient } from \"better-auth/react\";\nimport { passkeyClient } from \"@better-auth/passkey/client\";\nimport { anonymousClient } from \"better-auth/client/plugins\";\n\nexport const authClient = createAuthClient({\n    baseURL: typeof window !== 'undefined' ? window.location.origin : (process.env.NEXT_PUBLIC_BETTER_AUTH_URL || \"http://localhost:3000\"),\n    plugins: [\n        passkeyClient(),\n        anonymousClient()\n    ]\n});\n\nexport const { signIn, signUp, useSession, signOut } = authClient;\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AAAA;;;;AAEO,MAAM,aAAa,IAAA,0MAAgB,EAAC;IACvC,SAAS,uCAAgC,OAAO,QAAQ,CAAC,MAAM,GAAG;IAClE,SAAS;QACL,IAAA,kLAAa;QACb,IAAA,+LAAe;KAClB;AACL;AAEO,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG"}},
    {"offset": {"line": 1992, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/ChatInterface.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io, Socket } from 'socket.io-client';\nimport { User, Message, Tenant } from '@/types';\nimport { API_BASE_URL } from '@/config';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { sqliteService } from '@/lib/sqlite';\nimport { Keyboard, KeyboardResize } from '@capacitor/keyboard';\nimport { Haptics, ImpactStyle } from '@capacitor/haptics';\nimport { StatusBar, Style } from '@capacitor/status-bar';\nimport { Capacitor } from '@capacitor/core';\n\n// UI Components\nimport Login from './Login';\nimport GlobalChat from './GlobalChat';\nimport BottomNav from './BottomNav';\nimport UserList from './UserList';\nimport ChatList from './ChatList';\nimport Settings from './Settings';\nimport { useSwipeBack } from '@/hooks/useSwipeBack';\nimport { useSession, signOut } from '@/lib/auth-client';\n\ninterface ChatInterfaceProps {\n    tenant: Tenant;\n    initialMessages: Message[];\n}\n\ntype Tab = 'room' | 'users' | 'chats' | 'settings';\ntype PrivateChatsMap = Record<string, { peer: User; messages: Message[]; unread: number }>;\n\nexport default function ChatInterface({ tenant, initialMessages }: ChatInterfaceProps) {\n    const [currentUser, setCurrentUser] = useState<User | null>(null);\n    const [socket, setSocket] = useState<Socket | null>(null);\n    const { data: session, isPending: isSessionLoading } = useSession();\n\n    // UI State\n    const [activeTab, setActiveTab] = useState<Tab>('room');\n    const [selectedChatPeerId, setSelectedChatPeerId] = useState<string | null>(null);\n    const [isInputFocused, setIsInputFocused] = useState(false);\n\n    // Data State\n    const [onlineUsers, setOnlineUsers] = useState<(User & { socketId: string })[]>([]);\n    const [privateChats, setPrivateChats] = useState<PrivateChatsMap>({});\n    const [isConnected, setIsConnected] = useState(false);\n\n\n    const queryClient = useQueryClient();\n\n    // 1. Initial Data Fetching (Offline-First)\n    const { data: messages = initialMessages, isFetching: isFetchingGlobal } = useQuery({\n        queryKey: ['messages', 'global', tenant.slug],\n        queryFn: async () => {\n            // First load from SQLite\n            const localMessages = await sqliteService.getMessages(true);\n\n            // In a real app, you'd fetch from API here and update SQLite\n            // For now, we simulate API fetch by returning initialMessages if SQLite is empty\n            // or just returning what we have.\n\n            // Simulate background sync from server\n            try {\n                const response = await fetch(`${API_BASE_URL}/api/messages?tenant=${tenant.slug}`);\n                if (response.ok) {\n                    const serverMessages: Message[] = await response.json();\n                    for (const msg of serverMessages) {\n                        await sqliteService.saveMessage(msg, true);\n                    }\n                    return serverMessages;\n                }\n            } catch (e) {\n                console.warn(\"Failed to fetch from server, using local data\", e);\n            }\n\n            return localMessages.length > 0 ? localMessages : initialMessages;\n        },\n        initialData: initialMessages,\n    });\n\n    // 2. Initialize User, Keyboard and Haptics\n    useEffect(() => {\n        if (!isSessionLoading && session?.user) {\n            const authUser: User = {\n                id: session.user.id,\n                alias: session.user.name || \"User\",\n                gender: (session.user as any).gender || \"other\",\n                status: (session.user as any).status || \"\",\n                phoneNumber: (session.user as any).phoneNumber,\n                joinedAt: new Date(session.user.createdAt).getTime()\n            };\n            setCurrentUser(authUser);\n            localStorage.setItem('chat_user', JSON.stringify(authUser));\n        }\n    }, [session, isSessionLoading]);\n\n    useEffect(() => {\n        if (typeof window !== 'undefined') {\n            const savedUser = localStorage.getItem('chat_user');\n            if (savedUser && !session) {\n                try {\n                    const user = JSON.parse(savedUser);\n                    setCurrentUser(user);\n\n                    // Restore private chats from SQLite (native only)\n                    if (Capacitor.isNativePlatform()) {\n                        sqliteService.getPrivateChats(user.id).then(chats => {\n                            if (chats.length > 0) {\n                                const restoredChats: PrivateChatsMap = {};\n                                for (const chat of chats) {\n                                    const lastMsg = chat.messages[chat.messages.length - 1];\n                                    restoredChats[chat.peerId] = {\n                                        peer: {\n                                            id: chat.peerId,\n                                            alias: lastMsg.senderId === user.id ? 'Chat' : lastMsg.senderAlias,\n                                            gender: lastMsg.senderId === user.id ? 'other' : lastMsg.senderGender,\n                                            joinedAt: Date.now()\n                                        },\n                                        messages: chat.messages,\n                                        unread: 0\n                                    };\n                                }\n                                setPrivateChats(restoredChats);\n                                console.log(`Restored ${chats.length} private chats from SQLite`);\n                            }\n                        }).catch(err => console.error('Error restoring private chats:', err));\n                    }\n                } catch (e) {\n                    console.error(\"Invalid saved user\", e);\n                }\n            }\n\n            // Add platform class to body for targeted CSS\n            const platform = Capacitor.getPlatform();\n            document.documentElement.classList.add(`platform-${platform}`);\n\n            // Keyboard Configuration & Listeners\n            if (Capacitor.isNativePlatform()) {\n                // Use Body resize with zero-delay native patch\n                Keyboard.setResizeMode({ mode: KeyboardResize.Body }).catch(err => {\n                    console.error(\"Error setting keyboard resize mode\", err);\n                });\n\n                // StatusBar Configuration (Programmatic fix for white header standardization)\n                StatusBar.setOverlaysWebView({ overlay: false }).catch(err => {\n                    console.error(\"Error setting StatusBar overlay\", err);\n                });\n                StatusBar.setBackgroundColor({ color: '#ffffff' }).catch(err => {\n                    console.warn(\"StatusBar background color not supported on this platform\", err);\n                });\n                StatusBar.setStyle({ style: Style.Light }).catch(err => {\n                    console.error(\"Error setting StatusBar style\", err);\n                });\n\n                let showListener: any;\n                let hideListener: any;\n\n                const setup = async () => {\n                    showListener = await Keyboard.addListener('keyboardWillShow', () => {\n                        setIsInputFocused(true);\n                    });\n\n                    hideListener = await Keyboard.addListener('keyboardWillHide', () => {\n                        setIsInputFocused(false);\n                    });\n                };\n\n                setup();\n\n                return () => {\n                    if (showListener) showListener.remove();\n                    if (hideListener) hideListener.remove();\n                };\n            }\n        }\n    }, [tenant.slug]);\n\n    // 3. Connect Socket & Handlers\n    useEffect(() => {\n        if (!currentUser) return;\n\n        const newSocket = io(API_BASE_URL || undefined, {\n            query: {\n                tenantSlug: tenant.slug,\n                userId: currentUser.id\n            },\n            transports: ['websocket'],\n            reconnectionAttempts: 5,\n            timeout: 10000\n        });\n\n        setSocket(newSocket);\n\n        newSocket.on('connect_error', (err) => {\n            console.error(\"[Socket] Connect Error:\", err.message, err);\n        });\n\n        newSocket.on('error', (err) => {\n            console.error(\"[Socket] General Error:\", err);\n        });\n\n        newSocket.on('connect', () => {\n            console.log(\"Socket connected\");\n            setIsConnected(true);\n            newSocket.emit('join', { user: currentUser, tenantSlug: tenant.slug });\n        });\n\n        newSocket.on('disconnect', () => {\n            setIsConnected(false);\n        });\n\n        newSocket.on('presenceUpdate', (users: (User & { socketId: string })[]) => {\n            setOnlineUsers(users);\n        });\n\n        newSocket.on('newMessage', async (msg: Message) => {\n            await sqliteService.saveMessage(msg, true);\n            queryClient.invalidateQueries({ queryKey: ['messages', 'global', tenant.slug] });\n        });\n\n        newSocket.on('privateMessage', async (msg: Message) => {\n            const isMe = msg.senderId === currentUser.id;\n            const peerId = isMe ? msg.recipientId! : msg.senderId;\n\n            await sqliteService.saveMessage(msg, false);\n\n            // Haptic feedback for incoming private messages\n            if (!isMe && Capacitor.isNativePlatform()) {\n                Haptics.impact({ style: ImpactStyle.Light }).catch(() => { });\n            }\n\n            setPrivateChats(prev => {\n                const existing = prev[peerId] || {\n                    peer: {\n                        id: peerId,\n                        alias: isMe ? 'Unknown' : msg.senderAlias,\n                        gender: isMe ? 'male' : msg.senderGender,\n                        joinedAt: Date.now()\n                    },\n                    messages: [],\n                    unread: 0\n                };\n\n                if (existing.messages.some(m => m.id === msg.id)) return prev;\n\n                return {\n                    ...prev,\n                    [peerId]: {\n                        ...existing,\n                        messages: [...existing.messages, msg],\n                        unread: existing.unread + 1\n                    }\n                };\n            });\n        });\n\n        return () => {\n            newSocket.disconnect();\n        }\n    }, [currentUser, tenant.slug, queryClient]);\n\n    // 3. Mark read when viewing chat\n    useEffect(() => {\n        if (activeTab === 'chats' && selectedChatPeerId && privateChats[selectedChatPeerId]?.unread > 0) {\n            setPrivateChats(prev => ({\n                ...prev,\n                [selectedChatPeerId]: {\n                    ...prev[selectedChatPeerId],\n                    unread: 0\n                }\n            }));\n        }\n    }, [activeTab, selectedChatPeerId, privateChats]);\n\n\n    // Handlers\n    const handleLogin = (user: User) => {\n        setCurrentUser(user);\n        localStorage.setItem('chat_user', JSON.stringify(user));\n    };\n\n    const handleLogout = async () => {\n        if (session) {\n            await signOut();\n        }\n        setCurrentUser(null);\n        setSocket(null);\n        localStorage.removeItem('chat_user');\n        setPrivateChats({});\n        sqliteService.clearMessages();\n        queryClient.setQueryData(['messages', 'global', tenant.slug], initialMessages);\n        setSelectedChatPeerId(null);\n        setActiveTab('room');\n    };\n\n    const handleUpdateAlias = (newAlias: string) => {\n        if (!currentUser || !socket) return;\n\n        const updatedUser = { ...currentUser, alias: newAlias };\n        setCurrentUser(updatedUser);\n        localStorage.setItem('chat_user', JSON.stringify(updatedUser));\n\n        // Notify server - assuming server handles 'updateAlias' event or just re-join\n        // For simplicity reusing join or we could implement updateAlias on server\n        socket.emit('join', { user: updatedUser, tenantSlug: tenant.slug });\n    };\n\n    const handleUpdateStatus = (newStatus: string) => {\n        if (!currentUser || !socket) return;\n\n        const updatedUser = { ...currentUser, status: newStatus };\n        setCurrentUser(updatedUser);\n        localStorage.setItem('chat_user', JSON.stringify(updatedUser));\n\n        // Notify server of status update\n        socket.emit('join', { user: updatedUser, tenantSlug: tenant.slug });\n    };\n\n    const handleGlobalSend = async (text: string) => {\n        if (!currentUser || !socket) return;\n\n        const tempId = Date.now().toString();\n        const optimisticMsg: Message = {\n            id: tempId,\n            text: text,\n            senderId: currentUser.id,\n            senderAlias: currentUser.alias,\n            senderGender: currentUser.gender,\n            timestamp: new Date().toISOString()\n        };\n\n        // Haptic feedback for local send\n        if (Capacitor.isNativePlatform()) {\n            Haptics.impact({ style: ImpactStyle.Light }).catch(() => { });\n        }\n\n        // Persist to local SQLite immediately\n        await sqliteService.saveMessage(optimisticMsg, true);\n\n        // Update TanStack Query cache optimistically\n        queryClient.setQueryData(['messages', 'global', tenant.slug], (prev: Message[] | undefined) => {\n            return [...(prev || []), optimisticMsg];\n        });\n\n        socket.emit('sendMessage', {\n            ...optimisticMsg,\n            tenantSlug: tenant.slug\n        });\n    };\n\n    const handlePrivateSend = async (text: string) => {\n        if (!currentUser || !socket || !selectedChatPeerId) return;\n\n        const msg: Message = {\n            id: Date.now().toString(),\n            text,\n            senderId: currentUser.id,\n            senderAlias: currentUser.alias,\n            senderGender: currentUser.gender,\n            timestamp: new Date().toISOString(),\n            recipientId: selectedChatPeerId\n        };\n\n        // Haptic feedback for local send\n        if (Capacitor.isNativePlatform()) {\n            Haptics.impact({ style: ImpactStyle.Light }).catch(() => { });\n        }\n\n        // Save to SQLite for offline persistence\n        await sqliteService.saveMessage(msg, false);\n\n        // Optimistic update\n        setPrivateChats(prev => ({\n            ...prev,\n            [selectedChatPeerId]: {\n                ...prev[selectedChatPeerId],\n                messages: [...prev[selectedChatPeerId].messages, msg]\n            }\n        }));\n\n        socket.emit('sendMessage', {\n            ...msg,\n            tenantSlug: tenant.slug,\n            isPrivate: true // Signal to server\n        });\n    }\n\n    const handleStartChat = (peer: User) => {\n        if (!privateChats[peer.id]) {\n            setPrivateChats(prev => ({\n                ...prev,\n                [peer.id]: { peer, messages: [], unread: 0 }\n            }));\n        }\n        setSelectedChatPeerId(peer.id);\n        setActiveTab('chats');\n    };\n\n    const handleDeleteChat = (peerId: string) => {\n        setPrivateChats(prev => {\n            const next = { ...prev };\n            delete next[peerId];\n            return next;\n        });\n        if (selectedChatPeerId === peerId) {\n            setSelectedChatPeerId(null);\n        }\n    };\n\n\n    // Swipe back gesture for private chat\n    const { swipeHandlers, swipeStyle, isDragging } = useSwipeBack({\n        onSwipeBack: () => setSelectedChatPeerId(null),\n        enabled: Capacitor.isNativePlatform() && selectedChatPeerId !== null\n    });\n\n    // Render Login\n    if (!currentUser) {\n        return (\n            <div className=\"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col\">\n                <Login onLogin={handleLogin} tenantName={tenant.name} />\n            </div>\n        );\n    }\n\n    // Render Private Chat View\n    if (selectedChatPeerId && activeTab === 'chats') {\n        const chat = privateChats[selectedChatPeerId];\n        // If chat was deleted but we are here, go back\n        if (!chat) {\n            setSelectedChatPeerId(null);\n            return null;\n        }\n\n        return (\n            <div\n                className=\"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative\"\n                style={swipeStyle}\n                {...swipeHandlers}\n            >\n                {/* Shadow overlay when dragging */}\n                {isDragging && (\n                    <div\n                        className=\"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none\"\n                    />\n                )}\n\n                <header className=\"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0\">\n                    <div className=\"h-[60px] px-4 flex items-center gap-3\">\n                        <button onClick={() => setSelectedChatPeerId(null)} className=\"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                            </svg>\n                        </button>\n                        <div className=\"flex flex-col\">\n                            <h2 className=\"font-bold text-lg leading-tight\">{chat.peer.alias}</h2>\n                            {onlineUsers.some(u => u.id === selectedChatPeerId) && (\n                                <span className=\"text-xs text-emerald-500 font-medium\">Online</span>\n                            )}\n                        </div>\n                    </div>\n                </header>\n\n                <div className=\"flex-1 overflow-hidden relative\">\n                    <GlobalChat\n                        user={currentUser}\n                        messages={chat.messages}\n                        onSendMessage={handlePrivateSend}\n                        onlineCount={0}\n                        isOnline={true}\n                        hideHeader={true}\n                        showBottomNavPadding={false}\n                        onInputFocusChange={setIsInputFocused}\n                        isFocused={isInputFocused}\n                        isSyncing={false} // Private chat sync is separate\n                    />\n                </div>\n            </div>\n        );\n    }\n\n    const totalUnread = Object.values(privateChats).reduce((acc, chat) => acc + chat.unread, 0);\n\n    return (\n        <div\n            className=\"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative\"\n        >\n            <div className=\"flex-1 overflow-hidden relative\">\n                {activeTab === 'room' && (\n                    <GlobalChat\n                        user={currentUser}\n                        messages={messages}\n                        onSendMessage={handleGlobalSend}\n                        onlineCount={onlineUsers.length}\n                        isOnline={isConnected}\n                        headerTitle={tenant.name}\n                        showBottomNavPadding={true}\n                        onInputFocusChange={setIsInputFocused}\n                        isFocused={isInputFocused}\n                        isSyncing={isFetchingGlobal}\n                    />\n                )}\n                {activeTab === 'users' && (\n                    <UserList\n                        currentUser={currentUser}\n                        users={onlineUsers}\n                        onStartChat={handleStartChat}\n                    />\n                )}\n                {activeTab === 'chats' && (\n                    <ChatList\n                        chats={Object.values(privateChats).map(c => ({ ...c, unreadCount: c.unread })).sort((a, b) => {\n                            const tA = a.messages.length ? new Date(a.messages[a.messages.length - 1].timestamp).getTime() : 0;\n                            const tB = b.messages.length ? new Date(b.messages[b.messages.length - 1].timestamp).getTime() : 0;\n                            return tB - tA;\n                        })}\n                        onSelectChat={setSelectedChatPeerId}\n                        onDeleteChat={handleDeleteChat}\n                    />\n                )}\n                {activeTab === 'settings' && (\n                    <Settings\n                        user={currentUser}\n                        onLogout={handleLogout}\n                        onUpdateAlias={handleUpdateAlias}\n                        onUpdateStatus={handleUpdateStatus}\n                    />\n                )}\n            </div>\n\n            {/* Bottom Navigation - Managed via React state for visibility */}\n            <div\n                className={`transition-all duration-300 ease-in-out border-t border-gray-100 bg-white z-20 overflow-hidden ${isInputFocused ? 'opacity-0 pointer-events-none h-0' : 'opacity-100 h-auto'\n                    }`}\n            >\n                <BottomNav\n                    activeTab={activeTab}\n                    onTabChange={(t) => {\n                        setActiveTab(t);\n                        setSelectedChatPeerId(null);\n                    }}\n                    usersCount={onlineUsers.length}\n                    unreadChatsCount={totalUnread}\n                />\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2742, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/services/apiService.ts"],"sourcesContent":["import { API_BASE_URL } from \"@/config\";\nimport { Message } from \"@/types\";\n\nexport const clientResolveTenant = async (urlNasId?: string, bssid?: string): Promise<string | null> => {\n    const params = new URLSearchParams();\n    if (bssid) params.append('bssid', bssid);\n    if (urlNasId) params.append('nas_id', urlNasId);\n\n    const query = params.toString() ? `?${params.toString()}` : '';\n    const res = await fetch(`${API_BASE_URL}/api/validate-nas${query}`);\n    if (!res.ok) return null;\n    const data = await res.json();\n    return data.valid ? data.tenantSlug : null;\n};\n\nexport const clientGetTenantBySlug = async (slug: string) => {\n    const res = await fetch(`${API_BASE_URL}/api/tenants/${slug}`);\n    if (!res.ok) return null;\n    return await res.json();\n};\n\nexport const clientGetMessages = async (tenantSlug: string): Promise<Message[]> => {\n    const res = await fetch(`${API_BASE_URL}/api/messages?tenant=${tenantSlug}`);\n    if (!res.ok) return [];\n    return await res.json();\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGO,MAAM,sBAAsB,OAAO,UAAmB;IACzD,MAAM,SAAS,IAAI;IACnB,IAAI,OAAO,OAAO,MAAM,CAAC,SAAS;IAClC,IAAI,UAAU,OAAO,MAAM,CAAC,UAAU;IAEtC,MAAM,QAAQ,OAAO,QAAQ,KAAK,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IAC5D,MAAM,MAAM,MAAM,MAAM,GAAG,yHAAY,CAAC,iBAAiB,EAAE,OAAO;IAClE,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;IACpB,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,KAAK,KAAK,GAAG,KAAK,UAAU,GAAG;AAC1C;AAEO,MAAM,wBAAwB,OAAO;IACxC,MAAM,MAAM,MAAM,MAAM,GAAG,yHAAY,CAAC,aAAa,EAAE,MAAM;IAC7D,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;IACpB,OAAO,MAAM,IAAI,IAAI;AACzB;AAEO,MAAM,oBAAoB,OAAO;IACpC,MAAM,MAAM,MAAM,MAAM,GAAG,yHAAY,CAAC,qBAAqB,EAAE,YAAY;IAC3E,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE;IACtB,OAAO,MAAM,IAAI,IAAI;AACzB"}},
    {"offset": {"line": 2779, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/app/%5BtenantSlug%5D/TenantChatClient.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from \"react\";\nimport { useParams, notFound } from \"next/navigation\";\nimport ChatInterface from \"@/components/ChatInterface\";\nimport { clientGetTenantBySlug, clientGetMessages } from \"@/services/apiService\";\nimport { Tenant, Message } from \"@/types\";\n\nexport default function TenantChatClient() {\n    const params = useParams();\n    const tenantSlug = params.tenantSlug as string;\n\n    const [tenant, setTenant] = useState<Tenant | null>(null);\n    const [initialMessages, setInitialMessages] = useState<Message[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(false);\n\n    useEffect(() => {\n        async function loadData() {\n            try {\n                const tenantData = await clientGetTenantBySlug(tenantSlug);\n                if (!tenantData) {\n                    setError(true);\n                    setLoading(false);\n                    return;\n                }\n                setTenant(tenantData);\n\n                const dbMessages = await clientGetMessages(tenantSlug);\n                const mappedMessages: Message[] = dbMessages.map((msg: any) => ({\n                    id: msg.id,\n                    text: msg.text,\n                    senderId: msg.senderId || msg.userId,\n                    senderAlias: msg.senderAlias || msg.user?.name || \"Anonymous\",\n                    senderGender: msg.senderGender || \"other\",\n                    timestamp: new Date(msg.timestamp || msg.createdAt).toISOString(),\n                }));\n                setInitialMessages(mappedMessages);\n                setLoading(false);\n            } catch (err) {\n                console.error(\"Error loading chat data\", err);\n                setError(true);\n                setLoading(false);\n            }\n        }\n        loadData();\n    }, [tenantSlug]);\n\n    if (loading) {\n        return (\n            <div className=\"h-screen w-full flex items-center justify-center bg-gray-50\">\n                <div className=\"animate-pulse text-gray-400 font-medium\">Caricamento chat...</div>\n            </div>\n        );\n    }\n\n    if (error || !tenant) {\n        notFound();\n    }\n\n    return (\n        <main className=\"flex h-full flex-col items-center justify-between\">\n            <ChatInterface\n                tenant={tenant}\n                initialMessages={initialMessages}\n            />\n        </main>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAQe,SAAS;;IACpB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,aAAa,OAAO,UAAU;IAEpC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAgB;IACpD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAY,EAAE;IACpE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IAEnC,IAAA,0KAAS;sCAAC;YACN,eAAe;gBACX,IAAI;oBACA,MAAM,aAAa,MAAM,IAAA,kJAAqB,EAAC;oBAC/C,IAAI,CAAC,YAAY;wBACb,SAAS;wBACT,WAAW;wBACX;oBACJ;oBACA,UAAU;oBAEV,MAAM,aAAa,MAAM,IAAA,8IAAiB,EAAC;oBAC3C,MAAM,iBAA4B,WAAW,GAAG;8EAAC,CAAC,MAAa,CAAC;gCAC5D,IAAI,IAAI,EAAE;gCACV,MAAM,IAAI,IAAI;gCACd,UAAU,IAAI,QAAQ,IAAI,IAAI,MAAM;gCACpC,aAAa,IAAI,WAAW,IAAI,IAAI,IAAI,EAAE,QAAQ;gCAClD,cAAc,IAAI,YAAY,IAAI;gCAClC,WAAW,IAAI,KAAK,IAAI,SAAS,IAAI,IAAI,SAAS,EAAE,WAAW;4BACnE,CAAC;;oBACD,mBAAmB;oBACnB,WAAW;gBACf,EAAE,OAAO,KAAK;oBACV,QAAQ,KAAK,CAAC,2BAA2B;oBACzC,SAAS;oBACT,WAAW;gBACf;YACJ;YACA;QACJ;qCAAG;QAAC;KAAW;IAEf,IAAI,SAAS;QACT,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAI,WAAU;0BAA0C;;;;;;;;;;;IAGrE;IAEA,IAAI,SAAS,CAAC,QAAQ;QAClB,IAAA,iJAAQ;IACZ;IAEA,qBACI,6LAAC;QAAK,WAAU;kBACZ,cAAA,6LAAC,0IAAa;YACV,QAAQ;YACR,iBAAiB;;;;;;;;;;;AAIjC;GA5DwB;;QACL,kJAAS;;;KADJ"}}]
}