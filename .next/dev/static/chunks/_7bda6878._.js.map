{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/config.ts"],"sourcesContent":["import { Capacitor } from '@capacitor/core';\n\n// Detect if running natively (iOS or Android)\nconst isNative = Capacitor.isNativePlatform();\n\n// Use env variable or fallback\n// Set NEXT_PUBLIC_SERVER_URL in .env to your local IP (e.g. http://192.168.1.x:3000)\nexport const API_BASE_URL = isNative\n    ? (process.env.NEXT_PUBLIC_SERVER_URL || 'http://localhost:3000')\n    : '';\n"],"names":[],"mappings":";;;;AAQO;AARP;;AAEA,8CAA8C;AAC9C,MAAM,WAAW,oKAAS,CAAC,gBAAgB;AAIpC,MAAM,eAAe,WACrB,iEAAsC,0BACvC"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/Login.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { User, Gender } from '@/types';\n\ninterface LoginProps {\n  onLogin: (user: User) => void;\n  tenantName: string;\n}\n\nconst Login: React.FC<LoginProps> = ({ onLogin, tenantName }) => {\n  const [alias, setAlias] = useState('');\n  const [gender, setGender] = useState<Gender>('male');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!alias.trim()) return;\n\n    // Forza il blur per chiudere la tastiera su mobile (iOS CNA)\n    if (document.activeElement instanceof HTMLElement) {\n      document.activeElement.blur();\n    }\n\n    const newUser: User = {\n      id: Math.random().toString(36).substr(2, 9),\n      alias: alias.trim(),\n      gender,\n      joinedAt: Date.now(),\n    };\n\n    onLogin(newUser);\n  };\n\n  const genderLabels: Record<Gender, string> = {\n    male: 'Maschio',\n    female: 'Femmina',\n    other: 'Altro'\n  };\n\n  return (\n    <div className=\"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col justify-center\">\n      <div className=\"text-center mb-8\">\n        <div className=\"inline-flex items-center justify-center w-16 h-16 bg-emerald-500 rounded-full mb-4 shadow-lg shadow-emerald-200\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-8 h-8 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n          </svg>\n        </div>\n        <h1 className=\"text-2xl font-bold text-gray-800 tracking-tight\">{tenantName}</h1>\n        <p className=\"text-gray-500 mt-2 text-sm\">chatta in modo anonimo con le persone intorno a te</p>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Il tuo Alias</label>\n          <input\n            type=\"text\"\n            required\n            maxLength={20}\n            value={alias}\n            onChange={(e) => setAlias(e.target.value)}\n            placeholder=\"es. ShadowHunter\"\n            className=\"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800 placeholder-gray-300\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Identità di Genere</label>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {(['male', 'female', 'other'] as Gender[]).map((g) => (\n              <button\n                key={g}\n                type=\"button\"\n                onClick={() => setGender(g)}\n                className={`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${gender === g\n                  ? 'bg-emerald-500 text-white border-emerald-500 shadow-md'\n                  : 'bg-white text-gray-500 border-gray-200 hover:border-emerald-200'\n                  }`}\n              >\n                {genderLabels[g]}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <button\n          type=\"submit\"\n          className=\"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2 group\"\n        >\n          Entra nella Stanza\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 group-hover:translate-x-1 transition-transform\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14 5l7 7m0 0l-7 7m7-7H3\" />\n          </svg>\n        </button>\n      </form>\n\n      <p className=\"text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest\">\n        Zero database esterni • Privacy totale\n      </p>\n    </div>\n  );\n};\n\nexport default Login;\n"],"names":[],"mappings":";;;;;AAAA;;;;AAQA,MAAM,QAA8B,CAAC,EAAE,OAAO,EAAE,UAAU,EAAE;;IAC1D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAS;IAE7C,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IAAI,CAAC,MAAM,IAAI,IAAI;QAEnB,6DAA6D;QAC7D,IAAI,SAAS,aAAa,YAAY,aAAa;YACjD,SAAS,aAAa,CAAC,IAAI;QAC7B;QAEA,MAAM,UAAgB;YACpB,IAAI,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,GAAG;YACzC,OAAO,MAAM,IAAI;YACjB;YACA,UAAU,KAAK,GAAG;QACpB;QAEA,QAAQ;IACV;IAEA,MAAM,eAAuC;QAC3C,MAAM;QACN,QAAQ;QACR,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,OAAM;4BAA6B,WAAU;4BAAqB,MAAK;4BAAO,SAAQ;4BAAY,QAAO;sCAC5G,cAAA,6LAAC;gCAAK,eAAc;gCAAQ,gBAAe;gCAAQ,aAAa;gCAAG,GAAE;;;;;;;;;;;;;;;;kCAGzE,6LAAC;wBAAG,WAAU;kCAAmD;;;;;;kCACjE,6LAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;0BAG5C,6LAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CAAiD;;;;;;0CAClE,6LAAC;gCACC,MAAK;gCACL,QAAQ;gCACR,WAAW;gCACX,OAAO;gCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gCACxC,aAAY;gCACZ,WAAU;;;;;;;;;;;;kCAId,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CAAiD;;;;;;0CAClE,6LAAC;gCAAI,WAAU;0CACZ,AAAC;oCAAC;oCAAQ;oCAAU;iCAAQ,CAAc,GAAG,CAAC,CAAC,kBAC9C,6LAAC;wCAEC,MAAK;wCACL,SAAS,IAAM,UAAU;wCACzB,WAAW,CAAC,iFAAiF,EAAE,WAAW,IACtG,2DACA,mEACA;kDAEH,YAAY,CAAC,EAAE;uCARX;;;;;;;;;;;;;;;;kCAcb,6LAAC;wBACC,MAAK;wBACL,WAAU;;4BACX;0CAEC,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAyD,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAChJ,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa;oCAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;;0BAK3E,6LAAC;gBAAE,WAAU;0BAAuE;;;;;;;;;;;;AAK1F;GA1FM;KAAA;uCA4FS"}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/GlobalChat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, memo } from 'react';\nimport { User, Message, Gender } from '@/types';\n\ninterface GlobalChatProps {\n  user: User;\n  messages: Message[];\n  onSendMessage: (text: string) => void;\n  onlineCount: number;\n  isOnline: boolean;\n  hideHeader?: boolean;\n  headerTitle?: string;\n  showBottomNavPadding?: boolean;\n  isFocused?: boolean;\n  onInputFocusChange?: (isFocused: boolean) => void;\n}\n\nconst GenderIcon = memo(({ gender, className }: { gender: Gender; className?: string }) => {\n  if (gender === 'male') {\n    return (\n      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n        <path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"></path>\n        <circle cx=\"12\" cy=\"7\" r=\"4\"></circle>\n      </svg>\n    );\n  }\n  if (gender === 'female') {\n    return (\n      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n        <path d=\"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z\"></path>\n        <path d=\"M18 22H6c0-4 4-3 6-3s6-1 6 3Z\"></path>\n      </svg>\n    );\n  }\n  return (\n    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n      <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n      <circle cx=\"12\" cy=\"10\" r=\"3\"></circle>\n      <path d=\"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662\"></path>\n    </svg>\n  );\n});\n\nconst ChatInput = memo(({ onSendMessage, showBottomNavPadding, onFocusChange, isFocused }: {\n  onSendMessage: (text: string) => void,\n  showBottomNavPadding?: boolean,\n  onFocusChange?: (isFocused: boolean) => void,\n  isFocused?: boolean\n}) => {\n  const [text, setText] = useState('');\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Safeguard: forza il blur al montaggio per evitare che iOS apra la tastiera\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.blur();\n    }\n  }, []);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (text.trim()) {\n      onSendMessage(text.trim());\n      setText('');\n      inputRef.current?.blur();\n    }\n  };\n\n  // Calculate bottom padding: NavHeight (60px) + Safe Area + Visual Buffer (12px)\n  // This ensures 12px visible space below input, matching p-3 (12px) top padding.\n  const footerPadding = isFocused\n    ? 'pb-2'\n    : showBottomNavPadding\n      ? 'pb-[calc(60px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[80px]'\n      : 'pb-6 pt-2';\n\n  return (\n    <footer className={`px-3 pt-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${footerPadding}`}>\n      <form onSubmit={handleSubmit} className=\"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto\">\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          onFocus={() => onFocusChange?.(true)}\n          onBlur={() => onFocusChange?.(false)}\n          placeholder=\"Messaggio alla stanza...\"\n          className=\"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400\"\n          style={{ fontSize: '16px' }}\n        />\n        <button\n          type=\"submit\"\n          className=\"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform\"\n          onMouseDown={(e) => e.preventDefault()}\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 rotate-45\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n          </svg>\n        </button>\n      </form>\n    </footer>\n  );\n});\n\nconst GlobalChat: React.FC<GlobalChatProps> = ({ user, messages, onSendMessage, onlineCount, isOnline, hideHeader, headerTitle, showBottomNavPadding, onInputFocusChange, isFocused }) => {\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const isAtBottom = useRef(true);\n\n  const handleScroll = () => {\n    if (scrollContainerRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = scrollContainerRef.current;\n      isAtBottom.current = scrollHeight - scrollTop - clientHeight < 100;\n    }\n  };\n\n  useEffect(() => {\n    if (isAtBottom.current && scrollContainerRef.current) {\n      scrollContainerRef.current.scrollTop = scrollContainerRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  const getAvatarColor = (gender: string) => {\n    switch (gender) {\n      case 'male': return 'bg-blue-500';\n      case 'female': return 'bg-pink-500';\n      default: return 'bg-purple-500';\n    }\n  };\n\n  return (\n    <div className=\"w-full h-full flex flex-col bg-white\">\n      {/* Header Mobile Style */}\n      {!hideHeader && (\n        <header className=\"bg-emerald-600 pt-safe text-white shadow-md z-10 shrink-0 sticky top-0\">\n          <div className=\"h-[60px] px-4 flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-9 h-9 rounded-full bg-white/20 flex items-center justify-center\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n                </svg>\n              </div>\n              <div>\n                <h2 className=\"font-bold text-lg leading-tight\">{headerTitle || 'Salotto Pubblico'}</h2>\n                <div className=\"flex items-center gap-1.5\">\n                  <span className={`w-2 h-2 rounded-full ${isOnline ? 'bg-emerald-400' : 'bg-red-400'}`}></span>\n                  <p className=\"text-xs text-emerald-100 opacity-90\">\n                    {isOnline ? `${onlineCount} persone qui` : 'Disconnesso'}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </header>\n      )}\n\n      <main\n        ref={scrollContainerRef}\n        onScroll={handleScroll}\n        className=\"flex-1 overflow-y-auto p-4 space-y-4 chat-bg pb-[20px]\"\n      >\n        {messages.map((msg, index) => {\n          const isMe = msg.senderId === user.id;\n          const showSenderInfo = index === 0 || messages[index - 1].senderId !== msg.senderId;\n\n          return (\n            <div key={msg.id} className={`flex ${isMe ? 'justify-end' : 'justify-start'} animate-message`}>\n              <div className={`flex flex-col max-w-[85%] ${isMe ? 'items-end' : 'items-start'}`}>\n                {showSenderInfo && (\n                  <span className={`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${isMe ? 'text-emerald-700' : 'text-gray-600'}`}>\n                    {!isMe && (\n                      <div className={`w-3.5 h-3.5 rounded-full flex items-center justify-center ${getAvatarColor(msg.senderGender)}`}>\n                        <GenderIcon gender={msg.senderGender} className=\"w-2 h-2 text-white\" />\n                      </div>\n                    )}\n                    {isMe ? 'Tu' : msg.senderAlias}\n                  </span>\n                )}\n                <div className={`px-3 py-2 rounded-2xl shadow-sm ${isMe ? 'bg-emerald-500 text-white rounded-tr-none' : 'bg-white text-gray-800 rounded-tl-none border border-gray-100'}`}>\n                  <p className=\"whitespace-pre-wrap break-words leading-relaxed text-[15px]\">{msg.text}</p>\n                </div>\n                <span className=\"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70\">\n                  {new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                </span>\n              </div>\n            </div>\n          );\n        })}\n      </main>\n\n      <ChatInput\n        onSendMessage={onSendMessage}\n        showBottomNavPadding={showBottomNavPadding}\n        onFocusChange={onInputFocusChange}\n        isFocused={isFocused}\n      />\n    </div>\n  );\n};\n\nexport default GlobalChat;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 684, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/BottomNav.tsx"],"sourcesContent":["import React from 'react';\n\ntype Tab = 'room' | 'users' | 'chats' | 'settings';\n\ninterface BottomNavProps {\n    activeTab: Tab;\n    onTabChange: (tab: Tab) => void;\n    usersCount: number;\n    unreadChatsCount: number;\n}\n\nconst BottomNav: React.FC<BottomNavProps> = ({ activeTab, onTabChange, usersCount, unreadChatsCount }) => {\n    return (\n        <nav className=\"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(60px+env(safe-area-inset-bottom,0px))] md:h-[70px] flex justify-around items-center pb-[calc(env(safe-area-inset-bottom,0px)+12px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]\">\n\n            {/* Tab 1: Room */}\n            <button\n                onClick={() => onTabChange('room')}\n                className={`flex flex-col items-center justify-center w-full h-full relative ${activeTab === 'room' ? 'text-emerald-600' : 'text-gray-400'}`}\n            >\n                <div className=\"relative\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'room' ? 2.5 : 2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n                    </svg>\n                    {usersCount > 0 && (\n                        <span className=\"absolute -top-1 -right-2 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border border-white\">\n                            {usersCount}\n                        </span>\n                    )}\n                </div>\n                <span className=\"text-[10px] font-medium mt-1\">Stanza</span>\n            </button>\n\n            {/* Tab 2: Users */}\n            <button\n                onClick={() => onTabChange('users')}\n                className={`flex flex-col items-center justify-center w-full h-full relative ${activeTab === 'users' ? 'text-emerald-600' : 'text-gray-400'}`}\n            >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'users' ? 2.5 : 2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" />\n                </svg>\n                <span className=\"text-[10px] font-medium mt-1\">Utenti</span>\n            </button>\n\n            {/* Tab 3: Chats */}\n            <button\n                onClick={() => onTabChange('chats')}\n                className={`flex flex-col items-center justify-center w-full h-full relative ${activeTab === 'chats' ? 'text-emerald-600' : 'text-gray-400'}`}\n            >\n                <div className=\"relative\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'chats' ? 2.5 : 2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n                    </svg>\n                    {unreadChatsCount > 0 && (\n                        <span className=\"absolute -top-1 -right-2 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border border-white\">\n                            {unreadChatsCount}\n                        </span>\n                    )}\n                </div>\n                <span className=\"text-[10px] font-medium mt-1\">Chats</span>\n            </button>\n\n            {/* Tab 4: Settings */}\n            <button\n                onClick={() => onTabChange('settings')}\n                className={`flex flex-col items-center justify-center w-full h-full relative ${activeTab === 'settings' ? 'text-emerald-600' : 'text-gray-400'}`}\n            >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 md:h-7 md:w-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={activeTab === 'settings' ? 2.5 : 2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                </svg>\n                <span className=\"text-[10px] font-medium mt-1\">Me</span>\n            </button>\n        </nav>\n    );\n};\n\nexport default BottomNav;\n"],"names":[],"mappings":";;;;;;AAWA,MAAM,YAAsC,CAAC,EAAE,SAAS,EAAE,WAAW,EAAE,UAAU,EAAE,gBAAgB,EAAE;IACjG,qBACI,6LAAC;QAAI,WAAU;;0BAGX,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,iEAAiE,EAAE,cAAc,SAAS,qBAAqB,iBAAiB;;kCAE5I,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa,cAAc,SAAS,MAAM;oCAAG,GAAE;;;;;;;;;;;4BAErG,aAAa,mBACV,6LAAC;gCAAK,WAAU;0CACX;;;;;;;;;;;;kCAIb,6LAAC;wBAAK,WAAU;kCAA+B;;;;;;;;;;;;0BAInD,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,iEAAiE,EAAE,cAAc,UAAU,qBAAqB,iBAAiB;;kCAE7I,6LAAC;wBAAI,OAAM;wBAA6B,WAAU;wBAAwB,MAAK;wBAAO,SAAQ;wBAAY,QAAO;kCAC7G,cAAA,6LAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,aAAa,cAAc,UAAU,MAAM;4BAAG,GAAE;;;;;;;;;;;kCAEvG,6LAAC;wBAAK,WAAU;kCAA+B;;;;;;;;;;;;0BAInD,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,iEAAiE,EAAE,cAAc,UAAU,qBAAqB,iBAAiB;;kCAE7I,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa,cAAc,UAAU,MAAM;oCAAG,GAAE;;;;;;;;;;;4BAEtG,mBAAmB,mBAChB,6LAAC;gCAAK,WAAU;0CACX;;;;;;;;;;;;kCAIb,6LAAC;wBAAK,WAAU;kCAA+B;;;;;;;;;;;;0BAInD,6LAAC;gBACG,SAAS,IAAM,YAAY;gBAC3B,WAAW,CAAC,iEAAiE,EAAE,cAAc,aAAa,qBAAqB,iBAAiB;;kCAEhJ,6LAAC;wBAAI,OAAM;wBAA6B,WAAU;wBAAwB,MAAK;wBAAO,SAAQ;wBAAY,QAAO;kCAC7G,cAAA,6LAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,aAAa,cAAc,aAAa,MAAM;4BAAG,GAAE;;;;;;;;;;;kCAE1G,6LAAC;wBAAK,WAAU;kCAA+B;;;;;;;;;;;;;;;;;;AAI/D;KA/DM;uCAiES"}},
    {"offset": {"line": 902, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/UserList.tsx"],"sourcesContent":["import React from 'react';\nimport { User, Gender } from '@/types';\n\ninterface UserListProps {\n    currentUser: User;\n    users: (User & { socketId: string })[];\n    onStartChat: (targetUser: User) => void;\n}\n\nconst UserList: React.FC<UserListProps> = ({ currentUser, users, onStartChat }) => {\n    // Filter out self\n    const otherUsers = users.filter(u => u.id !== currentUser.id);\n\n    const getAvatarColor = (gender: Gender) => {\n        switch (gender) {\n            case 'male': return 'bg-blue-500';\n            case 'female': return 'bg-pink-500';\n            default: return 'bg-purple-500';\n        }\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10\">\n                <div className=\"h-[60px] px-4 flex items-center justify-between\">\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Utenti</h1>\n                    <span className=\"text-sm font-semibold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full\">\n                        {users.length} Online\n                    </span>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto p-4 pb-[80px]\">\n                {otherUsers.length === 0 ? (\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400 space-y-4\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 opacity-20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" />\n                        </svg>\n                        <p className=\"text-center font-medium\">Nessun altro utente online al momento.</p>\n                    </div>\n                ) : (\n                    <ul className=\"space-y-4\">\n                        {otherUsers.map(user => (\n                            <li key={user.id} className=\"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0\">\n                                <div className={`w-12 h-12 rounded-full ${getAvatarColor(user.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`}>\n                                    <span className=\"font-bold text-lg uppercase\">{user.alias.charAt(0)}</span>\n                                    <div className=\"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full\"></div>\n                                </div>\n                                <div className=\"flex-1 min-w-0\">\n                                    <h3 className=\"font-bold text-gray-900 truncate text-base\">{user.alias}</h3>\n                                    <p className=\"text-sm text-gray-500 truncate capitalize\">{user.gender}</p>\n                                </div>\n                                <button\n                                    onClick={() => onStartChat(user)}\n                                    className=\"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors\"\n                                >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                                    </svg>\n                                </button>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n            </main>\n        </div>\n    );\n};\n\nexport default UserList;\n"],"names":[],"mappings":";;;;;;AASA,MAAM,WAAoC,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,WAAW,EAAE;IAC1E,kBAAkB;IAClB,MAAM,aAAa,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,YAAY,EAAE;IAE5D,MAAM,iBAAiB,CAAC;QACpB,OAAQ;YACJ,KAAK;gBAAQ,OAAO;YACpB,KAAK;gBAAU,OAAO;YACtB;gBAAS,OAAO;QACpB;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,6LAAC;4BAAK,WAAU;;gCACX,MAAM,MAAM;gCAAC;;;;;;;;;;;;;;;;;;0BAK1B,6LAAC;gBAAK,WAAU;0BACX,WAAW,MAAM,KAAK,kBACnB,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAI,OAAM;4BAA6B,WAAU;4BAAuB,MAAK;4BAAO,SAAQ;4BAAY,QAAO;sCAC5G,cAAA,6LAAC;gCAAK,eAAc;gCAAQ,gBAAe;gCAAQ,aAAa;gCAAG,GAAE;;;;;;;;;;;sCAEzE,6LAAC;4BAAE,WAAU;sCAA0B;;;;;;;;;;;6EAG3C,6LAAC;oBAAG,WAAU;8BACT,WAAW,GAAG,CAAC,CAAA,qBACZ,6LAAC;4BAAiB,WAAU;;8CACxB,6LAAC;oCAAI,WAAW,CAAC,uBAAuB,EAAE,eAAe,KAAK,MAAM,EAAE,wEAAwE,CAAC;;sDAC3I,6LAAC;4CAAK,WAAU;sDAA+B,KAAK,KAAK,CAAC,MAAM,CAAC;;;;;;sDACjE,6LAAC;4CAAI,WAAU;;;;;;;;;;;;8CAEnB,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAG,WAAU;sDAA8C,KAAK,KAAK;;;;;;sDACtE,6LAAC;4CAAE,WAAU;sDAA6C,KAAK,MAAM;;;;;;;;;;;;8CAEzE,6LAAC;oCACG,SAAS,IAAM,YAAY;oCAC3B,WAAU;8CAEV,cAAA,6LAAC;wCAAI,OAAM;wCAA6B,WAAU;wCAAU,MAAK;wCAAO,SAAQ;wCAAY,QAAO;kDAC/F,cAAA,6LAAC;4CAAK,eAAc;4CAAQ,gBAAe;4CAAQ,aAAa;4CAAG,GAAE;;;;;;;;;;;;;;;;;2BAdxE,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;AAwB5C;KA1DM;uCA4DS"}},
    {"offset": {"line": 1115, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/ChatList.tsx"],"sourcesContent":["import React from 'react';\nimport { User, Message, Gender } from '@/types';\n\ninterface PrivateChatSession {\n    peer: User;\n    messages: Message[];\n    unreadCount: number;\n}\n\ninterface ChatListProps {\n    chats: PrivateChatSession[];\n    onSelectChat: (peerId: string) => void;\n    onDeleteChat: (peerId: string) => void;\n}\n\nconst ChatList: React.FC<ChatListProps> = ({ chats, onSelectChat, onDeleteChat }) => {\n    const getAvatarColor = (gender: Gender) => {\n        switch (gender) {\n            case 'male': return 'bg-blue-500';\n            case 'female': return 'bg-pink-500';\n            default: return 'bg-purple-500';\n        }\n    };\n\n    const getLastMessage = (msgs: Message[]) => {\n        if (msgs.length === 0) return 'Inizia la conversazione...';\n        return msgs[msgs.length - 1].text;\n    };\n\n    const getLastTime = (msgs: Message[]) => {\n        if (msgs.length === 0) return '';\n        const date = new Date(msgs[msgs.length - 1].timestamp);\n        // Se oggi mostra l'ora, altrimenti data\n        const now = new Date();\n        if (date.toDateString() === now.toDateString()) {\n            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n        }\n        return date.toLocaleDateString([], { day: '2-digit', month: '2-digit' });\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10\">\n                <div className=\"h-[60px] px-4 flex items-center justify-between\">\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Chat private</h1>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto p-4 pb-[80px]\">\n                {chats.length === 0 ? (\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400 space-y-4\">\n                        <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                            </svg>\n                        </div>\n                        <p className=\"text-center font-medium\">Nessuna chat attiva.<br />Cerca utenti nella scheda Utenti.</p>\n                    </div>\n                ) : (\n                    <ul className=\"space-y-4\">\n                        {chats.map((chat) => (\n                            <li\n                                key={chat.peer.id}\n                                onClick={() => onSelectChat(chat.peer.id)}\n                                className=\"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0\"\n                            >\n                                <div className={`w-14 h-14 rounded-full ${getAvatarColor(chat.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`}>\n                                    <span className=\"font-bold text-xl uppercase\">{chat.peer.alias.charAt(0)}</span>\n                                </div>\n\n                                <div className=\"flex-1 min-w-0\">\n                                    <div className=\"flex justify-between items-baseline mb-1\">\n                                        <h3 className=\"font-bold text-gray-900 truncate text-base\">{chat.peer.alias}</h3>\n                                        <span className=\"text-[11px] text-gray-400 font-medium\">{getLastTime(chat.messages)}</span>\n                                    </div>\n                                    <p className=\"text-sm text-gray-500 truncate\">{getLastMessage(chat.messages)}</p>\n                                </div>\n\n                                <div className=\"flex items-center gap-2\">\n                                    {chat.unreadCount > 0 && (\n                                        <div className=\"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center\">\n                                            <span className=\"text-[10px] font-bold text-white\">{chat.unreadCount}</span>\n                                        </div>\n                                    )}\n\n                                    <button\n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            onDeleteChat(chat.peer.id);\n                                        }}\n                                        className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                                        </svg>\n                                    </button>\n                                </div>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n            </main>\n        </div>\n    );\n};\n\nexport default ChatList;\n"],"names":[],"mappings":";;;;;;AAeA,MAAM,WAAoC,CAAC,EAAE,KAAK,EAAE,YAAY,EAAE,YAAY,EAAE;IAC5E,MAAM,iBAAiB,CAAC;QACpB,OAAQ;YACJ,KAAK;gBAAQ,OAAO;YACpB,KAAK;gBAAU,OAAO;YACtB;gBAAS,OAAO;QACpB;IACJ;IAEA,MAAM,iBAAiB,CAAC;QACpB,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAC9B,OAAO,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,CAAC,IAAI;IACrC;IAEA,MAAM,cAAc,CAAC;QACjB,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAC9B,MAAM,OAAO,IAAI,KAAK,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,CAAC,SAAS;QACrD,wCAAwC;QACxC,MAAM,MAAM,IAAI;QAChB,IAAI,KAAK,YAAY,OAAO,IAAI,YAAY,IAAI;YAC5C,OAAO,KAAK,kBAAkB,CAAC,EAAE,EAAE;gBAAE,MAAM;gBAAW,QAAQ;YAAU;QAC5E;QACA,OAAO,KAAK,kBAAkB,CAAC,EAAE,EAAE;YAAE,KAAK;YAAW,OAAO;QAAU;IAC1E;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAG,WAAU;kCAAmC;;;;;;;;;;;;;;;;0BAIzD,6LAAC;gBAAK,WAAU;0BACX,MAAM,MAAM,KAAK,kBACd,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,OAAM;gCAA6B,WAAU;gCAAwB,MAAK;gCAAO,SAAQ;gCAAY,QAAO;0CAC7G,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa;oCAAG,GAAE;;;;;;;;;;;;;;;;sCAG7E,6LAAC;4BAAE,WAAU;;gCAA0B;8CAAoB,6LAAC;;;;;gCAAK;;;;;;;;;;;;6EAGrE,6LAAC;oBAAG,WAAU;8BACT,MAAM,GAAG,CAAC,CAAC,qBACR,6LAAC;4BAEG,SAAS,IAAM,aAAa,KAAK,IAAI,CAAC,EAAE;4BACxC,WAAU;;8CAEV,6LAAC;oCAAI,WAAW,CAAC,uBAAuB,EAAE,eAAe,KAAK,IAAI,CAAC,MAAM,EAAE,wEAAwE,CAAC;8CAChJ,cAAA,6LAAC;wCAAK,WAAU;kDAA+B,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;;;;;;;;;;;8CAG1E,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDAAG,WAAU;8DAA8C,KAAK,IAAI,CAAC,KAAK;;;;;;8DAC3E,6LAAC;oDAAK,WAAU;8DAAyC,YAAY,KAAK,QAAQ;;;;;;;;;;;;sDAEtF,6LAAC;4CAAE,WAAU;sDAAkC,eAAe,KAAK,QAAQ;;;;;;;;;;;;8CAG/E,6LAAC;oCAAI,WAAU;;wCACV,KAAK,WAAW,GAAG,mBAChB,6LAAC;4CAAI,WAAU;sDACX,cAAA,6LAAC;gDAAK,WAAU;0DAAoC,KAAK,WAAW;;;;;;;;;;;sDAI5E,6LAAC;4CACG,SAAS,CAAC;gDACN,EAAE,eAAe;gDACjB,aAAa,KAAK,IAAI,CAAC,EAAE;4CAC7B;4CACA,WAAU;sDAEV,cAAA,6LAAC;gDAAI,OAAM;gDAA6B,WAAU;gDAAU,MAAK;gDAAO,SAAQ;gDAAY,QAAO;0DAC/F,cAAA,6LAAC;oDAAK,eAAc;oDAAQ,gBAAe;oDAAQ,aAAa;oDAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;;2BA/B5E,KAAK,IAAI,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;AA0CjD;KAzFM;uCA2FS"}},
    {"offset": {"line": 1384, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/Settings.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { User } from '@/types';\n\ninterface SettingsProps {\n    user: User;\n    onLogout: () => void;\n    onUpdateAlias: (newAlias: string) => void;\n}\n\nconst Settings: React.FC<SettingsProps> = ({ user, onLogout, onUpdateAlias }) => {\n    const [isEditing, setIsEditing] = useState(false);\n    const [newAlias, setNewAlias] = useState(user.alias);\n\n    const handleSave = () => {\n        if (newAlias.trim() && newAlias !== user.alias) {\n            onUpdateAlias(newAlias.trim());\n        }\n        setIsEditing(false);\n    };\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            <header className=\"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10\">\n                <div className=\"h-[60px] px-4 flex items-center justify-between\">\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Profilo</h1>\n                </div>\n            </header>\n\n            <main className=\"flex-1 overflow-y-auto p-4 space-y-6\">\n                {/* Profile Card */}\n                <div className=\"bg-gray-50 rounded-2xl p-6 flex flex-col items-center\">\n                    <div className=\"w-20 h-20 bg-emerald-500 rounded-full flex items-center justify-center text-white text-3xl font-bold mb-4 shadow-lg\">\n                        {user.alias.charAt(0).toUpperCase()}\n                    </div>\n\n                    {isEditing ? (\n                        <div className=\"w-full flex flex-col items-center gap-2\">\n                            <input\n                                type=\"text\"\n                                value={newAlias}\n                                onChange={(e) => setNewAlias(e.target.value)}\n                                className=\"px-4 py-2 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-center text-lg font-bold\"\n                                autoFocus\n                            />\n                            <div className=\"flex gap-2\">\n                                <button onClick={handleSave} className=\"px-4 py-1.5 bg-emerald-500 text-white rounded-lg text-sm font-bold\">Salva</button>\n                                <button onClick={() => { setIsEditing(false); setNewAlias(user.alias); }} className=\"px-4 py-1.5 bg-gray-200 text-gray-600 rounded-lg text-sm font-bold\">Annulla</button>\n                            </div>\n                        </div>\n                    ) : (\n                        <>\n                            <h2 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n                                {user.alias}\n                                <button onClick={() => setIsEditing(true)} className=\"p-1 text-gray-400 hover:text-emerald-500\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n                                    </svg>\n                                </button>\n                            </h2>\n                            <p className=\"text-gray-500 capitalize\">{user.gender}</p>\n                            <p className=\"text-[10px] text-gray-400 mt-1 font-mono uppercase tracking-widest\">{user.id}</p>\n                        </>\n                    )}\n                </div>\n\n                {/* Actions */}\n                <div className=\"space-y-3\">\n                    <button\n                        onClick={onLogout}\n                        className=\"w-full flex items-center gap-3 p-4 bg-red-50 text-red-600 rounded-xl hover:bg-red-100 transition-colors\"\n                    >\n                        <div className=\"p-2 bg-white rounded-full\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n                            </svg>\n                        </div>\n                        <span className=\"font-semibold\">Disconnetti</span>\n                    </button>\n                </div>\n            </main>\n        </div>\n    );\n};\n\nexport default Settings;\n"],"names":[],"mappings":";;;;;AAAA;;;;AASA,MAAM,WAAoC,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,aAAa,EAAE;;IACxE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC,KAAK,KAAK;IAEnD,MAAM,aAAa;QACf,IAAI,SAAS,IAAI,MAAM,aAAa,KAAK,KAAK,EAAE;YAC5C,cAAc,SAAS,IAAI;QAC/B;QACA,aAAa;IACjB;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAG,WAAU;kCAAmC;;;;;;;;;;;;;;;;0BAIzD,6LAAC;gBAAK,WAAU;;kCAEZ,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CACV,KAAK,KAAK,CAAC,MAAM,CAAC,GAAG,WAAW;;;;;;4BAGpC,0BACG,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCACG,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC3C,WAAU;wCACV,SAAS;;;;;;kDAEb,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAO,SAAS;gDAAY,WAAU;0DAAqE;;;;;;0DAC5G,6LAAC;gDAAO,SAAS;oDAAQ,aAAa;oDAAQ,YAAY,KAAK,KAAK;gDAAG;gDAAG,WAAU;0DAAqE;;;;;;;;;;;;;;;;;yFAIjK;;kDACI,6LAAC;wCAAG,WAAU;;4CACT,KAAK,KAAK;0DACX,6LAAC;gDAAO,SAAS,IAAM,aAAa;gDAAO,WAAU;0DACjD,cAAA,6LAAC;oDAAI,OAAM;oDAA6B,WAAU;oDAAU,MAAK;oDAAO,SAAQ;oDAAY,QAAO;8DAC/F,cAAA,6LAAC;wDAAK,eAAc;wDAAQ,gBAAe;wDAAQ,aAAa;wDAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;kDAIjF,6LAAC;wCAAE,WAAU;kDAA4B,KAAK,MAAM;;;;;;kDACpD,6LAAC;wCAAE,WAAU;kDAAsE,KAAK,EAAE;;;;;;;;;;;;;;kCAMtG,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;4BACG,SAAS;4BACT,WAAU;;8CAEV,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;wCAAI,OAAM;wCAA6B,WAAU;wCAAU,MAAK;wCAAO,SAAQ;wCAAY,QAAO;kDAC/F,cAAA,6LAAC;4CAAK,eAAc;4CAAQ,gBAAe;4CAAQ,aAAa;4CAAG,GAAE;;;;;;;;;;;;;;;;8CAG7E,6LAAC;oCAAK,WAAU;8CAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMxD;GAzEM;KAAA;uCA2ES"}},
    {"offset": {"line": 1634, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/ChatInterface.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io, Socket } from 'socket.io-client';\nimport { Tenant } from '@prisma/client';\nimport { User, Message } from '@/types';\nimport { API_BASE_URL } from '@/config';\n\n// UI Components\nimport Login from './Login';\nimport GlobalChat from './GlobalChat';\nimport BottomNav from './BottomNav';\nimport UserList from './UserList';\nimport ChatList from './ChatList';\nimport Settings from './Settings';\n\ninterface ChatInterfaceProps {\n    tenant: Tenant;\n    initialMessages: Message[];\n}\n\ntype Tab = 'room' | 'users' | 'chats' | 'settings';\ntype PrivateChatsMap = Record<string, { peer: User; messages: Message[]; unread: number }>;\n\nexport default function ChatInterface({ tenant, initialMessages }: ChatInterfaceProps) {\n    const [currentUser, setCurrentUser] = useState<User | null>(null);\n    const [socket, setSocket] = useState<Socket | null>(null);\n\n    // UI State\n    const [activeTab, setActiveTab] = useState<Tab>('room');\n    const [selectedChatPeerId, setSelectedChatPeerId] = useState<string | null>(null);\n    const [isInputFocused, setIsInputFocused] = useState(false);\n\n    // Data State\n    const [messages, setMessages] = useState<Message[]>(initialMessages); // Global messages\n    const [onlineUsers, setOnlineUsers] = useState<(User & { socketId: string })[]>([]);\n    const [privateChats, setPrivateChats] = useState<PrivateChatsMap>({});\n    const [isConnected, setIsConnected] = useState(false);\n\n\n    // 1. Initialize User (Check localStorage)\n    useEffect(() => {\n        if (typeof window !== 'undefined') {\n            const savedUser = localStorage.getItem('chat_user');\n            if (savedUser) {\n                try {\n                    const user = JSON.parse(savedUser);\n                    setCurrentUser(user);\n                } catch (e) {\n                    console.error(\"Invalid saved user\", e);\n                }\n            }\n        }\n    }, []);\n\n    // 2. Connect Socket & Handlers\n    useEffect(() => {\n        if (!currentUser) return;\n\n        const newSocket = io(API_BASE_URL || undefined, {\n            query: {\n                tenantSlug: tenant.slug,\n                userId: currentUser.id\n            }\n        });\n\n        setSocket(newSocket);\n\n        newSocket.on('connect', () => {\n            console.log(\"Socket connected\");\n            setIsConnected(true);\n            newSocket.emit('join', { user: currentUser, tenantSlug: tenant.slug });\n        });\n\n        newSocket.on('disconnect', () => {\n            setIsConnected(false);\n        });\n\n        newSocket.on('presenceUpdate', (users: (User & { socketId: string })[]) => {\n            setOnlineUsers(users);\n        });\n\n        newSocket.on('newMessage', (msg: Message) => {\n            setMessages(prev => {\n                if (prev.some(m => m.id === msg.id)) return prev;\n                return [...prev, msg];\n            });\n        });\n\n        newSocket.on('privateMessage', (msg: Message) => {\n            const isMe = msg.senderId === currentUser.id;\n            const peerId = isMe ? msg.recipientId! : msg.senderId;\n\n            // If receiving a message from someone not in our list, we need their info.\n            // For now, we construct it from the message data if valid.\n            // In a real app we might fetch user details.\n\n            setPrivateChats(prev => {\n                const existing = prev[peerId] || {\n                    peer: {\n                        id: peerId,\n                        alias: isMe ? 'Unknown' : msg.senderAlias,\n                        gender: isMe ? 'male' : msg.senderGender,\n                        joinedAt: Date.now()\n                    },\n                    messages: [],\n                    unread: 0\n                };\n\n                if (existing.messages.some(m => m.id === msg.id)) return prev;\n\n                // If we are currently viewing this chat, unread is 0\n                // Note: we can't access live 'activeTab' here inside closure easily without ref or dependency.\n                // But we have 'selectedChatPeerId' in dependency potentially or we handle read status in another effect.\n                // Simplified: increment unread, let the Effect [activeTab, selectedChatPeerId] clear it if open.\n\n                return {\n                    ...prev,\n                    [peerId]: {\n                        ...existing,\n                        messages: [...existing.messages, msg],\n                        unread: existing.unread + 1\n                    }\n                };\n            });\n        });\n\n        return () => {\n            newSocket.disconnect();\n        }\n    }, [currentUser, tenant.slug]);\n\n    // 3. Mark read when viewing chat\n    useEffect(() => {\n        if (activeTab === 'chats' && selectedChatPeerId && privateChats[selectedChatPeerId]?.unread > 0) {\n            setPrivateChats(prev => ({\n                ...prev,\n                [selectedChatPeerId]: {\n                    ...prev[selectedChatPeerId],\n                    unread: 0\n                }\n            }));\n        }\n    }, [activeTab, selectedChatPeerId, privateChats]);\n\n\n    // Handlers\n    const handleLogin = (user: User) => {\n        setCurrentUser(user);\n        localStorage.setItem('chat_user', JSON.stringify(user));\n    };\n\n    const handleLogout = () => {\n        setCurrentUser(null);\n        setSocket(null);\n        localStorage.removeItem('chat_user');\n        setPrivateChats({});\n        setMessages(initialMessages); // Reset to basics\n        setSelectedChatPeerId(null);\n        setActiveTab('room');\n    };\n\n    const handleUpdateAlias = (newAlias: string) => {\n        if (!currentUser || !socket) return;\n\n        const updatedUser = { ...currentUser, alias: newAlias };\n        setCurrentUser(updatedUser);\n        localStorage.setItem('chat_user', JSON.stringify(updatedUser));\n\n        // Notify server - assuming server handles 'updateAlias' event or just re-join\n        // For simplicity reusing join or we could implement updateAlias on server\n        socket.emit('join', { user: updatedUser, tenantSlug: tenant.slug });\n    };\n\n    const handleGlobalSend = async (text: string) => {\n        if (!currentUser || !socket) return;\n\n        const tempId = Date.now().toString();\n        const optimisticMsg: Message = {\n            id: tempId,\n            text: text,\n            senderId: currentUser.id,\n            senderAlias: currentUser.alias,\n            senderGender: currentUser.gender,\n            timestamp: new Date().toISOString()\n        };\n\n        setMessages(prev => [...prev, optimisticMsg]);\n\n        socket.emit('sendMessage', {\n            ...optimisticMsg,\n            tenantSlug: tenant.slug\n        });\n    };\n\n    const handlePrivateSend = (text: string) => {\n        if (!currentUser || !socket || !selectedChatPeerId) return;\n\n        const msg: Message = {\n            id: Date.now().toString(),\n            text,\n            senderId: currentUser.id,\n            senderAlias: currentUser.alias,\n            senderGender: currentUser.gender,\n            timestamp: new Date().toISOString(),\n            recipientId: selectedChatPeerId\n        };\n\n        // Optimistic update\n        setPrivateChats(prev => ({\n            ...prev,\n            [selectedChatPeerId]: {\n                ...prev[selectedChatPeerId],\n                messages: [...prev[selectedChatPeerId].messages, msg]\n            }\n        }));\n\n        socket.emit('sendMessage', {\n            ...msg,\n            tenantSlug: tenant.slug,\n            isPrivate: true // Signal to server\n        });\n    }\n\n    const handleStartChat = (peer: User) => {\n        if (!privateChats[peer.id]) {\n            setPrivateChats(prev => ({\n                ...prev,\n                [peer.id]: { peer, messages: [], unread: 0 }\n            }));\n        }\n        setSelectedChatPeerId(peer.id);\n        setActiveTab('chats');\n    };\n\n    const handleDeleteChat = (peerId: string) => {\n        setPrivateChats(prev => {\n            const next = { ...prev };\n            delete next[peerId];\n            return next;\n        });\n        if (selectedChatPeerId === peerId) {\n            setSelectedChatPeerId(null);\n        }\n    };\n\n\n    // Render Login\n    if (!currentUser) {\n        return (\n            <div className=\"h-[100dvh] w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col\">\n                <Login onLogin={handleLogin} tenantName={tenant.name} />\n            </div>\n        );\n    }\n\n    // Render Private Chat View\n    if (selectedChatPeerId && activeTab === 'chats') {\n        const chat = privateChats[selectedChatPeerId];\n        // If chat was deleted but we are here, go back\n        if (!chat) {\n            setSelectedChatPeerId(null);\n            return null;\n        }\n\n        return (\n            <div className=\"flex flex-col w-full h-[100dvh] max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative\">\n                <header className=\"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0\">\n                    <div className=\"h-[60px] px-4 flex items-center gap-3\">\n                        <button onClick={() => setSelectedChatPeerId(null)} className=\"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                            </svg>\n                        </button>\n                        <div className=\"flex flex-col\">\n                            <h2 className=\"font-bold text-lg leading-tight\">{chat.peer.alias}</h2>\n                            {onlineUsers.some(u => u.id === selectedChatPeerId) && (\n                                <span className=\"text-xs text-emerald-500 font-medium\">Online</span>\n                            )}\n                        </div>\n                    </div>\n                </header>\n\n                <div className=\"flex-1 overflow-hidden relative\">\n                    <GlobalChat\n                        user={currentUser}\n                        messages={chat.messages}\n                        onSendMessage={handlePrivateSend}\n                        onlineCount={0}\n                        isOnline={true}\n                        hideHeader={true}\n                        showBottomNavPadding={false}\n                        onInputFocusChange={setIsInputFocused}\n                        isFocused={isInputFocused}\n                    />\n                </div>\n            </div>\n        );\n    }\n\n    const totalUnread = Object.values(privateChats).reduce((acc, chat) => acc + chat.unread, 0);\n\n    return (\n        <div className=\"flex flex-col w-full h-[100dvh] max-w-3xl mx-auto bg-gray-100 shadow-xl overflow-hidden relative\">\n            <div className=\"flex-1 overflow-hidden relative\">\n                {activeTab === 'room' && (\n                    <GlobalChat\n                        user={currentUser}\n                        messages={messages}\n                        onSendMessage={handleGlobalSend}\n                        onlineCount={onlineUsers.length}\n                        isOnline={isConnected}\n                        headerTitle={tenant.name}\n                        showBottomNavPadding={true}\n                        onInputFocusChange={setIsInputFocused}\n                        isFocused={isInputFocused}\n                    />\n                )}\n                {activeTab === 'users' && (\n                    <UserList\n                        currentUser={currentUser}\n                        users={onlineUsers}\n                        onStartChat={handleStartChat}\n                    />\n                )}\n                {activeTab === 'chats' && (\n                    <ChatList\n                        chats={Object.values(privateChats).map(c => ({ ...c, unreadCount: c.unread })).sort((a, b) => {\n                            const tA = a.messages.length ? new Date(a.messages[a.messages.length - 1].timestamp).getTime() : 0;\n                            const tB = b.messages.length ? new Date(b.messages[b.messages.length - 1].timestamp).getTime() : 0;\n                            return tB - tA;\n                        })}\n                        onSelectChat={setSelectedChatPeerId}\n                        onDeleteChat={handleDeleteChat}\n                    />\n                )}\n                {activeTab === 'settings' && (\n                    <Settings\n                        user={currentUser}\n                        onLogout={handleLogout}\n                        onUpdateAlias={handleUpdateAlias}\n                    />\n                )}\n            </div>\n\n            {!isInputFocused && (\n                <BottomNav\n                    activeTab={activeTab}\n                    onTabChange={(t) => {\n                        setActiveTab(t);\n                        setSelectedChatPeerId(null);\n                    }}\n                    usersCount={onlineUsers.length}\n                    unreadChatsCount={totalUnread}\n                />\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}