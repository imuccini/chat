{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 17, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/lib/auth.ts"],"sourcesContent":["import { betterAuth } from \"better-auth\";\nimport { prismaAdapter } from \"better-auth/adapters/prisma\";\nimport { prisma } from \"./db\";\n\nexport const auth = betterAuth({\n    database: prismaAdapter(prisma, {\n        provider: \"postgresql\", // or \"mysql\", \"sqlite\"\n    }),\n    emailAndPassword: {\n        enabled: true\n    },\n    // Optional: Add more providers (Google, GitHub, etc.)\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;AACA;;;;AAEO,MAAM,OAAO,IAAA,qKAAU,EAAC;IAC3B,UAAU,IAAA,8MAAa,EAAC,mHAAM,EAAE;QAC5B,UAAU;IACd;IACA,kBAAkB;QACd,SAAS;IACb;AAEJ"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/services/messageService.ts"],"sourcesContent":["import { prisma } from \"@/lib/db\";\n\n// SERVICE: Tenant Resolution\nexport const getTenantByNasId = async (nasId: string) => {\n    return await prisma.tenant.findFirst({\n        where: {\n            devices: {\n                some: {\n                    nasId: nasId\n                }\n            }\n        }\n    });\n};\n\nexport const getTenantBySlug = async (slug: string) => {\n    return await prisma.tenant.findUnique({\n        where: { slug },\n    });\n};\n\n// SERVICE: Messagging (Multi-tenant Filtered)\nexport const getMessages = async (tenantId: string, limit = 50) => {\n    return await prisma.message.findMany({\n        where: { tenantId },\n        orderBy: { createdAt: \"desc\" },\n        take: limit,\n        include: { user: true }, // Include sender details\n    });\n};\n\nexport const createMessage = async (content: string, userId: string, tenantId: string) => {\n    return await prisma.message.create({\n        data: {\n            content,\n            userId,\n            tenantId,\n        },\n    });\n};\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,mBAAmB,OAAO;IACnC,OAAO,MAAM,mHAAM,CAAC,MAAM,CAAC,SAAS,CAAC;QACjC,OAAO;YACH,SAAS;gBACL,MAAM;oBACF,OAAO;gBACX;YACJ;QACJ;IACJ;AACJ;AAEO,MAAM,kBAAkB,OAAO;IAClC,OAAO,MAAM,mHAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE;QAAK;IAClB;AACJ;AAGO,MAAM,cAAc,OAAO,UAAkB,QAAQ,EAAE;IAC1D,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;QACjC,OAAO;YAAE;QAAS;QAClB,SAAS;YAAE,WAAW;QAAO;QAC7B,MAAM;QACN,SAAS;YAAE,MAAM;QAAK;IAC1B;AACJ;AAEO,MAAM,gBAAgB,OAAO,SAAiB,QAAgB;IACjE,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC/B,MAAM;YACF;YACA;YACA;QACJ;IACJ;AACJ"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/app/actions/sendMessage.ts"],"sourcesContent":["'use server'\n\nimport { auth } from \"@/lib/auth\"; // Better-auth\nimport { createMessage } from \"@/services/messageService\";\nimport { headers } from \"next/headers\";\nimport { revalidatePath } from \"next/cache\";\n\nexport async function sendMessageAction(formData: FormData) {\n    // 1. Authentication Check\n    const session = await auth.api.getSession({\n        headers: await headers()\n    });\n\n    if (!session || !session.user) {\n        return { success: false, error: \"Unauthorized\" };\n    }\n\n    // 2. Extract Data\n    const content = formData.get(\"content\") as string;\n    const tenantId = formData.get(\"tenantId\") as string;\n\n    if (!content || !tenantId) {\n        return { success: false, error: \"Missing content or tenantId\" };\n    }\n\n    try {\n        // 3. Create Message (Service Pattern)\n        await createMessage(content, session.user.id, tenantId);\n\n        // 4. Revalidate UI\n        revalidatePath(`/chat/${tenantId}`); // Assume this is the path\n        return { success: true };\n\n    } catch (error) {\n        console.error(\"Failed to send message:\", error);\n        return { success: false, error: \"Failed to send message\" };\n    }\n}\n"],"names":[],"mappings":";;;;;AAEA,2LAAmC,cAAc;AACjD;AACA;AACA;;;;;;;AAEO,eAAe,kBAAkB,QAAkB;IACtD,0BAA0B;IAC1B,MAAM,UAAU,MAAM,mHAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QACtC,SAAS,MAAM,IAAA,0IAAO;IAC1B;IAEA,IAAI,CAAC,WAAW,CAAC,QAAQ,IAAI,EAAE;QAC3B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAe;IACnD;IAEA,kBAAkB;IAClB,MAAM,UAAU,SAAS,GAAG,CAAC;IAC7B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,IAAI,CAAC,WAAW,CAAC,UAAU;QACvB,OAAO;YAAE,SAAS;YAAO,OAAO;QAA8B;IAClE;IAEA,IAAI;QACA,sCAAsC;QACtC,MAAM,IAAA,2IAAa,EAAC,SAAS,QAAQ,IAAI,CAAC,EAAE,EAAE;QAE9C,mBAAmB;QACnB,IAAA,+IAAc,EAAC,CAAC,MAAM,EAAE,UAAU,GAAG,0BAA0B;QAC/D,OAAO;YAAE,SAAS;QAAK;IAE3B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;YAAE,SAAS;YAAO,OAAO;QAAyB;IAC7D;AACJ;;;IA9BsB;;AAAA,+OAAA"}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/.next-internal/server/app/%5BtenantSlug%5D/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {sendMessageAction as '4098d4b807b76ceeda77f167f9adae4f2e40b6eff8'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}