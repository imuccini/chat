{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/services/messageService.ts"],"sourcesContent":["import { prisma } from \"@/lib/db\";\n\n// SERVICE: Tenant Resolution\nexport const getTenantByNasId = async (nasId: string) => {\n    return await prisma.tenant.findFirst({\n        where: {\n            devices: {\n                some: {\n                    nasId: nasId\n                }\n            }\n        }\n    });\n};\n\nexport const getTenantBySlug = async (slug: string) => {\n    return await prisma.tenant.findUnique({\n        where: { slug },\n    });\n};\n\n// SERVICE: Messagging (Multi-tenant Filtered)\nexport const getMessages = async (tenantId: string, limit = 50) => {\n    return await prisma.message.findMany({\n        where: { tenantId },\n        orderBy: { createdAt: \"desc\" },\n        take: limit,\n        include: { user: true }, // Include sender details\n    });\n};\n\nexport const createMessage = async (content: string, userId: string, tenantId: string) => {\n    return await prisma.message.create({\n        data: {\n            content,\n            userId,\n            tenantId,\n        },\n    });\n};\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,mBAAmB,OAAO;IACnC,OAAO,MAAM,mHAAM,CAAC,MAAM,CAAC,SAAS,CAAC;QACjC,OAAO;YACH,SAAS;gBACL,MAAM;oBACF,OAAO;gBACX;YACJ;QACJ;IACJ;AACJ;AAEO,MAAM,kBAAkB,OAAO;IAClC,OAAO,MAAM,mHAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE;QAAK;IAClB;AACJ;AAGO,MAAM,cAAc,OAAO,UAAkB,QAAQ,EAAE;IAC1D,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;QACjC,OAAO;YAAE;QAAS;QAClB,SAAS;YAAE,WAAW;QAAO;QAC7B,MAAM;QACN,SAAS;YAAE,MAAM;QAAK;IAC1B;AACJ;AAEO,MAAM,gBAAgB,OAAO,SAAiB,QAAgB;IACjE,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC/B,MAAM;YACF;YACA;YACA;QACJ;IACJ;AACJ"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/ChatInterface.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/ChatInterface.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ChatInterface.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAgS,GAC7T,8DACA","ignoreList":[0]}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/components/ChatInterface.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/ChatInterface.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ChatInterface.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4Q,GACzS,0CACA","ignoreList":[0]}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Apps/Antigravity/chat/chat/app/%5BtenantSlug%5D/page.tsx"],"sourcesContent":["import { getTenantBySlug, getMessages } from \"@/services/messageService\";\nimport { notFound } from \"next/navigation\";\nimport ChatInterface from \"@/components/ChatInterface\";\nimport { User, Message } from \"@/types\"; // We will ensure this exists/is compatible\n\ninterface PageProps {\n    params: Promise<{ tenantSlug: string }>\n}\n\nexport default async function TenantChatPage(props: PageProps) {\n    const params = await props.params;\n    const tenantSlug = params.tenantSlug;\n\n    // 1. Fetch Tenant\n    const tenant = await getTenantBySlug(tenantSlug);\n    if (!tenant) {\n        notFound();\n    }\n\n    // 2. Fetch History (Server-side)\n    // Note: getMessages returns Prisma objects, we might need to map them to our UI types\n    const dbMessages = await getMessages(tenant.id);\n\n    // Transform to UI Message type\n    const initialMessages: Message[] = dbMessages.map(msg => ({\n        id: msg.id,\n        text: msg.content,\n        senderId: msg.userId,\n        senderAlias: msg.user?.name || \"Anonymous\", // Fallback\n        senderGender: \"other\", // Database doesn't have gender yet, default/mock\n        timestamp: msg.createdAt.toISOString(),\n        // Add other fields if necessary\n    }));\n\n    return (\n        <main className=\"flex h-screen flex-col items-center justify-between\">\n            <ChatInterface\n                tenant={tenant}\n                initialMessages={initialMessages}\n            />\n        </main>\n    );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;;;;;AAOe,eAAe,eAAe,KAAgB;IACzD,MAAM,SAAS,MAAM,MAAM,MAAM;IACjC,MAAM,aAAa,OAAO,UAAU;IAEpC,kBAAkB;IAClB,MAAM,SAAS,MAAM,IAAA,6IAAe,EAAC;IACrC,IAAI,CAAC,QAAQ;QACT,IAAA,iMAAQ;IACZ;IAEA,iCAAiC;IACjC,sFAAsF;IACtF,MAAM,aAAa,MAAM,IAAA,yIAAW,EAAC,OAAO,EAAE;IAE9C,+BAA+B;IAC/B,MAAM,kBAA6B,WAAW,GAAG,CAAC,CAAA,MAAO,CAAC;YACtD,IAAI,IAAI,EAAE;YACV,MAAM,IAAI,OAAO;YACjB,UAAU,IAAI,MAAM;YACpB,aAAa,IAAI,IAAI,EAAE,QAAQ;YAC/B,cAAc;YACd,WAAW,IAAI,SAAS,CAAC,WAAW;QAExC,CAAC;IAED,qBACI,8OAAC;QAAK,WAAU;kBACZ,cAAA,8OAAC,uIAAa;YACV,QAAQ;YACR,iBAAiB;;;;;;;;;;;AAIjC"}}]
}