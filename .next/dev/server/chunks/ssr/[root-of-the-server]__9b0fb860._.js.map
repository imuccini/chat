{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/config.ts"],"sourcesContent":["import { Capacitor } from '@capacitor/core';\n\n// Detect if running natively (iOS or Android)\nconst isNative = Capacitor.isNativePlatform();\n\n// Use env variable or fallback\n// Set NEXT_PUBLIC_SERVER_URL in .env to your local IP (e.g. http://192.168.1.x:3000)\nexport const API_BASE_URL = isNative\n    ? (process.env.NEXT_PUBLIC_SERVER_URL || 'http://localhost:3000')\n    : '';\n\nif (isNative) {\n    console.log(\"[ChatConfig] Native Platform Detected. API_BASE_URL:\", API_BASE_URL);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,8CAA8C;AAC9C,MAAM,WAAW,iKAAS,CAAC,gBAAgB;AAIpC,MAAM,eAAe,WACrB,iEAAsC,0BACvC;AAEN,IAAI,UAAU;IACV,QAAQ,GAAG,CAAC,wDAAwD;AACxE"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/services/apiService.ts"],"sourcesContent":["import { API_BASE_URL } from \"@/config\";\nimport { Message } from \"@/types\";\n\nexport const clientResolveTenant = async (urlNasId?: string, bssid?: string): Promise<string | null> => {\n    const params = new URLSearchParams();\n    if (bssid) params.append('bssid', bssid);\n    if (urlNasId) params.append('nas_id', urlNasId);\n\n    const query = params.toString() ? `?${params.toString()}` : '';\n    const res = await fetch(`${API_BASE_URL}/api/validate-nas${query}`);\n    if (!res.ok) return null;\n    const data = await res.json();\n    return data.valid ? data.tenantSlug : null;\n};\n\nexport const clientGetTenantBySlug = async (slug: string) => {\n    const res = await fetch(`${API_BASE_URL}/api/tenants/${slug}`);\n    if (!res.ok) return null;\n    return await res.json();\n};\n\nexport const clientGetMessages = async (tenantSlug: string): Promise<Message[]> => {\n    const res = await fetch(`${API_BASE_URL}/api/messages?tenant=${tenantSlug}`);\n    if (!res.ok) return [];\n    return await res.json();\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGO,MAAM,sBAAsB,OAAO,UAAmB;IACzD,MAAM,SAAS,IAAI;IACnB,IAAI,OAAO,OAAO,MAAM,CAAC,SAAS;IAClC,IAAI,UAAU,OAAO,MAAM,CAAC,UAAU;IAEtC,MAAM,QAAQ,OAAO,QAAQ,KAAK,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IAC5D,MAAM,MAAM,MAAM,MAAM,GAAG,sHAAY,CAAC,iBAAiB,EAAE,OAAO;IAClE,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;IACpB,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,KAAK,KAAK,GAAG,KAAK,UAAU,GAAG;AAC1C;AAEO,MAAM,wBAAwB,OAAO;IACxC,MAAM,MAAM,MAAM,MAAM,GAAG,sHAAY,CAAC,aAAa,EAAE,MAAM;IAC7D,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;IACpB,OAAO,MAAM,IAAI,IAAI;AACzB;AAEO,MAAM,oBAAoB,OAAO;IACpC,MAAM,MAAM,MAAM,MAAM,GAAG,sHAAY,CAAC,qBAAqB,EAAE,YAAY;IAC3E,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE;IACtB,OAAO,MAAM,IAAI,IAAI;AACzB"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/lib/wifi.ts"],"sourcesContent":["import { Capacitor } from '@capacitor/core';\n\n// Dynamic import to avoid issues on web\nlet CapacitorWifi: any = null;\n\nasync function loadWifiPlugin() {\n    if (Capacitor.isNativePlatform() && !CapacitorWifi) {\n        try {\n            const module = await import('@capgo/capacitor-wifi');\n            CapacitorWifi = module.CapacitorWifi;\n        } catch (err) {\n            console.error('Failed to load WiFi plugin:', err);\n        }\n    }\n    return CapacitorWifi;\n}\n\nexport interface WifiInfo {\n    ssid: string | null;\n    bssid: string | null;\n    isConnected: boolean;\n}\n\n/**\n * Get the BSSID of the currently connected WiFi network.\n * Returns null on web or if not connected to WiFi.\n */\nexport async function getConnectedWifiInfo(): Promise<WifiInfo> {\n    if (!Capacitor.isNativePlatform()) {\n        return { ssid: null, bssid: null, isConnected: false };\n    }\n\n    const wifi = await loadWifiPlugin();\n    if (!wifi) {\n        return { ssid: null, bssid: null, isConnected: false };\n    }\n\n    try {\n        const info = await wifi.getWifiInfo();\n        return {\n            ssid: info.ssid || null,\n            bssid: info.bssid || null,\n            isConnected: !!info.ssid\n        };\n    } catch (err) {\n        console.error('Error getting WiFi info:', err);\n        return { ssid: null, bssid: null, isConnected: false };\n    }\n}\n\n/**\n * Check and request location permissions required for WiFi info.\n * Returns true if permissions are granted, false otherwise.\n */\nexport async function checkAndRequestLocationPermissions(): Promise<boolean> {\n    if (!Capacitor.isNativePlatform()) {\n        return true; // Not needed on web\n    }\n\n    const wifi = await loadWifiPlugin();\n    if (!wifi) {\n        return false;\n    }\n\n    try {\n        // Check current permission status\n        const status = await wifi.checkPermissions();\n\n        if (status.location === 'granted') {\n            return true;\n        }\n\n        // Request permissions if not granted\n        const result = await wifi.requestPermissions();\n        return result.location === 'granted';\n    } catch (err) {\n        console.error('Error checking/requesting permissions:', err);\n        return false;\n    }\n}\n\n/**\n * Check if WiFi is enabled on the device.\n */\nexport async function isWifiEnabled(): Promise<boolean> {\n    if (!Capacitor.isNativePlatform()) {\n        return true; // Assume true on web\n    }\n\n    const wifi = await loadWifiPlugin();\n    if (!wifi) {\n        return false;\n    }\n\n    try {\n        const status = await wifi.getStatus();\n        return status.enabled;\n    } catch (err) {\n        console.error('Error checking WiFi status:', err);\n        return false;\n    }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,wCAAwC;AACxC,IAAI,gBAAqB;AAEzB,eAAe;IACX,IAAI,iKAAS,CAAC,gBAAgB,MAAM,CAAC,eAAe;QAChD,IAAI;YACA,MAAM,SAAS;YACf,gBAAgB,OAAO,aAAa;QACxC,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC,+BAA+B;QACjD;IACJ;IACA,OAAO;AACX;AAYO,eAAe;IAClB,IAAI,CAAC,iKAAS,CAAC,gBAAgB,IAAI;QAC/B,OAAO;YAAE,MAAM;YAAM,OAAO;YAAM,aAAa;QAAM;IACzD;IAEA,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACP,OAAO;YAAE,MAAM;YAAM,OAAO;YAAM,aAAa;QAAM;IACzD;IAEA,IAAI;QACA,MAAM,OAAO,MAAM,KAAK,WAAW;QACnC,OAAO;YACH,MAAM,KAAK,IAAI,IAAI;YACnB,OAAO,KAAK,KAAK,IAAI;YACrB,aAAa,CAAC,CAAC,KAAK,IAAI;QAC5B;IACJ,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YAAE,MAAM;YAAM,OAAO;YAAM,aAAa;QAAM;IACzD;AACJ;AAMO,eAAe;IAClB,IAAI,CAAC,iKAAS,CAAC,gBAAgB,IAAI;QAC/B,OAAO,MAAM,oBAAoB;IACrC;IAEA,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACP,OAAO;IACX;IAEA,IAAI;QACA,kCAAkC;QAClC,MAAM,SAAS,MAAM,KAAK,gBAAgB;QAE1C,IAAI,OAAO,QAAQ,KAAK,WAAW;YAC/B,OAAO;QACX;QAEA,qCAAqC;QACrC,MAAM,SAAS,MAAM,KAAK,kBAAkB;QAC5C,OAAO,OAAO,QAAQ,KAAK;IAC/B,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,0CAA0C;QACxD,OAAO;IACX;AACJ;AAKO,eAAe;IAClB,IAAI,CAAC,iKAAS,CAAC,gBAAgB,IAAI;QAC/B,OAAO,MAAM,qBAAqB;IACtC;IAEA,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACP,OAAO;IACX;IAEA,IAAI;QACA,MAAM,SAAS,MAAM,KAAK,SAAS;QACnC,OAAO,OAAO,OAAO;IACzB,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO;IACX;AACJ"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/components/LandingPage.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport Link from 'next/link';\nimport { MessageSquare, Shield, Zap, Users, ArrowRight, Share2, Globe } from 'lucide-react';\n\ninterface LandingPageProps {\n    onConnect: () => void;\n}\n\nexport default function LandingPage({ onConnect }: LandingPageProps) {\n    return (\n        <div className=\"min-h-screen bg-white text-gray-900 font-sans selection:bg-emerald-100 selection:text-emerald-900\">\n            {/* Navigation */}\n            <nav className=\"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-md border-b border-gray-100\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"flex justify-between items-center h-16\">\n                        <div className=\"flex items-center gap-2\">\n                            <div className=\"w-8 h-8 rounded-lg bg-emerald-500 flex items-center justify-center shadow-emerald-200 shadow-lg\">\n                                <img src=\"/local_logo.svg\" alt=\"Local\" className=\"w-5 h-5 brightness-0 invert\" />\n                            </div>\n                            <span className=\"font-bold text-xl tracking-tight text-gray-900\">Local</span>\n                        </div>\n                        <div className=\"hidden md:flex items-center gap-8\">\n                            <a href=\"#features\" className=\"text-sm font-medium text-gray-500 hover:text-emerald-600 transition-colors\">Funzionalità</a>\n                            <a href=\"#how-it-works\" className=\"text-sm font-medium text-gray-500 hover:text-emerald-600 transition-colors\">Come funziona</a>\n                            <button\n                                onClick={onConnect}\n                                className=\"bg-emerald-500 hover:bg-emerald-600 text-white px-5 py-2 rounded-full text-sm font-semibold transition-all shadow-emerald-100 shadow-xl active:scale-95\"\n                            >\n                                Accedi alla Chat\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </nav>\n\n            {/* Hero Section */}\n            <section className=\"pt-32 pb-20 px-4 sm:px-6 lg:px-8\">\n                <div className=\"max-w-4xl mx-auto text-center\">\n                    <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-50 border border-emerald-100 text-emerald-600 text-xs font-bold mb-6 animate-fade-in\">\n                        <Zap className=\"w-3 h-3 fill-emerald-600\" />\n                        <span>NUOVO: ACCESSO TRAMITE PASSKEY</span>\n                    </div>\n                    <h1 className=\"text-5xl md:text-7xl font-extrabold tracking-tight text-gray-900 mb-6 bg-clip-text text-transparent bg-gradient-to-b from-gray-900 to-gray-600\">\n                        Connettiti con chi ti sta intorno.\n                    </h1>\n                    <p className=\"text-xl text-gray-500 mb-10 max-w-2xl mx-auto leading-relaxed\">\n                        La chat locale istantanea per treni, aeroporti e spazi pubblici. Nessuna app da installare, nessuna registrazione obbligatoria. Solo tu e la rete locale.\n                    </p>\n                    <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n                        <button\n                            onClick={onConnect}\n                            className=\"w-full sm:w-auto px-8 py-4 bg-emerald-500 hover:bg-emerald-600 text-white rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all shadow-emerald-200 shadow-2xl hover:-translate-y-1 active:scale-95 group\"\n                        >\n                            Connettiti ora\n                            <ArrowRight className=\"w-5 h-5 group-hover:translate-x-1 transition-transform\" />\n                        </button>\n                        <p className=\"text-sm text-gray-400\">\n                            Disponibile su tutte le reti WiFi abilitate.\n                        </p>\n                    </div>\n                </div>\n\n                {/* Abstract UI Preview */}\n                <div className=\"mt-20 max-w-5xl mx-auto relative px-4\">\n                    <div className=\"relative rounded-3xl overflow-hidden shadow-2xl border border-gray-100 bg-gray-50/50 p-2 sm:p-4 backdrop-blur-sm\">\n                        <div className=\"rounded-2xl overflow-hidden bg-white aspect-[16/9] flex items-center justify-center relative border border-gray-100\">\n                            <div className=\"absolute inset-0 bg-gradient-to-tr from-emerald-50/50 to-transparent pointer-events-none\" />\n                            <div className=\"flex flex-col items-center gap-4 max-w-md text-center\">\n                                <div className=\"w-20 h-20 rounded-2xl bg-emerald-50 flex items-center justify-center border border-emerald-100\">\n                                    <MessageSquare className=\"w-10 h-10 text-emerald-500\" />\n                                </div>\n                                <div>\n                                    <div className=\"h-4 w-32 bg-gray-100 rounded-full mx-auto mb-2\" />\n                                    <div className=\"h-3 w-48 bg-gray-50 rounded-full mx-auto\" />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    {/* Decorative elements */}\n                    <div className=\"absolute -top-10 -right-10 w-40 h-40 bg-emerald-400/10 rounded-full blur-3xl -z-10\" />\n                    <div className=\"absolute -bottom-10 -left-10 w-40 h-40 bg-emerald-400/10 rounded-full blur-3xl -z-10\" />\n                </div>\n            </section>\n\n            {/* Features Grid */}\n            <section id=\"features\" className=\"py-24 bg-gray-50/50\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"text-center mb-16\">\n                        <h2 className=\"text-3xl font-bold text-gray-900 mb-4\">Zero attrito, massima velocità.</h2>\n                        <p className=\"text-gray-500 max-w-xl mx-auto text-lg\">Local è progettato per essere invisibile ma indispensabile durante i tuoi spostamenti.</p>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                        <div className=\"bg-white p-8 rounded-3xl border border-gray-50 shadow-sm hover:shadow-md transition-shadow\">\n                            <div className=\"w-12 h-12 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 mb-6\">\n                                <Zap className=\"w-6 h-6 fill-emerald-500\" />\n                            </div>\n                            <h3 className=\"text-xl font-bold mb-3\">Connessione Istantanea</h3>\n                            <p className=\"text-gray-500 leading-relaxed\">\n                                Niente account da creare se non vuoi. Ti connetti al WiFi, apri l'app e sei subito nella chat dello spazio in cui ti trovi.\n                            </p>\n                        </div>\n\n                        <div className=\"bg-white p-8 rounded-3xl border border-gray-50 shadow-sm hover:shadow-md transition-shadow\">\n                            <div className=\"w-12 h-12 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 mb-6\">\n                                <Shield className=\"w-6 h-6 fill-emerald-500\" />\n                            </div>\n                            <h3 className=\"text-xl font-bold mb-3\">Privacy & Passkey</h3>\n                            <p className=\"text-gray-500 leading-relaxed\">\n                                Usa l'accesso anonimo per una sessione veloce, oppure salva il tuo profilo con le Passkey per una riconsociuta sicura e senza password.\n                            </p>\n                        </div>\n\n                        <div className=\"bg-white p-8 rounded-3xl border border-gray-50 shadow-sm hover:shadow-md transition-shadow\">\n                            <div className=\"w-12 h-12 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 mb-6\">\n                                <Share2 className=\"w-6 h-6\" />\n                            </div>\n                            <h3 className=\"text-xl font-bold mb-3\">Chat di Luogo</h3>\n                            <p className=\"text-gray-500 leading-relaxed\">\n                                Parla con gli altri viaggiatori sul tuo treno o con chi sta aspettando il volo insieme a te. Condividi info utili in tempo reale.\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            </section>\n\n            {/* Trust / How it works */}\n            <section id=\"how-it-works\" className=\"py-24 px-4 sm:px-6 lg:px-8\">\n                <div className=\"max-w-4xl mx-auto\">\n                    <div className=\"bg-gray-900 rounded-[3rem] p-8 md:p-16 relative overflow-hidden text-center md:text-left\">\n                        <div className=\"relative z-10 flex flex-col md:flex-row items-center gap-10\">\n                            <div className=\"flex-1\">\n                                <h2 className=\"text-3xl md:text-4xl font-bold text-white mb-6\">Come funziona l'accesso locale?</h2>\n                                <ul className=\"space-y-4\">\n                                    {[\n                                        \"L'app identifica automaticamente lo spazio tramite il WiFi\",\n                                        \"Vieni assegnato alla stanza corretta in pochi millisecondi\",\n                                        \"Puoi scegliere un alias e iniziare subito a scrivere\"\n                                    ].map((text, i) => (\n                                        <li key={i} className=\"flex items-center gap-3 text-gray-300\">\n                                            <div className=\"w-5 h-5 rounded-full bg-emerald-500/20 border border-emerald-500/30 flex items-center justify-center text-emerald-400 text-[10px] font-bold\">\n                                                {i + 1}\n                                            </div>\n                                            <span>{text}</span>\n                                        </li>\n                                    ))}\n                                </ul>\n                            </div>\n                            <div className=\"w-40 h-40 md:w-56 md:h-56 bg-emerald-500 rounded-3xl flex items-center justify-center shadow-2xl shadow-emerald-500/20 rotate-3\">\n                                <Users className=\"w-20 h-20 md:w-28 md:h-28 text-white\" />\n                            </div>\n                        </div>\n                        {/* Background pattern */}\n                        <div className=\"absolute inset-0 opacity-10 pointer-events-none bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:20px_20px]\" />\n                    </div>\n                </div>\n            </section>\n\n            {/* CTA Footer Section */}\n            <section className=\"py-20 text-center px-4\">\n                <h2 className=\"text-3xl font-bold mb-8\">Pronto a iniziare?</h2>\n                <button\n                    onClick={onConnect}\n                    className=\"px-10 py-5 bg-gray-900 hover:bg-black text-white rounded-2xl font-bold text-xl transition-all shadow-xl active:scale-95\"\n                >\n                    Entra in Local Chat\n                </button>\n            </section>\n\n            {/* Footer */}\n            <footer className=\"border-t border-gray-100 py-12 px-4 bg-white\">\n                <div className=\"max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-8\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-6 h-6 rounded-md bg-emerald-500 flex items-center justify-center\">\n                            <img src=\"/local_logo.svg\" alt=\"Local\" className=\"w-4 h-4 brightness-0 invert\" />\n                        </div>\n                        <span className=\"font-bold text-lg\">Local</span>\n                    </div>\n\n                    <div className=\"flex items-center gap-8 text-sm font-medium text-gray-400\">\n                        <Link href=\"/privacy\" className=\"hover:text-emerald-500 transition-colors\">Privacy Policy</Link>\n                        <Link href=\"/terms\" className=\"hover:text-emerald-500 transition-colors\">Terms of Use</Link>\n                        <a href=\"mailto:hello@localchat.app\" className=\"hover:text-emerald-500 transition-colors\">Contatti</a>\n                    </div>\n\n                    <p className=\"text-gray-400 text-sm\">\n                        © 2025 Local Team. All rights reserved.\n                    </p>\n                </div>\n            </footer>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 868, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivanmuccini/Desktop/chatapp/chat/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, Suspense } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { clientResolveTenant } from \"@/services/apiService\";\nimport { Capacitor } from \"@capacitor/core\";\nimport { checkAndRequestLocationPermissions, getConnectedWifiInfo } from \"@/lib/wifi\";\nimport { API_BASE_URL } from \"@/config\";\nimport LandingPage from \"@/components/LandingPage\";\n\ntype InitState = 'loading' | 'permission_denied' | 'wifi_disconnected' | 'tenant_not_found' | 'error';\n\nfunction HomeContent() {\n    const router = useRouter();\n    const searchParams = useSearchParams();\n    const [state, setState] = useState<InitState | 'idle'>('idle');\n    const [errorMessage, setErrorMessage] = useState<string | null>(null);\n\n    const initConnect = async () => {\n        setState('loading');\n        try {\n            const isNative = Capacitor.isNativePlatform();\n\n            const nasId = searchParams.get('nas_id') || undefined;\n            let bssid: string | undefined = undefined;\n\n            // Native app: attempt to get BSSID\n            if (isNative) {\n                try {\n                    const wifiCheckPromise = async () => {\n                        const hasPermission = await checkAndRequestLocationPermissions();\n                        if (hasPermission) {\n                            const wifiInfo = await getConnectedWifiInfo();\n                            if (wifiInfo.isConnected && wifiInfo.bssid) {\n                                bssid = wifiInfo.bssid;\n                            }\n                        }\n                    };\n\n                    const timeoutPromise = new Promise((_, reject) =>\n                        setTimeout(() => reject(new Error(\"Timeout\")), 1500)\n                    );\n\n                    await Promise.race([wifiCheckPromise(), timeoutPromise]);\n                } catch (e) {\n                    console.warn(\"WiFi detection skipped or failed:\", e);\n                }\n            }\n\n            // Resolve tenant\n            const tenantSlug = await clientResolveTenant(nasId, bssid);\n\n            if (tenantSlug) {\n                router.replace(`/${tenantSlug}`);\n            } else {\n                setState('tenant_not_found');\n            }\n        } catch (err: any) {\n            console.error(\"Failed to resolve tenant\", err);\n            setErrorMessage(\"Errore durante l'identificazione dello spazio chat.\");\n            setState('error');\n        }\n    };\n\n    // If idle, show Landing Page\n    if (state === 'idle') {\n        return <LandingPage onConnect={initConnect} />;\n    }\n\n    // Loading state\n    if (state === 'loading') {\n        return (\n            <div className=\"h-screen w-full flex flex-col items-center justify-center bg-white p-4\">\n                <div className=\"w-24 h-24 mb-6 flex items-center justify-center\">\n                    <img src=\"/local_logo.svg\" alt=\"Local Logo\" className=\"w-full h-full object-contain animate-pulse\" />\n                </div>\n                <div className=\"text-gray-400 font-medium animate-pulse\">Ricerca spazio locale...</div>\n            </div>\n        );\n    }\n\n    // Error states\n    const errorConfig = {\n        permission_denied: {\n            title: \"Permessi Richiesti\",\n            message: \"Per identificare la tua posizione, l'app ha bisogno del permesso di localizzazione.\",\n            hint: \"Vai nelle Impostazioni del telefono e abilita i permessi di localizzazione.\"\n        },\n        wifi_disconnected: {\n            title: \"WiFi Non Connesso\",\n            message: \"Devi essere connesso alla rete WiFi del locale per accedere alla chat.\",\n            hint: \"Connettiti al WiFi del treno o del locale e riprova.\"\n        },\n        tenant_not_found: {\n            title: \"Accesso Negato\",\n            message: \"Impossibile identificare lo spazio chat automaticamente.\",\n            hint: \"Assicurati di essere connesso al WiFi del servizio (es. WiFi Treno).\"\n        },\n        error: {\n            title: \"Errore\",\n            message: errorMessage || \"Si è verificato un errore imprevisto.\",\n            hint: \"Riprova più tardi.\"\n        },\n        idle: { title: \"\", message: \"\", hint: \"\" }\n    };\n\n    const config = errorConfig[state as keyof typeof errorConfig];\n\n    return (\n        <div className=\"h-screen w-full flex items-center justify-center bg-gray-50/50 backdrop-blur-sm p-4 animate-in fade-in zoom-in duration-300\">\n            <div className=\"text-center p-8 bg-white rounded-[2.5rem] shadow-2xl border border-gray-100 max-w-md\">\n                <div className=\"w-20 h-20 mx-auto mb-6 flex items-center justify-center rounded-2xl bg-gray-50\">\n                    <img src=\"/local_logo.svg\" alt=\"Local Logo\" className=\"w-12 h-12 object-contain\" />\n                </div>\n                <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{config.title}</h1>\n                <p className=\"text-gray-600 mb-2 leading-relaxed\">{config.message}</p>\n                <p className=\"text-gray-400 text-sm italic\">{config.hint}</p>\n\n                <div className=\"flex flex-col gap-3 mt-8\">\n                    <button\n                        onClick={initConnect}\n                        className=\"w-full px-6 py-4 bg-emerald-500 text-white rounded-2xl font-bold hover:bg-emerald-600 transition-all shadow-lg shadow-emerald-200 active:scale-95\"\n                    >\n                        Riprova\n                    </button>\n                    <button\n                        onClick={() => setState('idle')}\n                        className=\"w-full px-6 py-3 text-gray-400 font-medium hover:text-gray-600 transition-colors\"\n                    >\n                        Torna alla home\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default function Home() {\n    return (\n        <Suspense fallback={\n            <div className=\"h-screen w-full flex items-center justify-center bg-gray-50\">\n                <div className=\"animate-pulse text-gray-400 font-medium\">Inizializzazione in corso...</div>\n            </div>\n        }>\n            <HomeContent />\n        </Suspense>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}