module.exports=[22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},92509,(a,b,c)=>{b.exports=a.x("url",()=>require("url"))},33405,(a,b,c)=>{b.exports=a.x("child_process",()=>require("child_process"))},21517,(a,b,c)=>{b.exports=a.x("http",()=>require("http"))},24836,(a,b,c)=>{b.exports=a.x("https",()=>require("https"))},63047,(a,b,c)=>{var d=a.r(22734),e=a.r(92509),f=a.r(33405).spawn;function g(b){"use strict";b=b||{};var c,g,h=this,i=a.r(21517),j=a.r(24836),k={},l=!1,m={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},n=Object.assign({},m),o=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],p=["TRACE","TRACK","CONNECT"],q=!1,r=!1,s=!1,t={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null,this.open=function(a,b,c,d,e){if(this.abort(),r=!1,s=!1,!(a&&-1===p.indexOf(a)))throw Error("SecurityError: Request method not allowed");k={method:a,url:b.toString(),async:"boolean"!=typeof c||c,user:d||null,password:e||null},u(this.OPENED)},this.setDisableHeaderCheck=function(a){l=a},this.setRequestHeader=function(a,b){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!l&&(!a||-1!==o.indexOf(a.toLowerCase())))return console.warn('Refused to set unsafe header "'+a+'"'),!1;if(q)throw Error("INVALID_STATE_ERR: send flag is true");return n[a]=b,!0},this.getResponseHeader=function(a){return"string"==typeof a&&this.readyState>this.OPENED&&g.headers[a.toLowerCase()]&&!r?g.headers[a.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||r)return"";var a="";for(var b in g.headers)"set-cookie"!==b&&"set-cookie2"!==b&&(a+=b+": "+g.headers[b]+"\r\n");return a.substr(0,a.length-2)},this.getRequestHeader=function(a){return"string"==typeof a&&n[a]?n[a]:""},this.send=function(a){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(q)throw Error("INVALID_STATE_ERR: send has already been called");var l,m=!1,o=!1,p=e.parse(k.url);switch(p.protocol){case"https:":m=!0;case"http:":l=p.hostname;break;case"file:":o=!0;break;case void 0:case"":l="localhost";break;default:throw Error("Protocol not supported.")}if(o){if("GET"!==k.method)throw Error("XMLHttpRequest: Only GET method is supported");if(k.async)d.readFile(unescape(p.pathname),function(a,b){a?h.handleError(a,a.errno||-1):(h.status=200,h.responseText=b.toString("utf8"),h.response=b,u(h.DONE))});else try{this.response=d.readFileSync(unescape(p.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,u(h.DONE)}catch(a){this.handleError(a,a.errno||-1)}return}var s=p.port||(m?443:80),t=p.pathname+(p.search?p.search:"");if(n.Host=l,m&&443===s||80===s||(n.Host+=":"+p.port),k.user){void 0===k.password&&(k.password="");var v=new Buffer(k.user+":"+k.password);n.Authorization="Basic "+v.toString("base64")}"GET"===k.method||"HEAD"===k.method?a=null:a?(n["Content-Length"]=Buffer.isBuffer(a)?a.length:Buffer.byteLength(a),Object.keys(n).some(function(a){return"content-type"===a.toLowerCase()})||(n["Content-Type"]="text/plain;charset=UTF-8")):"POST"===k.method&&(n["Content-Length"]=0);var w=b.agent||!1,x={host:l,port:s,path:t,method:k.method,headers:n,agent:w};if(m&&(x.pfx=b.pfx,x.key=b.key,x.passphrase=b.passphrase,x.cert=b.cert,x.ca=b.ca,x.ciphers=b.ciphers,x.rejectUnauthorized=!1!==b.rejectUnauthorized),r=!1,k.async){var y=m?j.request:i.request;q=!0,h.dispatchEvent("readystatechange");var z=function(a){if(302===(g=a).statusCode||303===g.statusCode||307===g.statusCode){k.url=g.headers.location;var d=e.parse(k.url);l=d.hostname;var f={hostname:d.hostname,port:d.port,path:d.path,method:303===g.statusCode?"GET":k.method,headers:n};m&&(f.pfx=b.pfx,f.key=b.key,f.passphrase=b.passphrase,f.cert=b.cert,f.ca=b.ca,f.ciphers=b.ciphers,f.rejectUnauthorized=!1!==b.rejectUnauthorized),(c=y(f,z).on("error",A)).end();return}u(h.HEADERS_RECEIVED),h.status=g.statusCode,g.on("data",function(a){if(a){var b=Buffer.from(a);h.response=Buffer.concat([h.response,b])}q&&u(h.LOADING)}),g.on("end",function(){q&&(q=!1,u(h.DONE),h.responseText=h.response.toString("utf8"))}),g.on("error",function(a){h.handleError(a)})},A=function(a){if(c.reusedSocket&&"ECONNRESET"===a.code)return y(x,z).on("error",A);h.handleError(a)};c=y(x,z).on("error",A),b.autoUnref&&c.on("socket",a=>{a.unref()}),a&&c.write(a),c.end(),h.dispatchEvent("loadstart")}else{var B=".node-xmlhttprequest-content-"+process.pid,C=".node-xmlhttprequest-sync-"+process.pid;d.writeFileSync(C,"","utf8");for(var D="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(m?"s":"")+".request;var options = "+JSON.stringify(x)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+B+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+C+"');});response.on('error', function(error) {fs.writeFileSync('"+B+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});}).on('error', function(error) {fs.writeFileSync('"+B+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});"+(a?"req.write('"+JSON.stringify(a).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",E=f(process.argv[0],["-e",D]);d.existsSync(C););if(h.responseText=d.readFileSync(B,"utf8"),E.stdin.end(),d.unlinkSync(B),h.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var F=JSON.parse(h.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));h.handleError(F,503)}else{h.status=h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var G=JSON.parse(h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));g={statusCode:h.status,headers:G.data.headers},h.responseText=G.data.text,h.response=Buffer.from(G.data.data,"base64"),u(h.DONE,!0)}}},this.handleError=function(a,b){this.status=b||0,this.statusText=a,this.responseText=a.stack,r=!0,u(this.DONE)},this.abort=function(){c&&(c.abort(),c=null),n=Object.assign({},m),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),r=s=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||q)&&this.readyState!==this.DONE&&(q=!1,u(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(a,b){a in t||(t[a]=[]),t[a].push(b)},this.removeEventListener=function(a,b){a in t&&(t[a]=t[a].filter(function(a){return a!==b}))},this.dispatchEvent=function(a){if("function"==typeof h["on"+a]&&(this.readyState===this.DONE&&k.async?setTimeout(function(){h["on"+a]()},0):h["on"+a]()),a in t)for(let b=0,c=t[a].length;b<c;b++)this.readyState===this.DONE?setTimeout(function(){t[a][b].call(h)},0):t[a][b].call(h)};var u=function(a){if(h.readyState!==a&&(h.readyState!==h.UNSENT||!s)&&(h.readyState=a,(k.async||h.readyState<h.OPENED||h.readyState===h.DONE)&&h.dispatchEvent("readystatechange"),h.readyState===h.DONE)){let a;a=s?"abort":r?"error":"load",h.dispatchEvent(a),h.dispatchEvent("loadend")}}}b.exports=g,g.XMLHttpRequest=g},84425,(a,b,c)=>{function d(a,b,c,d){return Math.round(a/c)+" "+d+(b>=1.5*c?"s":"")}b.exports=function(a,b){b=b||{};var c,e,f,g,h=typeof a;if("string"===h&&a.length>0){var i=a;if(!((i=String(i)).length>100)){var j=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(j){var k=parseFloat(j[1]);switch((j[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*k;case"weeks":case"week":case"w":return 6048e5*k;case"days":case"day":case"d":return 864e5*k;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*k;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*k;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*k;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:break}}}return}if("number"===h&&isFinite(a)){return b.long?(e=Math.abs(c=a))>=864e5?d(c,e,864e5,"day"):e>=36e5?d(c,e,36e5,"hour"):e>=6e4?d(c,e,6e4,"minute"):e>=1e3?d(c,e,1e3,"second"):c+" ms":(g=Math.abs(f=a))>=864e5?Math.round(f/864e5)+"d":g>=36e5?Math.round(f/36e5)+"h":g>=6e4?Math.round(f/6e4)+"m":g>=1e3?Math.round(f/1e3)+"s":f+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},11017,(a,b,c)=>{b.exports=function(b){function c(a){let b,e,f,g=null;function h(...a){if(!h.enabled)return;let d=Number(new Date);h.diff=d-(b||d),h.prev=b,h.curr=d,b=d,a[0]=c.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let e=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(b,d)=>{if("%%"===b)return"%";e++;let f=c.formatters[d];if("function"==typeof f){let c=a[e];b=f.call(h,c),a.splice(e,1),e--}return b}),c.formatArgs.call(h,a),(h.log||c.log).apply(h,a)}return h.namespace=a,h.useColors=c.useColors(),h.color=c.selectColor(a),h.extend=d,h.destroy=c.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==g?g:(e!==c.namespaces&&(e=c.namespaces,f=c.enabled(a)),f),set:a=>{g=a}}),"function"==typeof c.init&&c.init(h),h}function d(a,b){let d=c(this.namespace+(void 0===b?":":b)+a);return d.log=this.log,d}function e(a,b){let c=0,d=0,e=-1,f=0;for(;c<a.length;)if(d<b.length&&(b[d]===a[c]||"*"===b[d]))"*"===b[d]?(e=d,f=c):c++,d++;else{if(-1===e)return!1;d=e+1,c=++f}for(;d<b.length&&"*"===b[d];)d++;return d===b.length}return c.debug=c,c.default=c,c.coerce=function(a){return a instanceof Error?a.stack||a.message:a},c.disable=function(){let a=[...c.names,...c.skips.map(a=>"-"+a)].join(",");return c.enable(""),a},c.enable=function(a){for(let b of(c.save(a),c.namespaces=a,c.names=[],c.skips=[],("string"==typeof a?a:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===b[0]?c.skips.push(b.slice(1)):c.names.push(b)},c.enabled=function(a){for(let b of c.skips)if(e(a,b))return!1;for(let b of c.names)if(e(a,b))return!0;return!1},c.humanize=a.r(84425),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(b).forEach(a=>{c[a]=b[a]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c)|0;return c.colors[Math.abs(b)%c.colors.length]},c.enable(c.load()),c}},70722,(a,b,c)=>{b.exports=a.x("tty",()=>require("tty"))},46786,(a,b,c)=>{b.exports=a.x("os",()=>require("os"))},55858,(a,b,c)=>{"use strict";b.exports=(a,b=process.argv)=>{let c=a.startsWith("-")?"":1===a.length?"-":"--",d=b.indexOf(c+a),e=b.indexOf("--");return -1!==d&&(-1===e||d<e)}},73083,(a,b,c)=>{"use strict";let d;a.r(46786);let e=a.r(70722),f=a.r(55858),{env:g}=process;function h(a){return 0!==a&&{level:a,hasBasic:!0,has256:a>=2,has16m:a>=3}}function i(a,b){if(0===d)return 0;if(f("color=16m")||f("color=full")||f("color=truecolor"))return 3;if(f("color=256"))return 2;if(a&&!b&&void 0===d)return 0;let c=d||0;if("dumb"===g.TERM)return c;if("CI"in g)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(a=>a in g)||"codeship"===g.CI_NAME?1:c;if("TEAMCITY_VERSION"in g)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(g.TEAMCITY_VERSION);if("truecolor"===g.COLORTERM)return 3;if("TERM_PROGRAM"in g){let a=parseInt((g.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(g.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(g.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(g.TERM)||"COLORTERM"in g?1:c}f("no-color")||f("no-colors")||f("color=false")||f("color=never")?d=0:(f("color")||f("colors")||f("color=true")||f("color=always"))&&(d=1),"FORCE_COLOR"in g&&(d="true"===g.FORCE_COLOR?1:"false"===g.FORCE_COLOR?0:0===g.FORCE_COLOR.length?1:Math.min(parseInt(g.FORCE_COLOR,10),3)),b.exports={supportsColor:function(a){return h(i(a,a&&a.isTTY))},stdout:h(i(!0,e.isatty(1))),stderr:h(i(!0,e.isatty(2)))}},81454,(a,b,c)=>{let d=a.r(70722),e=a.r(24361);c.init=function(a){a.inspectOpts={};let b=Object.keys(c.inspectOpts);for(let d=0;d<b.length;d++)a.inspectOpts[b[d]]=c.inspectOpts[b[d]]},c.log=function(...a){return process.stderr.write(e.formatWithOptions(c.inspectOpts,...a)+"\n")},c.formatArgs=function(a){let{namespace:d,useColors:e}=this;if(e){let c=this.color,e="\x1b[3"+(c<8?c:"8;5;"+c),f=`  ${e};1m${d} \u001B[0m`;a[0]=f+a[0].split("\n").join("\n"+f),a.push(e+"m+"+b.exports.humanize(this.diff)+"\x1b[0m")}else a[0]=(c.inspectOpts.hideDate?"":new Date().toISOString()+" ")+d+" "+a[0]},c.save=function(a){a?process.env.DEBUG=a:delete process.env.DEBUG},c.load=function(){return process.env.DEBUG},c.useColors=function(){return"colors"in c.inspectOpts?!!c.inspectOpts.colors:d.isatty(process.stderr.fd)},c.destroy=e.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),c.colors=[6,2,3,4,5,1];try{let b=a.r(73083);b&&(b.stderr||b).level>=2&&(c.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(a){}c.inspectOpts=Object.keys(process.env).filter(a=>/^debug_/i.test(a)).reduce((a,b)=>{let c=b.substring(6).toLowerCase().replace(/_([a-z])/g,(a,b)=>b.toUpperCase()),d=process.env[b];return d=!!/^(yes|on|true|enabled)$/i.test(d)||!/^(no|off|false|disabled)$/i.test(d)&&("null"===d?null:Number(d)),a[c]=d,a},{}),b.exports=a.r(11017)(c);let{formatters:f}=b.exports;f.o=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts).split("\n").map(a=>a.trim()).join(" ")},f.O=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts)}},47522,(a,b,c)=>{let d;c.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+b.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;a.splice(1,0,c,"color: inherit");let d=0,e=0;a[0].replace(/%[a-zA-Z%]/g,a=>{"%%"!==a&&(d++,"%c"===a&&(e=d))}),a.splice(e,0,c)},c.save=function(a){try{a?c.storage.setItem("debug",a):c.storage.removeItem("debug")}catch(a){}},c.load=function(){let a;try{a=c.storage.getItem("debug")||c.storage.getItem("DEBUG")}catch(a){}return!a&&"u">typeof process&&"env"in process&&(a=process.env.DEBUG),a},c.useColors=function(){let a;return!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof navigator&&navigator.userAgent&&(a=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(a[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},c.storage=function(){try{return localStorage}catch(a){}}(),d=!1,c.destroy=()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))},c.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],c.log=console.debug||console.log||(()=>{}),b.exports=a.r(11017)(c);let{formatters:e}=b.exports;e.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}},35290,(a,b,c)=>{"u"<typeof process||"renderer"===process.type||process.__nwjs?b.exports=a.r(47522):b.exports=a.r(81454)},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},4446,(a,b,c)=>{b.exports=a.x("net",()=>require("net"))},55004,(a,b,c)=>{b.exports=a.x("tls",()=>require("tls"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},6461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},65514,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="u">typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},40352,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(65514),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},29110,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},19199,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(40352),g=a.r(29110),{kStatusCode:h}=a.r(65514),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},55572,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(65514);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},75091,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(19199),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(65514),{concat:j,toArrayBuffer:k,unmask:l}=a.r(40352),{isValidStatusCode:m,isValidUTF8:n}=a.r(55572),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},10697,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(19199),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(65514),{isBlob:k,isValidStatusCode:l}=a.r(55572),{mask:m,toBuffer:n}=a.r(40352),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},4049,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(65514),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},20529,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},89877,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(19199),o=a.r(75091),p=a.r(10697),{isBlob:q}=a.r(55572),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(65514),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(4049),{format:B,parse:C}=a.r(20529),{toBuffer:D}=a.r(40352),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c))}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c))}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},29e3,(a,b,c)=>{"use strict";a.r(89877);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},71553,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},95837,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(20529),i=a.r(19199),j=a.r(71553),k=a.r(89877),{GUID:l,kWebSocket:m}=a.r(65514),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},15540,a=>{"use strict";let b,c,d,e,f;var g,h,i,j,k,l,m,n,o,p,q=a.i(87924),r=a.i(72131),s=a.i(50944),t=a.i(63047);let u=Object.create(null);u.open="0",u.close="1",u.ping="2",u.pong="3",u.message="4",u.upgrade="5",u.noop="6";let v=Object.create(null);Object.keys(u).forEach(a=>{v[u[a]]=a});let w={type:"error",data:"parser error"},x=({type:a,data:b},c,d)=>d(b instanceof ArrayBuffer||ArrayBuffer.isView(b)?c?b:"b"+y(b,!0).toString("base64"):u[a]+(b||"")),y=(a,b)=>Buffer.isBuffer(a)||a instanceof Uint8Array&&!b?a:a instanceof ArrayBuffer?Buffer.from(a):Buffer.from(a.buffer,a.byteOffset,a.byteLength),z=(a,b)=>{if("string"!=typeof a)return{type:"message",data:A(a,b)};let c=a.charAt(0);return"b"===c?{type:"message",data:A(Buffer.from(a.substring(1),"base64"),b)}:v[c]?a.length>1?{type:v[c],data:a.substring(1)}:{type:v[c]}:w},A=(a,b)=>"arraybuffer"===b?a instanceof ArrayBuffer?a:Buffer.isBuffer(a)?a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength):a.buffer:Buffer.isBuffer(a)?a:Buffer.from(a);function B(a){return a.reduce((a,b)=>a+b.length,0)}function C(a,b){if(a[0].length===b)return a.shift();let c=new Uint8Array(b),d=0;for(let e=0;e<b;e++)c[e]=a[0][d++],d===a[0].length&&(a.shift(),d=0);return a.length&&d<a[0].length&&(a[0]=a[0].slice(d)),c}function D(a){if(a){var b=a;for(var c in D.prototype)b[c]=D.prototype[c];return b}}D.prototype.on=D.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},D.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},D.prototype.off=D.prototype.removeListener=D.prototype.removeAllListeners=D.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c,d=this._callbacks["$"+a];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var e=0;e<d.length;e++)if((c=d[e])===b||c.fn===b){d.splice(e,1);break}return 0===d.length&&delete this._callbacks["$"+a],this},D.prototype.emit=function(a){this._callbacks=this._callbacks||{};for(var b=Array(arguments.length-1),c=this._callbacks["$"+a],d=1;d<arguments.length;d++)b[d-1]=arguments[d];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},D.prototype.emitReserved=D.prototype.emit,D.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},D.prototype.hasListeners=function(a){return!!this.listeners(a).length};let E=process.nextTick,F=a.g;class G{constructor(){this._cookies=new Map}parseCookies(a){a&&a.forEach(a=>{let b=function(a){let b=a.split("; "),c=b[0].indexOf("=");if(-1===c)return;let d=b[0].substring(0,c).trim();if(!d.length)return;let e=b[0].substring(c+1).trim();34===e.charCodeAt(0)&&(e=e.slice(1,-1));let f={name:d,value:e};for(let a=1;a<b.length;a++){let c=b[a].split("=");if(2!==c.length)continue;let d=c[0].trim(),e=c[1].trim();switch(d){case"Expires":f.expires=new Date(e);break;case"Max-Age":let g=new Date;g.setUTCSeconds(g.getUTCSeconds()+parseInt(e,10)),f.expires=g}}return f}(a);b&&this._cookies.set(b.name,b)})}get cookies(){let a=Date.now();return this._cookies.forEach((b,c)=>{var d;(null==(d=b.expires)?void 0:d.getTime())<a&&this._cookies.delete(c)}),this._cookies.entries()}addCookies(a){let b=[];for(let[a,c]of this.cookies)b.push(`${a}=${c.value}`);b.length&&(a.setDisableHeaderCheck(!0),a.setRequestHeader("cookie",b.join("; ")))}appendCookies(a){for(let[b,c]of this.cookies)a.append("cookie",`${b}=${c.value}`)}}function H(a,...b){return b.reduce((b,c)=>(a.hasOwnProperty(c)&&(b[c]=a[c]),b),{})}let I=F.setTimeout,J=F.clearTimeout;function K(a,b){b.useNativeTimers?(a.setTimeoutFn=I.bind(F),a.clearTimeoutFn=J.bind(F)):(a.setTimeoutFn=F.setTimeout.bind(F),a.clearTimeoutFn=F.clearTimeout.bind(F))}function L(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var M=a.i(35290);let N=(0,M.default)("engine.io-client:transport");class O extends Error{constructor(a,b,c){super(a),this.description=b,this.context=c,this.type="TransportError"}}class P extends D{constructor(a){super(),this.writable=!1,K(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,b,c){return super.emitReserved("error",new O(a,b,c)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(a){"open"===this.readyState?this.write(a):N("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){let b=z(a,this.socket.binaryType);this.onPacket(b)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,b={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(b)}_hostname(){let a=this.opts.hostname;return -1===a.indexOf(":")?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(a){let b=function(a){let b="";for(let c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b}(a);return b.length?"?"+b:""}}let Q=(0,M.default)("engine.io-client:polling");class R extends P{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(a){this.readyState="pausing";let b=()=>{Q("paused"),this.readyState="paused",a()};if(this._polling||!this.writable){let a=0;this._polling&&(Q("we are currently polling - waiting to pause"),a++,this.once("pollComplete",function(){Q("pre-pause polling complete"),--a||b()})),this.writable||(Q("we are currently writing - waiting to pause"),a++,this.once("drain",function(){Q("pre-pause writing complete"),--a||b()}))}else b()}_poll(){Q("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){Q("polling got data %s",a);let b=a=>{if("opening"===this.readyState&&"open"===a.type&&this.onOpen(),"close"===a.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};((a,b)=>{let c=a.split("\x1e"),d=[];for(let a=0;a<c.length;a++){let e=z(c[a],b);if(d.push(e),"error"===e.type)break}return d})(a,this.socket.binaryType).forEach(b),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this._poll():Q('ignoring poll - transport state "%s"',this.readyState))}doClose(){let a=()=>{Q("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(Q("transport open - closing"),a()):(Q("transport not open - deferring close"),this.once("open",a))}write(a){var b;let c,d,e;this.writable=!1,b=a=>{this.doWrite(a,()=>{this.writable=!0,this.emitReserved("drain")})},d=Array(c=a.length),e=0,a.forEach((a,f)=>{x(a,!1,a=>{d[f]=a,++e===c&&b(d.join("\x1e"))})})}uri(){let a=this.opts.secure?"https":"http",b=this.query||{};return!1!==this.opts.timestampRequests&&(b[this.opts.timestampParam]=L()),this.supportsBinary||b.sid||(b.b64=1),this.createUri(a,b)}}let S=!1;try{S="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(a){}let T=S,U=(0,M.default)("engine.io-client:polling");function V(){}class W extends R{constructor(a){if(super(a),"u">typeof location){const b="https:"===location.protocol;let c=location.port;c||(c=b?"443":"80"),this.xd="u">typeof location&&a.hostname!==location.hostname||c!==a.port}}doWrite(a,b){let c=this.request({method:"POST",data:a});c.on("success",b),c.on("error",(a,b)=>{this.onError("xhr post error",a,b)})}doPoll(){U("xhr poll");let a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(a,b)=>{this.onError("xhr poll error",a,b)}),this.pollXhr=a}}class X extends D{constructor(a,b,c){super(),this.createRequest=a,K(this,c),this._opts=c,this._method=c.method||"GET",this._uri=b,this._data=void 0!==c.data?c.data:null,this._create()}_create(){var a;let b=H(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");b.xdomain=!!this._opts.xd;let c=this._xhr=this.createRequest(b);try{U("xhr open %s: %s",this._method,this._uri),c.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let a in c.setDisableHeaderCheck&&c.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&c.setRequestHeader(a,this._opts.extraHeaders[a])}catch(a){}if("POST"===this._method)try{c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{c.setRequestHeader("Accept","*/*")}catch(a){}null==(a=this._opts.cookieJar)||a.addCookies(c),"withCredentials"in c&&(c.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(c.timeout=this._opts.requestTimeout),c.onreadystatechange=()=>{var a;3===c.readyState&&(null==(a=this._opts.cookieJar)||a.parseCookies(c.getResponseHeader("set-cookie"))),4===c.readyState&&(200===c.status||1223===c.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof c.status?c.status:0)},0))},U("xhr data %s",this._data),c.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}"u">typeof document&&(this._index=X.requestsCount++,X.requests[this._index]=this)}_onError(a){this.emitReserved("error",a,this._xhr),this._cleanup(!0)}_cleanup(a){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=V,a)try{this._xhr.abort()}catch(a){}"u">typeof document&&delete X.requests[this._index],this._xhr=null}}_onLoad(){let a=this._xhr.responseText;null!==a&&(this.emitReserved("data",a),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function Y(){for(let a in X.requests)X.requests.hasOwnProperty(a)&&X.requests[a].abort()}X.requestsCount=0,X.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Y):"function"==typeof addEventListener&&addEventListener("onpagehide"in F?"pagehide":"unload",Y,!1)),(d=function(a){let b=a.xdomain;try{if("u">typeof XMLHttpRequest&&(!b||T))return new XMLHttpRequest}catch(a){}if(!b)try{return new F[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(a){}}({xdomain:!1}))&&d.responseType;let Z=t.default||t;a.i(29e3),a.i(75091),a.i(10697);var $=a.i(89877);a.i(95837),$.default;let _=(0,M.default)("engine.io-client:websocket"),aa="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class ab extends P{get name(){return"websocket"}doOpen(){let a=this.uri(),b=this.opts.protocols,c=aa?{}:H(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(c.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(a,b,c)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let b=0;b<a.length;b++){let c=a[b],d=b===a.length-1;x(c,this.supportsBinary,a=>{try{this.doWrite(c,a)}catch(a){_("websocket closed before onclose event")}d&&E(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let a=this.opts.secure?"wss":"ws",b=this.query||{};return this.opts.timestampRequests&&(b[this.opts.timestampParam]=L()),this.supportsBinary||(b.b64=1),this.createUri(a,b)}}F.WebSocket||F.MozWebSocket;let ac=(0,M.default)("engine.io-client:webtransport"),ad={websocket:class extends ab{createSocket(a,b,c){var d;if(null==(d=this.socket)?void 0:d._cookieJar)for(let[a,b]of(c.headers=c.headers||{},c.headers.cookie="string"==typeof c.headers.cookie?[c.headers.cookie]:c.headers.cookie||[],this.socket._cookieJar.cookies))c.headers.cookie.push(`${a}=${b.value}`);return new $.default(a,b,c)}doWrite(a,b){let c={};a.options&&(c.compress=a.options.compress),this.opts.perMessageDeflate&&("string"==typeof b?Buffer.byteLength(b):b.length)<this.opts.perMessageDeflate.threshold&&(c.compress=!1),this.ws.send(b,c)}},webtransport:class extends P{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(a){return this.emitReserved("error",a)}this._transport.closed.then(()=>{ac("transport closed gracefully"),this.onClose()}).catch(a=>{ac("transport closed due to %s",a),this.onError("webtransport error",a)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(a=>{var d,e;let f,g,h,i,j=(d=Number.MAX_SAFE_INTEGER,e=this.socket.binaryType,c||(c=new TextDecoder),f=[],g=0,h=-1,i=!1,new TransformStream({transform(a,b){for(f.push(a);;){if(0===g){if(1>B(f))break;let a=C(f,1);i=(128&a[0])==128,g=(h=127&a[0])<126?3:126===h?1:2}else if(1===g){if(2>B(f))break;let a=C(f,2);h=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),g=3}else if(2===g){if(8>B(f))break;let a=C(f,8),c=new DataView(a.buffer,a.byteOffset,a.length),d=c.getUint32(0);if(d>2097151){b.enqueue(w);break}h=0x100000000*d+c.getUint32(4),g=3}else{if(B(f)<h)break;let a=C(f,h);b.enqueue(z(i?a:c.decode(a),e)),g=0}if(0===h||h>d){b.enqueue(w);break}}}})),k=a.readable.pipeThrough(j).getReader(),l=new TransformStream({transform(a,c){!function(a,c){if(a.data instanceof ArrayBuffer||ArrayBuffer.isView(a.data))return c(y(a.data,!1));x(a,!0,a=>{b||(b=new TextEncoder),c(b.encode(a))})}(a,b=>{let d,e=b.length;if(e<126)new DataView((d=new Uint8Array(1)).buffer).setUint8(0,e);else if(e<65536){let a=new DataView((d=new Uint8Array(3)).buffer);a.setUint8(0,126),a.setUint16(1,e)}else{let a=new DataView((d=new Uint8Array(9)).buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(e))}a.data&&"string"!=typeof a.data&&(d[0]|=128),c.enqueue(d),c.enqueue(b)})}});l.readable.pipeTo(a.writable),this._writer=l.writable.getWriter();let m=()=>{k.read().then(({done:a,value:b})=>{a?ac("session is closed"):(ac("received chunk: %o",b),this.onPacket(b),m())}).catch(a=>{ac("an error occurred while reading: %s",a)})};m();let n={type:"open"};this.query.sid&&(n.data=`{"sid":"${this.query.sid}"}`),this._writer.write(n).then(()=>this.onOpen())})})}write(a){this.writable=!1;for(let b=0;b<a.length;b++){let c=a[b],d=b===a.length-1;this._writer.write(c).then(()=>{d&&E(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var a;null==(a=this._transport)||a.close()}},polling:class extends W{request(a={}){var b;return Object.assign(a,{xd:this.xd,cookieJar:null==(b=this.socket)?void 0:b._cookieJar},this.opts),new X(a=>new Z(a),this.uri(),a)}}},ae=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,af=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ag(a){var b,c;let d,e;if(a.length>8e3)throw"URI too long";let f=a,g=a.indexOf("["),h=a.indexOf("]");-1!=g&&-1!=h&&(a=a.substring(0,g)+a.substring(g,h).replace(/:/g,";")+a.substring(h,a.length));let i=ae.exec(a||""),j={},k=14;for(;k--;)j[af[k]]=i[k]||"";return -1!=g&&-1!=h&&(j.source=f,j.host=j.host.substring(1,j.host.length-1).replace(/;/g,":"),j.authority=j.authority.replace("[","").replace("]","").replace(/;/g,":"),j.ipv6uri=!0),d=(b=j.path).replace(/\/{2,9}/g,"/").split("/"),("/"==b.slice(0,1)||0===b.length)&&d.splice(0,1),"/"==b.slice(-1)&&d.splice(d.length-1,1),j.pathNames=d,c=j.query,e={},c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,b,c){b&&(e[b]=c)}),j.queryKey=e,j}let ah=(0,M.default)("engine.io-client:socket"),ai="function"==typeof addEventListener&&"function"==typeof removeEventListener,aj=[];ai&&addEventListener("offline",()=>{ah("closing %d connection(s) because the network was lost",aj.length),aj.forEach(a=>a())},!1);class ak extends D{constructor(a,b){if(super(),this.binaryType="nodebuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,a&&"object"==typeof a&&(b=a,a=null),a){const c=ag(a);b.hostname=c.host,b.secure="https"===c.protocol||"wss"===c.protocol,b.port=c.port,c.query&&(b.query=c.query)}else b.host&&(b.hostname=ag(b.host).host);K(this,b),this.secure=null!=b.secure?b.secure:"u">typeof location&&"https:"===location.protocol,b.hostname&&!b.port&&(b.port=this.secure?"443":"80"),this.hostname=b.hostname||("u">typeof location?location.hostname:"localhost"),this.port=b.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},b.transports.forEach(a=>{let b=a.prototype.name;this.transports.push(b),this._transportsByName[b]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},b),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(a){let b={},c=a.split("&");for(let a=0,d=c.length;a<d;a++){let d=c[a].split("=");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return b}(this.opts.query)),ai&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(ah("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},aj.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=new G),this._open()}createTransport(a){ah('creating transport "%s"',a);let b=Object.assign({},this.opts.query);b.EIO=4,b.transport=a,this.id&&(b.sid=this.id);let c=Object.assign({},this.opts,{query:b,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[a]);return ah("options: %j",c),new this._transportsByName[a](c)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);let a=this.opts.rememberUpgrade&&ak.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let b=this.createTransport(a);b.open(),this.setTransport(b)}setTransport(a){ah("setting transport %s",a.name),this.transport&&(ah("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",a=>this._onClose("transport close",a))}onOpen(){ah("socket open"),this.readyState="open",ak.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(ah('socket receive: type "%s", data "%s"',a.type,a.data),this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let b=Error("server error");b.code=a.data,this._onError(b);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data)}else ah('packet received with socket readyState "%s"',this.readyState)}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this._pingInterval=a.pingInterval,this._pingTimeout=a.pingTimeout,this._maxPayload=a.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let a=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+a,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},a),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let a=this._getWritablePackets();ah("flushing %d packets in socket",a.length),this.transport.send(a),this._prevBufferLen=a.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let a=1;for(let b=0;b<this.writeBuffer.length;b++){let c=this.writeBuffer[b].data;if(c&&(a+="string"==typeof c?function(a){let b=0,c=0;for(let d=0,e=a.length;d<e;d++)(b=a.charCodeAt(d))<128?c+=1:b<2048?c+=2:b<55296||b>=57344?c+=3:(d++,c+=4);return c}(c):Math.ceil(1.33*(c.byteLength||c.size))),b>0&&a>this._maxPayload)return ah("only send %d out of %d packets",b,this.writeBuffer.length),this.writeBuffer.slice(0,b);a+=2}return ah("payload size is %d (max: %d)",a,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let a=Date.now()>this._pingTimeoutTime;return a&&(ah("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,E(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),a}write(a,b,c){return this._sendPacket("message",a,b,c),this}send(a,b,c){return this._sendPacket("message",a,b,c),this}_sendPacket(a,b,c,d){if("function"==typeof b&&(d=b,b=void 0),"function"==typeof c&&(d=c,c=null),"closing"===this.readyState||"closed"===this.readyState)return;(c=c||{}).compress=!1!==c.compress;let e={type:a,data:b,options:c};this.emitReserved("packetCreate",e),this.writeBuffer.push(e),d&&this.once("flush",d),this.flush()}close(){let a=()=>{this._onClose("forced close"),ah("socket closing - telling transport to close"),this.transport.close()},b=()=>{this.off("upgrade",b),this.off("upgradeError",b),a()},c=()=>{this.once("upgrade",b),this.once("upgradeError",b)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?c():a()}):this.upgrading?c():a()),this}_onError(a){if(ah("socket error %j",a),ak.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return ah("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",a),this._onClose("transport error",a)}_onClose(a,b){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(ah('socket close with reason: "%s"',a),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ai&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let a=aj.indexOf(this._offlineEventListener);-1!==a&&(ah("removing listener for the 'offline' event"),aj.splice(a,1))}this.readyState="closed",this.id=null,this.emitReserved("close",a,b),this.writeBuffer=[],this._prevBufferLen=0}}}ak.protocol=4;class al extends ak{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade){ah("starting upgrade probes");for(let a=0;a<this._upgrades.length;a++)this._probe(this._upgrades[a])}}_probe(a){ah('probing transport "%s"',a);let b=this.createTransport(a),c=!1;ak.priorWebsocketSuccess=!1;let d=()=>{c||(ah('probe transport "%s" opened',a),b.send([{type:"ping",data:"probe"}]),b.once("packet",d=>{if(!c)if("pong"===d.type&&"probe"===d.data){if(ah('probe transport "%s" pong',a),this.upgrading=!0,this.emitReserved("upgrading",b),!b)return;ak.priorWebsocketSuccess="websocket"===b.name,ah('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{c||"closed"!==this.readyState&&(ah("changing transport and sending upgrade packet"),j(),this.setTransport(b),b.send([{type:"upgrade"}]),this.emitReserved("upgrade",b),b=null,this.upgrading=!1,this.flush())})}else{ah('probe transport "%s" failed',a);let c=Error("probe error");c.transport=b.name,this.emitReserved("upgradeError",c)}}))};function e(){c||(c=!0,j(),b.close(),b=null)}let f=c=>{let d=Error("probe error: "+c);d.transport=b.name,e(),ah('probe transport "%s" failed because of error: %s',a,c),this.emitReserved("upgradeError",d)};function g(){f("transport closed")}function h(){f("socket closed")}function i(a){b&&a.name!==b.name&&(ah('"%s" works - aborting "%s"',a.name,b.name),e())}let j=()=>{b.removeListener("open",d),b.removeListener("error",f),b.removeListener("close",g),this.off("close",h),this.off("upgrading",i)};b.once("open",d),b.once("error",f),b.once("close",g),this.once("close",h),this.once("upgrading",i),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==a?this.setTimeoutFn(()=>{c||b.open()},200):b.open()}onHandshake(a){this._upgrades=this._filterUpgrades(a.upgrades),super.onHandshake(a)}_filterUpgrades(a){let b=[];for(let c=0;c<a.length;c++)~this.transports.indexOf(a[c])&&b.push(a[c]);return b}}class am extends al{constructor(a,b={}){const c="object"==typeof a?a:b;(!c.transports||c.transports&&"string"==typeof c.transports[0])&&(c.transports=(c.transports||["polling","websocket","webtransport"]).map(a=>ad[a]).filter(a=>!!a)),super(a,c)}}am.protocol;let an=(0,M.default)("socket.io-client:url"),ao="function"==typeof ArrayBuffer,ap=Object.prototype.toString,aq="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===ap.call(Blob),ar="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===ap.call(File);function as(a){return ao&&(a instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a.buffer instanceof ArrayBuffer))||aq&&a instanceof Blob||ar&&a instanceof File}let at=(0,M.default)("socket.io-parser"),au=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];(g=l||(l={}))[g.CONNECT=0]="CONNECT",g[g.DISCONNECT=1]="DISCONNECT",g[g.EVENT=2]="EVENT",g[g.ACK=3]="ACK",g[g.CONNECT_ERROR=4]="CONNECT_ERROR",g[g.BINARY_EVENT=5]="BINARY_EVENT",g[g.BINARY_ACK=6]="BINARY_ACK";class av{constructor(a){this.replacer=a}encode(a){return(at("encoding packet %j",a),(a.type===l.EVENT||a.type===l.ACK)&&function a(b,c){if(!b||"object"!=typeof b)return!1;if(Array.isArray(b)){for(let c=0,d=b.length;c<d;c++)if(a(b[c]))return!0;return!1}if(as(b))return!0;if(b.toJSON&&"function"==typeof b.toJSON&&1==arguments.length)return a(b.toJSON(),!0);for(let c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&a(b[c]))return!0;return!1}(a))?this.encodeAsBinary({type:a.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK,nsp:a.nsp,data:a.data,id:a.id}):[this.encodeAsString(a)]}encodeAsString(a){let b=""+a.type;return(a.type===l.BINARY_EVENT||a.type===l.BINARY_ACK)&&(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data,this.replacer)),at("encoded %j as %s",a,b),b}encodeAsBinary(a){let b,c,d=(b=[],c=a.data,a.data=function a(b,c){if(!b)return b;if(as(b)){let a={_placeholder:!0,num:c.length};return c.push(b),a}if(Array.isArray(b)){let d=Array(b.length);for(let e=0;e<b.length;e++)d[e]=a(b[e],c);return d}if("object"==typeof b&&!(b instanceof Date)){let d={};for(let e in b)Object.prototype.hasOwnProperty.call(b,e)&&(d[e]=a(b[e],c));return d}return b}(c,b),a.attachments=b.length,{packet:a,buffers:b}),e=this.encodeAsString(d.packet),f=d.buffers;return f.unshift(e),f}}class aw extends D{constructor(a){super(),this.reviver=a}add(a){let b;if("string"==typeof a){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let c=(b=this.decodeString(a)).type===l.BINARY_EVENT;c||b.type===l.BINARY_ACK?(b.type=c?l.EVENT:l.ACK,this.reconstructor=new ax(b),0===b.attachments&&super.emitReserved("decoded",b)):super.emitReserved("decoded",b)}else if(as(a)||a.base64)if(this.reconstructor)(b=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,super.emitReserved("decoded",b));else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a)}decodeString(a){let b=0,c={type:Number(a.charAt(0))};if(void 0===l[c.type])throw Error("unknown packet type "+c.type);if(c.type===l.BINARY_EVENT||c.type===l.BINARY_ACK){let d=b+1;for(;"-"!==a.charAt(++b)&&b!=a.length;);let e=a.substring(d,b);if(e!=Number(e)||"-"!==a.charAt(b))throw Error("Illegal attachments");c.attachments=Number(e)}if("/"===a.charAt(b+1)){let d=b+1;for(;++b&&","!==a.charAt(b)&&b!==a.length;);c.nsp=a.substring(d,b)}else c.nsp="/";let d=a.charAt(b+1);if(""!==d&&Number(d)==d){let d=b+1;for(;++b;){let c=a.charAt(b);if(null==c||Number(c)!=c){--b;break}if(b===a.length)break}c.id=Number(a.substring(d,b+1))}if(a.charAt(++b)){let d=this.tryParse(a.substr(b));if(aw.isPayloadValid(c.type,d))c.data=d;else throw Error("invalid payload")}return at("decoded %s as %j",a,c),c}tryParse(a){try{return JSON.parse(a,this.reviver)}catch(a){return!1}}static isPayloadValid(a,b){switch(a){case l.CONNECT:return az(b);case l.DISCONNECT:return void 0===b;case l.CONNECT_ERROR:return"string"==typeof b||az(b);case l.EVENT:case l.BINARY_EVENT:return Array.isArray(b)&&("number"==typeof b[0]||"string"==typeof b[0]&&-1===au.indexOf(b[0]));case l.ACK:case l.BINARY_ACK:return Array.isArray(b)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ax{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){var b,c;let a=(b=this.reconPack,c=this.buffers,b.data=function a(b,c){if(!b)return b;if(b&&!0===b._placeholder){if("number"==typeof b.num&&b.num>=0&&b.num<c.length)return c[b.num];throw Error("illegal attachments")}if(Array.isArray(b))for(let d=0;d<b.length;d++)b[d]=a(b[d],c);else if("object"==typeof b)for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(b[d]=a(b[d],c));return b}(b.data,c),delete b.attachments,b);return this.finishedReconstruction(),a}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}let ay=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a};function az(a){return"[object Object]"===Object.prototype.toString.call(a)}function aA(a){var b;return"string"==typeof a.nsp&&(void 0===(b=a.id)||ay(b))&&function(a,b){switch(a){case l.CONNECT:return void 0===b||az(b);case l.DISCONNECT:return void 0===b;case l.EVENT:return Array.isArray(b)&&("number"==typeof b[0]||"string"==typeof b[0]&&-1===au.indexOf(b[0]));case l.ACK:return Array.isArray(b);case l.CONNECT_ERROR:return"string"==typeof b||az(b);default:return!1}}(a.type,a.data)}function aB(a,b,c){return a.on(b,c),function(){a.off(b,c)}}a.s(["Decoder",()=>aw,"Encoder",()=>av,"PacketType",()=>l,"isPacketValid",()=>aA,"protocol",0,5],32882);let aC=(0,M.default)("socket.io-client:socket"),aD=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class aE extends D{constructor(a,b,c){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=b,c&&c.auth&&(this.auth=c.auth),this._opts=Object.assign({},c),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let a=this.io;this.subs=[aB(a,"open",this.onopen.bind(this)),aB(a,"packet",this.onpacket.bind(this)),aB(a,"error",this.onerror.bind(this)),aB(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...b){var c,d,e;if(aD.hasOwnProperty(a))throw Error('"'+a.toString()+'" is a reserved event name');if(b.unshift(a),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(b),this;let f={type:l.EVENT,data:b};if(f.options={},f.options.compress=!1!==this.flags.compress,"function"==typeof b[b.length-1]){let a=this.ids++;aC("emitting packet with ack id %d",a);let c=b.pop();this._registerAckCallback(a,c),f.id=a}let g=null==(d=null==(c=this.io.engine)?void 0:c.transport)?void 0:d.writable,h=this.connected&&!(null==(e=this.io.engine)?void 0:e._hasPingExpired());return this.flags.volatile&&!g?aC("discard packet as the transport is not currently writable"):h?(this.notifyOutgoingListeners(f),this.packet(f)):this.sendBuffer.push(f),this.flags={},this}_registerAckCallback(a,b){var c;let d=null!=(c=this.flags.timeout)?c:this._opts.ackTimeout;if(void 0===d){this.acks[a]=b;return}let e=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let b=0;b<this.sendBuffer.length;b++)this.sendBuffer[b].id===a&&(aC("removing packet with ack id %d from the buffer",a),this.sendBuffer.splice(b,1));aC("event with ack id %d has timed out after %d ms",a,d),b.call(this,Error("operation has timed out"))},d),f=(...a)=>{this.io.clearTimeoutFn(e),b.apply(this,a)};f.withError=!0,this.acks[a]=f}emitWithAck(a,...b){return new Promise((c,d)=>{let e=(a,b)=>a?d(a):c(b);e.withError=!0,b.push(e),this.emit(a,...b)})}_addToQueue(a){let b;"function"==typeof a[a.length-1]&&(b=a.pop());let c={id:this._queueSeq++,tryCount:0,pending:!1,args:a,flags:Object.assign({fromQueue:!0},this.flags)};a.push((a,...d)=>c!==this._queue[0]?aC("packet [%d] already acknowledged",c.id):(null!==a?c.tryCount>this._opts.retries&&(aC("packet [%d] is discarded after %d tries",c.id,c.tryCount),this._queue.shift(),b&&b(a)):(aC("packet [%d] was successfully sent",c.id),this._queue.shift(),b&&b(null,...d)),c.pending=!1,this._drainQueue())),this._queue.push(c),this._drainQueue()}_drainQueue(a=!1){if(aC("draining queue"),!this.connected||0===this._queue.length)return;let b=this._queue[0];b.pending&&!a?aC("packet [%d] has already been sent and is waiting for an ack",b.id):(b.pending=!0,b.tryCount++,aC("sending packet [%d] (try n%d)",b.id,b.tryCount),this.flags=b.flags,this.emit.apply(this,b.args))}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){aC("transport is open - connecting"),"function"==typeof this.auth?this.auth(a=>{this._sendConnectPacket(a)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(a){this.packet({type:l.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},a):a})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,b){aC("close (%s)",a),this.connected=!1,delete this.id,this.emitReserved("disconnect",a,b),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(a=>{if(!this.sendBuffer.some(b=>String(b.id)===a)){let b=this.acks[a];delete this.acks[a],b.withError&&b.call(this,Error("socket has been disconnected"))}})}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case l.CONNECT:a.data&&a.data.sid?this.onconnect(a.data.sid,a.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case l.EVENT:case l.BINARY_EVENT:this.onevent(a);break;case l.ACK:case l.BINARY_ACK:this.onack(a);break;case l.DISCONNECT:this.ondisconnect();break;case l.CONNECT_ERROR:this.destroy();let b=Error(a.data.message);b.data=a.data.data,this.emitReserved("connect_error",b)}}onevent(a){let b=a.data||[];aC("emitting event %j",b),null!=a.id&&(aC("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?this.emitEvent(b):this.receiveBuffer.push(Object.freeze(b))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length)for(let b of this._anyListeners.slice())b.apply(this,a);super.emit.apply(this,a),this._pid&&a.length&&"string"==typeof a[a.length-1]&&(this._lastOffset=a[a.length-1])}ack(a){let b=this,c=!1;return function(...d){c||(c=!0,aC("sending ack %j",d),b.packet({type:l.ACK,id:a,data:d}))}}onack(a){let b=this.acks[a.id];"function"!=typeof b?aC("bad ack %s",a.id):(delete this.acks[a.id],aC("calling ack %s with %j",a.id,a.data),b.withError&&a.data.unshift(null),b.apply(this,a.data))}onconnect(a,b){aC("socket connected with id %s",a),this.id=a,this.recovered=b&&this._pid===b,this._pid=b,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){aC("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(aC("performing disconnect (%s)",this.nsp),this.packet({type:l.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){let b=this._anyListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){let b=this._anyOutgoingListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let b of this._anyOutgoingListeners.slice())b.apply(this,a.data)}}var aF=a.i(32882);function aG(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}aG.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=(1&Math.floor(10*b))==0?a-c:a+c}return 0|Math.min(a,this.max)},aG.prototype.reset=function(){this.attempts=0},aG.prototype.setMin=function(a){this.ms=a},aG.prototype.setMax=function(a){this.max=a},aG.prototype.setJitter=function(a){this.jitter=a};let aH=(0,M.default)("socket.io-client:manager");class aI extends D{constructor(a,b){var c;super(),this.nsps={},this.subs=[],a&&"object"==typeof a&&(b=a,a=void 0),(b=b||{}).path=b.path||"/socket.io",this.opts=b,K(this,b),this.reconnection(!1!==b.reconnection),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(c=b.randomizationFactor)?c:.5),this.backoff=new aG({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this._readyState="closed",this.uri=a;const d=b.parser||aF;this.encoder=new d.Encoder,this.decoder=new d.Decoder,this._autoConnect=!1!==b.autoConnect,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,a||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(a){return void 0===a?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var b;return void 0===a?this._reconnectionDelay:(this._reconnectionDelay=a,null==(b=this.backoff)||b.setMin(a),this)}randomizationFactor(a){var b;return void 0===a?this._randomizationFactor:(this._randomizationFactor=a,null==(b=this.backoff)||b.setJitter(a),this)}reconnectionDelayMax(a){var b;return void 0===a?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,null==(b=this.backoff)||b.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(a){if(aH("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;aH("opening %s",this.uri),this.engine=new am(this.uri,this.opts);let b=this.engine,c=this;this._readyState="opening",this.skipReconnect=!1;let d=aB(b,"open",function(){c.onopen(),a&&a()}),e=b=>{aH("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",b),a?a(b):this.maybeReconnectOnOpen()},f=aB(b,"error",e);if(!1!==this._timeout){let a=this._timeout;aH("connect attempt will timeout after %d",a);let c=this.setTimeoutFn(()=>{aH("connect attempt timed out after %d",a),d(),e(Error("timeout")),b.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(d),this.subs.push(f),this}connect(a){return this.open(a)}onopen(){aH("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let a=this.engine;this.subs.push(aB(a,"ping",this.onping.bind(this)),aB(a,"data",this.ondata.bind(this)),aB(a,"error",this.onerror.bind(this)),aB(a,"close",this.onclose.bind(this)),aB(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(a){this.onclose("parse error",a)}}ondecoded(a){E(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){aH("error",a),this.emitReserved("error",a)}socket(a,b){let c=this.nsps[a];return c?this._autoConnect&&!c.active&&c.connect():(c=new aE(this,a,b),this.nsps[a]=c),c}_destroy(a){for(let a of Object.keys(this.nsps))if(this.nsps[a].active)return void aH("socket %s is still active, skipping close",a);this._close()}_packet(a){aH("writing packet %j",a);let b=this.encoder.encode(a);for(let c=0;c<b.length;c++)this.engine.write(b[c],a.options)}cleanup(){aH("cleanup"),this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){aH("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(a,b){var c;aH("closed due to %s",a),this.cleanup(),null==(c=this.engine)||c.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,b),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let a=this;if(this.backoff.attempts>=this._reconnectionAttempts)aH("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let b=this.backoff.duration();aH("will wait %dms before reconnect attempt",b),this._reconnecting=!0;let c=this.setTimeoutFn(()=>{a.skipReconnect||(aH("attempting reconnect"),this.emitReserved("reconnect_attempt",a.backoff.attempts),a.skipReconnect||a.open(b=>{b?(aH("reconnect attempt error"),a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",b)):(aH("reconnect success"),a.onreconnect())}))},b);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}}onreconnect(){let a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}let aJ=(0,M.default)("socket.io-client"),aK={};function aL(a,b){let c;"object"==typeof a&&(b=a,a=void 0);let d=function(a,b="",c){let d=a;c=c||"u">typeof location&&location,null==a&&(a=c.protocol+"//"+c.host),"string"==typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?c.protocol+a:c.host+a),/^(https?|wss?):\/\//.test(a)||(an("protocol-less url %s",a),a=void 0!==c?c.protocol+"//"+a:"https://"+a),an("parse %s",a),d=ag(a)),!d.port&&(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";let e=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+e+":"+d.port+b,d.href=d.protocol+"://"+e+(c&&c.port===d.port?"":":"+d.port),d}(a,(b=b||{}).path||"/socket.io"),e=d.source,f=d.id,g=d.path,h=aK[f]&&g in aK[f].nsps;return b.forceNew||b["force new connection"]||!1===b.multiplex||h?(aJ("ignoring socket cache for %s",e),c=new aI(e,b)):(aK[f]||(aJ("new io instance for %s",e),aK[f]=new aI(e,b)),c=aK[f]),d.query&&!b.query&&(b.query=d.queryKey),c.socket(d.path,b)}Object.assign(aL,{Manager:aI,Socket:aE,io:aL,connect:aL});var aM=a.i(87702),aN=a.i(99745),aO=a.i(18544),aP=a.i(76644),aQ=a.i(33791),aR=a.i(79715),aS=a.i(42871),aT=a.i(8361),aU=class extends aQ.Subscribable{constructor(a,b){super(),this.options=b,this.#a=a,this.#b=null,this.#c=(0,aR.pendingThenable)(),this.bindMethods(),this.setOptions(b)}#a;#d=void 0;#e=void 0;#f=void 0;#g;#h;#c;#b;#i;#j;#k;#l;#m;#n;#o=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#d.addObserver(this),aV(this.#d,this.options)?this.#p():this.updateResult(),this.#q())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return aW(this.#d,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return aW(this.#d,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#r(),this.#s(),this.#d.removeObserver(this)}setOptions(a){let b=this.options,c=this.#d;if(this.options=this.#a.defaultQueryOptions(a),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,aS.resolveEnabled)(this.options.enabled,this.#d))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#t(),this.#d.setOptions(this.options),b._defaulted&&!(0,aS.shallowEqualObjects)(this.options,b)&&this.#a.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#d,observer:this});let d=this.hasListeners();d&&aX(this.#d,c,this.options,b)&&this.#p(),this.updateResult(),d&&(this.#d!==c||(0,aS.resolveEnabled)(this.options.enabled,this.#d)!==(0,aS.resolveEnabled)(b.enabled,this.#d)||(0,aS.resolveStaleTime)(this.options.staleTime,this.#d)!==(0,aS.resolveStaleTime)(b.staleTime,this.#d))&&this.#u();let e=this.#v();d&&(this.#d!==c||(0,aS.resolveEnabled)(this.options.enabled,this.#d)!==(0,aS.resolveEnabled)(b.enabled,this.#d)||e!==this.#n)&&this.#w(e)}getOptimisticResult(a){var b,c;let d=this.#a.getQueryCache().build(this.#a,a),e=this.createResult(d,a);return b=this,c=e,(0,aS.shallowEqualObjects)(b.getCurrentResult(),c)||(this.#f=e,this.#h=this.options,this.#g=this.#d.state),e}getCurrentResult(){return this.#f}trackResult(a,b){return new Proxy(a,{get:(a,c)=>(this.trackProp(c),b?.(c),"promise"===c&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#c.status||this.#c.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,c))})}trackProp(a){this.#o.add(a)}getCurrentQuery(){return this.#d}refetch({...a}={}){return this.fetch({...a})}fetchOptimistic(a){let b=this.#a.defaultQueryOptions(a),c=this.#a.getQueryCache().build(this.#a,b);return c.fetch().then(()=>this.createResult(c,b))}fetch(a){return this.#p({...a,cancelRefetch:a.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#f))}#p(a){this.#t();let b=this.#d.fetch(this.options,a);return a?.throwOnError||(b=b.catch(aS.noop)),b}#u(){this.#r();let a=(0,aS.resolveStaleTime)(this.options.staleTime,this.#d);if(aS.isServer||this.#f.isStale||!(0,aS.isValidTimeout)(a))return;let b=(0,aS.timeUntilStale)(this.#f.dataUpdatedAt,a);this.#l=aT.timeoutManager.setTimeout(()=>{this.#f.isStale||this.updateResult()},b+1)}#v(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#d):this.options.refetchInterval)??!1}#w(a){this.#s(),this.#n=a,!aS.isServer&&!1!==(0,aS.resolveEnabled)(this.options.enabled,this.#d)&&(0,aS.isValidTimeout)(this.#n)&&0!==this.#n&&(this.#m=aT.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||aN.focusManager.isFocused())&&this.#p()},this.#n))}#q(){this.#u(),this.#w(this.#v())}#r(){this.#l&&(aT.timeoutManager.clearTimeout(this.#l),this.#l=void 0)}#s(){this.#m&&(aT.timeoutManager.clearInterval(this.#m),this.#m=void 0)}createResult(a,b){let c,d=this.#d,e=this.options,f=this.#f,g=this.#g,h=this.#h,i=a!==d?a.state:this.#e,{state:j}=a,k={...j},l=!1;if(b._optimisticResults){let c=this.hasListeners(),f=!c&&aV(a,b),g=c&&aX(a,d,b,e);(f||g)&&(k={...k,...(0,aP.fetchState)(j.data,a.options)}),"isRestoring"===b._optimisticResults&&(k.fetchStatus="idle")}let{error:m,errorUpdatedAt:n,status:o}=k;c=k.data;let p=!1;if(void 0!==b.placeholderData&&void 0===c&&"pending"===o){let a;f?.isPlaceholderData&&b.placeholderData===h?.placeholderData?(a=f.data,p=!0):a="function"==typeof b.placeholderData?b.placeholderData(this.#k?.state.data,this.#k):b.placeholderData,void 0!==a&&(o="success",c=(0,aS.replaceData)(f?.data,a,b),l=!0)}if(b.select&&void 0!==c&&!p)if(f&&c===g?.data&&b.select===this.#i)c=this.#j;else try{this.#i=b.select,c=b.select(c),c=(0,aS.replaceData)(f?.data,c,b),this.#j=c,this.#b=null}catch(a){this.#b=a}this.#b&&(m=this.#b,c=this.#j,n=Date.now(),o="error");let q="fetching"===k.fetchStatus,r="pending"===o,s="error"===o,t=r&&q,u=void 0!==c,v={status:o,fetchStatus:k.fetchStatus,isPending:r,isSuccess:"success"===o,isError:s,isInitialLoading:t,isLoading:t,data:c,dataUpdatedAt:k.dataUpdatedAt,error:m,errorUpdatedAt:n,failureCount:k.fetchFailureCount,failureReason:k.fetchFailureReason,errorUpdateCount:k.errorUpdateCount,isFetched:k.dataUpdateCount>0||k.errorUpdateCount>0,isFetchedAfterMount:k.dataUpdateCount>i.dataUpdateCount||k.errorUpdateCount>i.errorUpdateCount,isFetching:q,isRefetching:q&&!r,isLoadingError:s&&!u,isPaused:"paused"===k.fetchStatus,isPlaceholderData:l,isRefetchError:s&&u,isStale:aY(a,b),refetch:this.refetch,promise:this.#c,isEnabled:!1!==(0,aS.resolveEnabled)(b.enabled,a)};if(this.options.experimental_prefetchInRender){let b=void 0!==v.data,c="error"===v.status&&!b,e=a=>{c?a.reject(v.error):b&&a.resolve(v.data)},f=()=>{e(this.#c=v.promise=(0,aR.pendingThenable)())},g=this.#c;switch(g.status){case"pending":a.queryHash===d.queryHash&&e(g);break;case"fulfilled":(c||v.data!==g.value)&&f();break;case"rejected":c&&v.error===g.reason||f()}}return v}updateResult(){let a=this.#f,b=this.createResult(this.#d,this.options);if(this.#g=this.#d.state,this.#h=this.options,void 0!==this.#g.data&&(this.#k=this.#d),(0,aS.shallowEqualObjects)(b,a))return;this.#f=b;let c=()=>{if(!a)return!0;let{notifyOnChangeProps:b}=this.options,c="function"==typeof b?b():b;if("all"===c||!c&&!this.#o.size)return!0;let d=new Set(c??this.#o);return this.options.throwOnError&&d.add("error"),Object.keys(this.#f).some(b=>this.#f[b]!==a[b]&&d.has(b))};this.#x({listeners:c()})}#t(){let a=this.#a.getQueryCache().build(this.#a,this.options);if(a===this.#d)return;let b=this.#d;this.#d=a,this.#e=a.state,this.hasListeners()&&(b?.removeObserver(this),a.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#q()}#x(a){aO.notifyManager.batch(()=>{a.listeners&&this.listeners.forEach(a=>{a(this.#f)}),this.#a.getQueryCache().notify({query:this.#d,type:"observerResultsUpdated"})})}};function aV(a,b){return!1!==(0,aS.resolveEnabled)(b.enabled,a)&&void 0===a.state.data&&("error"!==a.state.status||!1!==b.retryOnMount)||void 0!==a.state.data&&aW(a,b,b.refetchOnMount)}function aW(a,b,c){if(!1!==(0,aS.resolveEnabled)(b.enabled,a)&&"static"!==(0,aS.resolveStaleTime)(b.staleTime,a)){let d="function"==typeof c?c(a):c;return"always"===d||!1!==d&&aY(a,b)}return!1}function aX(a,b,c,d){return(a!==b||!1===(0,aS.resolveEnabled)(d.enabled,a))&&(!c.suspense||"error"!==a.state.status)&&aY(a,c)}function aY(a,b){return!1!==(0,aS.resolveEnabled)(b.enabled,a)&&a.isStaleByTime((0,aS.resolveStaleTime)(b.staleTime,a))}var aZ=a.i(37927),a$=r.createContext((e=!1,{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e})),a_=r.createContext(!1);a_.Provider;var a0=(a,b,c)=>b.fetchOptimistic(a).catch(()=>{c.clearReset()}),a1=a.i(53774);(0,a1.registerPlugin)("CapacitorSQLite",{web:()=>a.A(82652).then(a=>new a.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite});let a2=new class{sqlite=null;db=null;dbName="chat_cache";async initialize(){console.log("SQLite: Disabled for debugging.")}async saveMessage(a,b=!0){if(this.db||await this.initialize(),!this.db)return;let c=`
            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, isGlobal)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?);
        `,d=[a.id,a.text,a.senderId,a.senderAlias,a.senderGender,a.timestamp,a.recipientId||null,+!!b];try{await this.db.run(c,d)}catch(a){console.error("Error saving message to SQLite:",a)}}async getMessages(a=!0,b){if(this.db||await this.initialize(),!this.db)return[];let c="",d=[];a?c="SELECT * FROM messages WHERE isGlobal = 1 ORDER BY timestamp ASC LIMIT 100;":(c="SELECT * FROM messages WHERE isGlobal = 0 AND (recipientId = ? OR senderId = ?) ORDER BY timestamp ASC LIMIT 100;",d=[b,b]);try{return((await this.db.query(c,d)).values||[]).map(a=>({...a,isGlobal:void 0}))}catch(a){return console.error("Error fetching messages from SQLite:",a),[]}}async clearMessages(){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages;",[])}catch(a){console.error("Error clearing messages from SQLite:",a)}}async getPrivateChats(a){if(this.db||await this.initialize(),!this.db)return[];try{let b=((await this.db.query("SELECT * FROM messages WHERE isGlobal = 0 ORDER BY timestamp ASC;",[])).values||[]).map(a=>({id:a.id,text:a.text,senderId:a.senderId,senderAlias:a.senderAlias,senderGender:a.senderGender,timestamp:a.timestamp,recipientId:a.recipientId})),c=new Map;for(let d of b){let b=d.senderId===a?d.recipientId:d.senderId;c.has(b)||c.set(b,[]),c.get(b).push(d)}return Array.from(c.entries()).map(([a,b])=>({peerId:a,messages:b}))}catch(a){return console.error("Error loading private chats from SQLite:",a),[]}}};(h=m||(m={})).Dark="DARK",h.Light="LIGHT",h.Default="DEFAULT",(i=n||(n={})).Body="body",i.Ionic="ionic",i.Native="native",i.None="none",(0,a1.registerPlugin)("Keyboard");var a3=a.i(95421);let a4=(0,a1.registerPlugin)("Haptics",{web:()=>a.A(84104).then(a=>new a.HapticsWeb)});(j=o||(o={})).Dark="DARK",j.Light="LIGHT",j.Default="DEFAULT",(k=p||(p={})).None="NONE",k.Slide="SLIDE",k.Fade="FADE",(0,a1.registerPlugin)("StatusBar");let a5=({onLogin:a,tenantName:b})=>{let[c,d]=(0,r.useState)(""),[e,f]=(0,r.useState)("male"),g={male:"Maschio",female:"Femmina",other:"Altro"};return(0,q.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col justify-center",children:[(0,q.jsxs)("div",{className:"text-center mb-8",children:[(0,q.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-500 rounded-full mb-4 shadow-lg shadow-emerald-200",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,q.jsx)("h1",{className:"text-2xl font-bold text-gray-800 tracking-tight",children:b}),(0,q.jsx)("p",{className:"text-gray-500 mt-2 text-sm",children:"chatta in modo anonimo con le persone intorno a te"})]}),(0,q.jsxs)("form",{onSubmit:b=>{b.preventDefault(),c.trim()&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),a({id:Math.random().toString(36).substr(2,9),alias:c.trim(),gender:e,joinedAt:Date.now()}))},className:"space-y-6",children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Alias"}),(0,q.jsx)("input",{type:"text",required:!0,maxLength:20,value:c,onChange:a=>d(a.target.value),placeholder:"es. ShadowHunter",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800 placeholder-gray-300"})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Identit di Genere"}),(0,q.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(a=>(0,q.jsx)("button",{type:"button",onClick:()=>f(a),className:`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${e===a?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"}`,children:g[a]},a))})]}),(0,q.jsxs)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2 group",children:["Entra nella Stanza",(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),(0,q.jsx)("p",{className:"text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest",children:"Zero database esterni  Privacy totale"})]})};var a6=a.i(35112);function a7(a){a()}function a8(a,b){return c=>a(b(c))}function a9(a){return void 0!==a}function ba(){}function bb(a,b){return b(a)}function bc(...a){return a}function bd(a){a(2)}function be(a){return a(4)}function bf(a,b){return a(1,a=>b(0,a))}function bg(a,b){let c=a(1,a=>{c(),b(a)});return c}function bh(a){let b,c;return d=>e=>{b=e,c&&clearTimeout(c),c=setTimeout(()=>{d(b)},a)}}function bi(a,b){return a===b}function bj(a=bi){let b;return c=>d=>{a(b,d)||(b=d,c(d))}}function bk(a){return b=>c=>{a(c)&&b(c)}}function bl(a){return b=>a8(b,a)}function bm(a){return b=>()=>{b(a)}}function bn(a,...b){let c=function(...a){return b=>a.reduceRight(bb,b)}(...b);return(b,d)=>{switch(b){case 2:bd(a);return;case 1:return a(1,c(d))}}}function bo(a,b){return c=>d=>{c(b=a(b,d))}}function bp(a){return b=>c=>{a>0?a--:b(c)}}function bq(a){let b=null,c;return d=>e=>{b=e,c||(c=setTimeout(()=>{c=void 0,d(b)},a))}}function br(...a){let b=Array(a.length),c=0,d=null,e=Math.pow(2,a.length)-1;return a.forEach((a,f)=>{let g=Math.pow(2,f);a(1,a=>{let h=c;c|=g,b[f]=a,h!==e&&c===e&&d&&(d(),d=null)})}),a=>f=>{let g=()=>{a([f].concat(b))};c===e?g():d=g}}function bs(a){let b=a,c=bu();return(a,d)=>{switch(a){case 0:b=d;break;case 1:d(b);break;case 4:return b}return c(a,d)}}function bt(a,b){var c;return c=bs(b),bf(a,c),c}function bu(){let a=[];return(b,c)=>{switch(b){case 0:a.slice().forEach(a=>{a(c)});return;case 2:a.splice(0,a.length);return;case 1:return a.push(c),()=>{let b=a.indexOf(c);b>-1&&a.splice(b,1)}}}}function bv(a){var b;return b=bu(),bf(a,b),b}function bw(a,b=[],{singleton:c}={singleton:!0}){return{constructor:a,dependencies:b,id:bx(),singleton:c}}let bx=()=>Symbol();function by(...a){let b=bu(),c=Array(a.length),d=0,e=Math.pow(2,a.length)-1;return a.forEach((a,f)=>{let g=Math.pow(2,f);a(1,a=>{c[f]=a,(d|=g)===e&&b(0,c)})}),function(a,f){switch(a){case 2:return void bd(b);case 1:return d===e&&f(c),b(1,f)}}}function bz(a,b=bi){return bn(a,bj(b))}function bA(...a){return function(b,c){switch(b){case 2:return;case 1:return function(...a){return()=>{a.map(a7)}}(...a.map(a=>a(1,c)))}}}var bB=((f=bB||{})[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f);let bC={0:"debug",3:"error",1:"log",2:"warn"},bD=bw(()=>{let a=bs(3);return{log:bs((b,c,d=1)=>{var e;d>=(null!=(e=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?e:be(a))&&console[bC[d]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",b,c)}),logLevel:a}},[],{singleton:!0});function bE(a,b,c){return bF(a,b,c).callbackRef}function bF(a,b,c){let d=r.default.useRef(null),e=r.default.useMemo(()=>"u">typeof ResizeObserver?new ResizeObserver(b=>{let d=()=>{let c=b[0].target;null!==c.offsetParent&&a(c)};c?d():requestAnimationFrame(d)}):null,[a,c]);return{callbackRef:a=>{a&&b?(null==e||e.observe(a),d.current=a):(d.current&&(null==e||e.unobserve(d.current)),d.current=null)},ref:d}}function bG(a,b,c,d,e,f,g,h,i){return bF(r.default.useCallback(c=>{let i,j=function(a,b,c,d){let e=a.length;if(0===e)return null;let f=[];for(let g=0;g<e;g++){let e=a.item(g);if(void 0===e.dataset.index)continue;let h=parseInt(e.dataset.index),i=parseFloat(e.dataset.knownSize),j=b(e,c);if(0===j&&d("Zero-sized element, this should not happen",{child:e},bB.ERROR),j===i)continue;let k=f[f.length-1];0===f.length||k.size!==j||k.endIndex!==h-1?f.push({endIndex:h,size:j,startIndex:h}):f[f.length-1].endIndex++}return f}(c.children,b,h?"offsetWidth":"offsetHeight",e),k=c.parentElement;for(;!k.dataset.virtuosoScroller;)k=k.parentElement;let l="window"===k.lastElementChild.dataset.viewportType;l&&(i=k.ownerDocument.defaultView);let m=g?h?g.scrollLeft:g.scrollTop:l?h?i.scrollX||i.document.documentElement.scrollLeft:i.scrollY||i.document.documentElement.scrollTop:h?k.scrollLeft:k.scrollTop;d({scrollHeight:g?h?g.scrollWidth:g.scrollHeight:l?h?i.document.documentElement.scrollWidth:i.document.documentElement.scrollHeight:h?k.scrollWidth:k.scrollHeight,scrollTop:Math.max(m,0),viewportHeight:g?h?g.offsetWidth:g.offsetHeight:l?h?i.innerWidth:i.innerHeight:h?k.offsetWidth:k.offsetHeight}),null==f||f(h?bH("column-gap",getComputedStyle(c).columnGap,e):bH("row-gap",getComputedStyle(c).rowGap,e)),null!==j&&a(j)},[a,b,e,f,g,d,h]),c,i)}function bH(a,b,c){return"normal"===b||null!=b&&b.endsWith("px")||c(`${a} was not resolved to pixel value correctly`,b,bB.WARN),"normal"===b?0:parseInt(null!=b?b:"0",10)}function bI(a,b,c){let d=r.default.useRef(null),e=r.default.useCallback(c=>{let e,f;if(!(null!=c&&c.offsetParent))return;let h=c.getBoundingClientRect(),i=h.width;if(b){let a=b.getBoundingClientRect(),c=h.top-a.top;f=a.height-Math.max(0,c),e=c+b.scrollTop}else{let a=g.current.ownerDocument.defaultView;f=a.innerHeight-Math.max(0,h.top),e=h.top+a.scrollY}d.current={offsetTop:e,visibleHeight:f,visibleWidth:i},a(d.current)},[a,b]),{callbackRef:f,ref:g}=bF(e,!0,c),h=r.default.useCallback(()=>{e(g.current)},[e,g]);return r.default.useEffect(()=>{var a;if(b){b.addEventListener("scroll",h);let a=new ResizeObserver(()=>{requestAnimationFrame(h)});return a.observe(b),()=>{b.removeEventListener("scroll",h),a.unobserve(b)}}{let b=null==(a=g.current)?void 0:a.ownerDocument.defaultView;return null==b||b.addEventListener("scroll",h),null==b||b.addEventListener("resize",h),()=>{null==b||b.removeEventListener("scroll",h),null==b||b.removeEventListener("resize",h)}}},[h,b,g]),f}let bJ=bw(()=>{let a=bu(),b=bu(),c=bs(0),d=bu(),e=bs(0),f=bu(),g=bu(),h=bs(0),i=bs(0),j=bs(0),k=bs(0),l=bu(),m=bu(),n=bs(!1),o=bs(!1),p=bs(!1);return bf(bn(a,bl(({scrollTop:a})=>a)),b),bf(bn(a,bl(({scrollHeight:a})=>a)),g),bf(b,e),{deviation:c,fixedFooterHeight:j,fixedHeaderHeight:i,footerHeight:k,headerHeight:h,horizontalDirection:o,scrollBy:m,scrollContainerState:a,scrollHeight:g,scrollingInProgress:n,scrollTo:l,scrollTop:b,skipAnimationFrameInResizeObserver:p,smoothScrollTargetReached:d,statefulScrollTop:e,viewportHeight:f}},[],{singleton:!0}),bK={lvl:0};function bL(a,b){let c=a.length;if(0===c)return[];let{index:d,value:e}=b(a[0]),f=[];for(let g=1;g<c;g++){let{index:c,value:h}=b(a[g]);f.push({end:c-1,start:d,value:e}),d=c,e=h}return f.push({end:1/0,start:d,value:e}),f}function bM(a){return a===bK}function bN(a,b){if(!bM(a))return b===a.k?a.v:b<a.k?bN(a.l,b):bN(a.r,b)}function bO(a,b,c="k"){if(bM(a))return[-1/0,void 0];if(Number(a[c])===b)return[a.k,a.v];if(Number(a[c])<b){let d=bO(a.r,b,c);return d[0]===-1/0?[a.k,a.v]:d}return bO(a.l,b,c)}function bP(a,b,c){return bM(a)?bV(b,c,1):b===a.k?bT(a,{k:b,v:c}):b<a.k?bX(bW(bT(a,{l:bP(a.l,b,c)}))):bX(bW(bT(a,{r:bP(a.r,b,c)})))}function bQ(a,b,c){if(bM(a))return[];let d=bO(a,b)[0];return bL(function a(b,c,d){if(bM(b))return[];let{k:e,l:f,r:g,v:h}=b,i=[];return e>c&&(i=i.concat(a(f,c,d))),e>=c&&e<=d&&i.push({k:e,v:h}),e<=d&&(i=i.concat(a(g,c,d))),i}(a,d,c),({k:a,v:b})=>({index:a,value:b}))}function bR(a){return bM(a)?[]:[...bR(a.l),{k:a.k,v:a.v},...bR(a.r)]}function bS(a){let{l:b,lvl:c,r:d}=a;if(d.lvl>=c-1&&b.lvl>=c-1)return a;if(c>d.lvl+1){if(bU(b))return bW(bT(a,{lvl:c-1}));if(!bM(b)&&!bM(b.r))return bT(b.r,{l:bT(b,{r:b.r.l}),lvl:c,r:bT(a,{l:b.r.r,lvl:c-1})});throw Error("Unexpected empty nodes")}if(bU(a))return bX(bT(a,{lvl:c-1}));if(bM(d)||bM(d.l))throw Error("Unexpected empty nodes");{let b=d.l,e=bU(b)?d.lvl-1:d.lvl;return bT(b,{l:bT(a,{lvl:c-1,r:b.l}),lvl:b.lvl+1,r:bX(bT(d,{l:b.r,lvl:e}))})}}function bT(a,b){return bV(void 0!==b.k?b.k:a.k,void 0!==b.v?b.v:a.v,void 0!==b.lvl?b.lvl:a.lvl,void 0!==b.l?b.l:a.l,void 0!==b.r?b.r:a.r)}function bU(a){return bM(a)||a.lvl>a.r.lvl}function bV(a,b,c,d=bK,e=bK){return{k:a,l:d,lvl:c,r:e,v:b}}function bW(a){let{l:b}=a;return bM(b)||b.lvl!==a.lvl?a:bT(b,{r:bT(a,{l:b.r})})}function bX(a){let{lvl:b,r:c}=a;return bM(c)||bM(c.r)||c.lvl!==b||c.r.lvl!==b?a:bT(c,{l:bT(a,{r:c.l}),lvl:b+1})}function bY(a,b){return!!(a&&a.startIndex===b.startIndex&&a.endIndex===b.endIndex)}function bZ(a,b){return!!(a&&a[0]===b[0]&&a[1]===b[1])}let b$=bw(()=>({recalcInProgress:bs(!1)}),[],{singleton:!0});function b_(a,b,c,d=0){let e=a.length-1;for(;d<=e;){let f=Math.floor((d+e)/2),g=c(a[f],b);if(0===g)return f;if(-1===g){if(e-d<2)return f-1;e=f-1}else{if(e===d)return f;d=f+1}}throw Error(`Failed binary finding record in array - ${a.join(",")}, searched for ${b}`)}function b0(a,b){return Math.round(a.getBoundingClientRect()[b])}function b1(a){return!bM(a.groupOffsetTree)}function b2({index:a},b){return b===a?0:b<a?-1:1}function b3({offset:a},b){return b===a?0:b<a?-1:1}function b4(a,b,c){if(0===b.length)return 0;let{index:d,offset:e,size:f}=b[b_(b,a,b2)],g=a-d,h=f*g+(g-1)*c+e;return h>0?h+c:h}function b5(a,b){if(!b1(b))return a;let c=0;for(;b.groupIndices[c]<=a+c;)c++;return a+c}function b6(a,b,c){if("u">typeof a.groupIndex)return b.groupIndices[a.groupIndex]+1;{let d=b5("LAST"===a.index?c:a.index,b);return Math.max(0,d,Math.min(c,d))}}function b7(a,[b,c,d,e]){b.length>0&&d("received item sizes",b,bB.DEBUG);let f=a.sizeTree,g=f,h=0;if(c.length>0&&bM(f)&&2===b.length){let a=b[0].size,d=b[1].size;g=c.reduce((b,c)=>bP(bP(b,c,a),c+1,d),g)}else[g,h]=function(a,b){let c=bM(a)?0:1/0;for(let d of b){let{endIndex:b,size:e,startIndex:f}=d;if(c=Math.min(c,f),bM(a)){a=bP(a,0,e);continue}let g=bQ(a,f-1,b+1);if(g.some(function(a){let{endIndex:b,size:c,startIndex:d}=a;return a=>a.start===d&&(a.end===b||a.end===1/0)&&a.value===c}(d)))continue;let h=!1,i=!1;for(let{end:c,start:d,value:f}of g)h?(b>=d||e===f)&&(a=function a(b,c){if(bM(b))return bK;let{k:d,l:e,r:f}=b;if(c!==d)return c<d?bS(bT(b,{l:a(e,c)})):bS(bT(b,{r:a(f,c)}));if(bM(e))return f;if(bM(f))return e;{let[a,c]=function a(b){return bM(b.r)?[b.k,b.v]:a(b.r)}(e);return bS(bT(b,{k:a,l:function a(b){return bM(b.r)?b.l:bS(bT(b,{r:a(b.r)}))}(e),v:c}))}}(a,d)):(i=f!==e,h=!0),c>b&&b>=d&&f!==e&&(a=bP(a,b+1,f));i&&(a=bP(a,f,e))}return[a,c]}(g,b);if(g===f)return a;let{lastIndex:i,lastOffset:j,lastSize:k,offsetTree:l}=b9(a.offsetTree,h,g,e);return{groupIndices:c,groupOffsetTree:c.reduce((a,b)=>bP(a,b,b4(b,l,e)),bK),lastIndex:i,lastOffset:j,lastSize:k,offsetTree:l,sizeTree:g}}function b8(a,b){let c=0,d=0;for(;c<a;)c+=b[d+1]-b[d]-1,d++;return d-(c!==a)}function b9(a,b,c,d){let e=a,f=0,g=0,h=0,i=0;if(0!==b){i=b_(e,b-1,b2),h=e[i].offset;let a=bO(c,b-1);f=a[0],g=a[1],e.length&&e[i].size===bO(c,b)[1]&&(i-=1),e=e.slice(0,i+1)}else e=[];for(let{start:a,value:i}of bQ(c,b,1/0)){let b=a-f,c=b*g+h+b*d;e.push({index:a,offset:c,size:i}),f=a,h=c,g=i}return{lastIndex:f,lastOffset:h,lastSize:g,offsetTree:e}}function ca(a){return{index:a.index,value:a}}let cb={offsetHeight:"height",offsetWidth:"width"},cc=bw(([{log:a},{recalcInProgress:b}])=>{let c=bu(),d=bu(),e=bt(d,0),f=bu(),g=bu(),h=bs(0),i=bs([]),j=bs(void 0),k=bs(void 0),l=bs(void 0),m=bs(void 0),n=bs((a,b)=>b0(a,cb[b])),o=bs(void 0),p=bs(0),q={groupIndices:[],groupOffsetTree:bK,lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:bK},r=bt(bn(c,br(i,a,p),bo(b7,q),bj()),q),s=bt(bn(i,bj(),bo((a,b)=>({current:b,prev:a.current}),{current:[],prev:[]}),bl(({prev:a})=>a)),[]);bf(bn(i,bk(a=>a.length>0),br(r,p),bl(([a,b,c])=>{let d=a.reduce((a,d,e)=>bP(a,d,b4(d,b.offsetTree,c)||e),bK);return{...b,groupIndices:a,groupOffsetTree:d}})),r),bf(bn(d,br(r),bk(([a,{lastIndex:b}])=>a<b),bl(([a,{lastIndex:b,lastSize:c}])=>[{endIndex:b,size:c,startIndex:a}])),c),bf(j,k);let t=bt(bn(j,bl(a=>void 0===a)),!0);bf(bn(k,bk(a=>void 0!==a&&bM(be(r).sizeTree)),bl(a=>{let b=be(l),c=be(i).length>0;return b?c?[{endIndex:0,size:b,startIndex:0},{endIndex:1,size:a,startIndex:1}]:[]:[{endIndex:0,size:a,startIndex:0}]})),c),bf(bn(m,bk(a=>void 0!==a&&a.length>0&&bM(be(r).sizeTree)),bl(a=>{let b=[],c=a[0],d=0;for(let e=1;e<a.length;e++){let f=a[e];f!==c&&(b.push({endIndex:e-1,size:c,startIndex:d}),c=f,d=e)}return b.push({endIndex:a.length-1,size:c,startIndex:d}),b})),c),bf(bn(i,br(l,k),bk(([,a,b])=>void 0!==a&&void 0!==b),bl(([a,b,c])=>{let d=[];for(let e=0;e<a.length;e++){let f=a[e],g=a[e+1];d.push({startIndex:f,endIndex:f,size:b}),void 0!==g&&d.push({startIndex:f+1,endIndex:g-1,size:c})}return d})),c);let u=bv(bn(c,br(r),bo(({sizes:a},[b,c])=>({changed:c!==a,sizes:c}),{changed:!1,sizes:q}),bl(a=>a.changed)));bn(h,bo((a,b)=>({diff:a.prev-b,prev:b}),{diff:0,prev:0}),bl(a=>a.diff))(1,a=>{let{groupIndices:c}=be(r);if(a>0)b(0,!0),f(0,a+b8(a,c));else if(a<0){let b=be(s);b.length>0&&(a-=b8(-a,b)),g(0,a)}}),bn(h,br(a))(1,([a,b])=>{a<0&&b("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:h},bB.ERROR)});let v=bv(f);bf(bn(f,br(r),bl(([a,b])=>{let c=b.groupIndices.length>0,d=[],e=b.lastSize;if(c){let c=bN(b.sizeTree,0),f=0,g=0;for(;f<a;){let a=b.groupIndices[g],h=b.groupIndices.length===g+1?1/0:b.groupIndices[g+1]-a-1;d.push({endIndex:a,size:c,startIndex:a}),d.push({endIndex:a+1+h-1,size:e,startIndex:a+1}),g++,f+=h+1}let h=bR(b.sizeTree);return f!==a&&h.shift(),h.reduce((b,{k:c,v:d})=>{let e=b.ranges;return 0!==b.prevSize&&(e=[...b.ranges,{endIndex:c+a-1,size:b.prevSize,startIndex:b.prevIndex}]),{prevIndex:c+a,prevSize:d,ranges:e}},{prevIndex:a,prevSize:0,ranges:d}).ranges}return bR(b.sizeTree).reduce((b,{k:c,v:d})=>({prevIndex:c+a,prevSize:d,ranges:[...b.ranges,{endIndex:c+a-1,size:b.prevSize,startIndex:b.prevIndex}]}),{prevIndex:0,prevSize:e,ranges:[]}).ranges})),c);let w=bv(bn(g,br(r,p),bl(([a,{offsetTree:b},c])=>b4(-a,b,c))));return bf(bn(g,br(r,p),bl(([a,b,c])=>{if(b.groupIndices.length>0){if(bM(b.sizeTree))return b;let d=bK,e=be(s),f=0,g=0,h=0;for(;f<-a;){h=e[g];let a=e[g+1]-h-1;g++,f+=a+1}return d=bR(b.sizeTree).reduce((b,{k:c,v:d})=>bP(b,Math.max(0,c+a),d),d),f!==-a&&(d=bP(d,0,bN(b.sizeTree,h)),d=bP(d,1,bO(b.sizeTree,-a+1)[1])),{...b,sizeTree:d,...b9(b.offsetTree,0,d,c)}}{let d=bR(b.sizeTree).reduce((b,{k:c,v:d})=>bP(b,Math.max(0,c+a),d),bK);return{...b,sizeTree:d,...b9(b.offsetTree,0,d,c)}}})),r),{beforeUnshiftWith:v,data:o,defaultItemSize:k,firstItemIndex:h,fixedItemSize:j,fixedGroupSize:l,gap:p,groupIndices:i,heightEstimates:m,itemSize:n,listRefresh:u,shiftWith:g,shiftWithOffset:w,sizeRanges:c,sizes:r,statefulTotalCount:e,totalCount:d,trackItemSizes:t,unshiftWith:f}},bc(bD,b$),{singleton:!0});function cd(a){return a.reduce((a,b)=>(a.groupIndices.push(a.totalCount),a.totalCount+=b+1,a),{groupIndices:[],totalCount:0})}let ce=bw(([{groupIndices:a,sizes:b,totalCount:c},{headerHeight:d,scrollTop:e}])=>{let f=bu(),g=bu(),h=bv(bn(f,bl(cd)));return bf(bn(h,bl(a=>a.totalCount)),c),bf(bn(h,bl(a=>a.groupIndices)),a),bf(bn(by(e,b,d),bk(([a,b])=>b1(b)),bl(([a,b,c])=>bO(b.groupOffsetTree,Math.max(a-c,0),"v")[0]),bj(),bl(a=>[a])),g),{groupCounts:f,topItemsIndexes:g}},bc(cc,bJ)),cf=bw(([{log:a}])=>{let b=bs(!1),c=bv(bn(b,bk(a=>a),bj()));return b(1,b=>{b&&be(a)("props updated",{},bB.DEBUG)}),{didMount:c,propsReady:b}},bc(bD),{singleton:!0}),cg="u">typeof document&&"scrollBehavior"in document.documentElement.style;function ch(a){let b="number"==typeof a?{index:a}:a;return b.align||(b.align="start"),b.behavior&&cg||(b.behavior="auto"),b.offset||(b.offset=0),b}let ci=bw(([{gap:a,listRefresh:b,sizes:c,totalCount:d},{fixedFooterHeight:e,fixedHeaderHeight:f,footerHeight:g,headerHeight:h,scrollingInProgress:i,scrollTo:j,smoothScrollTargetReached:k,viewportHeight:l},{log:m}])=>{let n=bu(),o=bu(),p=bs(0),q=null,r=null,s=null;function t(){q&&(q(),q=null),s&&(s(),s=null),r&&(clearTimeout(r),r=null),i(0,!1)}return bf(bn(n,br(c,l,d,p,h,g,m),br(a,f,e),bl(([[a,c,d,e,f,g,h,j],l,m,p])=>{let u=ch(a),{align:v,behavior:w,offset:x}=u,y=e-1,z=b6(u,c,y),A=b4(z,c.offsetTree,l)+g;"end"===v?(A+=m+bO(c.sizeTree,z)[1]-d+p,z===y&&(A+=h)):"center"===v?A+=(m+bO(c.sizeTree,z)[1]-d+p)/2:A-=f,x&&(A+=x);let B=b=>{t(),b?(j("retrying to scroll to",{location:a},bB.DEBUG),n(0,a)):(o(0,!0),j("list did not change, scroll successful",{},bB.DEBUG))};if(t(),"smooth"===w){let a=!1;s=b(1,b=>{a=a||b}),q=bg(k,()=>{B(a)})}else q=bg(bn(b,a=>{let b=setTimeout(()=>{a(!1)},150);return c=>{c&&(a(!0),clearTimeout(b))}}),B);return r=setTimeout(()=>{t()},1200),i(0,!0),j("scrolling from index to",{behavior:w,index:z,top:A},bB.DEBUG),{behavior:w,top:A}})),j),{scrollTargetReached:o,scrollToIndex:n,topListHeight:p}},bc(cc,bJ,bD),{singleton:!0});function cj(a,b){0==a?b():requestAnimationFrame(()=>{cj(a-1,b)})}function ck(a,b){return"number"==typeof a?a:"LAST"===a.index?b-1:a.index}let cl=bw(([{defaultItemSize:a,listRefresh:b,sizes:c},{scrollTop:d},{scrollTargetReached:e,scrollToIndex:f},{didMount:g}])=>{let h=bs(!0),i=bs(0),j=bs(!0);return bf(bn(g,br(i),bk(([a,b])=>!!b),bm(!1)),h),bf(bn(g,br(i),bk(([a,b])=>!!b),bm(!1)),j),bn(by(b,g),br(h,c,a,j),bk(([[,a],b,{sizeTree:c},d,e])=>a&&(!bM(c)||a9(d))&&!b&&!e),br(i))(1,([,a])=>{bg(e,()=>{j(0,!0)}),cj(4,()=>{bg(d,()=>{h(0,!0)}),f(0,a)})}),{initialItemFinalLocationReached:j,initialTopMostItemIndex:i,scrolledToInitialItem:h}},bc(cc,bJ,ci,cf),{singleton:!0});function cm(a,b){return 1.01>Math.abs(a-b)}let cn="down",co={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},cp=bw(([{footerHeight:a,headerHeight:b,scrollBy:c,scrollContainerState:d,scrollTop:e,viewportHeight:f}])=>{let g=bs(!1),h=bs(!0),i=bu(),j=bu(),k=bs(4),l=bs(0),m=bt(bn(bA(bn(bz(e),bp(1),bm(!0)),bn(bz(e),bp(1),bm(!1),bh(100))),bj()),!1),n=bt(bn(bA(bn(c,bm(!0)),bn(c,bm(!1),bh(200))),bj()),!1);bf(bn(by(bz(e),bz(l)),bl(([a,b])=>a<=b),bj()),h),bf(bn(h,bq(50)),j);let o=bv(bn(by(d,bz(f),bz(b),bz(a),bz(k)),bo((a,[{scrollHeight:b,scrollTop:c},d,e,f,g])=>{let h={scrollHeight:b,scrollTop:c,viewportHeight:d};if(c+d-b>-g){let b,d;return c>a.state.scrollTop?(b="SCROLLED_DOWN",d=a.state.scrollTop-c):(b="SIZE_DECREASED",d=a.state.scrollTop-c||a.scrollTopDelta),{atBottom:!0,atBottomBecause:b,scrollTopDelta:d,state:h}}return{atBottom:!1,notAtBottomBecause:h.scrollHeight>a.state.scrollHeight?"SIZE_INCREASED":d<a.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":c<a.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:h}},co),bj((a,b)=>a&&a.atBottom===b.atBottom))),p=bt(bn(d,bo((a,{scrollHeight:b,scrollTop:c,viewportHeight:d})=>{if(cm(a.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:c};{let e=b-(c+d)<1;return a.scrollTop!==c&&e?{changed:!0,jump:a.scrollTop-c,scrollHeight:b,scrollTop:c}:{changed:!0,jump:0,scrollHeight:b,scrollTop:c}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),bk(a=>a.changed),bl(a=>a.jump)),0);bf(bn(o,bl(a=>a.atBottom)),g),bf(bn(g,bq(50)),i);let q=bs(cn);bf(bn(d,bl(({scrollTop:a})=>a),bj(),bo((a,b)=>be(n)?{direction:a.direction,prevScrollTop:b}:{direction:b<a.prevScrollTop?"up":cn,prevScrollTop:b},{direction:cn,prevScrollTop:0}),bl(a=>a.direction)),q),bf(bn(d,bq(50),bm("none")),q);let r=bs(0);return bf(bn(m,bk(a=>!a),bm(0)),r),bf(bn(e,bq(100),br(m),bk(([a,b])=>b),bo(([a,b],[c])=>[b,c],[0,0]),bl(([a,b])=>b-a)),r),{atBottomState:o,atBottomStateChange:i,atBottomThreshold:k,atTopStateChange:j,atTopThreshold:l,isAtBottom:g,isAtTop:h,isScrolling:m,lastJumpDueToItemResize:p,scrollDirection:q,scrollVelocity:r}},bc(bJ)),cq="bottom",cr="none";function cs(a,b,c){return"number"==typeof a?"up"===c&&"top"===b||c===cn&&b===cq?a:0:"up"===c?"top"===b?a.main:a.reverse:b===cq?a.main:a.reverse}function ct(a,b){var c;return"number"==typeof a?a:null!=(c=a[b])?c:0}let cu=bw(([{deviation:a,fixedHeaderHeight:b,headerHeight:c,scrollTop:d,viewportHeight:e}])=>{let f=bu(),g=bs(0),h=bs(0),i=bs(0),j=bt(bn(by(bz(d),bz(e),bz(c),bz(f,bZ),bz(i),bz(g),bz(b),bz(a),bz(h)),bl(([a,b,c,[d,e],f,g,h,i,j])=>{let k=a-i,l=Math.max(c-k,0),m=cr,n=ct(j,"top"),o=ct(j,cq);return d-=i,d+=c+h,e+=c+h,d>a+(g+h)-n&&(m="up"),(e-=i)<a-l+b+o&&(m=cn),m!==cr?[Math.max(k-c-cs(f,"top",m)-n,0),k-l-h+b+cs(f,cq,m)+o]:null}),bk(a=>null!=a),bj(bZ)),[0,0]);return{increaseViewportBy:h,listBoundary:f,overscan:i,topListHeight:g,visibleRange:j}},bc(bJ),{singleton:!0}),cv={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function cw(a,b,c,d,e,f){let{lastIndex:g,lastOffset:h,lastSize:i}=e,j=0,k=0;if(a.length>0){j=a[0].offset;let b=a[a.length-1];k=b.offset+b.size}let l=c-g,m=j,n=h+l*i+(l-1)*d-k;return{bottom:k,firstItemIndex:f,items:cy(a,e,f),offsetBottom:n,offsetTop:j,top:m,topItems:cy(b,e,f),topListHeight:b.reduce((a,b)=>b.size+a,0),totalCount:c}}function cx(a,b,c,d,e,f){let g=0;if(c.groupIndices.length>0)for(let b of c.groupIndices){if(b-g>=a)break;g++}let h=a+g,i=ck(b,h);return cw(Array.from({length:h}).map((a,b)=>({data:f[b+i],index:b+i,offset:0,size:0})),[],h,e,c,d)}function cy(a,b,c){if(0===a.length)return[];if(!b1(b))return a.map(a=>({...a,index:a.index+c,originalIndex:a.index}));let d=a[0].index,e=a[a.length-1].index,f=[],g=bQ(b.groupOffsetTree,d,e),h,i=0;for(let d of a){let a;(!h||h.end<d.index)&&(h=g.shift(),i=b.groupIndices.indexOf(h.start)),a=d.index===h.start?{index:i,type:"group"}:{groupIndex:i,index:d.index-(i+1)+c},f.push({...a,data:d.data,offset:d.offset,originalIndex:d.index,size:d.size})}return f}function cz(a,b){var c;return void 0===a?0:"number"==typeof a?a:null!=(c=a[b])?c:0}let cA=bw(([{data:a,firstItemIndex:b,gap:c,sizes:d,totalCount:e},f,{listBoundary:g,topListHeight:h,visibleRange:i},{initialTopMostItemIndex:j,scrolledToInitialItem:k},{topListHeight:l},m,{didMount:n},{recalcInProgress:o}])=>{let p=bs([]),q=bs(0),r=bu(),s=bs(0);bf(f.topItemsIndexes,p);let t=bt(bn(by(n,o,bz(i,bZ),bz(e),bz(d),bz(j),k,bz(p),bz(b),bz(c),bz(s),a),bk(([a,b,,c,,,,,,,,d])=>{let e=d&&d.length!==c;return a&&!b&&!e}),bl(([,,[a,b],c,d,e,f,g,h,i,j,k])=>{var l,m,n,o,p;let{offsetTree:r,sizeTree:s}=d,t=be(q);if(0===c)return{...cv,totalCount:c};if(0===a&&0===b)return 0===t?{...cv,totalCount:c}:cx(t,e,d,h,i,k||[]);if(bM(s))return t>0?null:cw(function(a,b,c){if(b1(b)){let d=b5(a,b);return[{index:bO(b.groupOffsetTree,d)[0],offset:0,size:0},{data:null==c?void 0:c[0],index:d,offset:0,size:0}]}return[{data:null==c?void 0:c[0],index:a,offset:0,size:0}]}(ck(e,c),d,k),[],c,i,d,h);let u=[];if(g.length>0){let a=g[0],b=g[g.length-1],c=0;for(let d of bQ(s,a,b)){let e=d.value,f=Math.max(d.start,a),g=Math.min(d.end,b);for(let a=f;a<=g;a++)u.push({data:null==k?void 0:k[a],index:a,offset:c,size:e}),c+=e}}if(!f)return cw([],u,c,i,d,h);let v=g.length>0?g[g.length-1]+1:0,w=function(a,b,c,d=0){let e,f;return d>0&&(b=Math.max(b,a[b_(a,d,b2)].offset)),bL((e=b_(a,b,b3),f=b_(a,c,b3,e),a.slice(e,f+1)),ca)}(r,a,b,v);if(0===w.length)return null;let x=c-1,y=((c=>{for(let d of w){let e=d.value,f=e.offset,g=d.start,h=e.size;if(e.offset<a){let b=(g+=Math.floor((a-e.offset+i)/(h+i)))-d.start;f+=b*h+b*i}g<v&&(f+=(v-g)*h,g=v);let j=Math.min(d.end,x);for(let a=g;a<=j&&!(f>=b);a++)c.push({data:null==k?void 0:k[a],index:a,offset:f,size:h}),f+=h+i}})(p=[]),p),z=cz(j,"top"),A=cz(j,cq);if(y.length>0&&(z>0||A>0)){let a=y[0],b=y[y.length-1];if(z>0&&a.index>v){let b=Math.min(z,a.index-v),c=[],d=a.offset;for(let e=a.index-1;e>=a.index-b;e--){let b=null!=(m=null==(l=bQ(s,e,e)[0])?void 0:l.value)?m:a.size;d-=b+i,c.unshift({data:null==k?void 0:k[e],index:e,offset:d,size:b})}y.unshift(...c)}if(A>0&&b.index<x){let a=Math.min(A,x-b.index),c=b.offset+b.size+i;for(let d=b.index+1;d<=b.index+a;d++){let a=null!=(o=null==(n=bQ(s,d,d)[0])?void 0:n.value)?o:b.size;y.push({data:null==k?void 0:k[d],index:d,offset:c,size:a}),c+=a+i}}}return cw(y,u,c,i,d,h)}),bk(a=>null!==a),bj()),cv);bf(bn(a,bk(a9),bl(a=>null==a?void 0:a.length)),e),bf(bn(t,bl(a=>a.topListHeight)),l),bf(l,h),bf(bn(t,bl(a=>[a.top,a.bottom])),g),bf(bn(t,bl(a=>a.items)),r);let u=bv(bn(t,bk(({items:a})=>a.length>0),br(e,a),bk(([{items:a},b])=>a[a.length-1].originalIndex===b-1),bl(([,a,b])=>[a-1,b]),bj(bZ),bl(([a])=>a))),v=bv(bn(t,bq(200),bk(({items:a,topItems:b})=>a.length>0&&a[0].originalIndex===b.length),bl(({items:a})=>a[0].index),bj())),w=bv(bn(t,bk(({items:a})=>a.length>0),bl(({items:a})=>{let b=0,c=a.length-1;for(;"group"===a[b].type&&b<c;)b++;for(;"group"===a[c].type&&c>b;)c--;return{endIndex:a[c].index,startIndex:a[b].index}}),bj(bY)));return{endReached:u,initialItemCount:q,itemsRendered:r,listState:t,minOverscanItemCount:s,rangeChanged:w,startReached:v,topItemsIndexes:p,...m}},bc(cc,ce,cu,cl,ci,cp,cf,b$),{singleton:!0}),cB=bw(([{fixedFooterHeight:a,fixedHeaderHeight:b,footerHeight:c,headerHeight:d},{listState:e}])=>{let f=bu(),g=bt(bn(by(c,a,d,b,e),bl(([a,b,c,d,e])=>a+b+c+d+e.offsetBottom+e.bottom)),0);return bf(bz(g),f),{totalListHeight:g,totalListHeightChanged:f}},bc(bJ,cA),{singleton:!0}),cC=bw(([{viewportHeight:a},{totalListHeight:b}])=>{let c=bs(!1),d=bt(bn(by(c,a,b),bk(([a])=>a),bl(([,a,b])=>Math.max(0,a-b)),bq(0),bj()),0);return{alignToBottom:c,paddingTopAddition:d}},bc(bJ,cB),{singleton:!0}),cD=bw(()=>({context:bs(null)})),cE=({itemBottom:a,itemTop:b,locationParams:{align:c,behavior:d,...e},viewportBottom:f,viewportTop:g})=>b<g?{...e,align:null!=c?c:"start",behavior:d}:a>f?{...e,align:null!=c?c:"end",behavior:d}:null,cF=bw(([{gap:a,sizes:b,totalCount:c},{fixedFooterHeight:d,fixedHeaderHeight:e,headerHeight:f,scrollingInProgress:g,scrollTop:h,viewportHeight:i},{scrollToIndex:j}])=>{let k=bu();return bf(bn(k,br(b,i,c,f,e,d,h),br(a),bl(([[a,b,c,d,e,f,h,i],j])=>{let{align:k,behavior:l,calculateViewLocation:m=cE,done:n,...o}=a,p=b6(a,b,d-1),q=b4(p,b.offsetTree,j)+e+f,r=m({itemBottom:q+bO(b.sizeTree,p)[1],itemTop:q,locationParams:{align:k,behavior:l,...o},viewportBottom:i+c-h,viewportTop:i+f});return r?n&&bg(bn(g,bk(a=>!a),bp(be(g)?1:2)),n):null==n||n(),r}),bk(a=>null!==a)),j),{scrollIntoView:k}},bc(cc,bJ,ci,cA,bD),{singleton:!0});function cG(a){return!!a&&("smooth"===a?"smooth":"auto")}let cH=bw(([{listRefresh:a,totalCount:b,fixedItemSize:c,data:d},{atBottomState:e,isAtBottom:f},{scrollToIndex:g},{scrolledToInitialItem:h},{didMount:i,propsReady:j},{log:k},{scrollingInProgress:l},{context:m},{scrollIntoView:n}])=>{let o=bs(!1),p=bu(),q=null;function r(a){g(0,{align:"end",behavior:a,index:"LAST"})}function s(a){setTimeout(bg(e,b=>{!a||b.atBottom||"SIZE_INCREASED"!==b.notAtBottomBecause||q||(be(k)("scrolling to bottom due to increased size",{},bB.DEBUG),r("auto"))}),100)}bn(by(bn(bz(b),bp(1)),i),br(bz(o),f,h,l),bl(([[a,b],c,d,e,f])=>{let g,h=b&&e,i="auto";return h&&(g=d||f,i="function"==typeof c?cG(c(g)):g&&cG(c),h=h&&!!i),{followOutputBehavior:i,shouldFollow:h,totalCount:a}}),bk(({shouldFollow:a})=>a))(1,({followOutputBehavior:b,totalCount:d})=>{q&&(q(),q=null),be(c)?requestAnimationFrame(()=>{be(k)("following output to ",{totalCount:d},bB.DEBUG),r(b)}):q=bg(a,()=>{be(k)("following output to ",{totalCount:d},bB.DEBUG),r(b),q=null})}),bn(by(bz(o),b,j),bk(([a,,b])=>a&&b),bo(({value:a},[,b])=>({refreshed:a===b,value:b}),{refreshed:!1,value:0}),bk(({refreshed:a})=>a),br(o,b))(1,([,a])=>{be(h)&&s(!1!==a)}),p(1,()=>{s(!1!==be(o))}),by(bz(o),e)(1,([a,b])=>{a&&!b.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===b.notAtBottomBecause&&r("auto")});let t=bs(null),u=bu();return bf(bA(bn(bz(d),bl(a=>{var b;return null!=(b=null==a?void 0:a.length)?b:0})),bn(bz(b))),u),bn(by(bn(u,bp(1)),i),br(bz(t),h,l,m),bl(([[a,b],c,d,e,f])=>b&&d&&(null==c?void 0:c({context:f,totalCount:a,scrollingInProgress:e}))),bk(a=>!!a),bq(0))(1,b=>{q&&(q(),q=null),be(c)?requestAnimationFrame(()=>{be(k)("scrolling into view",{}),n(0,b)}):q=bg(a,()=>{be(k)("scrolling into view",{}),n(0,b),q=null})}),{autoscrollToBottom:p,followOutput:o,scrollIntoViewOnChange:t}},bc(cc,cp,ci,cl,cf,bD,bJ,cD,cF)),cI=bw(([{data:a,firstItemIndex:b,gap:c,sizes:d},{initialTopMostItemIndex:e},{initialItemCount:f,listState:g},{didMount:h}])=>(bf(bn(h,br(f),bk(([,a])=>0!==a),br(e,d,b,c,a),bl(([[,a],b,c,d,e,f=[]])=>cx(a,b,c,d,e,f))),g),{}),bc(cc,cl,cA,cf),{singleton:!0}),cJ=bw(([{didMount:a},{scrollTo:b},{listState:c}])=>{let d=bs(0);return bn(a,br(d),bk(([,a])=>0!==a),bl(([,a])=>({top:a})))(1,a=>{bg(bn(c,bp(1),bk(a=>a.items.length>1)),()=>{requestAnimationFrame(()=>{b(0,a)})})}),{initialScrollTop:d}},bc(cf,bJ,cA),{singleton:!0}),cK=bw(([{scrollVelocity:a}])=>{let b=bs(!1),c=bu(),d=bs(!1);return bf(bn(a,br(d,b,c),bk(([a,b])=>!!b),bl(([a,b,c,d])=>{let{enter:e,exit:f}=b;if(c){if(f(a,d))return!1}else if(e(a,d))return!0;return c}),bj()),b),bn(by(b,a,c),br(d))(1,([[a,b,c],d])=>{a&&d&&d.change&&d.change(b,c)}),{isSeeking:b,scrollSeekConfiguration:d,scrollSeekRangeChanged:c,scrollVelocity:a}},bc(cp),{singleton:!0}),cL=bw(([{scrollContainerState:a,scrollTo:b}])=>{let c=bu(),d=bu(),e=bu(),f=bs(!1),g=bs(void 0);return bf(bn(by(c,d),bl(([{scrollHeight:a,scrollTop:b,viewportHeight:c},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,b-d),viewportHeight:c}))),a),bf(bn(b,br(d),bl(([a,{offsetTop:b}])=>({...a,top:a.top+b}))),e),{customScrollParent:g,useWindowScroll:f,windowScrollContainerState:c,windowScrollTo:e,windowViewportRect:d}},bc(bJ)),cM=bw(([{sizeRanges:a,sizes:b},{headerHeight:c,scrollTop:d},{initialTopMostItemIndex:e},{didMount:f},{useWindowScroll:g,windowScrollContainerState:h,windowViewportRect:i}])=>{let j=bu(),k=bs(void 0),l=bs(null),m=bs(null);return bf(h,l),bf(i,m),bn(j,br(b,d,g,l,m,c))(1,([a,b,c,d,e,f,g])=>{let h=bR(b.sizeTree).map(({k:a,v:b},c,d)=>{let e=d[c+1];return{endIndex:e?e.k-1:1/0,size:b,startIndex:a}});d&&null!==e&&null!==f&&(c=e.scrollTop-f.offsetTop),a({ranges:h,scrollTop:c-=g})}),bf(bn(k,bk(a9),bl(cN)),e),bf(bn(f,br(k),bk(([,a])=>void 0!==a),bj(),bl(([,a])=>a.ranges)),a),{getState:j,restoreStateFrom:k}},bc(cc,bJ,cl,cf,cL));function cN(a){return{align:"start",index:0,offset:a.scrollTop}}let cO=bw(([{topItemsIndexes:a}])=>{let b=bs(0);return bf(bn(b,bk(a=>a>=0),bl(a=>Array.from({length:a}).map((a,b)=>b))),a),{topItemCount:b}},bc(cA));function cP(a){let b=!1,c;return()=>(b||(b=!0,c=a()),c)}let cQ=cP(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),cR=bw(([{deviation:a,scrollBy:b,scrollingInProgress:c,scrollTop:d},{isAtBottom:e,isScrolling:f,lastJumpDueToItemResize:g,scrollDirection:h},{listState:i},{beforeUnshiftWith:j,gap:k,shiftWithOffset:l,sizes:m},{log:n},{recalcInProgress:o}])=>{let p=bv(bn(i,br(g),bo(([,a,b,c],[{bottom:d,items:e,offsetBottom:f,totalCount:g},h])=>{let i=d+f,j=0;return b===g&&a.length>0&&e.length>0&&(0===e[0].originalIndex&&0===a[0].originalIndex||0!=(j=i-c)&&(j+=h)),[j,e,g,i]},[0,[],0,0]),bk(([a])=>0!==a),br(d,h,c,e,n,o),bk(([,a,b,c,,,d])=>!d&&!c&&0!==a&&"up"===b),bl(([[a],,,,,b])=>(b("Upward scrolling compensation",{amount:a},bB.DEBUG),a))));function q(c){c>0?(b(0,{behavior:"auto",top:-c}),a(0,0)):(a(0,0),b(0,{behavior:"auto",top:-c}))}return bn(p,br(a,f))(1,([b,c,d])=>{d&&cQ()?a(0,c-b):q(-b)}),bn(by(bt(f,!1),a,o),bk(([a,b,c])=>!a&&!c&&0!==b),bl(([a,b])=>b),bq(1))(1,q),bf(bn(l,bl(a=>({top:-a}))),b),bn(j,br(m,k),bl(([a,{groupIndices:b,lastSize:c,sizeTree:d},e])=>{if(0===b.length)return a*(c+e);{let f=0,g=bN(d,0),h=0,i=0;for(;h<a;){h++,f+=g;let d=b.length===i+1?1/0:b[i+1]-b[i]-1;h+d>a&&(f-=g,d=a-h+1),h+=d,f+=d*(c+e),i++}return f}}))(1,c=>{a(0,c),requestAnimationFrame(()=>{b(0,{top:c}),requestAnimationFrame(()=>{a(0,0),o(0,!1)})})}),{deviation:a}},bc(bJ,cp,cA,cc,bD,b$)),cS=bw(([a,b,c,d,e,f,g,h,i,j,k])=>({...a,...b,...c,...d,...e,...f,...g,...h,...i,...j,...k}),bc(cu,cI,cf,cK,cB,cJ,cC,cL,cF,bD,cD)),cT=bw(([{data:a,defaultItemSize:b,firstItemIndex:c,fixedItemSize:d,fixedGroupSize:e,gap:f,groupIndices:g,heightEstimates:h,itemSize:i,sizeRanges:j,sizes:k,statefulTotalCount:l,totalCount:m,trackItemSizes:n},{initialItemFinalLocationReached:o,initialTopMostItemIndex:p,scrolledToInitialItem:q},r,s,t,u,{scrollToIndex:v},w,{topItemCount:x},{groupCounts:y},z])=>{let{listState:A,minOverscanItemCount:B,topItemsIndexes:C,rangeChanged:D,...E}=u;return bf(D,z.scrollSeekRangeChanged),bf(bn(z.windowViewportRect,bl(a=>a.visibleHeight)),r.viewportHeight),{data:a,defaultItemHeight:b,firstItemIndex:c,fixedItemHeight:d,fixedGroupHeight:e,gap:f,groupCounts:y,heightEstimates:h,initialItemFinalLocationReached:o,initialTopMostItemIndex:p,scrolledToInitialItem:q,sizeRanges:j,topItemCount:x,topItemsIndexes:C,totalCount:m,...t,groupIndices:g,itemSize:i,listState:A,minOverscanItemCount:B,scrollToIndex:v,statefulTotalCount:l,trackItemSizes:n,rangeChanged:D,...E,...z,...r,sizes:k,...s}},bc(cc,cl,bJ,cM,cH,cA,ci,cR,cO,ce,cS)),cU="u">typeof document?r.default.useLayoutEffect:r.default.useEffect;function cV(a,b,c){let d=Object.keys(b.required||{}),e=Object.keys(b.optional||{}),f=Object.keys(b.methods||{}),g=Object.keys(b.events||{}),h=r.default.createContext({});function i(a,c){for(let e of(a.propsReady&&(0,a.propsReady)(0,!1),d))(0,a[b.required[e]])(0,c[e]);for(let d of e)d in c&&(0,a[b.optional[d]])(0,c[d]);a.propsReady&&(0,a.propsReady)(0,!0)}function j(a){return g.reduce((c,d)=>{var e;let f,g,h;return c[d]=(e=a[b.events[d]],h=()=>null==f?void 0:f(),function(a,b){switch(a){case 1:return b?g===b?void 0:(h(),g=b,f=e(1,b)):(h(),ba);case 2:h(),g=null;return}}),c},{})}return{Component:r.default.forwardRef((k,l)=>{var m;let{children:n,...o}=k,[p]=r.default.useState(()=>{var b;let c,d;return c=new Map,i(b=(d=({constructor:a,dependencies:b,id:e,singleton:f})=>{if(f&&c.has(e))return c.get(e);let g=a(b.map(a=>d(a)));return f&&c.set(e,g),g})(a),o),b}),[s]=r.default.useState(()=>j(p));return cU(()=>{for(let a of g)a in o&&(0,s[a])(1,o[a]);return()=>{Object.values(s).map(bd)}},[o,s,p]),cU(()=>{i(p,o)}),r.default.useImperativeHandle(l,(m=f.reduce((a,c)=>(a[c]=a=>{(0,p[b.methods[c]])(0,a)},a),{}),()=>m)),(0,q.jsx)(h.Provider,{value:p,children:c?(0,q.jsx)(c,{...function(a,b){let c={},d={},e=0,f=a.length;for(;e<f;)d[a[e]]=1,e+=1;for(let a in b)Object.hasOwn(d,a)||(c[a]=b[a]);return c}([...d,...e,...g],o),children:n}):n})}),useEmitter:(a,b)=>{let c=r.default.useContext(h)[a];cU(()=>c(1,b),[b,c])},useEmitterValue:r.default.version.startsWith("18")?a=>{let b=r.default.useContext(h)[a],c=r.default.useCallback(a=>b(1,a),[b]);return r.default.useSyncExternalStore(c,()=>be(b),()=>be(b))}:a=>{let b=r.default.useContext(h)[a],[c,d]=r.default.useState(()=>be(b));return cU(()=>b(1,a=>{a!==c&&d(()=>a)}),[b,c]),c},usePublisher:a=>{let b=r.default.useContext(h);return r.default.useCallback(c=>{(0,b[a])(0,c)},[b,a])}}}let cW=r.default.createContext(void 0),cX=r.default.createContext(void 0),cY="u">typeof document?r.default.useLayoutEffect:r.default.useEffect;function cZ(a){return"self"in a}function c$(a,b,c,d=ba,e,f){let g=r.default.useRef(null),h=r.default.useRef(null),i=r.default.useRef(null),j=r.default.useCallback(c=>{let d,e,g,j=c.target;if("body"in j||cZ(j)){let a=cZ(j)?j:j.defaultView;g=f?a.scrollX:a.scrollY,d=f?a.document.documentElement.scrollWidth:a.document.documentElement.scrollHeight,e=f?a.innerWidth:a.innerHeight}else g=f?j.scrollLeft:j.scrollTop,d=f?j.scrollWidth:j.scrollHeight,e=f?j.offsetWidth:j.offsetHeight;let k=()=>{a({scrollHeight:d,scrollTop:Math.max(g,0),viewportHeight:e})};c.suppressFlushSync?k():a6.default.flushSync(k),null!==h.current&&(g===h.current||g<=0||g===d-e)&&(h.current=null,b(!0),i.current&&(clearTimeout(i.current),i.current=null))},[a,b,f]);return r.default.useEffect(()=>{let a=e||g.current;return d(e||g.current),j({suppressFlushSync:!0,target:a}),a.addEventListener("scroll",j,{passive:!0}),()=>{d(null),a.removeEventListener("scroll",j)}},[g,j,c,d,e]),{scrollByCallback:function(a){f&&(a={behavior:a.behavior,left:a.top}),g.current.scrollBy(a)},scrollerRef:g,scrollToCallback:function(c){let d,e,j,k=g.current;if(!k||(f?"offsetWidth"in k&&0===k.offsetWidth:"offsetHeight"in k&&0===k.offsetHeight))return;let l="smooth"===c.behavior;cZ(k)?(e=Math.max(b0(k.document.documentElement,f?"width":"height"),f?k.document.documentElement.scrollWidth:k.document.documentElement.scrollHeight),d=f?k.innerWidth:k.innerHeight,j=f?window.scrollX:window.scrollY):(e=k[f?"scrollWidth":"scrollHeight"],d=b0(k,f?"width":"height"),j=k[f?"scrollLeft":"scrollTop"]);let m=e-d;if(c.top=Math.ceil(Math.max(Math.min(m,c.top),0)),cm(d,e)||c.top===j){a({scrollHeight:e,scrollTop:j,viewportHeight:d}),l&&b(!0);return}l?(h.current=c.top,i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{i.current=null,h.current=null,b(!0)},1e3)):h.current=null,f&&(c={behavior:c.behavior,left:c.top}),k.scrollTo(c)}}}let c_="-webkit-sticky",c0="sticky",c1=cP(()=>{if(typeof document>"u")return c0;let a=document.createElement("div");return a.style.position=c_,a.style.position===c_?c_:c0});function c2(a){return a}let c3=bw(()=>{let a=bs(a=>`Item ${a}`),b=bs(a=>`Group ${a}`),c=bs({}),d=bs(c2),e=bs("div"),f=bs(ba),g=(a,b=null)=>bt(bn(c,bl(b=>b[a]),bj()),b);return{components:c,computeItemKey:d,EmptyPlaceholder:g("EmptyPlaceholder"),FooterComponent:g("Footer"),GroupComponent:g("Group","div"),groupContent:b,HeaderComponent:g("Header"),HeaderFooterTag:e,ItemComponent:g("Item","div"),itemContent:a,ListComponent:g("List","div"),ScrollerComponent:g("Scroller","div"),scrollerRef:f,ScrollSeekPlaceholder:g("ScrollSeekPlaceholder"),TopItemListComponent:g("TopItemList")}}),c4=bw(([a,b])=>({...a,...b}),bc(cT,c3)),c5=({height:a})=>(0,q.jsx)("div",{style:{height:a}}),c6={overflowAnchor:"none",position:c1(),zIndex:1},c7={overflowAnchor:"none"},c8={...c7,display:"inline-block",height:"100%"},c9=r.default.memo(function({showTopList:a=!1}){let b=dq("listState"),c=dr("sizeRanges"),d=dq("useWindowScroll"),e=dq("customScrollParent"),f=dr("windowScrollContainerState"),g=dr("scrollContainerState"),h=dq("itemContent"),i=dq("context"),j=dq("groupContent"),k=dq("trackItemSizes"),l=dq("itemSize"),m=dq("log"),n=dr("gap"),o=dq("horizontalDirection"),{callbackRef:p}=bG(c,l,k,a?ba:e||d?f:g,m,n,e,o,dq("skipAnimationFrameInResizeObserver")),[s,t]=r.default.useState(0);dp("deviation",a=>{s!==a&&t(a)});let u=dq("EmptyPlaceholder"),v=dq("ScrollSeekPlaceholder")||c5,w=dq("ListComponent"),x=dq("ItemComponent"),y=dq("GroupComponent"),z=dq("computeItemKey"),A=dq("isSeeking"),B=dq("groupIndices").length>0,C=dq("alignToBottom"),D=dq("initialItemFinalLocationReached"),E=a?{}:{boxSizing:"border-box",...o?{display:"inline-block",height:"100%",marginLeft:0!==s?s:C?"auto":0,paddingLeft:b.offsetTop,paddingRight:b.offsetBottom,whiteSpace:"nowrap"}:{marginTop:0!==s?s:C?"auto":0,paddingBottom:b.offsetBottom,paddingTop:b.offsetTop},...D?{}:{visibility:"hidden"}};return!a&&0===b.totalCount&&u?(0,q.jsx)(u,{...de(u,i)}):(0,q.jsx)(w,{...de(w,i),"data-testid":a?"virtuoso-top-item-list":"virtuoso-item-list",ref:p,style:E,children:(a?b.topItems:b.items).map(a=>{let c=a.originalIndex,d=z(c+b.firstItemIndex,a.data,i);return A?(0,r.createElement)(v,{...de(v,i),height:a.size,index:a.index,key:d,type:a.type||"item",..."group"===a.type?{}:{groupIndex:a.groupIndex}}):"group"===a.type?(0,r.createElement)(y,{...de(y,i),"data-index":c,"data-item-index":a.index,"data-known-size":a.size,key:d,style:c6},j(a.index,i)):(0,r.createElement)(x,{...de(x,i),...df(x,a.data),"data-index":c,"data-item-group-index":a.groupIndex,"data-item-index":a.index,"data-known-size":a.size,key:d,style:o?c8:c7},B?h(a.index,a.groupIndex,a.data,i):h(a.index,a.data,i))})})}),da={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},db={outline:"none",overflowX:"auto",position:"relative"},dc=a=>({height:"100%",position:"absolute",top:0,width:"100%",...a?{display:"flex",flexDirection:"column"}:{}}),dd={position:c1(),top:0,width:"100%",zIndex:1};function de(a,b){if("string"!=typeof a)return{context:b}}function df(a,b){return{item:"string"==typeof a?void 0:b}}let dg=r.default.memo(function(){let a=dq("HeaderComponent"),b=dr("headerHeight"),c=dq("HeaderFooterTag"),d=bE(r.default.useMemo(()=>a=>{b(b0(a,"height"))},[b]),!0,dq("skipAnimationFrameInResizeObserver")),e=dq("context");return a?(0,q.jsx)(c,{ref:d,children:(0,q.jsx)(a,{...de(a,e)})}):null}),dh=r.default.memo(function(){let a=dq("FooterComponent"),b=dr("footerHeight"),c=dq("HeaderFooterTag"),d=bE(r.default.useMemo(()=>a=>{b(b0(a,"height"))},[b]),!0,dq("skipAnimationFrameInResizeObserver")),e=dq("context");return a?(0,q.jsx)(c,{ref:d,children:(0,q.jsx)(a,{...de(a,e)})}):null});function di({useEmitter:a,useEmitterValue:b,usePublisher:c}){return r.default.memo(function({children:d,style:e,context:f,...g}){let h=c("scrollContainerState"),i=b("ScrollerComponent"),j=c("smoothScrollTargetReached"),k=b("scrollerRef"),l=b("horizontalDirection")||!1,{scrollByCallback:m,scrollerRef:n,scrollToCallback:o}=c$(h,j,i,k,void 0,l);return a("scrollTo",o),a("scrollBy",m),(0,q.jsx)(i,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:n,style:{...l?db:da,...e},tabIndex:0,...g,...de(i,f),children:d})})}function dj({useEmitter:a,useEmitterValue:b,usePublisher:c}){return r.default.memo(function({children:d,style:e,context:f,...g}){let h=c("windowScrollContainerState"),i=b("ScrollerComponent"),j=c("smoothScrollTargetReached"),k=b("totalListHeight"),l=b("deviation"),m=b("customScrollParent"),n=r.default.useRef(null),{scrollByCallback:o,scrollerRef:p,scrollToCallback:s}=c$(h,j,i,b("scrollerRef"),m);return cY(()=>{var a;return p.current=m||(null==(a=n.current)?void 0:a.ownerDocument.defaultView),()=>{p.current=null}},[p,m]),a("windowScrollTo",s),a("scrollBy",o),(0,q.jsx)(i,{ref:n,"data-virtuoso-scroller":!0,style:{position:"relative",...e,...0!==k?{height:k+l}:{}},...g,...de(i,f),children:d})})}let dk=({children:a})=>{let b=r.default.useContext(cW),c=dr("viewportHeight"),d=dr("fixedItemHeight"),e=dq("alignToBottom"),f=dq("horizontalDirection"),g=bE(r.default.useMemo(()=>a8(c,a=>b0(a,f?"width":"height")),[c,f]),!0,dq("skipAnimationFrameInResizeObserver"));return r.default.useEffect(()=>{b&&(c(b.viewportHeight),d(b.itemHeight))},[b,c,d]),(0,q.jsx)("div",{"data-viewport-type":"element",ref:g,style:dc(e),children:a})},dl=({children:a})=>{let b=r.default.useContext(cW),c=dr("windowViewportRect"),d=dr("fixedItemHeight"),e=bI(c,dq("customScrollParent"),dq("skipAnimationFrameInResizeObserver")),f=dq("alignToBottom");return r.default.useEffect(()=>{b&&(d(b.itemHeight),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:100}))},[b,c,d]),(0,q.jsx)("div",{"data-viewport-type":"window",ref:e,style:dc(f),children:a})},dm=({children:a})=>{let b=dq("TopItemListComponent")||"div",c=dq("headerHeight"),d={...dd,marginTop:`${c}px`},e=dq("context");return(0,q.jsx)(b,{style:d,...de(b,e),children:a})},{Component:dn,useEmitter:dp,useEmitterValue:dq,usePublisher:dr}=cV(c4,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},r.default.memo(function(a){let b=dq("useWindowScroll"),c=dq("topItemsIndexes").length>0,d=dq("customScrollParent"),e=dq("context");return(0,q.jsxs)(d||b?dt:ds,{...a,context:e,children:[c&&(0,q.jsx)(dm,{children:(0,q.jsx)(c9,{showTopList:!0})}),(0,q.jsxs)(d||b?dl:dk,{children:[(0,q.jsx)(dg,{}),(0,q.jsx)(c9,{}),(0,q.jsx)(dh,{})]})]})})),ds=di({useEmitter:dp,useEmitterValue:dq,usePublisher:dr}),dt=dj({useEmitter:dp,useEmitterValue:dq,usePublisher:dr}),du=bw(()=>{let a=bs(a=>(0,q.jsxs)("td",{children:["Item $",a]})),b=bs(null),c=bs(a=>(0,q.jsxs)("td",{colSpan:1e3,children:["Group ",a]})),d=bs(null),e=bs(null),f=bs({}),g=bs(c2),h=bs(ba),i=(a,b=null)=>bt(bn(f,bl(b=>b[a]),bj()),b);return{components:f,computeItemKey:g,context:b,EmptyPlaceholder:i("EmptyPlaceholder"),FillerRow:i("FillerRow"),fixedFooterContent:e,fixedHeaderContent:d,itemContent:a,groupContent:c,ScrollerComponent:i("Scroller","div"),scrollerRef:h,ScrollSeekPlaceholder:i("ScrollSeekPlaceholder"),TableBodyComponent:i("TableBody","tbody"),TableComponent:i("Table","table"),TableFooterComponent:i("TableFoot","tfoot"),TableHeadComponent:i("TableHead","thead"),TableRowComponent:i("TableRow","tr"),GroupComponent:i("Group","tr")}}),dv=bw(([a,b])=>({...a,...b}),bc(cT,du)),dw=({height:a})=>(0,q.jsx)("tr",{children:(0,q.jsx)("td",{style:{height:a}})}),dx=({height:a})=>(0,q.jsx)("tr",{children:(0,q.jsx)("td",{style:{border:0,height:a,padding:0}})}),dy={overflowAnchor:"none"},dz={position:c1(),zIndex:2,overflowAnchor:"none"},dA=r.default.memo(function({showTopList:a=!1}){let b=dF("listState"),c=dF("computeItemKey"),d=dF("firstItemIndex"),e=dF("context"),f=dF("isSeeking"),g=dF("fixedHeaderHeight"),h=dF("groupIndices").length>0,i=dF("itemContent"),j=dF("groupContent"),k=dF("ScrollSeekPlaceholder")||dw,l=dF("GroupComponent"),m=dF("TableRowComponent"),n=(a?b.topItems:[]).reduce((a,b,c)=>(0===c?a.push(b.size):a.push(a[c-1]+b.size),a),[]),o=(a?b.topItems:b.items).map(b=>{let o=b.originalIndex,p=c(o+d,b.data,e),q=a?0===o?0:n[o-1]:0;return f?(0,r.createElement)(k,{...de(k,e),height:b.size,index:b.index,key:p,type:b.type||"item"}):"group"===b.type?(0,r.createElement)(l,{...de(l,e),"data-index":o,"data-item-index":b.index,"data-known-size":b.size,key:p,style:{...dz,top:g}},j(b.index,e)):(0,r.createElement)(m,{...de(m,e),...df(m,b.data),"data-index":o,"data-item-index":b.index,"data-known-size":b.size,"data-item-group-index":b.groupIndex,key:p,style:a?{...dz,top:g+q}:dy},h?i(b.index,b.groupIndex,b.data,e):i(b.index,b.data,e))});return(0,q.jsx)(q.Fragment,{children:o})}),dB=r.default.memo(function(){let a=dF("listState"),b=dF("topItemsIndexes").length>0,c=dG("sizeRanges"),d=dF("useWindowScroll"),e=dF("customScrollParent"),f=dG("windowScrollContainerState"),g=dG("scrollContainerState"),h=dF("trackItemSizes"),{callbackRef:i,ref:j}=bG(c,dF("itemSize"),h,e||d?f:g,dF("log"),void 0,e,!1,dF("skipAnimationFrameInResizeObserver")),[k,l]=r.default.useState(0);dE("deviation",a=>{k!==a&&(j.current.style.marginTop=`${a}px`,l(a))});let m=dF("EmptyPlaceholder"),n=dF("FillerRow")||dx,o=dF("TableBodyComponent"),p=dF("paddingTopAddition"),s=dF("statefulTotalCount"),t=dF("context");if(0===s&&m)return(0,q.jsx)(m,{...de(m,t)});let u=(b?a.topItems:[]).reduce((a,b)=>a+b.size,0),v=a.offsetTop+p+k-u,w=a.offsetBottom,x=v>0?(0,q.jsx)(n,{context:t,height:v},"padding-top"):null,y=w>0?(0,q.jsx)(n,{context:t,height:w},"padding-bottom"):null;return(0,q.jsxs)(o,{"data-testid":"virtuoso-item-list",ref:i,...de(o,t),children:[x,b&&(0,q.jsx)(dA,{showTopList:!0}),(0,q.jsx)(dA,{}),y]})}),dC=({children:a})=>{let b=r.default.useContext(cW),c=dG("viewportHeight"),d=dG("fixedItemHeight"),e=bE(r.default.useMemo(()=>a8(c,a=>b0(a,"height")),[c]),!0,dF("skipAnimationFrameInResizeObserver"));return r.default.useEffect(()=>{b&&(c(b.viewportHeight),d(b.itemHeight))},[b,c,d]),(0,q.jsx)("div",{"data-viewport-type":"element",ref:e,style:dc(!1),children:a})},dD=({children:a})=>{let b=r.default.useContext(cW),c=dG("windowViewportRect"),d=dG("fixedItemHeight"),e=bI(c,dF("customScrollParent"),dF("skipAnimationFrameInResizeObserver"));return r.default.useEffect(()=>{b&&(d(b.itemHeight),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:100}))},[b,c,d]),(0,q.jsx)("div",{"data-viewport-type":"window",ref:e,style:dc(!1),children:a})},{useEmitter:dE,useEmitterValue:dF,usePublisher:dG}=cV(dv,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},r.default.memo(function(a){let b=dF("useWindowScroll"),c=dF("customScrollParent"),d=dG("fixedHeaderHeight"),e=dG("fixedFooterHeight"),f=dF("fixedHeaderContent"),g=dF("fixedFooterContent"),h=dF("context"),i=bE(r.default.useMemo(()=>a8(d,a=>b0(a,"height")),[d]),!0,dF("skipAnimationFrameInResizeObserver")),j=bE(r.default.useMemo(()=>a8(e,a=>b0(a,"height")),[e]),!0,dF("skipAnimationFrameInResizeObserver")),k=c||b?dI:dH,l=c||b?dD:dC,m=dF("TableComponent"),n=dF("TableHeadComponent"),o=dF("TableFooterComponent"),p=f?(0,q.jsx)(n,{ref:i,style:{position:"sticky",top:0,zIndex:2},...de(n,h),children:f()},"TableHead"):null,s=g?(0,q.jsx)(o,{ref:j,style:{bottom:0,position:"sticky",zIndex:1},...de(o,h),children:g()},"TableFoot"):null;return(0,q.jsx)(k,{...a,...de(k,h),children:(0,q.jsx)(l,{children:(0,q.jsxs)(m,{style:{borderSpacing:0,overflowAnchor:"none"},...de(m,h),children:[p,(0,q.jsx)(dB,{},"TableBody"),s]})})})})),dH=di({useEmitter:dE,useEmitterValue:dF,usePublisher:dG}),dI=dj({useEmitter:dE,useEmitterValue:dF,usePublisher:dG}),dJ={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},dK={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:dL,floor:dM,max:dN,min:dO,round:dP}=Math;function dQ(a,b,c){return Array.from({length:b-a+1}).map((b,d)=>({data:null===c?null:c[d+a],index:d+a}))}function dR(a,b){return a&&a.width===b.width&&a.height===b.height}function dS(a,b){return a&&a.column===b.column&&a.row===b.row}let dT=bw(([{increaseViewportBy:a,listBoundary:b,overscan:c,visibleRange:d},{footerHeight:e,headerHeight:f,scrollBy:g,scrollContainerState:h,scrollTo:i,scrollTop:j,smoothScrollTargetReached:k,viewportHeight:l},m,n,{didMount:o,propsReady:p},{customScrollParent:q,useWindowScroll:r,windowScrollContainerState:s,windowScrollTo:t,windowViewportRect:u},v])=>{let w=bs(0),x=bs(0),y=bs(dJ),z=bs({height:0,width:0}),A=bs({height:0,width:0}),B=bu(),C=bu(),D=bs(0),E=bs(null),F=bs({column:0,row:0}),G=bu(),H=bu(),I=bs(!1),J=bs(0),K=bs(!0),L=bs(!1),M=bs(!1);bn(o,br(J),bk(([a,b])=>!!b))(1,()=>{K(0,!1)}),bn(by(o,K,A,z,J,L),bk(([a,b,c,d,,e])=>a&&!b&&0!==c.height&&0!==d.height&&!e))(1,([,,,,a])=>{L(0,!0),cj(1,()=>{B(0,a)}),bg(bn(j),()=>{b(0,[0,0]),K(0,!0)})}),bf(bn(H,bk(a=>null!=a&&a.scrollTop>0),bm(0)),x),bn(o,br(H),bk(([,a])=>null!=a))(1,([,a])=>{a&&(z(0,a.viewport),A(0,a.item),F(0,a.gap),a.scrollTop>0&&(I(0,!0),bg(bn(j,bp(1)),a=>{I(0,!1)}),i(0,{top:a.scrollTop})))}),bf(bn(z,bl(({height:a})=>a)),l),bf(bn(by(bz(z,dR),bz(A,dR),bz(F,(a,b)=>a&&a.column===b.column&&a.row===b.row),bz(j)),bl(([a,b,c,d])=>({gap:c,item:b,scrollTop:d,viewport:a}))),G),bf(bn(by(bz(w),d,bz(F,dS),bz(A,dR),bz(z,dR),bz(E),bz(x),bz(I),bz(K),bz(J)),bk(([,,,,,,,a])=>!a),bl(([a,[b,c],d,e,f,g,h,,i,j])=>{let k,l,{column:m,row:n}=d,{height:o,width:p}=e,{width:q}=f;if(0===h&&(0===a||0===q))return dJ;if(0===p){var r;let b=ck(j,a),c=b+Math.max(h-1,0);return r=dQ(b,c,g),{...dK,items:r}}let s=dU(q,p,m);i?0===b&&0===c&&h>0?(k=0,l=h-1):(k=s*dM((b+n)/(o+n)),l=dO(a-1,dN(l=s*dL((c+n)/(o+n))-1,s-1)),k=dO(l,dN(0,k))):(k=0,l=-1);let t=dQ(k,l,g),{bottom:u,top:v}=dV(f,d,e,t),w=dL(a/s);return{bottom:u,itemHeight:o,items:t,itemWidth:p,offsetBottom:w*o+(w-1)*n-u,offsetTop:v,top:v}})),y),bf(bn(E,bk(a=>null!==a),bl(a=>a.length)),w),bf(bn(by(z,A,y,F),bk(([a,b,{items:c}])=>c.length>0&&0!==b.height&&0!==a.height),bl(([a,b,{items:c},d])=>{let{bottom:e,top:f}=dV(a,d,b,c);return[f,e]}),bj(bZ)),b);let N=bs(!1);bf(bn(j,br(N),bl(([a,b])=>b||0!==a)),N);let O=bv(bn(by(y,w),bk(([{items:a}])=>a.length>0),br(N),bk(([[a,b],c])=>{let d=a.items[a.items.length-1].index===b-1;return(c||a.bottom>0&&a.itemHeight>0&&0===a.offsetBottom&&a.items.length===b)&&d}),bl(([[,a]])=>a-1),bj())),P=bv(bn(bz(y),bk(({items:a})=>a.length>0&&0===a[0].index),bm(0),bj())),Q=bv(bn(bz(y),br(I),bk(([{items:a},b])=>a.length>0&&!b),bl(([{items:a}])=>({endIndex:a[a.length-1].index,startIndex:a[0].index})),bj(bY),bq(0)));bf(Q,n.scrollSeekRangeChanged),bf(bn(B,br(z,A,w,F),bl(([a,b,c,d,e])=>{let f=ch(a),{align:g,behavior:h,offset:i}=f,j=f.index;"LAST"===j&&(j=d-1);let k=dW(b,e,c,j=dN(0,j,dO(d-1,j)));return"end"===g?k=dP(k-b.height+c.height):"center"===g&&(k=dP(k-b.height/2+c.height/2)),i&&(k+=i),{behavior:h,top:k}})),i);let R=bt(bn(y,bl(a=>a.offsetBottom+a.bottom)),0);return bf(bn(u,bl(a=>({height:a.visibleHeight,width:a.visibleWidth}))),z),{customScrollParent:q,data:E,deviation:D,footerHeight:e,gap:F,headerHeight:f,increaseViewportBy:a,initialItemCount:x,itemDimensions:A,overscan:c,restoreStateFrom:H,scrollBy:g,scrollContainerState:h,scrollHeight:C,scrollTo:i,scrollToIndex:B,scrollTop:j,smoothScrollTargetReached:k,totalCount:w,useWindowScroll:r,viewportDimensions:z,windowScrollContainerState:s,windowScrollTo:t,windowViewportRect:u,...n,gridState:y,horizontalDirection:M,initialTopMostItemIndex:J,totalListHeight:R,...m,endReached:O,propsReady:p,rangeChanged:Q,startReached:P,stateChanged:G,stateRestoreInProgress:I,...v}},bc(cu,bJ,cp,cK,cf,cL,bD));function dU(a,b,c){return dN(1,dM((a+c)/(dM(b)+c)))}function dV(a,b,c,d){let{height:e}=c;if(void 0===e||0===d.length)return{bottom:0,top:0};let f=dW(a,b,c,d[0].index);return{bottom:dW(a,b,c,d[d.length-1].index)+e,top:f}}function dW(a,b,c,d){let e=dM(d/dU(a.width,c.width,b.column)),f=e*c.height+dN(0,e-1)*b.row;return f>0?f+b.row:f}let dX=bw(()=>{let a=bs(a=>`Item ${a}`),b=bs({}),c=bs(null),d=bs("virtuoso-grid-item"),e=bs("virtuoso-grid-list"),f=bs(c2),g=bs("div"),h=bs(ba),i=(a,c=null)=>bt(bn(b,bl(b=>b[a]),bj()),c),j=bs(!1),k=bs(!1);return bf(bz(k),j),{components:b,computeItemKey:f,context:c,FooterComponent:i("Footer"),HeaderComponent:i("Header"),headerFooterTag:g,itemClassName:d,ItemComponent:i("Item","div"),itemContent:a,listClassName:e,ListComponent:i("List","div"),readyStateChanged:j,reportReadyState:k,ScrollerComponent:i("Scroller","div"),scrollerRef:h,ScrollSeekPlaceholder:i("ScrollSeekPlaceholder","div")}}),dY=bw(([a,b])=>({...a,...b}),bc(dT,dX)),dZ=r.default.memo(function(){let a=d3("gridState"),b=d3("listClassName"),c=d3("itemClassName"),d=d3("itemContent"),e=d3("computeItemKey"),f=d3("isSeeking"),g=d4("scrollHeight"),h=d3("ItemComponent"),i=d3("ListComponent"),j=d3("ScrollSeekPlaceholder"),k=d3("context"),l=d4("itemDimensions"),m=d4("gap"),n=d3("log"),o=d3("stateRestoreInProgress"),p=d4("reportReadyState"),s=bE(r.default.useMemo(()=>a=>{g(a.parentElement.parentElement.scrollHeight);let b=a.firstChild;if(b){let{height:a,width:c}=b.getBoundingClientRect();l({height:a,width:c})}m({column:d7("column-gap",getComputedStyle(a).columnGap,n),row:d7("row-gap",getComputedStyle(a).rowGap,n)})},[g,l,m,n]),!0,!1);return cY(()=>{a.itemHeight>0&&a.itemWidth>0&&p(!0)},[a]),o?null:(0,q.jsx)(i,{className:b,ref:s,...de(i,k),"data-testid":"virtuoso-item-list",style:{paddingBottom:a.offsetBottom,paddingTop:a.offsetTop},children:a.items.map(b=>{let g=e(b.index,b.data,k);return f?(0,q.jsx)(j,{...de(j,k),height:a.itemHeight,index:b.index,width:a.itemWidth},g):(0,r.createElement)(h,{...de(h,k),className:c,"data-index":b.index,key:g},d(b.index,b.data,k))})})}),d$=r.default.memo(function(){let a=d3("HeaderComponent"),b=d4("headerHeight"),c=d3("headerFooterTag"),d=bE(r.default.useMemo(()=>a=>{b(b0(a,"height"))},[b]),!0,!1),e=d3("context");return a?(0,q.jsx)(c,{ref:d,children:(0,q.jsx)(a,{...de(a,e)})}):null}),d_=r.default.memo(function(){let a=d3("FooterComponent"),b=d4("footerHeight"),c=d3("headerFooterTag"),d=bE(r.default.useMemo(()=>a=>{b(b0(a,"height"))},[b]),!0,!1),e=d3("context");return a?(0,q.jsx)(c,{ref:d,children:(0,q.jsx)(a,{...de(a,e)})}):null}),d0=({children:a})=>{let b=r.default.useContext(cX),c=d4("itemDimensions"),d=d4("viewportDimensions"),e=bE(r.default.useMemo(()=>a=>{d(a.getBoundingClientRect())},[d]),!0,!1);return r.default.useEffect(()=>{b&&(d({height:b.viewportHeight,width:b.viewportWidth}),c({height:b.itemHeight,width:b.itemWidth}))},[b,d,c]),(0,q.jsx)("div",{ref:e,style:dc(!1),children:a})},d1=({children:a})=>{let b=r.default.useContext(cX),c=d4("windowViewportRect"),d=d4("itemDimensions"),e=bI(c,d3("customScrollParent"),!1);return r.default.useEffect(()=>{b&&(d({height:b.itemHeight,width:b.itemWidth}),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:b.viewportWidth}))},[b,c,d]),(0,q.jsx)("div",{ref:e,style:dc(!1),children:a})},{useEmitter:d2,useEmitterValue:d3,usePublisher:d4}=cV(dY,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},r.default.memo(function({...a}){let b=d3("useWindowScroll"),c=d3("customScrollParent"),d=c||b?d6:d5,e=c||b?d1:d0,f=d3("context");return(0,q.jsx)(d,{...a,...de(d,f),children:(0,q.jsxs)(e,{children:[(0,q.jsx)(d$,{}),(0,q.jsx)(dZ,{}),(0,q.jsx)(d_,{})]})})})),d5=di({useEmitter:d2,useEmitterValue:d3,usePublisher:d4}),d6=dj({useEmitter:d2,useEmitterValue:d3,usePublisher:d4});function d7(a,b,c){return"normal"===b||null!=b&&b.endsWith("px")||c(`${a} was not resolved to pixel value correctly`,b,bB.WARN),"normal"===b?0:parseInt(null!=b?b:"0",10)}let d8=(0,r.memo)(({gender:a,className:b})=>"male"===a?(0,q.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,q.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,q.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):"female"===a?(0,q.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,q.jsx)("path",{d:"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"}),(0,q.jsx)("path",{d:"M18 22H6c0-4 4-3 6-3s6-1 6 3Z"})]}):(0,q.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,q.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,q.jsx)("circle",{cx:"12",cy:"10",r:"3"}),(0,q.jsx)("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]})),d9=(0,r.memo)(({onSendMessage:a,showBottomNavPadding:b,onFocusChange:c,isFocused:d})=>{let[e,f]=(0,r.useState)(""),g=(0,r.useRef)(null);return(0,q.jsx)("footer",{className:`px-3 py-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${d?"pb-4 pt-3":b?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[90px] pt-4":"py-4"}`,children:(0,q.jsxs)("form",{onSubmit:b=>{b.preventDefault(),e.trim()&&(a(e.trim()),f(""),g.current?.blur())},className:"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto",children:[(0,q.jsx)("input",{ref:g,type:"text",value:e,onChange:a=>f(a.target.value),onFocus:()=>c?.(!0),onBlur:()=>c?.(!1),placeholder:"Messaggio alla stanza...",className:"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400",style:{fontSize:"16px"}}),(0,q.jsx)("button",{type:"submit",className:"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform",onMouseDown:a=>a.preventDefault(),children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 rotate-45",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})}),ea=({user:a,messages:b,onSendMessage:c,onlineCount:d,isOnline:e,hideHeader:f,headerTitle:g,showBottomNavPadding:h,onInputFocusChange:i,isFocused:j,isSyncing:k})=>{let l=(0,r.useRef)(null),m=(0,r.useCallback)((c,d)=>{let e=d.senderId===a.id,f=0===c||b[c-1].senderId!==d.senderId;return(0,q.jsx)("div",{className:`flex ${e?"justify-end":"justify-start"} animate-message pb-4 px-4`,children:(0,q.jsxs)("div",{className:`flex flex-col max-w-[85%] ${e?"items-end":"items-start"}`,children:[f&&(0,q.jsxs)("span",{className:`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${e?"text-emerald-700":"text-gray-600"}`,children:[!e&&(0,q.jsx)("div",{className:`w-3.5 h-3.5 rounded-full flex items-center justify-center ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(d.senderGender)}`,children:(0,q.jsx)(d8,{gender:d.senderGender,className:"w-2 h-2 text-white"})}),e?"Tu":d.senderAlias]}),(0,q.jsx)("div",{className:`px-3 py-2 rounded-2xl shadow-sm ${e?"bg-emerald-500 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:(0,q.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed text-[15px]",children:d.text})}),(0,q.jsx)("span",{className:"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70",children:new Date(d.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},[a.id,b]);return(0,q.jsxs)("div",{className:"w-full h-full flex flex-col bg-white",children:[!f&&(0,q.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 shrink-0",children:(0,q.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h2",{className:"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight",children:g||"Stanza"}),(0,q.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,q.jsx)("span",{className:`w-2 h-2 rounded-full ${e?"bg-emerald-500":"bg-red-500"}`}),(0,q.jsx)("p",{className:"text-[11px] font-bold text-emerald-600 uppercase tracking-wide",children:e?`${d} persone qui`:"Disconnesso"})]})]})]}),k&&(0,q.jsxs)("div",{className:"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse",children:[(0,q.jsxs)("svg",{className:"animate-spin h-3 w-3 text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,q.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,q.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,q.jsx)("span",{className:"text-[10px] font-bold text-emerald-700 tracking-wide uppercase",children:"Sincronizzazione"})]})]})}),(0,q.jsx)("div",{className:"flex-1 overflow-hidden relative chat-bg",children:(0,q.jsx)(dn,{ref:l,data:b,initialTopMostItemIndex:b.length-1,itemContent:m,followOutput:"smooth",className:"h-full w-full",alignToBottom:!0})}),(0,q.jsx)(d9,{onSendMessage:c,showBottomNavPadding:h,onFocusChange:i,isFocused:j})]})},eb=({activeTab:a,onTabChange:b,usersCount:c,unreadChatsCount:d})=>(0,q.jsxs)("nav",{className:"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]",children:[(0,q.jsxs)("button",{onClick:()=>b("room"),className:`flex flex-col items-center justify-center w-full relative ${"room"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"room"===a?2.6:2.2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),c>0&&(0,q.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:c})]}),(0,q.jsx)("span",{className:`text-[10px] mt-1 ${"room"===a?"font-bold":"font-semibold"}`,children:"Stanza"})]}),(0,q.jsxs)("button",{onClick:()=>b("users"),className:`flex flex-col items-center justify-center w-full relative ${"users"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"users"===a?2.6:2.2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,q.jsx)("span",{className:`text-[10px] mt-1 ${"users"===a?"font-bold":"font-semibold"}`,children:"Utenti"})]}),(0,q.jsxs)("button",{onClick:()=>b("chats"),className:`flex flex-col items-center justify-center w-full relative ${"chats"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"chats"===a?2.6:2.2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),d>0&&(0,q.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:d})]}),(0,q.jsx)("span",{className:`text-[10px] mt-1 ${"chats"===a?"font-bold":"font-semibold"}`,children:"Chats"})]}),(0,q.jsxs)("button",{onClick:()=>b("settings"),className:`flex flex-col items-center justify-center w-full relative ${"settings"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"settings"===a?2.6:2.2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,q.jsx)("span",{className:`text-[10px] mt-1 ${"settings"===a?"font-bold":"font-semibold"}`,children:"Me"})]})]}),ec=({currentUser:a,users:b,onStartChat:c})=>{let[d,e]=(0,r.useState)(""),f=b.filter(b=>b.id!==a.id&&b.alias.toLowerCase().includes(d.toLowerCase()));return(0,q.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,q.jsxs)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 transition-all",children:[(0,q.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,q.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Utenti"}),(0,q.jsxs)("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide",children:[b.length," Online"]})]}),(0,q.jsx)("div",{className:"px-4 pb-3",children:(0,q.jsxs)("div",{className:"relative group",children:[(0,q.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,q.jsx)("input",{type:"text",placeholder:"Cerca utente per nome...",value:d,onChange:a=>e(a.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm"}),d&&(0,q.jsx)("button",{onClick:()=>e(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),(0,q.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===f.length?(0,q.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,q.jsx)("p",{className:"text-center font-medium",children:d?"Nessun utente trovato.":"Nessun altro utente online al momento."})]}):(0,q.jsx)("ul",{className:"space-y-4",children:f.map(a=>(0,q.jsxs)("li",{className:"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0",children:[(0,q.jsxs)("div",{className:`w-12 h-12 rounded-full ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(a.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:[(0,q.jsx)("span",{className:"font-bold text-lg uppercase",children:a.alias.charAt(0)}),(0,q.jsx)("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"})]}),(0,q.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,q.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:a.alias}),(0,q.jsx)("p",{className:"text-sm text-gray-500 truncate",children:a.status||(0,q.jsx)("span",{className:"capitalize",children:a.gender})})]}),(0,q.jsx)("button",{onClick:()=>c(a),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]},a.id))})})]})},ed=({chats:a,onSelectChat:b,onDeleteChat:c})=>(0,q.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,q.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,q.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,q.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Chat private"})})}),(0,q.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===a.length?(0,q.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,q.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,q.jsxs)("p",{className:"text-center font-medium",children:["Nessuna chat attiva.",(0,q.jsx)("br",{}),"Cerca utenti nella scheda Utenti."]})]}):(0,q.jsx)("ul",{className:"space-y-4",children:a.map(a=>{var d;return(0,q.jsxs)("li",{onClick:()=>b(a.peer.id),className:"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0",children:[(0,q.jsx)("div",{className:`w-14 h-14 rounded-full ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(a.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:(0,q.jsx)("span",{className:"font-bold text-xl uppercase",children:a.peer.alias.charAt(0)})}),(0,q.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,q.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,q.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:a.peer.alias}),(0,q.jsx)("span",{className:"text-[11px] text-gray-400 font-medium",children:(a=>{if(0===a.length)return"";let b=new Date(a[a.length-1].timestamp),c=new Date;return b.toDateString()===c.toDateString()?b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):b.toLocaleDateString([],{day:"2-digit",month:"2-digit"})})(a.messages)})]}),(0,q.jsx)("p",{className:"text-sm text-gray-500 truncate",children:0===(d=a.messages).length?"Inizia la conversazione...":d[d.length-1].text})]}),(0,q.jsxs)("div",{className:"flex items-center gap-2",children:[a.unreadCount>0&&(0,q.jsx)("div",{className:"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center",children:(0,q.jsx)("span",{className:"text-[10px] font-bold text-white",children:a.unreadCount})}),(0,q.jsx)("button",{onClick:b=>{b.stopPropagation(),c(a.peer.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},a.peer.id)})})})]}),ee=({user:a,onLogout:b,onUpdateAlias:c,onUpdateStatus:d})=>{let[e,f]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[i,j]=(0,r.useState)(a.alias),[k,l]=(0,r.useState)(a.status||""),m=()=>{i.trim()&&i!==a.alias&&c(i.trim()),f(!1)},n=()=>{k.trim()!==(a.status||"")&&d(k.trim()),h(!1)};return(0,q.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,q.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,q.jsx)("div",{className:"h-[60px] px-4 flex items-center",children:(0,q.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Profilo"})})}),(0,q.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,q.jsxs)("div",{className:"pb-32",children:[(0,q.jsxs)("div",{className:"py-8 flex flex-col items-center bg-white border-b border-gray-100",children:[(0,q.jsxs)("div",{className:"relative group",children:[(0,q.jsx)("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden",children:a.alias.charAt(0).toUpperCase()}),(0,q.jsx)("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-md flex items-center justify-center border border-gray-100",children:(0,q.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,q.jsx)("button",{className:"mt-4 text-emerald-600 font-medium text-sm hover:opacity-75",children:"Edit"})]}),(0,q.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"About"}),(0,q.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,q.jsxs)("button",{onClick:()=>h(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,q.jsx)("div",{className:"flex flex-col items-start truncate overflow-hidden",children:g?(0,q.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),onBlur:n,onKeyDown:a=>"Enter"===a.key&&n(),maxLength:50,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,q.jsx)("span",{className:"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left",children:a.status||"Available"})}),(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,q.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,q.jsxs)("button",{onClick:()=>f(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,q.jsx)("div",{className:"flex flex-col items-start",children:e?(0,q.jsx)("input",{type:"text",value:i,onChange:a=>j(a.target.value),onBlur:m,onKeyDown:a=>"Enter"===a.key&&m(),maxLength:20,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,q.jsx)("span",{className:"text-[17px] text-gray-900",children:a.alias})}),(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),(0,q.jsxs)("div",{className:"bg-white border-y border-gray-100 divide-y divide-gray-50",children:[(0,q.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,q.jsx)("span",{className:"text-[17px] text-gray-400 capitalize",children:"Gender"}),(0,q.jsx)("span",{className:"text-[17px] text-gray-900",children:a.gender})]}),(0,q.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,q.jsx)("span",{className:"text-[17px] text-gray-400",children:"User ID"}),(0,q.jsx)("span",{className:"text-xs font-mono text-gray-400 uppercase tracking-wider",children:a.id})]})]})]}),(0,q.jsx)("div",{className:"pt-4",children:(0,q.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,q.jsx)("button",{onClick:b,className:"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors",children:"Log Out"})})})]})]})})]})};function ef({tenant:a,initialMessages:b}){let[c,d]=(0,r.useState)(null),[e,f]=(0,r.useState)(null),[g,h]=(0,r.useState)("room"),[i,j]=(0,r.useState)(null),[k,l]=(0,r.useState)(!1),[m,n]=(0,r.useState)([]),[o,p]=(0,r.useState)({}),[s,t]=(0,r.useState)(!1),u=(0,aZ.useQueryClient)(),{data:v=b,isFetching:w}=function(a,b,c){let d,e=r.useContext(a_),f=r.useContext(a$),g=(0,aZ.useQueryClient)(c),h=g.defaultQueryOptions(a);g.getDefaultOptions().queries?._experimental_beforeQuery?.(h);let i=g.getQueryCache().get(h.queryHash);if(h._optimisticResults=e?"isRestoring":"optimistic",h.suspense){let a=a=>"static"===a?a:Math.max(a??1e3,1e3),b=h.staleTime;h.staleTime="function"==typeof b?(...c)=>a(b(...c)):a(b),"number"==typeof h.gcTime&&(h.gcTime=Math.max(h.gcTime,1e3))}d=i?.state.error&&"function"==typeof h.throwOnError?(0,aS.shouldThrowError)(h.throwOnError,[i.state.error,i]):h.throwOnError,(h.suspense||h.experimental_prefetchInRender||d)&&!f.isReset()&&(h.retryOnMount=!1),r.useEffect(()=>{f.clearReset()},[f]);let j=!g.getQueryCache().get(h.queryHash),[k]=r.useState(()=>new b(g,h)),l=k.getOptimisticResult(h),m=!e&&!1!==a.subscribed;if(r.useSyncExternalStore(r.useCallback(a=>{let b=m?k.subscribe(aO.notifyManager.batchCalls(a)):aS.noop;return k.updateResult(),b},[k,m]),()=>k.getCurrentResult(),()=>k.getCurrentResult()),r.useEffect(()=>{k.setOptions(h)},[h,k]),h?.suspense&&l.isPending)throw a0(h,k,f);if((({result:a,errorResetBoundary:b,throwOnError:c,query:d,suspense:e})=>a.isError&&!b.isReset()&&!a.isFetching&&d&&(e&&void 0===a.data||(0,aS.shouldThrowError)(c,[a.error,d])))({result:l,errorResetBoundary:f,throwOnError:h.throwOnError,query:i,suspense:h.suspense}))throw l.error;if(g.getDefaultOptions().queries?._experimental_afterQuery?.(h,l),h.experimental_prefetchInRender&&!aS.isServer&&l.isLoading&&l.isFetching&&!e){let a=j?a0(h,k,f):i?.promise;a?.catch(aS.noop).finally(()=>{k.updateResult()})}return h.notifyOnChangeProps?l:k.trackResult(l)}({queryKey:["messages","global",a.slug],queryFn:async()=>{let c=await a2.getMessages(!0);try{let b=await fetch(`${aM.API_BASE_URL}/api/messages?tenant=${a.slug}`);if(b.ok){let a=await b.json();for(let b of a)await a2.saveMessage(b,!0);return a}}catch(a){console.warn("Failed to fetch from server, using local data",a)}return c.length>0?c:b},initialData:b},aU,void 0);(0,r.useEffect)(()=>{},[a.slug]),(0,r.useEffect)(()=>{if(!c)return;let b=aL(aM.API_BASE_URL||void 0,{query:{tenantSlug:a.slug,userId:c.id},transports:["websocket"],reconnectionAttempts:5,timeout:1e4});return f(b),b.on("connect_error",a=>{console.error("[Socket] Connect Error:",a.message,a)}),b.on("error",a=>{console.error("[Socket] General Error:",a)}),b.on("connect",()=>{console.log("Socket connected"),t(!0),b.emit("join",{user:c,tenantSlug:a.slug})}),b.on("disconnect",()=>{t(!1)}),b.on("presenceUpdate",a=>{n(a)}),b.on("newMessage",async b=>{await a2.saveMessage(b,!0),u.invalidateQueries({queryKey:["messages","global",a.slug]})}),b.on("privateMessage",async a=>{let b=a.senderId===c.id,d=b?a.recipientId:a.senderId;await a2.saveMessage(a,!1),!b&&a1.Capacitor.isNativePlatform()&&a4.impact({style:a3.ImpactStyle.Light}).catch(()=>{}),p(c=>{let e=c[d]||{peer:{id:d,alias:b?"Unknown":a.senderAlias,gender:b?"male":a.senderGender,joinedAt:Date.now()},messages:[],unread:0};return e.messages.some(b=>b.id===a.id)?c:{...c,[d]:{...e,messages:[...e.messages,a],unread:e.unread+1}}})}),()=>{b.disconnect()}},[c,a.slug,u]),(0,r.useEffect)(()=>{"chats"===g&&i&&o[i]?.unread>0&&p(a=>({...a,[i]:{...a[i],unread:0}}))},[g,i,o]);let x=async b=>{if(!c||!e)return;let d={id:Date.now().toString(),text:b,senderId:c.id,senderAlias:c.alias,senderGender:c.gender,timestamp:new Date().toISOString()};a1.Capacitor.isNativePlatform()&&a4.impact({style:a3.ImpactStyle.Light}).catch(()=>{}),await a2.saveMessage(d,!0),u.setQueryData(["messages","global",a.slug],a=>[...a||[],d]),e.emit("sendMessage",{...d,tenantSlug:a.slug})},y=async b=>{if(!c||!e||!i)return;let d={id:Date.now().toString(),text:b,senderId:c.id,senderAlias:c.alias,senderGender:c.gender,timestamp:new Date().toISOString(),recipientId:i};a1.Capacitor.isNativePlatform()&&a4.impact({style:a3.ImpactStyle.Light}).catch(()=>{}),await a2.saveMessage(d,!1),p(a=>({...a,[i]:{...a[i],messages:[...a[i].messages,d]}})),e.emit("sendMessage",{...d,tenantSlug:a.slug,isPrivate:!0})},{swipeHandlers:z,swipeStyle:A,isDragging:B}=function({onSwipeBack:a,edgeWidth:b=30,threshold:c=100,enabled:d=!0}){let[e,f]=(0,r.useState)({isDragging:!1,translateX:0,opacity:1}),g=(0,r.useRef)(0),h=(0,r.useRef)(0),i=(0,r.useRef)(!1),j=(0,r.useRef)(!1);return{swipeHandlers:{onTouchStart:(0,r.useCallback)(a=>{if(!d)return;let c=a.touches[0];g.current=c.clientX,h.current=c.clientY,i.current=c.clientX<=b,j.current=!1,i.current&&f({isDragging:!0,translateX:0,opacity:1})},[d,b]),onTouchMove:(0,r.useCallback)(a=>{if(!d||!i.current||j.current)return;let b=a.touches[0],c=b.clientX-g.current;if(Math.abs(b.clientY-h.current)>30&&c<30){i.current=!1,f({isDragging:!1,translateX:0,opacity:1});return}if(c>0){let b=Math.min(.8*c,window.innerWidth),d=1-b/window.innerWidth*.3;f({isDragging:!0,translateX:b,opacity:d}),a.preventDefault()}},[d]),onTouchEnd:(0,r.useCallback)(()=>{if(!d||!i.current||j.current)return void f({isDragging:!1,translateX:0,opacity:1});let{translateX:b}=e;b>=c?(j.current=!0,f({isDragging:!1,translateX:window.innerWidth,opacity:0}),setTimeout(()=>{a(),f({isDragging:!1,translateX:0,opacity:1})},150)):f({isDragging:!1,translateX:0,opacity:1}),i.current=!1},[d,e,c,a])},swipeStyle:{transform:`translateX(${e.translateX}px)`,transition:e.isDragging?"none":"transform 0.2s ease-out, opacity 0.2s ease-out",opacity:e.opacity},isDragging:e.isDragging,translateX:e.translateX}}({onSwipeBack:()=>j(null),enabled:a1.Capacitor.isNativePlatform()&&null!==i});if(!c)return(0,q.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col",children:(0,q.jsx)(a5,{onLogin:a=>{d(a),localStorage.setItem("chat_user",JSON.stringify(a))},tenantName:a.name})});if(i&&"chats"===g){let a=o[i];return a?(0,q.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",style:A,...z,children:[B&&(0,q.jsx)("div",{className:"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none"}),(0,q.jsx)("header",{className:"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0",children:(0,q.jsxs)("div",{className:"h-[60px] px-4 flex items-center gap-3",children:[(0,q.jsx)("button",{onClick:()=>j(null),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,q.jsxs)("div",{className:"flex flex-col",children:[(0,q.jsx)("h2",{className:"font-bold text-lg leading-tight",children:a.peer.alias}),m.some(a=>a.id===i)&&(0,q.jsx)("span",{className:"text-xs text-emerald-500 font-medium",children:"Online"})]})]})}),(0,q.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,q.jsx)(ea,{user:c,messages:a.messages,onSendMessage:y,onlineCount:0,isOnline:!0,hideHeader:!0,showBottomNavPadding:!1,onInputFocusChange:l,isFocused:k,isSyncing:!1})})]}):(j(null),null)}let C=Object.values(o).reduce((a,b)=>a+b.unread,0);return(0,q.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",children:[(0,q.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:["room"===g&&(0,q.jsx)(ea,{user:c,messages:v,onSendMessage:x,onlineCount:m.length,isOnline:s,headerTitle:a.name,showBottomNavPadding:!0,onInputFocusChange:l,isFocused:k,isSyncing:w}),"users"===g&&(0,q.jsx)(ec,{currentUser:c,users:m,onStartChat:a=>{o[a.id]||p(b=>({...b,[a.id]:{peer:a,messages:[],unread:0}})),j(a.id),h("chats")}}),"chats"===g&&(0,q.jsx)(ed,{chats:Object.values(o).map(a=>({...a,unreadCount:a.unread})).sort((a,b)=>{let c=a.messages.length?new Date(a.messages[a.messages.length-1].timestamp).getTime():0;return(b.messages.length?new Date(b.messages[b.messages.length-1].timestamp).getTime():0)-c}),onSelectChat:j,onDeleteChat:a=>{p(b=>{let c={...b};return delete c[a],c}),i===a&&j(null)}}),"settings"===g&&(0,q.jsx)(ee,{user:c,onLogout:()=>{d(null),f(null),localStorage.removeItem("chat_user"),p({}),a2.clearMessages(),u.setQueryData(["messages","global",a.slug],b),j(null),h("room")},onUpdateAlias:b=>{if(!c||!e)return;let f={...c,alias:b};d(f),localStorage.setItem("chat_user",JSON.stringify(f)),e.emit("join",{user:f,tenantSlug:a.slug})},onUpdateStatus:b=>{if(!c||!e)return;let f={...c,status:b};d(f),localStorage.setItem("chat_user",JSON.stringify(f)),e.emit("join",{user:f,tenantSlug:a.slug})}})]}),(0,q.jsx)("div",{className:`transition-all duration-300 ease-in-out border-t border-gray-100 bg-white z-20 overflow-hidden ${k?"opacity-0 pointer-events-none h-0":"opacity-100 h-auto"}`,children:(0,q.jsx)(eb,{activeTab:g,onTabChange:a=>{h(a),j(null)},usersCount:m.length,unreadChatsCount:C})})]})}var eg=a.i(59197);function eh(){let a=(0,s.useParams)().tenantSlug,[b,c]=(0,r.useState)(null),[d,e]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0),[h,i]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{!async function(){try{let b=await (0,eg.clientGetTenantBySlug)(a);if(!b){i(!0),g(!1);return}c(b);let d=(await (0,eg.clientGetMessages)(a)).map(a=>({id:a.id,text:a.text,senderId:a.senderId||a.userId,senderAlias:a.senderAlias||a.user?.name||"Anonymous",senderGender:a.senderGender||"other",timestamp:new Date(a.timestamp||a.createdAt).toISOString()}));e(d),g(!1)}catch(a){console.error("Error loading chat data",a),i(!0),g(!1)}}()},[a]),f)?(0,q.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,q.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Caricamento chat..."})}):((h||!b)&&(0,s.notFound)(),(0,q.jsx)("main",{className:"flex h-full flex-col items-center justify-between",children:(0,q.jsx)(ef,{tenant:b,initialMessages:d})}))}a.s(["default",()=>eh],15540)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__88b6e4ed._.js.map