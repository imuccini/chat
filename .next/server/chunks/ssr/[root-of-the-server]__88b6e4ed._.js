module.exports=[22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},92509,(a,b,c)=>{b.exports=a.x("url",()=>require("url"))},33405,(a,b,c)=>{b.exports=a.x("child_process",()=>require("child_process"))},21517,(a,b,c)=>{b.exports=a.x("http",()=>require("http"))},24836,(a,b,c)=>{b.exports=a.x("https",()=>require("https"))},63047,(a,b,c)=>{var d=a.r(22734),e=a.r(92509),f=a.r(33405).spawn;function g(b){"use strict";b=b||{};var c,g,h=this,i=a.r(21517),j=a.r(24836),k={},l=!1,m={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},n=Object.assign({},m),o=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],p=["TRACE","TRACK","CONNECT"],q=!1,r=!1,s=!1,t={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null,this.open=function(a,b,c,d,e){if(this.abort(),r=!1,s=!1,!(a&&-1===p.indexOf(a)))throw Error("SecurityError: Request method not allowed");k={method:a,url:b.toString(),async:"boolean"!=typeof c||c,user:d||null,password:e||null},u(this.OPENED)},this.setDisableHeaderCheck=function(a){l=a},this.setRequestHeader=function(a,b){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!l&&(!a||-1!==o.indexOf(a.toLowerCase())))return console.warn('Refused to set unsafe header "'+a+'"'),!1;if(q)throw Error("INVALID_STATE_ERR: send flag is true");return n[a]=b,!0},this.getResponseHeader=function(a){return"string"==typeof a&&this.readyState>this.OPENED&&g.headers[a.toLowerCase()]&&!r?g.headers[a.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||r)return"";var a="";for(var b in g.headers)"set-cookie"!==b&&"set-cookie2"!==b&&(a+=b+": "+g.headers[b]+"\r\n");return a.substr(0,a.length-2)},this.getRequestHeader=function(a){return"string"==typeof a&&n[a]?n[a]:""},this.send=function(a){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(q)throw Error("INVALID_STATE_ERR: send has already been called");var l,m=!1,o=!1,p=e.parse(k.url);switch(p.protocol){case"https:":m=!0;case"http:":l=p.hostname;break;case"file:":o=!0;break;case void 0:case"":l="localhost";break;default:throw Error("Protocol not supported.")}if(o){if("GET"!==k.method)throw Error("XMLHttpRequest: Only GET method is supported");if(k.async)d.readFile(unescape(p.pathname),function(a,b){a?h.handleError(a,a.errno||-1):(h.status=200,h.responseText=b.toString("utf8"),h.response=b,u(h.DONE))});else try{this.response=d.readFileSync(unescape(p.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,u(h.DONE)}catch(a){this.handleError(a,a.errno||-1)}return}var s=p.port||(m?443:80),t=p.pathname+(p.search?p.search:"");if(n.Host=l,m&&443===s||80===s||(n.Host+=":"+p.port),k.user){void 0===k.password&&(k.password="");var v=new Buffer(k.user+":"+k.password);n.Authorization="Basic "+v.toString("base64")}"GET"===k.method||"HEAD"===k.method?a=null:a?(n["Content-Length"]=Buffer.isBuffer(a)?a.length:Buffer.byteLength(a),Object.keys(n).some(function(a){return"content-type"===a.toLowerCase()})||(n["Content-Type"]="text/plain;charset=UTF-8")):"POST"===k.method&&(n["Content-Length"]=0);var w=b.agent||!1,x={host:l,port:s,path:t,method:k.method,headers:n,agent:w};if(m&&(x.pfx=b.pfx,x.key=b.key,x.passphrase=b.passphrase,x.cert=b.cert,x.ca=b.ca,x.ciphers=b.ciphers,x.rejectUnauthorized=!1!==b.rejectUnauthorized),r=!1,k.async){var y=m?j.request:i.request;q=!0,h.dispatchEvent("readystatechange");var z=function(a){if(302===(g=a).statusCode||303===g.statusCode||307===g.statusCode){k.url=g.headers.location;var d=e.parse(k.url);l=d.hostname;var f={hostname:d.hostname,port:d.port,path:d.path,method:303===g.statusCode?"GET":k.method,headers:n};m&&(f.pfx=b.pfx,f.key=b.key,f.passphrase=b.passphrase,f.cert=b.cert,f.ca=b.ca,f.ciphers=b.ciphers,f.rejectUnauthorized=!1!==b.rejectUnauthorized),(c=y(f,z).on("error",A)).end();return}u(h.HEADERS_RECEIVED),h.status=g.statusCode,g.on("data",function(a){if(a){var b=Buffer.from(a);h.response=Buffer.concat([h.response,b])}q&&u(h.LOADING)}),g.on("end",function(){q&&(q=!1,u(h.DONE),h.responseText=h.response.toString("utf8"))}),g.on("error",function(a){h.handleError(a)})},A=function(a){if(c.reusedSocket&&"ECONNRESET"===a.code)return y(x,z).on("error",A);h.handleError(a)};c=y(x,z).on("error",A),b.autoUnref&&c.on("socket",a=>{a.unref()}),a&&c.write(a),c.end(),h.dispatchEvent("loadstart")}else{var B=".node-xmlhttprequest-content-"+process.pid,C=".node-xmlhttprequest-sync-"+process.pid;d.writeFileSync(C,"","utf8");for(var D="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(m?"s":"")+".request;var options = "+JSON.stringify(x)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+B+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+C+"');});response.on('error', function(error) {fs.writeFileSync('"+B+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});}).on('error', function(error) {fs.writeFileSync('"+B+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});"+(a?"req.write('"+JSON.stringify(a).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",E=f(process.argv[0],["-e",D]);d.existsSync(C););if(h.responseText=d.readFileSync(B,"utf8"),E.stdin.end(),d.unlinkSync(B),h.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var F=JSON.parse(h.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));h.handleError(F,503)}else{h.status=h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var G=JSON.parse(h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));g={statusCode:h.status,headers:G.data.headers},h.responseText=G.data.text,h.response=Buffer.from(G.data.data,"base64"),u(h.DONE,!0)}}},this.handleError=function(a,b){this.status=b||0,this.statusText=a,this.responseText=a.stack,r=!0,u(this.DONE)},this.abort=function(){c&&(c.abort(),c=null),n=Object.assign({},m),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),r=s=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||q)&&this.readyState!==this.DONE&&(q=!1,u(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(a,b){a in t||(t[a]=[]),t[a].push(b)},this.removeEventListener=function(a,b){a in t&&(t[a]=t[a].filter(function(a){return a!==b}))},this.dispatchEvent=function(a){if("function"==typeof h["on"+a]&&(this.readyState===this.DONE&&k.async?setTimeout(function(){h["on"+a]()},0):h["on"+a]()),a in t)for(let b=0,c=t[a].length;b<c;b++)this.readyState===this.DONE?setTimeout(function(){t[a][b].call(h)},0):t[a][b].call(h)};var u=function(a){if(h.readyState!==a&&(h.readyState!==h.UNSENT||!s)&&(h.readyState=a,(k.async||h.readyState<h.OPENED||h.readyState===h.DONE)&&h.dispatchEvent("readystatechange"),h.readyState===h.DONE)){let a;a=s?"abort":r?"error":"load",h.dispatchEvent(a),h.dispatchEvent("loadend")}}}b.exports=g,g.XMLHttpRequest=g},84425,(a,b,c)=>{function d(a,b,c,d){return Math.round(a/c)+" "+d+(b>=1.5*c?"s":"")}b.exports=function(a,b){b=b||{};var c,e,f,g,h=typeof a;if("string"===h&&a.length>0){var i=a;if(!((i=String(i)).length>100)){var j=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(j){var k=parseFloat(j[1]);switch((j[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*k;case"weeks":case"week":case"w":return 6048e5*k;case"days":case"day":case"d":return 864e5*k;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*k;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*k;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*k;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:break}}}return}if("number"===h&&isFinite(a)){return b.long?(e=Math.abs(c=a))>=864e5?d(c,e,864e5,"day"):e>=36e5?d(c,e,36e5,"hour"):e>=6e4?d(c,e,6e4,"minute"):e>=1e3?d(c,e,1e3,"second"):c+" ms":(g=Math.abs(f=a))>=864e5?Math.round(f/864e5)+"d":g>=36e5?Math.round(f/36e5)+"h":g>=6e4?Math.round(f/6e4)+"m":g>=1e3?Math.round(f/1e3)+"s":f+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},11017,(a,b,c)=>{b.exports=function(b){function c(a){let b,e,f,g=null;function h(...a){if(!h.enabled)return;let d=Number(new Date);h.diff=d-(b||d),h.prev=b,h.curr=d,b=d,a[0]=c.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let e=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(b,d)=>{if("%%"===b)return"%";e++;let f=c.formatters[d];if("function"==typeof f){let c=a[e];b=f.call(h,c),a.splice(e,1),e--}return b}),c.formatArgs.call(h,a),(h.log||c.log).apply(h,a)}return h.namespace=a,h.useColors=c.useColors(),h.color=c.selectColor(a),h.extend=d,h.destroy=c.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==g?g:(e!==c.namespaces&&(e=c.namespaces,f=c.enabled(a)),f),set:a=>{g=a}}),"function"==typeof c.init&&c.init(h),h}function d(a,b){let d=c(this.namespace+(void 0===b?":":b)+a);return d.log=this.log,d}function e(a,b){let c=0,d=0,e=-1,f=0;for(;c<a.length;)if(d<b.length&&(b[d]===a[c]||"*"===b[d]))"*"===b[d]?(e=d,f=c):c++,d++;else{if(-1===e)return!1;d=e+1,c=++f}for(;d<b.length&&"*"===b[d];)d++;return d===b.length}return c.debug=c,c.default=c,c.coerce=function(a){return a instanceof Error?a.stack||a.message:a},c.disable=function(){let a=[...c.names,...c.skips.map(a=>"-"+a)].join(",");return c.enable(""),a},c.enable=function(a){for(let b of(c.save(a),c.namespaces=a,c.names=[],c.skips=[],("string"==typeof a?a:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===b[0]?c.skips.push(b.slice(1)):c.names.push(b)},c.enabled=function(a){for(let b of c.skips)if(e(a,b))return!1;for(let b of c.names)if(e(a,b))return!0;return!1},c.humanize=a.r(84425),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(b).forEach(a=>{c[a]=b[a]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c)|0;return c.colors[Math.abs(b)%c.colors.length]},c.enable(c.load()),c}},70722,(a,b,c)=>{b.exports=a.x("tty",()=>require("tty"))},46786,(a,b,c)=>{b.exports=a.x("os",()=>require("os"))},55858,(a,b,c)=>{"use strict";b.exports=(a,b=process.argv)=>{let c=a.startsWith("-")?"":1===a.length?"-":"--",d=b.indexOf(c+a),e=b.indexOf("--");return -1!==d&&(-1===e||d<e)}},73083,(a,b,c)=>{"use strict";let d;a.r(46786);let e=a.r(70722),f=a.r(55858),{env:g}=process;function h(a){return 0!==a&&{level:a,hasBasic:!0,has256:a>=2,has16m:a>=3}}function i(a,b){if(0===d)return 0;if(f("color=16m")||f("color=full")||f("color=truecolor"))return 3;if(f("color=256"))return 2;if(a&&!b&&void 0===d)return 0;let c=d||0;if("dumb"===g.TERM)return c;if("CI"in g)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(a=>a in g)||"codeship"===g.CI_NAME?1:c;if("TEAMCITY_VERSION"in g)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(g.TEAMCITY_VERSION);if("truecolor"===g.COLORTERM)return 3;if("TERM_PROGRAM"in g){let a=parseInt((g.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(g.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(g.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(g.TERM)||"COLORTERM"in g?1:c}f("no-color")||f("no-colors")||f("color=false")||f("color=never")?d=0:(f("color")||f("colors")||f("color=true")||f("color=always"))&&(d=1),"FORCE_COLOR"in g&&(d="true"===g.FORCE_COLOR?1:"false"===g.FORCE_COLOR?0:0===g.FORCE_COLOR.length?1:Math.min(parseInt(g.FORCE_COLOR,10),3)),b.exports={supportsColor:function(a){return h(i(a,a&&a.isTTY))},stdout:h(i(!0,e.isatty(1))),stderr:h(i(!0,e.isatty(2)))}},81454,(a,b,c)=>{let d=a.r(70722),e=a.r(24361);c.init=function(a){a.inspectOpts={};let b=Object.keys(c.inspectOpts);for(let d=0;d<b.length;d++)a.inspectOpts[b[d]]=c.inspectOpts[b[d]]},c.log=function(...a){return process.stderr.write(e.formatWithOptions(c.inspectOpts,...a)+"\n")},c.formatArgs=function(a){let{namespace:d,useColors:e}=this;if(e){let c=this.color,e="\x1b[3"+(c<8?c:"8;5;"+c),f=`  ${e};1m${d} \u001B[0m`;a[0]=f+a[0].split("\n").join("\n"+f),a.push(e+"m+"+b.exports.humanize(this.diff)+"\x1b[0m")}else a[0]=(c.inspectOpts.hideDate?"":new Date().toISOString()+" ")+d+" "+a[0]},c.save=function(a){a?process.env.DEBUG=a:delete process.env.DEBUG},c.load=function(){return process.env.DEBUG},c.useColors=function(){return"colors"in c.inspectOpts?!!c.inspectOpts.colors:d.isatty(process.stderr.fd)},c.destroy=e.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),c.colors=[6,2,3,4,5,1];try{let b=a.r(73083);b&&(b.stderr||b).level>=2&&(c.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(a){}c.inspectOpts=Object.keys(process.env).filter(a=>/^debug_/i.test(a)).reduce((a,b)=>{let c=b.substring(6).toLowerCase().replace(/_([a-z])/g,(a,b)=>b.toUpperCase()),d=process.env[b];return d=!!/^(yes|on|true|enabled)$/i.test(d)||!/^(no|off|false|disabled)$/i.test(d)&&("null"===d?null:Number(d)),a[c]=d,a},{}),b.exports=a.r(11017)(c);let{formatters:f}=b.exports;f.o=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts).split("\n").map(a=>a.trim()).join(" ")},f.O=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts)}},47522,(a,b,c)=>{let d;c.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+b.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;a.splice(1,0,c,"color: inherit");let d=0,e=0;a[0].replace(/%[a-zA-Z%]/g,a=>{"%%"!==a&&(d++,"%c"===a&&(e=d))}),a.splice(e,0,c)},c.save=function(a){try{a?c.storage.setItem("debug",a):c.storage.removeItem("debug")}catch(a){}},c.load=function(){let a;try{a=c.storage.getItem("debug")||c.storage.getItem("DEBUG")}catch(a){}return!a&&"u">typeof process&&"env"in process&&(a=process.env.DEBUG),a},c.useColors=function(){let a;return!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof navigator&&navigator.userAgent&&(a=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(a[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},c.storage=function(){try{return localStorage}catch(a){}}(),d=!1,c.destroy=()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))},c.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],c.log=console.debug||console.log||(()=>{}),b.exports=a.r(11017)(c);let{formatters:e}=b.exports;e.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}},35290,(a,b,c)=>{"u"<typeof process||"renderer"===process.type||process.__nwjs?b.exports=a.r(47522):b.exports=a.r(81454)},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},4446,(a,b,c)=>{b.exports=a.x("net",()=>require("net"))},55004,(a,b,c)=>{b.exports=a.x("tls",()=>require("tls"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},6461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},65514,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="u">typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},40352,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(65514),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},29110,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},19199,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(40352),g=a.r(29110),{kStatusCode:h}=a.r(65514),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},55572,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(65514);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},75091,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(19199),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(65514),{concat:j,toArrayBuffer:k,unmask:l}=a.r(40352),{isValidStatusCode:m,isValidUTF8:n}=a.r(55572),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},10697,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(19199),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(65514),{isBlob:k,isValidStatusCode:l}=a.r(55572),{mask:m,toBuffer:n}=a.r(40352),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},4049,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(65514),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},20529,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},89877,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(19199),o=a.r(75091),p=a.r(10697),{isBlob:q}=a.r(55572),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(65514),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(4049),{format:B,parse:C}=a.r(20529),{toBuffer:D}=a.r(40352),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c))}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c))}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},29e3,(a,b,c)=>{"use strict";a.r(89877);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},71553,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},95837,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(20529),i=a.r(19199),j=a.r(71553),k=a.r(89877),{GUID:l,kWebSocket:m}=a.r(65514),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},15540,a=>{"use strict";let b,c,d,e,f,g,h,i,j;var k,l,m,n,o,p,q,r,s,t,u,v,w=a.i(87924),x=a.i(72131),y=a.i(50944),z=a.i(63047);let A=Object.create(null);A.open="0",A.close="1",A.ping="2",A.pong="3",A.message="4",A.upgrade="5",A.noop="6";let B=Object.create(null);Object.keys(A).forEach(a=>{B[A[a]]=a});let C={type:"error",data:"parser error"},D=({type:a,data:b},c,d)=>d(b instanceof ArrayBuffer||ArrayBuffer.isView(b)?c?b:"b"+E(b,!0).toString("base64"):A[a]+(b||"")),E=(a,b)=>Buffer.isBuffer(a)||a instanceof Uint8Array&&!b?a:a instanceof ArrayBuffer?Buffer.from(a):Buffer.from(a.buffer,a.byteOffset,a.byteLength),F=(a,b)=>{if("string"!=typeof a)return{type:"message",data:G(a,b)};let c=a.charAt(0);return"b"===c?{type:"message",data:G(Buffer.from(a.substring(1),"base64"),b)}:B[c]?a.length>1?{type:B[c],data:a.substring(1)}:{type:B[c]}:C},G=(a,b)=>"arraybuffer"===b?a instanceof ArrayBuffer?a:Buffer.isBuffer(a)?a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength):a.buffer:Buffer.isBuffer(a)?a:Buffer.from(a);function H(a){return a.reduce((a,b)=>a+b.length,0)}function I(a,b){if(a[0].length===b)return a.shift();let c=new Uint8Array(b),d=0;for(let e=0;e<b;e++)c[e]=a[0][d++],d===a[0].length&&(a.shift(),d=0);return a.length&&d<a[0].length&&(a[0]=a[0].slice(d)),c}function J(a){if(a){var b=a;for(var c in J.prototype)b[c]=J.prototype[c];return b}}J.prototype.on=J.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},J.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},J.prototype.off=J.prototype.removeListener=J.prototype.removeAllListeners=J.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c,d=this._callbacks["$"+a];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var e=0;e<d.length;e++)if((c=d[e])===b||c.fn===b){d.splice(e,1);break}return 0===d.length&&delete this._callbacks["$"+a],this},J.prototype.emit=function(a){this._callbacks=this._callbacks||{};for(var b=Array(arguments.length-1),c=this._callbacks["$"+a],d=1;d<arguments.length;d++)b[d-1]=arguments[d];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},J.prototype.emitReserved=J.prototype.emit,J.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},J.prototype.hasListeners=function(a){return!!this.listeners(a).length};let K=process.nextTick,L=a.g;class M{constructor(){this._cookies=new Map}parseCookies(a){a&&a.forEach(a=>{let b=function(a){let b=a.split("; "),c=b[0].indexOf("=");if(-1===c)return;let d=b[0].substring(0,c).trim();if(!d.length)return;let e=b[0].substring(c+1).trim();34===e.charCodeAt(0)&&(e=e.slice(1,-1));let f={name:d,value:e};for(let a=1;a<b.length;a++){let c=b[a].split("=");if(2!==c.length)continue;let d=c[0].trim(),e=c[1].trim();switch(d){case"Expires":f.expires=new Date(e);break;case"Max-Age":let g=new Date;g.setUTCSeconds(g.getUTCSeconds()+parseInt(e,10)),f.expires=g}}return f}(a);b&&this._cookies.set(b.name,b)})}get cookies(){let a=Date.now();return this._cookies.forEach((b,c)=>{var d;(null==(d=b.expires)?void 0:d.getTime())<a&&this._cookies.delete(c)}),this._cookies.entries()}addCookies(a){let b=[];for(let[a,c]of this.cookies)b.push(`${a}=${c.value}`);b.length&&(a.setDisableHeaderCheck(!0),a.setRequestHeader("cookie",b.join("; ")))}appendCookies(a){for(let[b,c]of this.cookies)a.append("cookie",`${b}=${c.value}`)}}function N(a,...b){return b.reduce((b,c)=>(a.hasOwnProperty(c)&&(b[c]=a[c]),b),{})}let O=L.setTimeout,P=L.clearTimeout;function Q(a,b){b.useNativeTimers?(a.setTimeoutFn=O.bind(L),a.clearTimeoutFn=P.bind(L)):(a.setTimeoutFn=L.setTimeout.bind(L),a.clearTimeoutFn=L.clearTimeout.bind(L))}function R(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var S=a.i(35290);let T=(0,S.default)("engine.io-client:transport");class U extends Error{constructor(a,b,c){super(a),this.description=b,this.context=c,this.type="TransportError"}}class V extends J{constructor(a){super(),this.writable=!1,Q(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,b,c){return super.emitReserved("error",new U(a,b,c)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(a){"open"===this.readyState?this.write(a):T("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){let b=F(a,this.socket.binaryType);this.onPacket(b)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,b={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(b)}_hostname(){let a=this.opts.hostname;return -1===a.indexOf(":")?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(a){let b=function(a){let b="";for(let c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b}(a);return b.length?"?"+b:""}}let W=(0,S.default)("engine.io-client:polling");class X extends V{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(a){this.readyState="pausing";let b=()=>{W("paused"),this.readyState="paused",a()};if(this._polling||!this.writable){let a=0;this._polling&&(W("we are currently polling - waiting to pause"),a++,this.once("pollComplete",function(){W("pre-pause polling complete"),--a||b()})),this.writable||(W("we are currently writing - waiting to pause"),a++,this.once("drain",function(){W("pre-pause writing complete"),--a||b()}))}else b()}_poll(){W("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){W("polling got data %s",a);let b=a=>{if("opening"===this.readyState&&"open"===a.type&&this.onOpen(),"close"===a.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};((a,b)=>{let c=a.split("\x1e"),d=[];for(let a=0;a<c.length;a++){let e=F(c[a],b);if(d.push(e),"error"===e.type)break}return d})(a,this.socket.binaryType).forEach(b),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this._poll():W('ignoring poll - transport state "%s"',this.readyState))}doClose(){let a=()=>{W("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(W("transport open - closing"),a()):(W("transport not open - deferring close"),this.once("open",a))}write(a){var b;let c,d,e;this.writable=!1,b=a=>{this.doWrite(a,()=>{this.writable=!0,this.emitReserved("drain")})},d=Array(c=a.length),e=0,a.forEach((a,f)=>{D(a,!1,a=>{d[f]=a,++e===c&&b(d.join("\x1e"))})})}uri(){let a=this.opts.secure?"https":"http",b=this.query||{};return!1!==this.opts.timestampRequests&&(b[this.opts.timestampParam]=R()),this.supportsBinary||b.sid||(b.b64=1),this.createUri(a,b)}}let Y=!1;try{Y="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(a){}let Z=Y,$=(0,S.default)("engine.io-client:polling");function _(){}class aa extends X{constructor(a){if(super(a),"u">typeof location){const b="https:"===location.protocol;let c=location.port;c||(c=b?"443":"80"),this.xd="u">typeof location&&a.hostname!==location.hostname||c!==a.port}}doWrite(a,b){let c=this.request({method:"POST",data:a});c.on("success",b),c.on("error",(a,b)=>{this.onError("xhr post error",a,b)})}doPoll(){$("xhr poll");let a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(a,b)=>{this.onError("xhr poll error",a,b)}),this.pollXhr=a}}class ab extends J{constructor(a,b,c){super(),this.createRequest=a,Q(this,c),this._opts=c,this._method=c.method||"GET",this._uri=b,this._data=void 0!==c.data?c.data:null,this._create()}_create(){var a;let b=N(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");b.xdomain=!!this._opts.xd;let c=this._xhr=this.createRequest(b);try{$("xhr open %s: %s",this._method,this._uri),c.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let a in c.setDisableHeaderCheck&&c.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&c.setRequestHeader(a,this._opts.extraHeaders[a])}catch(a){}if("POST"===this._method)try{c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{c.setRequestHeader("Accept","*/*")}catch(a){}null==(a=this._opts.cookieJar)||a.addCookies(c),"withCredentials"in c&&(c.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(c.timeout=this._opts.requestTimeout),c.onreadystatechange=()=>{var a;3===c.readyState&&(null==(a=this._opts.cookieJar)||a.parseCookies(c.getResponseHeader("set-cookie"))),4===c.readyState&&(200===c.status||1223===c.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof c.status?c.status:0)},0))},$("xhr data %s",this._data),c.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}"u">typeof document&&(this._index=ab.requestsCount++,ab.requests[this._index]=this)}_onError(a){this.emitReserved("error",a,this._xhr),this._cleanup(!0)}_cleanup(a){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=_,a)try{this._xhr.abort()}catch(a){}"u">typeof document&&delete ab.requests[this._index],this._xhr=null}}_onLoad(){let a=this._xhr.responseText;null!==a&&(this.emitReserved("data",a),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function ac(){for(let a in ab.requests)ab.requests.hasOwnProperty(a)&&ab.requests[a].abort()}ab.requestsCount=0,ab.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",ac):"function"==typeof addEventListener&&addEventListener("onpagehide"in L?"pagehide":"unload",ac,!1)),(d=function(a){let b=a.xdomain;try{if("u">typeof XMLHttpRequest&&(!b||Z))return new XMLHttpRequest}catch(a){}if(!b)try{return new L[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(a){}}({xdomain:!1}))&&d.responseType;let ad=z.default||z;a.i(29e3),a.i(75091),a.i(10697);var ae=a.i(89877);a.i(95837),ae.default;let af=(0,S.default)("engine.io-client:websocket"),ag="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class ah extends V{get name(){return"websocket"}doOpen(){let a=this.uri(),b=this.opts.protocols,c=ag?{}:N(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(c.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(a,b,c)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let b=0;b<a.length;b++){let c=a[b],d=b===a.length-1;D(c,this.supportsBinary,a=>{try{this.doWrite(c,a)}catch(a){af("websocket closed before onclose event")}d&&K(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let a=this.opts.secure?"wss":"ws",b=this.query||{};return this.opts.timestampRequests&&(b[this.opts.timestampParam]=R()),this.supportsBinary||(b.b64=1),this.createUri(a,b)}}L.WebSocket||L.MozWebSocket;let ai=(0,S.default)("engine.io-client:webtransport"),aj={websocket:class extends ah{createSocket(a,b,c){var d;if(null==(d=this.socket)?void 0:d._cookieJar)for(let[a,b]of(c.headers=c.headers||{},c.headers.cookie="string"==typeof c.headers.cookie?[c.headers.cookie]:c.headers.cookie||[],this.socket._cookieJar.cookies))c.headers.cookie.push(`${a}=${b.value}`);return new ae.default(a,b,c)}doWrite(a,b){let c={};a.options&&(c.compress=a.options.compress),this.opts.perMessageDeflate&&("string"==typeof b?Buffer.byteLength(b):b.length)<this.opts.perMessageDeflate.threshold&&(c.compress=!1),this.ws.send(b,c)}},webtransport:class extends V{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(a){return this.emitReserved("error",a)}this._transport.closed.then(()=>{ai("transport closed gracefully"),this.onClose()}).catch(a=>{ai("transport closed due to %s",a),this.onError("webtransport error",a)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(a=>{var d,e;let f,g,h,i,j=(d=Number.MAX_SAFE_INTEGER,e=this.socket.binaryType,c||(c=new TextDecoder),f=[],g=0,h=-1,i=!1,new TransformStream({transform(a,b){for(f.push(a);;){if(0===g){if(1>H(f))break;let a=I(f,1);i=(128&a[0])==128,g=(h=127&a[0])<126?3:126===h?1:2}else if(1===g){if(2>H(f))break;let a=I(f,2);h=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),g=3}else if(2===g){if(8>H(f))break;let a=I(f,8),c=new DataView(a.buffer,a.byteOffset,a.length),d=c.getUint32(0);if(d>2097151){b.enqueue(C);break}h=0x100000000*d+c.getUint32(4),g=3}else{if(H(f)<h)break;let a=I(f,h);b.enqueue(F(i?a:c.decode(a),e)),g=0}if(0===h||h>d){b.enqueue(C);break}}}})),k=a.readable.pipeThrough(j).getReader(),l=new TransformStream({transform(a,c){!function(a,c){if(a.data instanceof ArrayBuffer||ArrayBuffer.isView(a.data))return c(E(a.data,!1));D(a,!0,a=>{b||(b=new TextEncoder),c(b.encode(a))})}(a,b=>{let d,e=b.length;if(e<126)new DataView((d=new Uint8Array(1)).buffer).setUint8(0,e);else if(e<65536){let a=new DataView((d=new Uint8Array(3)).buffer);a.setUint8(0,126),a.setUint16(1,e)}else{let a=new DataView((d=new Uint8Array(9)).buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(e))}a.data&&"string"!=typeof a.data&&(d[0]|=128),c.enqueue(d),c.enqueue(b)})}});l.readable.pipeTo(a.writable),this._writer=l.writable.getWriter();let m=()=>{k.read().then(({done:a,value:b})=>{a?ai("session is closed"):(ai("received chunk: %o",b),this.onPacket(b),m())}).catch(a=>{ai("an error occurred while reading: %s",a)})};m();let n={type:"open"};this.query.sid&&(n.data=`{"sid":"${this.query.sid}"}`),this._writer.write(n).then(()=>this.onOpen())})})}write(a){this.writable=!1;for(let b=0;b<a.length;b++){let c=a[b],d=b===a.length-1;this._writer.write(c).then(()=>{d&&K(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var a;null==(a=this._transport)||a.close()}},polling:class extends aa{request(a={}){var b;return Object.assign(a,{xd:this.xd,cookieJar:null==(b=this.socket)?void 0:b._cookieJar},this.opts),new ab(a=>new ad(a),this.uri(),a)}}},ak=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,al=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function am(a){var b,c;let d,e;if(a.length>8e3)throw"URI too long";let f=a,g=a.indexOf("["),h=a.indexOf("]");-1!=g&&-1!=h&&(a=a.substring(0,g)+a.substring(g,h).replace(/:/g,";")+a.substring(h,a.length));let i=ak.exec(a||""),j={},k=14;for(;k--;)j[al[k]]=i[k]||"";return -1!=g&&-1!=h&&(j.source=f,j.host=j.host.substring(1,j.host.length-1).replace(/;/g,":"),j.authority=j.authority.replace("[","").replace("]","").replace(/;/g,":"),j.ipv6uri=!0),d=(b=j.path).replace(/\/{2,9}/g,"/").split("/"),("/"==b.slice(0,1)||0===b.length)&&d.splice(0,1),"/"==b.slice(-1)&&d.splice(d.length-1,1),j.pathNames=d,c=j.query,e={},c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,b,c){b&&(e[b]=c)}),j.queryKey=e,j}let an=(0,S.default)("engine.io-client:socket"),ao="function"==typeof addEventListener&&"function"==typeof removeEventListener,ap=[];ao&&addEventListener("offline",()=>{an("closing %d connection(s) because the network was lost",ap.length),ap.forEach(a=>a())},!1);class aq extends J{constructor(a,b){if(super(),this.binaryType="nodebuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,a&&"object"==typeof a&&(b=a,a=null),a){const c=am(a);b.hostname=c.host,b.secure="https"===c.protocol||"wss"===c.protocol,b.port=c.port,c.query&&(b.query=c.query)}else b.host&&(b.hostname=am(b.host).host);Q(this,b),this.secure=null!=b.secure?b.secure:"u">typeof location&&"https:"===location.protocol,b.hostname&&!b.port&&(b.port=this.secure?"443":"80"),this.hostname=b.hostname||("u">typeof location?location.hostname:"localhost"),this.port=b.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},b.transports.forEach(a=>{let b=a.prototype.name;this.transports.push(b),this._transportsByName[b]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},b),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(a){let b={},c=a.split("&");for(let a=0,d=c.length;a<d;a++){let d=c[a].split("=");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return b}(this.opts.query)),ao&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(an("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ap.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=new M),this._open()}createTransport(a){an('creating transport "%s"',a);let b=Object.assign({},this.opts.query);b.EIO=4,b.transport=a,this.id&&(b.sid=this.id);let c=Object.assign({},this.opts,{query:b,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[a]);return an("options: %j",c),new this._transportsByName[a](c)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);let a=this.opts.rememberUpgrade&&aq.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let b=this.createTransport(a);b.open(),this.setTransport(b)}setTransport(a){an("setting transport %s",a.name),this.transport&&(an("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",a=>this._onClose("transport close",a))}onOpen(){an("socket open"),this.readyState="open",aq.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(an('socket receive: type "%s", data "%s"',a.type,a.data),this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let b=Error("server error");b.code=a.data,this._onError(b);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data)}else an('packet received with socket readyState "%s"',this.readyState)}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this._pingInterval=a.pingInterval,this._pingTimeout=a.pingTimeout,this._maxPayload=a.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let a=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+a,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},a),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let a=this._getWritablePackets();an("flushing %d packets in socket",a.length),this.transport.send(a),this._prevBufferLen=a.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let a=1;for(let b=0;b<this.writeBuffer.length;b++){let c=this.writeBuffer[b].data;if(c&&(a+="string"==typeof c?function(a){let b=0,c=0;for(let d=0,e=a.length;d<e;d++)(b=a.charCodeAt(d))<128?c+=1:b<2048?c+=2:b<55296||b>=57344?c+=3:(d++,c+=4);return c}(c):Math.ceil(1.33*(c.byteLength||c.size))),b>0&&a>this._maxPayload)return an("only send %d out of %d packets",b,this.writeBuffer.length),this.writeBuffer.slice(0,b);a+=2}return an("payload size is %d (max: %d)",a,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let a=Date.now()>this._pingTimeoutTime;return a&&(an("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,K(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),a}write(a,b,c){return this._sendPacket("message",a,b,c),this}send(a,b,c){return this._sendPacket("message",a,b,c),this}_sendPacket(a,b,c,d){if("function"==typeof b&&(d=b,b=void 0),"function"==typeof c&&(d=c,c=null),"closing"===this.readyState||"closed"===this.readyState)return;(c=c||{}).compress=!1!==c.compress;let e={type:a,data:b,options:c};this.emitReserved("packetCreate",e),this.writeBuffer.push(e),d&&this.once("flush",d),this.flush()}close(){let a=()=>{this._onClose("forced close"),an("socket closing - telling transport to close"),this.transport.close()},b=()=>{this.off("upgrade",b),this.off("upgradeError",b),a()},c=()=>{this.once("upgrade",b),this.once("upgradeError",b)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?c():a()}):this.upgrading?c():a()),this}_onError(a){if(an("socket error %j",a),aq.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return an("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",a),this._onClose("transport error",a)}_onClose(a,b){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(an('socket close with reason: "%s"',a),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ao&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let a=ap.indexOf(this._offlineEventListener);-1!==a&&(an("removing listener for the 'offline' event"),ap.splice(a,1))}this.readyState="closed",this.id=null,this.emitReserved("close",a,b),this.writeBuffer=[],this._prevBufferLen=0}}}aq.protocol=4;class ar extends aq{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade){an("starting upgrade probes");for(let a=0;a<this._upgrades.length;a++)this._probe(this._upgrades[a])}}_probe(a){an('probing transport "%s"',a);let b=this.createTransport(a),c=!1;aq.priorWebsocketSuccess=!1;let d=()=>{c||(an('probe transport "%s" opened',a),b.send([{type:"ping",data:"probe"}]),b.once("packet",d=>{if(!c)if("pong"===d.type&&"probe"===d.data){if(an('probe transport "%s" pong',a),this.upgrading=!0,this.emitReserved("upgrading",b),!b)return;aq.priorWebsocketSuccess="websocket"===b.name,an('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{c||"closed"!==this.readyState&&(an("changing transport and sending upgrade packet"),j(),this.setTransport(b),b.send([{type:"upgrade"}]),this.emitReserved("upgrade",b),b=null,this.upgrading=!1,this.flush())})}else{an('probe transport "%s" failed',a);let c=Error("probe error");c.transport=b.name,this.emitReserved("upgradeError",c)}}))};function e(){c||(c=!0,j(),b.close(),b=null)}let f=c=>{let d=Error("probe error: "+c);d.transport=b.name,e(),an('probe transport "%s" failed because of error: %s',a,c),this.emitReserved("upgradeError",d)};function g(){f("transport closed")}function h(){f("socket closed")}function i(a){b&&a.name!==b.name&&(an('"%s" works - aborting "%s"',a.name,b.name),e())}let j=()=>{b.removeListener("open",d),b.removeListener("error",f),b.removeListener("close",g),this.off("close",h),this.off("upgrading",i)};b.once("open",d),b.once("error",f),b.once("close",g),this.once("close",h),this.once("upgrading",i),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==a?this.setTimeoutFn(()=>{c||b.open()},200):b.open()}onHandshake(a){this._upgrades=this._filterUpgrades(a.upgrades),super.onHandshake(a)}_filterUpgrades(a){let b=[];for(let c=0;c<a.length;c++)~this.transports.indexOf(a[c])&&b.push(a[c]);return b}}class as extends ar{constructor(a,b={}){const c="object"==typeof a?a:b;(!c.transports||c.transports&&"string"==typeof c.transports[0])&&(c.transports=(c.transports||["polling","websocket","webtransport"]).map(a=>aj[a]).filter(a=>!!a)),super(a,c)}}as.protocol;let at=(0,S.default)("socket.io-client:url"),au="function"==typeof ArrayBuffer,av=Object.prototype.toString,aw="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===av.call(Blob),ax="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===av.call(File);function ay(a){return au&&(a instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a.buffer instanceof ArrayBuffer))||aw&&a instanceof Blob||ax&&a instanceof File}let az=(0,S.default)("socket.io-parser"),aA=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];(k=q||(q={}))[k.CONNECT=0]="CONNECT",k[k.DISCONNECT=1]="DISCONNECT",k[k.EVENT=2]="EVENT",k[k.ACK=3]="ACK",k[k.CONNECT_ERROR=4]="CONNECT_ERROR",k[k.BINARY_EVENT=5]="BINARY_EVENT",k[k.BINARY_ACK=6]="BINARY_ACK";class aB{constructor(a){this.replacer=a}encode(a){return(az("encoding packet %j",a),(a.type===q.EVENT||a.type===q.ACK)&&function a(b,c){if(!b||"object"!=typeof b)return!1;if(Array.isArray(b)){for(let c=0,d=b.length;c<d;c++)if(a(b[c]))return!0;return!1}if(ay(b))return!0;if(b.toJSON&&"function"==typeof b.toJSON&&1==arguments.length)return a(b.toJSON(),!0);for(let c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&a(b[c]))return!0;return!1}(a))?this.encodeAsBinary({type:a.type===q.EVENT?q.BINARY_EVENT:q.BINARY_ACK,nsp:a.nsp,data:a.data,id:a.id}):[this.encodeAsString(a)]}encodeAsString(a){let b=""+a.type;return(a.type===q.BINARY_EVENT||a.type===q.BINARY_ACK)&&(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data,this.replacer)),az("encoded %j as %s",a,b),b}encodeAsBinary(a){let b,c,d=(b=[],c=a.data,a.data=function a(b,c){if(!b)return b;if(ay(b)){let a={_placeholder:!0,num:c.length};return c.push(b),a}if(Array.isArray(b)){let d=Array(b.length);for(let e=0;e<b.length;e++)d[e]=a(b[e],c);return d}if("object"==typeof b&&!(b instanceof Date)){let d={};for(let e in b)Object.prototype.hasOwnProperty.call(b,e)&&(d[e]=a(b[e],c));return d}return b}(c,b),a.attachments=b.length,{packet:a,buffers:b}),e=this.encodeAsString(d.packet),f=d.buffers;return f.unshift(e),f}}class aC extends J{constructor(a){super(),this.reviver=a}add(a){let b;if("string"==typeof a){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let c=(b=this.decodeString(a)).type===q.BINARY_EVENT;c||b.type===q.BINARY_ACK?(b.type=c?q.EVENT:q.ACK,this.reconstructor=new aD(b),0===b.attachments&&super.emitReserved("decoded",b)):super.emitReserved("decoded",b)}else if(ay(a)||a.base64)if(this.reconstructor)(b=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,super.emitReserved("decoded",b));else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a)}decodeString(a){let b=0,c={type:Number(a.charAt(0))};if(void 0===q[c.type])throw Error("unknown packet type "+c.type);if(c.type===q.BINARY_EVENT||c.type===q.BINARY_ACK){let d=b+1;for(;"-"!==a.charAt(++b)&&b!=a.length;);let e=a.substring(d,b);if(e!=Number(e)||"-"!==a.charAt(b))throw Error("Illegal attachments");c.attachments=Number(e)}if("/"===a.charAt(b+1)){let d=b+1;for(;++b&&","!==a.charAt(b)&&b!==a.length;);c.nsp=a.substring(d,b)}else c.nsp="/";let d=a.charAt(b+1);if(""!==d&&Number(d)==d){let d=b+1;for(;++b;){let c=a.charAt(b);if(null==c||Number(c)!=c){--b;break}if(b===a.length)break}c.id=Number(a.substring(d,b+1))}if(a.charAt(++b)){let d=this.tryParse(a.substr(b));if(aC.isPayloadValid(c.type,d))c.data=d;else throw Error("invalid payload")}return az("decoded %s as %j",a,c),c}tryParse(a){try{return JSON.parse(a,this.reviver)}catch(a){return!1}}static isPayloadValid(a,b){switch(a){case q.CONNECT:return aF(b);case q.DISCONNECT:return void 0===b;case q.CONNECT_ERROR:return"string"==typeof b||aF(b);case q.EVENT:case q.BINARY_EVENT:return Array.isArray(b)&&("number"==typeof b[0]||"string"==typeof b[0]&&-1===aA.indexOf(b[0]));case q.ACK:case q.BINARY_ACK:return Array.isArray(b)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class aD{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){var b,c;let a=(b=this.reconPack,c=this.buffers,b.data=function a(b,c){if(!b)return b;if(b&&!0===b._placeholder){if("number"==typeof b.num&&b.num>=0&&b.num<c.length)return c[b.num];throw Error("illegal attachments")}if(Array.isArray(b))for(let d=0;d<b.length;d++)b[d]=a(b[d],c);else if("object"==typeof b)for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(b[d]=a(b[d],c));return b}(b.data,c),delete b.attachments,b);return this.finishedReconstruction(),a}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}let aE=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a};function aF(a){return"[object Object]"===Object.prototype.toString.call(a)}function aG(a){var b;return"string"==typeof a.nsp&&(void 0===(b=a.id)||aE(b))&&function(a,b){switch(a){case q.CONNECT:return void 0===b||aF(b);case q.DISCONNECT:return void 0===b;case q.EVENT:return Array.isArray(b)&&("number"==typeof b[0]||"string"==typeof b[0]&&-1===aA.indexOf(b[0]));case q.ACK:return Array.isArray(b);case q.CONNECT_ERROR:return"string"==typeof b||aF(b);default:return!1}}(a.type,a.data)}function aH(a,b,c){return a.on(b,c),function(){a.off(b,c)}}a.s(["Decoder",()=>aC,"Encoder",()=>aB,"PacketType",()=>q,"isPacketValid",()=>aG,"protocol",0,5],32882);let aI=(0,S.default)("socket.io-client:socket"),aJ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class aK extends J{constructor(a,b,c){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=b,c&&c.auth&&(this.auth=c.auth),this._opts=Object.assign({},c),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let a=this.io;this.subs=[aH(a,"open",this.onopen.bind(this)),aH(a,"packet",this.onpacket.bind(this)),aH(a,"error",this.onerror.bind(this)),aH(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...b){var c,d,e;if(aJ.hasOwnProperty(a))throw Error('"'+a.toString()+'" is a reserved event name');if(b.unshift(a),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(b),this;let f={type:q.EVENT,data:b};if(f.options={},f.options.compress=!1!==this.flags.compress,"function"==typeof b[b.length-1]){let a=this.ids++;aI("emitting packet with ack id %d",a);let c=b.pop();this._registerAckCallback(a,c),f.id=a}let g=null==(d=null==(c=this.io.engine)?void 0:c.transport)?void 0:d.writable,h=this.connected&&!(null==(e=this.io.engine)?void 0:e._hasPingExpired());return this.flags.volatile&&!g?aI("discard packet as the transport is not currently writable"):h?(this.notifyOutgoingListeners(f),this.packet(f)):this.sendBuffer.push(f),this.flags={},this}_registerAckCallback(a,b){var c;let d=null!=(c=this.flags.timeout)?c:this._opts.ackTimeout;if(void 0===d){this.acks[a]=b;return}let e=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let b=0;b<this.sendBuffer.length;b++)this.sendBuffer[b].id===a&&(aI("removing packet with ack id %d from the buffer",a),this.sendBuffer.splice(b,1));aI("event with ack id %d has timed out after %d ms",a,d),b.call(this,Error("operation has timed out"))},d),f=(...a)=>{this.io.clearTimeoutFn(e),b.apply(this,a)};f.withError=!0,this.acks[a]=f}emitWithAck(a,...b){return new Promise((c,d)=>{let e=(a,b)=>a?d(a):c(b);e.withError=!0,b.push(e),this.emit(a,...b)})}_addToQueue(a){let b;"function"==typeof a[a.length-1]&&(b=a.pop());let c={id:this._queueSeq++,tryCount:0,pending:!1,args:a,flags:Object.assign({fromQueue:!0},this.flags)};a.push((a,...d)=>c!==this._queue[0]?aI("packet [%d] already acknowledged",c.id):(null!==a?c.tryCount>this._opts.retries&&(aI("packet [%d] is discarded after %d tries",c.id,c.tryCount),this._queue.shift(),b&&b(a)):(aI("packet [%d] was successfully sent",c.id),this._queue.shift(),b&&b(null,...d)),c.pending=!1,this._drainQueue())),this._queue.push(c),this._drainQueue()}_drainQueue(a=!1){if(aI("draining queue"),!this.connected||0===this._queue.length)return;let b=this._queue[0];b.pending&&!a?aI("packet [%d] has already been sent and is waiting for an ack",b.id):(b.pending=!0,b.tryCount++,aI("sending packet [%d] (try n%d)",b.id,b.tryCount),this.flags=b.flags,this.emit.apply(this,b.args))}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){aI("transport is open - connecting"),"function"==typeof this.auth?this.auth(a=>{this._sendConnectPacket(a)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(a){this.packet({type:q.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},a):a})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,b){aI("close (%s)",a),this.connected=!1,delete this.id,this.emitReserved("disconnect",a,b),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(a=>{if(!this.sendBuffer.some(b=>String(b.id)===a)){let b=this.acks[a];delete this.acks[a],b.withError&&b.call(this,Error("socket has been disconnected"))}})}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case q.CONNECT:a.data&&a.data.sid?this.onconnect(a.data.sid,a.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case q.EVENT:case q.BINARY_EVENT:this.onevent(a);break;case q.ACK:case q.BINARY_ACK:this.onack(a);break;case q.DISCONNECT:this.ondisconnect();break;case q.CONNECT_ERROR:this.destroy();let b=Error(a.data.message);b.data=a.data.data,this.emitReserved("connect_error",b)}}onevent(a){let b=a.data||[];aI("emitting event %j",b),null!=a.id&&(aI("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?this.emitEvent(b):this.receiveBuffer.push(Object.freeze(b))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length)for(let b of this._anyListeners.slice())b.apply(this,a);super.emit.apply(this,a),this._pid&&a.length&&"string"==typeof a[a.length-1]&&(this._lastOffset=a[a.length-1])}ack(a){let b=this,c=!1;return function(...d){c||(c=!0,aI("sending ack %j",d),b.packet({type:q.ACK,id:a,data:d}))}}onack(a){let b=this.acks[a.id];"function"!=typeof b?aI("bad ack %s",a.id):(delete this.acks[a.id],aI("calling ack %s with %j",a.id,a.data),b.withError&&a.data.unshift(null),b.apply(this,a.data))}onconnect(a,b){aI("socket connected with id %s",a),this.id=a,this.recovered=b&&this._pid===b,this._pid=b,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){aI("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(aI("performing disconnect (%s)",this.nsp),this.packet({type:q.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){let b=this._anyListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){let b=this._anyOutgoingListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let b of this._anyOutgoingListeners.slice())b.apply(this,a.data)}}var aL=a.i(32882);function aM(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}aM.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=(1&Math.floor(10*b))==0?a-c:a+c}return 0|Math.min(a,this.max)},aM.prototype.reset=function(){this.attempts=0},aM.prototype.setMin=function(a){this.ms=a},aM.prototype.setMax=function(a){this.max=a},aM.prototype.setJitter=function(a){this.jitter=a};let aN=(0,S.default)("socket.io-client:manager");class aO extends J{constructor(a,b){var c;super(),this.nsps={},this.subs=[],a&&"object"==typeof a&&(b=a,a=void 0),(b=b||{}).path=b.path||"/socket.io",this.opts=b,Q(this,b),this.reconnection(!1!==b.reconnection),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(c=b.randomizationFactor)?c:.5),this.backoff=new aM({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this._readyState="closed",this.uri=a;const d=b.parser||aL;this.encoder=new d.Encoder,this.decoder=new d.Decoder,this._autoConnect=!1!==b.autoConnect,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,a||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(a){return void 0===a?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var b;return void 0===a?this._reconnectionDelay:(this._reconnectionDelay=a,null==(b=this.backoff)||b.setMin(a),this)}randomizationFactor(a){var b;return void 0===a?this._randomizationFactor:(this._randomizationFactor=a,null==(b=this.backoff)||b.setJitter(a),this)}reconnectionDelayMax(a){var b;return void 0===a?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,null==(b=this.backoff)||b.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(a){if(aN("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;aN("opening %s",this.uri),this.engine=new as(this.uri,this.opts);let b=this.engine,c=this;this._readyState="opening",this.skipReconnect=!1;let d=aH(b,"open",function(){c.onopen(),a&&a()}),e=b=>{aN("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",b),a?a(b):this.maybeReconnectOnOpen()},f=aH(b,"error",e);if(!1!==this._timeout){let a=this._timeout;aN("connect attempt will timeout after %d",a);let c=this.setTimeoutFn(()=>{aN("connect attempt timed out after %d",a),d(),e(Error("timeout")),b.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(d),this.subs.push(f),this}connect(a){return this.open(a)}onopen(){aN("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let a=this.engine;this.subs.push(aH(a,"ping",this.onping.bind(this)),aH(a,"data",this.ondata.bind(this)),aH(a,"error",this.onerror.bind(this)),aH(a,"close",this.onclose.bind(this)),aH(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(a){this.onclose("parse error",a)}}ondecoded(a){K(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){aN("error",a),this.emitReserved("error",a)}socket(a,b){let c=this.nsps[a];return c?this._autoConnect&&!c.active&&c.connect():(c=new aK(this,a,b),this.nsps[a]=c),c}_destroy(a){for(let a of Object.keys(this.nsps))if(this.nsps[a].active)return void aN("socket %s is still active, skipping close",a);this._close()}_packet(a){aN("writing packet %j",a);let b=this.encoder.encode(a);for(let c=0;c<b.length;c++)this.engine.write(b[c],a.options)}cleanup(){aN("cleanup"),this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){aN("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(a,b){var c;aN("closed due to %s",a),this.cleanup(),null==(c=this.engine)||c.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,b),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let a=this;if(this.backoff.attempts>=this._reconnectionAttempts)aN("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let b=this.backoff.duration();aN("will wait %dms before reconnect attempt",b),this._reconnecting=!0;let c=this.setTimeoutFn(()=>{a.skipReconnect||(aN("attempting reconnect"),this.emitReserved("reconnect_attempt",a.backoff.attempts),a.skipReconnect||a.open(b=>{b?(aN("reconnect attempt error"),a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",b)):(aN("reconnect success"),a.onreconnect())}))},b);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}}onreconnect(){let a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}let aP=(0,S.default)("socket.io-client"),aQ={};function aR(a,b){let c;"object"==typeof a&&(b=a,a=void 0);let d=function(a,b="",c){let d=a;c=c||"u">typeof location&&location,null==a&&(a=c.protocol+"//"+c.host),"string"==typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?c.protocol+a:c.host+a),/^(https?|wss?):\/\//.test(a)||(at("protocol-less url %s",a),a=void 0!==c?c.protocol+"//"+a:"https://"+a),at("parse %s",a),d=am(a)),!d.port&&(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";let e=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+e+":"+d.port+b,d.href=d.protocol+"://"+e+(c&&c.port===d.port?"":":"+d.port),d}(a,(b=b||{}).path||"/socket.io"),e=d.source,f=d.id,g=d.path,h=aQ[f]&&g in aQ[f].nsps;return b.forceNew||b["force new connection"]||!1===b.multiplex||h?(aP("ignoring socket cache for %s",e),c=new aO(e,b)):(aQ[f]||(aP("new io instance for %s",e),aQ[f]=new aO(e,b)),c=aQ[f]),d.query&&!b.query&&(b.query=d.queryKey),c.socket(d.path,b)}Object.assign(aR,{Manager:aO,Socket:aK,io:aR,connect:aR});var aS=a.i(87702),aT=a.i(99745),aU=a.i(18544),aV=a.i(76644),aW=a.i(33791),aX=a.i(79715),aY=a.i(42871),aZ=a.i(8361),a$=class extends aW.Subscribable{constructor(a,b){super(),this.options=b,this.#a=a,this.#b=null,this.#c=(0,aX.pendingThenable)(),this.bindMethods(),this.setOptions(b)}#a;#d=void 0;#e=void 0;#f=void 0;#g;#h;#c;#b;#i;#j;#k;#l;#m;#n;#o=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#d.addObserver(this),a_(this.#d,this.options)?this.#p():this.updateResult(),this.#q())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return a0(this.#d,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return a0(this.#d,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#r(),this.#s(),this.#d.removeObserver(this)}setOptions(a){let b=this.options,c=this.#d;if(this.options=this.#a.defaultQueryOptions(a),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,aY.resolveEnabled)(this.options.enabled,this.#d))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#t(),this.#d.setOptions(this.options),b._defaulted&&!(0,aY.shallowEqualObjects)(this.options,b)&&this.#a.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#d,observer:this});let d=this.hasListeners();d&&a1(this.#d,c,this.options,b)&&this.#p(),this.updateResult(),d&&(this.#d!==c||(0,aY.resolveEnabled)(this.options.enabled,this.#d)!==(0,aY.resolveEnabled)(b.enabled,this.#d)||(0,aY.resolveStaleTime)(this.options.staleTime,this.#d)!==(0,aY.resolveStaleTime)(b.staleTime,this.#d))&&this.#u();let e=this.#v();d&&(this.#d!==c||(0,aY.resolveEnabled)(this.options.enabled,this.#d)!==(0,aY.resolveEnabled)(b.enabled,this.#d)||e!==this.#n)&&this.#w(e)}getOptimisticResult(a){var b,c;let d=this.#a.getQueryCache().build(this.#a,a),e=this.createResult(d,a);return b=this,c=e,(0,aY.shallowEqualObjects)(b.getCurrentResult(),c)||(this.#f=e,this.#h=this.options,this.#g=this.#d.state),e}getCurrentResult(){return this.#f}trackResult(a,b){return new Proxy(a,{get:(a,c)=>(this.trackProp(c),b?.(c),"promise"===c&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#c.status||this.#c.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,c))})}trackProp(a){this.#o.add(a)}getCurrentQuery(){return this.#d}refetch({...a}={}){return this.fetch({...a})}fetchOptimistic(a){let b=this.#a.defaultQueryOptions(a),c=this.#a.getQueryCache().build(this.#a,b);return c.fetch().then(()=>this.createResult(c,b))}fetch(a){return this.#p({...a,cancelRefetch:a.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#f))}#p(a){this.#t();let b=this.#d.fetch(this.options,a);return a?.throwOnError||(b=b.catch(aY.noop)),b}#u(){this.#r();let a=(0,aY.resolveStaleTime)(this.options.staleTime,this.#d);if(aY.isServer||this.#f.isStale||!(0,aY.isValidTimeout)(a))return;let b=(0,aY.timeUntilStale)(this.#f.dataUpdatedAt,a);this.#l=aZ.timeoutManager.setTimeout(()=>{this.#f.isStale||this.updateResult()},b+1)}#v(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#d):this.options.refetchInterval)??!1}#w(a){this.#s(),this.#n=a,!aY.isServer&&!1!==(0,aY.resolveEnabled)(this.options.enabled,this.#d)&&(0,aY.isValidTimeout)(this.#n)&&0!==this.#n&&(this.#m=aZ.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||aT.focusManager.isFocused())&&this.#p()},this.#n))}#q(){this.#u(),this.#w(this.#v())}#r(){this.#l&&(aZ.timeoutManager.clearTimeout(this.#l),this.#l=void 0)}#s(){this.#m&&(aZ.timeoutManager.clearInterval(this.#m),this.#m=void 0)}createResult(a,b){let c,d=this.#d,e=this.options,f=this.#f,g=this.#g,h=this.#h,i=a!==d?a.state:this.#e,{state:j}=a,k={...j},l=!1;if(b._optimisticResults){let c=this.hasListeners(),f=!c&&a_(a,b),g=c&&a1(a,d,b,e);(f||g)&&(k={...k,...(0,aV.fetchState)(j.data,a.options)}),"isRestoring"===b._optimisticResults&&(k.fetchStatus="idle")}let{error:m,errorUpdatedAt:n,status:o}=k;c=k.data;let p=!1;if(void 0!==b.placeholderData&&void 0===c&&"pending"===o){let a;f?.isPlaceholderData&&b.placeholderData===h?.placeholderData?(a=f.data,p=!0):a="function"==typeof b.placeholderData?b.placeholderData(this.#k?.state.data,this.#k):b.placeholderData,void 0!==a&&(o="success",c=(0,aY.replaceData)(f?.data,a,b),l=!0)}if(b.select&&void 0!==c&&!p)if(f&&c===g?.data&&b.select===this.#i)c=this.#j;else try{this.#i=b.select,c=b.select(c),c=(0,aY.replaceData)(f?.data,c,b),this.#j=c,this.#b=null}catch(a){this.#b=a}this.#b&&(m=this.#b,c=this.#j,n=Date.now(),o="error");let q="fetching"===k.fetchStatus,r="pending"===o,s="error"===o,t=r&&q,u=void 0!==c,v={status:o,fetchStatus:k.fetchStatus,isPending:r,isSuccess:"success"===o,isError:s,isInitialLoading:t,isLoading:t,data:c,dataUpdatedAt:k.dataUpdatedAt,error:m,errorUpdatedAt:n,failureCount:k.fetchFailureCount,failureReason:k.fetchFailureReason,errorUpdateCount:k.errorUpdateCount,isFetched:k.dataUpdateCount>0||k.errorUpdateCount>0,isFetchedAfterMount:k.dataUpdateCount>i.dataUpdateCount||k.errorUpdateCount>i.errorUpdateCount,isFetching:q,isRefetching:q&&!r,isLoadingError:s&&!u,isPaused:"paused"===k.fetchStatus,isPlaceholderData:l,isRefetchError:s&&u,isStale:a2(a,b),refetch:this.refetch,promise:this.#c,isEnabled:!1!==(0,aY.resolveEnabled)(b.enabled,a)};if(this.options.experimental_prefetchInRender){let b=void 0!==v.data,c="error"===v.status&&!b,e=a=>{c?a.reject(v.error):b&&a.resolve(v.data)},f=()=>{e(this.#c=v.promise=(0,aX.pendingThenable)())},g=this.#c;switch(g.status){case"pending":a.queryHash===d.queryHash&&e(g);break;case"fulfilled":(c||v.data!==g.value)&&f();break;case"rejected":c&&v.error===g.reason||f()}}return v}updateResult(){let a=this.#f,b=this.createResult(this.#d,this.options);if(this.#g=this.#d.state,this.#h=this.options,void 0!==this.#g.data&&(this.#k=this.#d),(0,aY.shallowEqualObjects)(b,a))return;this.#f=b;let c=()=>{if(!a)return!0;let{notifyOnChangeProps:b}=this.options,c="function"==typeof b?b():b;if("all"===c||!c&&!this.#o.size)return!0;let d=new Set(c??this.#o);return this.options.throwOnError&&d.add("error"),Object.keys(this.#f).some(b=>this.#f[b]!==a[b]&&d.has(b))};this.#x({listeners:c()})}#t(){let a=this.#a.getQueryCache().build(this.#a,this.options);if(a===this.#d)return;let b=this.#d;this.#d=a,this.#e=a.state,this.hasListeners()&&(b?.removeObserver(this),a.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#q()}#x(a){aU.notifyManager.batch(()=>{a.listeners&&this.listeners.forEach(a=>{a(this.#f)}),this.#a.getQueryCache().notify({query:this.#d,type:"observerResultsUpdated"})})}};function a_(a,b){return!1!==(0,aY.resolveEnabled)(b.enabled,a)&&void 0===a.state.data&&("error"!==a.state.status||!1!==b.retryOnMount)||void 0!==a.state.data&&a0(a,b,b.refetchOnMount)}function a0(a,b,c){if(!1!==(0,aY.resolveEnabled)(b.enabled,a)&&"static"!==(0,aY.resolveStaleTime)(b.staleTime,a)){let d="function"==typeof c?c(a):c;return"always"===d||!1!==d&&a2(a,b)}return!1}function a1(a,b,c,d){return(a!==b||!1===(0,aY.resolveEnabled)(d.enabled,a))&&(!c.suspense||"error"!==a.state.status)&&a2(a,c)}function a2(a,b){return!1!==(0,aY.resolveEnabled)(b.enabled,a)&&a.isStaleByTime((0,aY.resolveStaleTime)(b.staleTime,a))}var a3=a.i(11508),a4=x.createContext((e=!1,{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e})),a5=x.createContext(!1);a5.Provider;var a6=(a,b,c)=>b.fetchOptimistic(a).catch(()=>{c.clearReset()}),a7=a.i(53774);(0,a7.registerPlugin)("CapacitorSQLite",{web:()=>a.A(82652).then(a=>new a.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite});let a8=new class{sqlite=null;db=null;dbName="chat_cache";async initialize(){console.log("SQLite: Disabled for debugging.")}async saveMessage(a,b=!0){if(this.db||await this.initialize(),!this.db)return;let c=`
            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, isGlobal)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?);
        `,d=[a.id,a.text,a.senderId,a.senderAlias,a.senderGender,a.timestamp,a.recipientId||null,+!!b];try{await this.db.run(c,d)}catch(a){console.error("Error saving message to SQLite:",a)}}async getMessages(a=!0,b){if(this.db||await this.initialize(),!this.db)return[];let c="",d=[];a?c="SELECT * FROM messages WHERE isGlobal = 1 ORDER BY timestamp ASC LIMIT 100;":(c="SELECT * FROM messages WHERE isGlobal = 0 AND (recipientId = ? OR senderId = ?) ORDER BY timestamp ASC LIMIT 100;",d=[b,b]);try{return((await this.db.query(c,d)).values||[]).map(a=>({...a,isGlobal:void 0}))}catch(a){return console.error("Error fetching messages from SQLite:",a),[]}}async clearMessages(){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages;",[])}catch(a){console.error("Error clearing messages from SQLite:",a)}}async getPrivateChats(a){if(this.db||await this.initialize(),!this.db)return[];try{let b=((await this.db.query("SELECT * FROM messages WHERE isGlobal = 0 ORDER BY timestamp ASC;",[])).values||[]).map(a=>({id:a.id,text:a.text,senderId:a.senderId,senderAlias:a.senderAlias,senderGender:a.senderGender,timestamp:a.timestamp,recipientId:a.recipientId})),c=new Map;for(let d of b){let b=d.senderId===a?d.recipientId:d.senderId;c.has(b)||c.set(b,[]),c.get(b).push(d)}return Array.from(c.entries()).map(([a,b])=>({peerId:a,messages:b}))}catch(a){return console.error("Error loading private chats from SQLite:",a),[]}}};(l=r||(r={})).Dark="DARK",l.Light="LIGHT",l.Default="DEFAULT",(m=s||(s={})).Body="body",m.Ionic="ionic",m.Native="native",m.None="none",(0,a7.registerPlugin)("Keyboard");var a9=a.i(95421);let ba=(0,a7.registerPlugin)("Haptics",{web:()=>a.A(84104).then(a=>new a.HapticsWeb)});(n=t||(t={})).Dark="DARK",n.Light="LIGHT",n.Default="DEFAULT",(o=u||(u={})).None="NONE",o.Slide="SLIDE",o.Fade="FADE",(0,a7.registerPlugin)("StatusBar");let bb=Object.create(null),bc=a=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(a?bb:globalThis),bd=new Proxy(bb,{get:(a,b)=>bc()[b]??bb[b],has:(a,b)=>b in bc()||b in bb,set:(a,b,c)=>(bc(!0)[b]=c,!0),deleteProperty(a,b){if(!b)return!1;let c=bc(!0);return delete c[b],!0},ownKeys:()=>Object.keys(bc(!0))});function be(a,b){return"u">typeof process&&process.env?process.env[a]??b:"u">typeof Deno?Deno.env.get(a)??b:"u">typeof Bun?Bun.env[a]??b:b}"u">typeof process&&process.env,Object.freeze({get BETTER_AUTH_SECRET(){return be("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return be("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return be("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return be("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return be("NODE_ENV","development")},get PACKAGE_VERSION(){return be("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return be("BETTER_AUTH_TELEMETRY_ENDPOINT","")}});let bf={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},bg=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),bh=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],bi="\x1b[0m",bj="\x1b[31m",bk="\x1b[32m",bl="\x1b[33m",bm="\x1b[34m",bn="\x1b[35m",bo=["debug","info","success","warn","error"],bp={info:bm,success:bk,warn:bl,error:bj,debug:bn};function bq(a,b,c){function d(c,d){if(c._zod||Object.defineProperty(c,"_zod",{value:{def:d,constr:g,traits:new Set},enumerable:!1}),c._zod.traits.has(a))return;c._zod.traits.add(a),b(c,d);let e=g.prototype,f=Object.keys(e);for(let a=0;a<f.length;a++){let b=f[a];b in c||(c[b]=e[b].bind(c))}}let e=c?.Parent??Object;class f extends e{}function g(a){var b;let e=c?.Parent?new f:this;for(let c of(d(e,a),(b=e._zod).deferred??(b.deferred=[]),e._zod.deferred))c();return e}return Object.defineProperty(f,"name",{value:a}),Object.defineProperty(g,"init",{value:d}),Object.defineProperty(g,Symbol.hasInstance,{value:b=>!!c?.Parent&&b instanceof c.Parent||b?._zod?.traits?.has(a)}),Object.defineProperty(g,"name",{value:a}),g}f=p?.disabled!==!0,g=p?.level??"warn",h=p?.disableColors!==void 0?!p.disableColors:1!==function(){if(void 0!==be("FORCE_COLOR"))switch(be("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==be("NODE_DISABLE_COLORS")&&""!==be("NODE_DISABLE_COLORS")||void 0!==be("NO_COLOR")&&""!==be("NO_COLOR")||"dumb"===be("TERM"))return 1;if(be("TMUX"))return 24;if("TF_BUILD"in bd&&"AGENT_NAME"in bd)return 4;if("CI"in bd){for(let{0:a,1:b}of bg)if(a in bd)return b;return"codeship"===be("CI_NAME")?8:1}if("TEAMCITY_VERSION"in bd)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(be("TEAMCITY_VERSION"))?4:1;switch(be("TERM_PROGRAM")){case"iTerm.app":if(!be("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(be("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===be("COLORTERM")||"24bit"===be("COLORTERM"))return 24;if(be("TERM")){if(null!==/truecolor/.exec(be("TERM")))return 24;if(null!==/^xterm-256/.exec(be("TERM")))return 8;let a=be("TERM").toLowerCase();if(bf[a])return bf[a];if(bh.some(b=>null!==b.exec(a)))return 4}return be("COLORTERM")?4:1}(),Object.fromEntries(bo.map(a=>[a,(...[b,...c])=>((a,b,c=[])=>{let d;if(!f||!(bo.indexOf(a)>=bo.indexOf(g)))return;let e=(d=new Date().toISOString(),h?`\x1b[2m${d}${bi} ${bp[a]}${a.toUpperCase()}${bi} \x1b[1m[Better Auth]:${bi} ${b}`:`${d} ${a.toUpperCase()} [Better Auth]: ${b}`);p&&"function"==typeof p.log?p.log("success"===a?"info":a,b,...c):"error"===a?console.error(e,...c):"warn"===a?console.warn(e,...c):console.log(e,...c)})(a,b,c)])),Object.freeze({status:"aborted"}),Symbol("zod_brand");class br extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class bs extends Error{constructor(a){super(`Encountered unidirectional transform during encode: ${a}`),this.name="ZodEncodeError"}}let bt={};function bu(a){return a&&Object.assign(bt,a),bt}function bv(a){return a}function bw(a){return a}function bx(a){}function by(a){throw Error("Unexpected value in exhaustive check")}function bz(a){}function bA(a){let b=Object.values(a).filter(a=>"number"==typeof a);return Object.entries(a).filter(([a,c])=>-1===b.indexOf(+a)).map(([a,b])=>b)}function bB(a,b="|"){return a.map(a=>b2(a)).join(b)}function bC(a,b){return"bigint"==typeof b?b.toString():b}function bD(a){return{get value(){{let b=a();return Object.defineProperty(this,"value",{value:b}),b}}}}function bE(a){return null==a}function bF(a){let b=+!!a.startsWith("^"),c=a.endsWith("$")?a.length-1:a.length;return a.slice(b,c)}function bG(a,b){let c=(a.toString().split(".")[1]||"").length,d=b.toString(),e=(d.split(".")[1]||"").length;if(0===e&&/\d?e-\d?/.test(d)){let a=d.match(/\d?e-(\d?)/);a?.[1]&&(e=Number.parseInt(a[1]))}let f=c>e?c:e;return Number.parseInt(a.toFixed(f).replace(".",""))%Number.parseInt(b.toFixed(f).replace(".",""))/10**f}let bH=Symbol("evaluating");function bI(a,b,c){let d;Object.defineProperty(a,b,{get(){if(d!==bH)return void 0===d&&(d=bH,d=c()),d},set(c){Object.defineProperty(a,b,{value:c})},configurable:!0})}function bJ(a){return Object.create(Object.getPrototypeOf(a),Object.getOwnPropertyDescriptors(a))}function bK(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})}function bL(...a){let b={};for(let c of a)Object.assign(b,Object.getOwnPropertyDescriptors(c));return Object.defineProperties({},b)}function bM(a){return bL(a._zod.def)}function bN(a,b){return b?b.reduce((a,b)=>a?.[b],a):a}function bO(a){let b=Object.keys(a);return Promise.all(b.map(b=>a[b])).then(a=>{let c={};for(let d=0;d<b.length;d++)c[b[d]]=a[d];return c})}function bP(a=10){let b="abcdefghijklmnopqrstuvwxyz",c="";for(let d=0;d<a;d++)c+=b[Math.floor(Math.random()*b.length)];return c}function bQ(a){return JSON.stringify(a)}function bR(a){return a.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let bS="captureStackTrace"in Error?Error.captureStackTrace:(...a)=>{};function bT(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}let bU=bD(()=>{if("u">typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(a){return!1}});function bV(a){if(!1===bT(a))return!1;let b=a.constructor;if(void 0===b||"function"!=typeof b)return!0;let c=b.prototype;return!1!==bT(c)&&!1!==Object.prototype.hasOwnProperty.call(c,"isPrototypeOf")}function bW(a){return bV(a)?{...a}:Array.isArray(a)?[...a]:a}function bX(a){let b=0;for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}let bY=new Set(["string","number","symbol"]),bZ=new Set(["string","number","bigint","boolean","symbol","undefined"]);function b$(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b_(a,b,c){let d=new a._zod.constr(b??a._zod.def);return(!b||c?.parent)&&(d._zod.parent=a),d}function b0(a){if(!a)return{};if("string"==typeof a)return{error:()=>a};if(a?.message!==void 0){if(a?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");a.error=a.message}return(delete a.message,"string"==typeof a.error)?{...a,error:()=>a.error}:a}function b1(a){let b;return new Proxy({},{get:(c,d,e)=>(b??(b=a()),Reflect.get(b,d,e)),set:(c,d,e,f)=>(b??(b=a()),Reflect.set(b,d,e,f)),has:(c,d)=>(b??(b=a()),Reflect.has(b,d)),deleteProperty:(c,d)=>(b??(b=a()),Reflect.deleteProperty(b,d)),ownKeys:c=>(b??(b=a()),Reflect.ownKeys(b)),getOwnPropertyDescriptor:(c,d)=>(b??(b=a()),Reflect.getOwnPropertyDescriptor(b,d)),defineProperty:(c,d,e)=>(b??(b=a()),Reflect.defineProperty(b,d,e))})}function b2(a){return"bigint"==typeof a?a.toString()+"n":"string"==typeof a?`"${a}"`:`${a}`}function b3(a){return Object.keys(a).filter(b=>"optional"===a[b]._zod.optin&&"optional"===a[b]._zod.optout)}let b4={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},b5={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function b6(a,b){let c=a._zod.def,d=c.checks;if(d&&d.length>0)throw Error(".pick() cannot be used on object schemas containing refinements");let e=bL(a._zod.def,{get shape(){let a={};for(let d in b){if(!(d in c.shape))throw Error(`Unrecognized key: "${d}"`);b[d]&&(a[d]=c.shape[d])}return bK(this,"shape",a),a},checks:[]});return b_(a,e)}function b7(a,b){let c=a._zod.def,d=c.checks;if(d&&d.length>0)throw Error(".omit() cannot be used on object schemas containing refinements");let e=bL(a._zod.def,{get shape(){let d={...a._zod.def.shape};for(let a in b){if(!(a in c.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&delete d[a]}return bK(this,"shape",d),d},checks:[]});return b_(a,e)}function b8(a,b){if(!bV(b))throw Error("Invalid input to extend: expected a plain object");let c=a._zod.def.checks;if(c&&c.length>0){let c=a._zod.def.shape;for(let a in b)if(void 0!==Object.getOwnPropertyDescriptor(c,a))throw Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}let d=bL(a._zod.def,{get shape(){let c={...a._zod.def.shape,...b};return bK(this,"shape",c),c}});return b_(a,d)}function b9(a,b){if(!bV(b))throw Error("Invalid input to safeExtend: expected a plain object");let c=bL(a._zod.def,{get shape(){let c={...a._zod.def.shape,...b};return bK(this,"shape",c),c}});return b_(a,c)}function ca(a,b){let c=bL(a._zod.def,{get shape(){let c={...a._zod.def.shape,...b._zod.def.shape};return bK(this,"shape",c),c},get catchall(){return b._zod.def.catchall},checks:[]});return b_(a,c)}function cb(a,b,c){let d=b._zod.def.checks;if(d&&d.length>0)throw Error(".partial() cannot be used on object schemas containing refinements");let e=bL(b._zod.def,{get shape(){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in d))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=a?new a({type:"optional",innerType:d[b]}):d[b])}else for(let b in d)e[b]=a?new a({type:"optional",innerType:d[b]}):d[b];return bK(this,"shape",e),e},checks:[]});return b_(b,e)}function cc(a,b,c){let d=bL(b._zod.def,{get shape(){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in e))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=new a({type:"nonoptional",innerType:d[b]}))}else for(let b in d)e[b]=new a({type:"nonoptional",innerType:d[b]});return bK(this,"shape",e),e}});return b_(b,d)}function cd(a,b=0){if(!0===a.aborted)return!0;for(let c=b;c<a.issues.length;c++)if(a.issues[c]?.continue!==!0)return!0;return!1}function ce(a,b){return b.map(b=>(b.path??(b.path=[]),b.path.unshift(a),b))}function cf(a){return"string"==typeof a?a:a?.message}function cg(a,b,c){let d={...a,path:a.path??[]};return a.message||(d.message=cf(a.inst?._zod.def?.error?.(a))??cf(b?.error?.(a))??cf(c.customError?.(a))??cf(c.localeError?.(a))??"Invalid input"),delete d.inst,delete d.continue,b?.reportInput||delete d.input,d}function ch(a){return a instanceof Set?"set":a instanceof Map?"map":a instanceof File?"file":"unknown"}function ci(a){return Array.isArray(a)?"array":"string"==typeof a?"string":"unknown"}function cj(a){let b=typeof a;switch(b){case"number":return Number.isNaN(a)?"nan":"number";case"object":if(null===a)return"null";if(Array.isArray(a))return"array";if(a&&Object.getPrototypeOf(a)!==Object.prototype&&"constructor"in a&&a.constructor)return a.constructor.name}return b}function ck(...a){let[b,c,d]=a;return"string"==typeof b?{message:b,code:"custom",input:c,inst:d}:{...b}}function cl(a){return Object.entries(a).filter(([a,b])=>Number.isNaN(Number.parseInt(a,10))).map(a=>a[1])}function cm(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c}function cn(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return btoa(b)}function co(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c="=".repeat((4-b.length%4)%4);return cm(b+c)}function cp(a){return cn(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function cq(a){let b=a.replace(/^0x/,"");if(b.length%2!=0)throw Error("Invalid hex string length");let c=new Uint8Array(b.length/2);for(let a=0;a<b.length;a+=2)c[a/2]=Number.parseInt(b.slice(a,a+2),16);return c}function cr(a){return Array.from(a).map(a=>a.toString(16).padStart(2,"0")).join("")}class cs{constructor(...a){}}a.s(["BIGINT_FORMAT_RANGES",0,b5,"Class",()=>cs,"NUMBER_FORMAT_RANGES",0,b4,"aborted",()=>cd,"allowsEval",0,bU,"assert",()=>bz,"assertEqual",()=>bv,"assertIs",()=>bx,"assertNever",()=>by,"assertNotEqual",()=>bw,"assignProp",()=>bK,"base64ToUint8Array",()=>cm,"base64urlToUint8Array",()=>co,"cached",()=>bD,"captureStackTrace",0,bS,"cleanEnum",()=>cl,"cleanRegex",()=>bF,"clone",()=>b_,"cloneDef",()=>bM,"createTransparentProxy",()=>b1,"defineLazy",()=>bI,"esc",()=>bQ,"escapeRegex",()=>b$,"extend",()=>b8,"finalizeIssue",()=>cg,"floatSafeRemainder",()=>bG,"getElementAtPath",()=>bN,"getEnumValues",()=>bA,"getLengthableOrigin",()=>ci,"getParsedType",0,a=>{let b=typeof a;switch(b){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(a)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(a))return"array";if(null===a)return"null";if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return"promise";if("u">typeof Map&&a instanceof Map)return"map";if("u">typeof Set&&a instanceof Set)return"set";if("u">typeof Date&&a instanceof Date)return"date";if("u">typeof File&&a instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${b}`)}},"getSizableOrigin",()=>ch,"hexToUint8Array",()=>cq,"isObject",()=>bT,"isPlainObject",()=>bV,"issue",()=>ck,"joinValues",()=>bB,"jsonStringifyReplacer",()=>bC,"merge",()=>ca,"mergeDefs",()=>bL,"normalizeParams",()=>b0,"nullish",()=>bE,"numKeys",()=>bX,"objectClone",()=>bJ,"omit",()=>b7,"optionalKeys",()=>b3,"parsedType",()=>cj,"partial",()=>cb,"pick",()=>b6,"prefixIssues",()=>ce,"primitiveTypes",0,bZ,"promiseAllObject",()=>bO,"propertyKeyTypes",0,bY,"randomString",()=>bP,"required",()=>cc,"safeExtend",()=>b9,"shallowClone",()=>bW,"slugify",()=>bR,"stringifyPrimitive",()=>b2,"uint8ArrayToBase64",()=>cn,"uint8ArrayToBase64url",()=>cp,"uint8ArrayToHex",()=>cr,"unwrapMessage",()=>cf],66446);let ct=(a,b)=>{a.name="$ZodError",Object.defineProperty(a,"_zod",{value:a._zod,enumerable:!1}),Object.defineProperty(a,"issues",{value:b,enumerable:!1}),a.message=JSON.stringify(b,bC,2),Object.defineProperty(a,"toString",{value:()=>a.message,enumerable:!1})},cu=bq("$ZodError",ct),cv=bq("$ZodError",ct,{Parent:Error}),cw=a=>(b,c,d,e)=>{let f=d?Object.assign(d,{async:!1}):{async:!1},g=b._zod.run({value:c,issues:[]},f);if(g instanceof Promise)throw new br;if(g.issues.length){let b=new(e?.Err??a)(g.issues.map(a=>cg(a,f,bu())));throw bS(b,e?.callee),b}return g.value},cx=cw(cv),cy=a=>async(b,c,d,e)=>{let f=d?Object.assign(d,{async:!0}):{async:!0},g=b._zod.run({value:c,issues:[]},f);if(g instanceof Promise&&(g=await g),g.issues.length){let b=new(e?.Err??a)(g.issues.map(a=>cg(a,f,bu())));throw bS(b,e?.callee),b}return g.value},cz=cy(cv),cA=a=>(b,c,d)=>{let e=d?{...d,async:!1}:{async:!1},f=b._zod.run({value:c,issues:[]},e);if(f instanceof Promise)throw new br;return f.issues.length?{success:!1,error:new(a??cu)(f.issues.map(a=>cg(a,e,bu())))}:{success:!0,data:f.value}},cB=cA(cv),cC=a=>async(b,c,d)=>{let e=d?Object.assign(d,{async:!0}):{async:!0},f=b._zod.run({value:c,issues:[]},e);return f instanceof Promise&&(f=await f),f.issues.length?{success:!1,error:new a(f.issues.map(a=>cg(a,e,bu())))}:{success:!0,data:f.value}},cD=cC(cv),cE=/^[cC][^\s-]{8,}$/,cF=/^[0-9a-z]+$/,cG=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,cH=/^[0-9a-vA-V]{20}$/,cI=/^[A-Za-z0-9]{27}$/,cJ=/^[a-zA-Z0-9_-]{21}$/,cK=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,cL=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,cM=a=>a?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${a}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,cN=cM(4),cO=cM(6),cP=cM(7),cQ=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,cR=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function cS(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let cT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cU=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,cV=a=>{let b=b$(a??":");return RegExp(`^(?:[0-9A-F]{2}${b}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${b}){5}[0-9a-f]{2}$`)},cW=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,cX=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cY=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,cZ=/^[A-Za-z0-9_-]*$/,c$=/^\+[1-9]\d{6,14}$/,c_="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",c0=RegExp(`^${c_}$`);function c1(a){let b="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof a.precision?-1===a.precision?`${b}`:0===a.precision?`${b}:[0-5]\\d`:`${b}:[0-5]\\d\\.\\d{${a.precision}}`:`${b}(?::[0-5]\\d(?:\\.\\d+)?)?`}function c2(a){return RegExp(`^${c1(a)}$`)}function c3(a){let b=c1({precision:a.precision}),c=["Z"];a.local&&c.push(""),a.offset&&c.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let d=`${b}(?:${c.join("|")})`;return RegExp(`^${c_}T(?:${d})$`)}let c4=a=>{let b=a?`[\\s\\S]{${a?.minimum??0},${a?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${b}$`)},c5=/^-?\d+n?$/,c6=/^-?\d+$/,c7=/^-?\d+(?:\.\d+)?$/,c8=/^(?:true|false)$/i,c9=/^null$/i,da=/^undefined$/i,db=/^[^A-Z]*$/,dc=/^[^a-z]*$/;function dd(a,b){return RegExp(`^[A-Za-z0-9+/]{${a}}${b}$`)}function de(a){return RegExp(`^[A-Za-z0-9_-]{${a}}$`)}let df=dd(22,"=="),dg=de(22),dh=dd(27,"="),di=de(27),dj=dd(43,"="),dk=de(43),dl=dd(64,""),dm=de(64),dn=dd(86,"=="),dp=de(86);a.s(["base64",0,cY,"base64url",0,cZ,"bigint",0,c5,"boolean",0,c8,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,cW,"cidrv6",0,cX,"cuid",0,cE,"cuid2",0,cF,"date",0,c0,"datetime",()=>c3,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,cK,"e164",0,c$,"email",0,cQ,"emoji",()=>cS,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,cL,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,cR,"integer",0,c6,"ipv4",0,cT,"ipv6",0,cU,"ksuid",0,cI,"lowercase",0,db,"mac",0,cV,"md5_base64",0,df,"md5_base64url",0,dg,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,cJ,"null",()=>c9,"number",0,c7,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,dh,"sha1_base64url",0,di,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,dj,"sha256_base64url",0,dk,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,dl,"sha384_base64url",0,dm,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,dn,"sha512_base64url",0,dp,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,c4,"time",()=>c2,"ulid",0,cG,"undefined",()=>da,"unicodeEmail",0,cR,"uppercase",0,dc,"uuid",0,cM,"uuid4",0,cN,"uuid6",0,cO,"uuid7",0,cP,"xid",0,cH],45976);let dq=bq("$ZodCheck",(a,b)=>{var c;a._zod??(a._zod={}),a._zod.def=b,(c=a._zod).onattach??(c.onattach=[])}),dr={number:"number",bigint:"bigint",object:"date"},ds=bq("$ZodCheckLessThan",(a,b)=>{dq.init(a,b);let c=dr[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.maximum:c.exclusiveMaximum)??1/0;b.value<d&&(b.inclusive?c.maximum=b.value:c.exclusiveMaximum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value<=b.value:d.value<b.value)||d.issues.push({origin:c,code:"too_big",maximum:"object"==typeof b.value?b.value.getTime():b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),dt=bq("$ZodCheckGreaterThan",(a,b)=>{dq.init(a,b);let c=dr[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.minimum:c.exclusiveMinimum)??-1/0;b.value>d&&(b.inclusive?c.minimum=b.value:c.exclusiveMinimum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value>=b.value:d.value>b.value)||d.issues.push({origin:c,code:"too_small",minimum:"object"==typeof b.value?b.value.getTime():b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),du=bq("$ZodCheckMultipleOf",(a,b)=>{dq.init(a,b),a._zod.onattach.push(a=>{var c;(c=a._zod.bag).multipleOf??(c.multipleOf=b.value)}),a._zod.check=c=>{if(typeof c.value!=typeof b.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof c.value?c.value%b.value===BigInt(0):0===bG(c.value,b.value))||c.issues.push({origin:typeof c.value,code:"not_multiple_of",divisor:b.value,input:c.value,inst:a,continue:!b.abort})}}),dv=bq("$ZodCheckNumberFormat",(a,b)=>{dq.init(a,b),b.format=b.format||"float64";let c=b.format?.includes("int"),d=c?"int":"number",[e,f]=b4[b.format];a._zod.onattach.push(a=>{let d=a._zod.bag;d.format=b.format,d.minimum=e,d.maximum=f,c&&(d.pattern=c6)}),a._zod.check=g=>{let h=g.value;if(c){if(!Number.isInteger(h))return void g.issues.push({expected:d,format:b.format,code:"invalid_type",continue:!1,input:h,inst:a});if(!Number.isSafeInteger(h))return void(h>0?g.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,inclusive:!0,continue:!b.abort}):g.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,inclusive:!0,continue:!b.abort}))}h<e&&g.issues.push({origin:"number",input:h,code:"too_small",minimum:e,inclusive:!0,inst:a,continue:!b.abort}),h>f&&g.issues.push({origin:"number",input:h,code:"too_big",maximum:f,inclusive:!0,inst:a,continue:!b.abort})}}),dw=bq("$ZodCheckBigIntFormat",(a,b)=>{dq.init(a,b);let[c,d]=b5[b.format];a._zod.onattach.push(a=>{let e=a._zod.bag;e.format=b.format,e.minimum=c,e.maximum=d}),a._zod.check=e=>{let f=e.value;f<c&&e.issues.push({origin:"bigint",input:f,code:"too_small",minimum:c,inclusive:!0,inst:a,continue:!b.abort}),f>d&&e.issues.push({origin:"bigint",input:f,code:"too_big",maximum:d,inclusive:!0,inst:a,continue:!b.abort})}}),dx=bq("$ZodCheckMaxSize",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.size}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;d.size<=b.maximum||c.issues.push({origin:ch(d),code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dy=bq("$ZodCheckMinSize",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.size}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;d.size>=b.minimum||c.issues.push({origin:ch(d),code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dz=bq("$ZodCheckSizeEquals",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.size}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.size,c.maximum=b.size,c.size=b.size}),a._zod.check=c=>{let d=c.value,e=d.size;if(e===b.size)return;let f=e>b.size;c.issues.push({origin:ch(d),...f?{code:"too_big",maximum:b.size}:{code:"too_small",minimum:b.size},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),dA=bq("$ZodCheckMaxLength",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;if(d.length<=b.maximum)return;let e=ci(d);c.issues.push({origin:e,code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dB=bq("$ZodCheckMinLength",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;if(d.length>=b.minimum)return;let e=ci(d);c.issues.push({origin:e,code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dC=bq("$ZodCheckLengthEquals",(a,b)=>{var c;dq.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!bE(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.length,c.maximum=b.length,c.length=b.length}),a._zod.check=c=>{let d=c.value,e=d.length;if(e===b.length)return;let f=ci(d),g=e>b.length;c.issues.push({origin:f,...g?{code:"too_big",maximum:b.length}:{code:"too_small",minimum:b.length},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),dD=bq("$ZodCheckStringFormat",(a,b)=>{var c,d;dq.init(a,b),a._zod.onattach.push(a=>{let c=a._zod.bag;c.format=b.format,b.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(b.pattern))}),b.pattern?(c=a._zod).check??(c.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:b.format,input:c.value,...b.pattern?{pattern:b.pattern.toString()}:{},inst:a,continue:!b.abort})}):(d=a._zod).check??(d.check=()=>{})}),dE=bq("$ZodCheckRegex",(a,b)=>{dD.init(a,b),a._zod.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:"regex",input:c.value,pattern:b.pattern.toString(),inst:a,continue:!b.abort})}}),dF=bq("$ZodCheckLowerCase",(a,b)=>{b.pattern??(b.pattern=db),dD.init(a,b)}),dG=bq("$ZodCheckUpperCase",(a,b)=>{b.pattern??(b.pattern=dc),dD.init(a,b)}),dH=bq("$ZodCheckIncludes",(a,b)=>{dq.init(a,b);let c=b$(b.includes),d=new RegExp("number"==typeof b.position?`^.{${b.position}}${c}`:c);b.pattern=d,a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(d)}),a._zod.check=c=>{c.value.includes(b.includes,b.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:b.includes,input:c.value,inst:a,continue:!b.abort})}}),dI=bq("$ZodCheckStartsWith",(a,b)=>{dq.init(a,b);let c=RegExp(`^${b$(b.prefix)}.*`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.startsWith(b.prefix)||c.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:b.prefix,input:c.value,inst:a,continue:!b.abort})}}),dJ=bq("$ZodCheckEndsWith",(a,b)=>{dq.init(a,b);let c=RegExp(`.*${b$(b.suffix)}$`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.endsWith(b.suffix)||c.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:b.suffix,input:c.value,inst:a,continue:!b.abort})}});(a,b)=>{dq.init(a,b);let c=new Set(b.mime);a._zod.onattach.push(a=>{a._zod.bag.mime=b.mime}),a._zod.check=d=>{c.has(d.value.type)||d.issues.push({code:"invalid_value",values:b.mime,input:d.value.type,inst:a,continue:!b.abort})}};let dK=bq("$ZodCheckOverwrite",(a,b)=>{dq.init(a,b),a._zod.check=a=>{a.value=b.tx(a.value)}});class dL{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if("function"==typeof a){a(this,{execution:"sync"}),a(this,{execution:"async"});return}let b=a.split("\n").filter(a=>a),c=Math.min(...b.map(a=>a.length-a.trimStart().length));for(let a of b.map(a=>a.slice(c)).map(a=>" ".repeat(2*this.indent)+a))this.content.push(a)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(a=>`  ${a}`)].join("\n"))}}let dM={major:4,minor:3,patch:6},dN=bq("$ZodType",(a,b)=>{var c;a??(a={}),a._zod.def=b,a._zod.bag=a._zod.bag||{},a._zod.version=dM;let d=[...a._zod.def.checks??[]];for(let b of(a._zod.traits.has("$ZodCheck")&&d.unshift(a),d))for(let c of b._zod.onattach)c(a);if(0===d.length)(c=a._zod).deferred??(c.deferred=[]),a._zod.deferred?.push(()=>{a._zod.run=a._zod.parse});else{let b=(a,b,c)=>{let d,e=cd(a);for(let f of b){if(f._zod.def.when){if(!f._zod.def.when(a))continue}else if(e)continue;let b=a.issues.length,g=f._zod.check(a);if(g instanceof Promise&&c?.async===!1)throw new br;if(d||g instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await g,a.issues.length!==b&&(e||(e=cd(a,b)))});else{if(a.issues.length===b)continue;e||(e=cd(a,b))}}return d?d.then(()=>a):a},c=(c,e,f)=>{if(cd(c))return c.aborted=!0,c;let g=b(e,d,f);if(g instanceof Promise){if(!1===f.async)throw new br;return g.then(b=>a._zod.parse(b,f))}return a._zod.parse(g,f)};a._zod.run=(e,f)=>{if(f.skipChecks)return a._zod.parse(e,f);if("backward"===f.direction){let b=a._zod.parse({value:e.value,issues:[]},{...f,skipChecks:!0});return b instanceof Promise?b.then(a=>c(a,e,f)):c(b,e,f)}let g=a._zod.parse(e,f);if(g instanceof Promise){if(!1===f.async)throw new br;return g.then(a=>b(a,d,f))}return b(g,d,f)}}bI(a,"~standard",()=>({validate:b=>{try{let c=cB(a,b);return c.success?{value:c.data}:{issues:c.error?.issues}}catch(c){return cD(a,b).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}))}),dO=bq("$ZodString",(a,b)=>{dN.init(a,b),a._zod.pattern=[...a?._zod.bag?.patterns??[]].pop()??c4(a._zod.bag),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=String(c.value)}catch(a){}return"string"==typeof c.value||c.issues.push({expected:"string",code:"invalid_type",input:c.value,inst:a}),c}}),dP=bq("$ZodStringFormat",(a,b)=>{dD.init(a,b),dO.init(a,b)}),dQ=bq("$ZodGUID",(a,b)=>{b.pattern??(b.pattern=cL),dP.init(a,b)}),dR=bq("$ZodUUID",(a,b)=>{if(b.version){let a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[b.version];if(void 0===a)throw Error(`Invalid UUID version: "${b.version}"`);b.pattern??(b.pattern=cM(a))}else b.pattern??(b.pattern=cM());dP.init(a,b)}),dS=bq("$ZodEmail",(a,b)=>{b.pattern??(b.pattern=cQ),dP.init(a,b)}),dT=bq("$ZodURL",(a,b)=>{dP.init(a,b),a._zod.check=c=>{try{let d=c.value.trim(),e=new URL(d);b.hostname&&(b.hostname.lastIndex=0,b.hostname.test(e.hostname)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:b.hostname.source,input:c.value,inst:a,continue:!b.abort})),b.protocol&&(b.protocol.lastIndex=0,b.protocol.test(e.protocol.endsWith(":")?e.protocol.slice(0,-1):e.protocol)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:b.protocol.source,input:c.value,inst:a,continue:!b.abort})),b.normalize?c.value=e.href:c.value=d;return}catch(d){c.issues.push({code:"invalid_format",format:"url",input:c.value,inst:a,continue:!b.abort})}}}),dU=bq("$ZodEmoji",(a,b)=>{b.pattern??(b.pattern=cS()),dP.init(a,b)}),dV=bq("$ZodNanoID",(a,b)=>{b.pattern??(b.pattern=cJ),dP.init(a,b)}),dW=bq("$ZodCUID",(a,b)=>{b.pattern??(b.pattern=cE),dP.init(a,b)}),dX=bq("$ZodCUID2",(a,b)=>{b.pattern??(b.pattern=cF),dP.init(a,b)}),dY=bq("$ZodULID",(a,b)=>{b.pattern??(b.pattern=cG),dP.init(a,b)}),dZ=bq("$ZodXID",(a,b)=>{b.pattern??(b.pattern=cH),dP.init(a,b)}),d$=bq("$ZodKSUID",(a,b)=>{b.pattern??(b.pattern=cI),dP.init(a,b)}),d_=bq("$ZodISODateTime",(a,b)=>{b.pattern??(b.pattern=c3(b)),dP.init(a,b)}),d0=bq("$ZodISODate",(a,b)=>{b.pattern??(b.pattern=c0),dP.init(a,b)}),d1=bq("$ZodISOTime",(a,b)=>{b.pattern??(b.pattern=c2(b)),dP.init(a,b)}),d2=bq("$ZodISODuration",(a,b)=>{b.pattern??(b.pattern=cK),dP.init(a,b)}),d3=bq("$ZodIPv4",(a,b)=>{b.pattern??(b.pattern=cT),dP.init(a,b),a._zod.bag.format="ipv4"}),d4=bq("$ZodIPv6",(a,b)=>{b.pattern??(b.pattern=cU),dP.init(a,b),a._zod.bag.format="ipv6",a._zod.check=c=>{try{new URL(`http://[${c.value}]`)}catch{c.issues.push({code:"invalid_format",format:"ipv6",input:c.value,inst:a,continue:!b.abort})}}}),d5=bq("$ZodMAC",(a,b)=>{b.pattern??(b.pattern=cV(b.delimiter)),dP.init(a,b),a._zod.bag.format="mac"}),d6=bq("$ZodCIDRv4",(a,b)=>{b.pattern??(b.pattern=cW),dP.init(a,b)}),d7=bq("$ZodCIDRv6",(a,b)=>{b.pattern??(b.pattern=cX),dP.init(a,b),a._zod.check=c=>{let d=c.value.split("/");try{if(2!==d.length)throw Error();let[a,b]=d;if(!b)throw Error();let c=Number(b);if(`${c}`!==b||c<0||c>128)throw Error();new URL(`http://[${a}]`)}catch{c.issues.push({code:"invalid_format",format:"cidrv6",input:c.value,inst:a,continue:!b.abort})}}});function d8(a){if(""===a)return!0;if(a.length%4!=0)return!1;try{return atob(a),!0}catch{return!1}}let d9=bq("$ZodBase64",(a,b)=>{b.pattern??(b.pattern=cY),dP.init(a,b),a._zod.bag.contentEncoding="base64",a._zod.check=c=>{d8(c.value)||c.issues.push({code:"invalid_format",format:"base64",input:c.value,inst:a,continue:!b.abort})}});function ea(a){if(!cZ.test(a))return!1;let b=a.replace(/[-_]/g,a=>"-"===a?"+":"/");return d8(b.padEnd(4*Math.ceil(b.length/4),"="))}let eb=bq("$ZodBase64URL",(a,b)=>{b.pattern??(b.pattern=cZ),dP.init(a,b),a._zod.bag.contentEncoding="base64url",a._zod.check=c=>{ea(c.value)||c.issues.push({code:"invalid_format",format:"base64url",input:c.value,inst:a,continue:!b.abort})}}),ec=bq("$ZodE164",(a,b)=>{b.pattern??(b.pattern=c$),dP.init(a,b)});function ed(a,b=null){try{let c=a.split(".");if(3!==c.length)return!1;let[d]=c;if(!d)return!1;let e=JSON.parse(atob(d));if("typ"in e&&e?.typ!=="JWT"||!e.alg||b&&(!("alg"in e)||e.alg!==b))return!1;return!0}catch{return!1}}let ee=bq("$ZodJWT",(a,b)=>{dP.init(a,b),a._zod.check=c=>{ed(c.value,b.alg)||c.issues.push({code:"invalid_format",format:"jwt",input:c.value,inst:a,continue:!b.abort})}}),ef=bq("$ZodCustomStringFormat",(a,b)=>{dP.init(a,b),a._zod.check=c=>{b.fn(c.value)||c.issues.push({code:"invalid_format",format:b.format,input:c.value,inst:a,continue:!b.abort})}}),eg=bq("$ZodNumber",(a,b)=>{dN.init(a,b),a._zod.pattern=a._zod.bag.pattern??c7,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=Number(c.value)}catch(a){}let e=c.value;if("number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e))return c;let f="number"==typeof e?Number.isNaN(e)?"NaN":Number.isFinite(e)?void 0:"Infinity":void 0;return c.issues.push({expected:"number",code:"invalid_type",input:e,inst:a,...f?{received:f}:{}}),c}}),eh=bq("$ZodNumberFormat",(a,b)=>{dv.init(a,b),eg.init(a,b)}),ei=bq("$ZodBoolean",(a,b)=>{dN.init(a,b),a._zod.pattern=c8,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=!!c.value}catch(a){}let e=c.value;return"boolean"==typeof e||c.issues.push({expected:"boolean",code:"invalid_type",input:e,inst:a}),c}}),ej=bq("$ZodBigInt",(a,b)=>{dN.init(a,b),a._zod.pattern=c5,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=BigInt(c.value)}catch(a){}return"bigint"==typeof c.value||c.issues.push({expected:"bigint",code:"invalid_type",input:c.value,inst:a}),c}}),ek=bq("$ZodBigIntFormat",(a,b)=>{dw.init(a,b),ej.init(a,b)}),el=bq("$ZodSymbol",(a,b)=>{dN.init(a,b),a._zod.parse=(b,c)=>{let d=b.value;return"symbol"==typeof d||b.issues.push({expected:"symbol",code:"invalid_type",input:d,inst:a}),b}}),em=bq("$ZodUndefined",(a,b)=>{dN.init(a,b),a._zod.pattern=da,a._zod.values=new Set([void 0]),a._zod.optin="optional",a._zod.optout="optional",a._zod.parse=(b,c)=>{let d=b.value;return void 0===d||b.issues.push({expected:"undefined",code:"invalid_type",input:d,inst:a}),b}}),en=bq("$ZodNull",(a,b)=>{dN.init(a,b),a._zod.pattern=c9,a._zod.values=new Set([null]),a._zod.parse=(b,c)=>{let d=b.value;return null===d||b.issues.push({expected:"null",code:"invalid_type",input:d,inst:a}),b}}),eo=bq("$ZodAny",(a,b)=>{dN.init(a,b),a._zod.parse=a=>a}),ep=bq("$ZodUnknown",(a,b)=>{dN.init(a,b),a._zod.parse=a=>a}),eq=bq("$ZodNever",(a,b)=>{dN.init(a,b),a._zod.parse=(b,c)=>(b.issues.push({expected:"never",code:"invalid_type",input:b.value,inst:a}),b)}),er=bq("$ZodVoid",(a,b)=>{dN.init(a,b),a._zod.parse=(b,c)=>{let d=b.value;return void 0===d||b.issues.push({expected:"void",code:"invalid_type",input:d,inst:a}),b}}),es=bq("$ZodDate",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=new Date(c.value)}catch(a){}let e=c.value,f=e instanceof Date;return f&&!Number.isNaN(e.getTime())||c.issues.push({expected:"date",code:"invalid_type",input:e,...f?{received:"Invalid Date"}:{},inst:a}),c}});function et(a,b,c){a.issues.length&&b.issues.push(...ce(c,a.issues)),b.value[c]=a.value}let eu=bq("$ZodArray",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!Array.isArray(e))return c.issues.push({expected:"array",code:"invalid_type",input:e,inst:a}),c;c.value=Array(e.length);let f=[];for(let a=0;a<e.length;a++){let g=e[a],h=b.element._zod.run({value:g,issues:[]},d);h instanceof Promise?f.push(h.then(b=>et(b,c,a))):et(h,c,a)}return f.length?Promise.all(f).then(()=>c):c}});function ev(a,b,c,d,e){if(a.issues.length){if(e&&!(c in d))return;b.issues.push(...ce(c,a.issues))}void 0===a.value?c in d&&(b.value[c]=void 0):b.value[c]=a.value}function ew(a){let b=Object.keys(a.shape);for(let c of b)if(!a.shape?.[c]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${c}": expected a Zod schema`);let c=b3(a.shape);return{...a,keys:b,keySet:new Set(b),numKeys:b.length,optionalKeys:new Set(c)}}function ex(a,b,c,d,e,f){let g=[],h=e.keySet,i=e.catchall._zod,j=i.def.type,k="optional"===i.optout;for(let e in b){if(h.has(e))continue;if("never"===j){g.push(e);continue}let f=i.run({value:b[e],issues:[]},d);f instanceof Promise?a.push(f.then(a=>ev(a,c,e,b,k))):ev(f,c,e,b,k)}return(g.length&&c.issues.push({code:"unrecognized_keys",keys:g,input:b,inst:f}),a.length)?Promise.all(a).then(()=>c):c}let ey=bq("$ZodObject",(a,b)=>{let c;dN.init(a,b);let d=Object.getOwnPropertyDescriptor(b,"shape");if(!d?.get){let a=b.shape;Object.defineProperty(b,"shape",{get:()=>{let c={...a};return Object.defineProperty(b,"shape",{value:c}),c}})}let e=bD(()=>ew(b));bI(a._zod,"propValues",()=>{let a=b.shape,c={};for(let b in a){let d=a[b]._zod;if(d.values)for(let a of(c[b]??(c[b]=new Set),d.values))c[b].add(a)}return c});let f=b.catchall;a._zod.parse=(b,d)=>{c??(c=e.value);let g=b.value;if(!bT(g))return b.issues.push({expected:"object",code:"invalid_type",input:g,inst:a}),b;b.value={};let h=[],i=c.shape;for(let a of c.keys){let c=i[a],e="optional"===c._zod.optout,f=c._zod.run({value:g[a],issues:[]},d);f instanceof Promise?h.push(f.then(c=>ev(c,b,a,g,e))):ev(f,b,a,g,e)}return f?ex(h,g,b,d,e.value,a):h.length?Promise.all(h).then(()=>b):b}}),ez=bq("$ZodObjectJIT",(a,b)=>{let c,d;ey.init(a,b);let e=a._zod.parse,f=bD(()=>ew(b)),g=!bt.jitless,h=g&&bU.value,i=b.catchall;a._zod.parse=(j,k)=>{d??(d=f.value);let l=j.value;return bT(l)?g&&h&&k?.async===!1&&!0!==k.jitless?(c||(c=(a=>{let b=new dL(["shape","payload","ctx"]),c=f.value,d=a=>{let b=bQ(a);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};b.write("const input = payload.value;");let e=Object.create(null),g=0;for(let a of c.keys)e[a]=`key_${g++}`;for(let f of(b.write("const newResult = {};"),c.keys)){let c=e[f],g=bQ(f),h=a[f],i=h?._zod?.optout==="optional";b.write(`const ${c} = ${d(f)};`),i?b.write(`
        if (${c}.issues.length) {
          if (${g} in input) {
            payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${g}, ...iss.path] : [${g}]
            })));
          }
        }
        
        if (${c}.value === undefined) {
          if (${g} in input) {
            newResult[${g}] = undefined;
          }
        } else {
          newResult[${g}] = ${c}.value;
        }
        
      `):b.write(`
        if (${c}.issues.length) {
          payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${g}, ...iss.path] : [${g}]
          })));
        }
        
        if (${c}.value === undefined) {
          if (${g} in input) {
            newResult[${g}] = undefined;
          }
        } else {
          newResult[${g}] = ${c}.value;
        }
        
      `)}b.write("payload.value = newResult;"),b.write("return payload;");let h=b.compile();return(b,c)=>h(a,b,c)})(b.shape)),j=c(j,k),i)?ex([],l,j,k,d,a):j:e(j,k):(j.issues.push({expected:"object",code:"invalid_type",input:l,inst:a}),j)}});function eA(a,b,c,d){for(let c of a)if(0===c.issues.length)return b.value=c.value,b;let e=a.filter(a=>!cd(a));return 1===e.length?(b.value=e[0].value,e[0]):(b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>cg(a,d,bu())))}),b)}let eB=bq("$ZodUnion",(a,b)=>{dN.init(a,b),bI(a._zod,"optin",()=>b.options.some(a=>"optional"===a._zod.optin)?"optional":void 0),bI(a._zod,"optout",()=>b.options.some(a=>"optional"===a._zod.optout)?"optional":void 0),bI(a._zod,"values",()=>{if(b.options.every(a=>a._zod.values))return new Set(b.options.flatMap(a=>Array.from(a._zod.values)))}),bI(a._zod,"pattern",()=>{if(b.options.every(a=>a._zod.pattern)){let a=b.options.map(a=>a._zod.pattern);return RegExp(`^(${a.map(a=>bF(a.source)).join("|")})$`)}});let c=1===b.options.length,d=b.options[0]._zod.run;a._zod.parse=(e,f)=>{if(c)return d(e,f);let g=!1,h=[];for(let a of b.options){let b=a._zod.run({value:e.value,issues:[]},f);if(b instanceof Promise)h.push(b),g=!0;else{if(0===b.issues.length)return b;h.push(b)}}return g?Promise.all(h).then(b=>eA(b,e,a,f)):eA(h,e,a,f)}});function eC(a,b,c,d){let e=a.filter(a=>0===a.issues.length);return 1===e.length?b.value=e[0].value:0===e.length?b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>cg(a,d,bu())))}):b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:[],inclusive:!1}),b}let eD=bq("$ZodXor",(a,b)=>{eB.init(a,b),b.inclusive=!1;let c=1===b.options.length,d=b.options[0]._zod.run;a._zod.parse=(e,f)=>{if(c)return d(e,f);let g=!1,h=[];for(let a of b.options){let b=a._zod.run({value:e.value,issues:[]},f);b instanceof Promise?(h.push(b),g=!0):h.push(b)}return g?Promise.all(h).then(b=>eC(b,e,a,f)):eC(h,e,a,f)}}),eE=bq("$ZodDiscriminatedUnion",(a,b)=>{b.inclusive=!1,eB.init(a,b);let c=a._zod.parse;bI(a._zod,"propValues",()=>{let a={};for(let c of b.options){let d=c._zod.propValues;if(!d||0===Object.keys(d).length)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(c)}"`);for(let[b,c]of Object.entries(d))for(let d of(a[b]||(a[b]=new Set),c))a[b].add(d)}return a});let d=bD(()=>{let a=b.options,c=new Map;for(let d of a){let a=d._zod.propValues?.[b.discriminator];if(!a||0===a.size)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(d)}"`);for(let b of a){if(c.has(b))throw Error(`Duplicate discriminator value "${String(b)}"`);c.set(b,d)}}return c});a._zod.parse=(e,f)=>{let g=e.value;if(!bT(g))return e.issues.push({code:"invalid_type",expected:"object",input:g,inst:a}),e;let h=d.value.get(g?.[b.discriminator]);return h?h._zod.run(e,f):b.unionFallback?c(e,f):(e.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:b.discriminator,input:g,path:[b.discriminator],inst:a}),e)}}),eF=bq("$ZodIntersection",(a,b)=>{dN.init(a,b),a._zod.parse=(a,c)=>{let d=a.value,e=b.left._zod.run({value:d,issues:[]},c),f=b.right._zod.run({value:d,issues:[]},c);return e instanceof Promise||f instanceof Promise?Promise.all([e,f]).then(([b,c])=>eG(a,b,c)):eG(a,e,f)}});function eG(a,b,c){let d,e=new Map;for(let c of b.issues)if("unrecognized_keys"===c.code)for(let a of(d??(d=c),c.keys))e.has(a)||e.set(a,{}),e.get(a).l=!0;else a.issues.push(c);for(let b of c.issues)if("unrecognized_keys"===b.code)for(let a of b.keys)e.has(a)||e.set(a,{}),e.get(a).r=!0;else a.issues.push(b);let f=[...e].filter(([,a])=>a.l&&a.r).map(([a])=>a);if(f.length&&d&&a.issues.push({...d,keys:f}),cd(a))return a;let g=function a(b,c){if(b===c||b instanceof Date&&c instanceof Date&&+b==+c)return{valid:!0,data:b};if(bV(b)&&bV(c)){let d=Object.keys(c),e=Object.keys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1,mergeErrorPath:[d,...e.mergeErrorPath]};f[d]=e.data}return{valid:!0,data:f}}if(Array.isArray(b)&&Array.isArray(c)){if(b.length!==c.length)return{valid:!1,mergeErrorPath:[]};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1,mergeErrorPath:[e,...f.mergeErrorPath]};d.push(f.data)}return{valid:!0,data:d}}return{valid:!1,mergeErrorPath:[]}}(b.value,c.value);if(!g.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(g.mergeErrorPath)}`);return a.value=g.data,a}let eH=bq("$ZodTuple",(a,b)=>{dN.init(a,b);let c=b.items;a._zod.parse=(d,e)=>{let f=d.value;if(!Array.isArray(f))return d.issues.push({input:f,inst:a,expected:"tuple",code:"invalid_type"}),d;d.value=[];let g=[],h=[...c].reverse().findIndex(a=>"optional"!==a._zod.optin),i=-1===h?0:c.length-h;if(!b.rest){let b=f.length>c.length,e=f.length<i-1;if(b||e)return d.issues.push({...b?{code:"too_big",maximum:c.length,inclusive:!0}:{code:"too_small",minimum:c.length},input:f,inst:a,origin:"array"}),d}let j=-1;for(let a of c){if(++j>=f.length&&j>=i)continue;let b=a._zod.run({value:f[j],issues:[]},e);b instanceof Promise?g.push(b.then(a=>eI(a,d,j))):eI(b,d,j)}if(b.rest)for(let a of f.slice(c.length)){j++;let c=b.rest._zod.run({value:a,issues:[]},e);c instanceof Promise?g.push(c.then(a=>eI(a,d,j))):eI(c,d,j)}return g.length?Promise.all(g).then(()=>d):d}});function eI(a,b,c){a.issues.length&&b.issues.push(...ce(c,a.issues)),b.value[c]=a.value}let eJ=bq("$ZodRecord",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!bV(e))return c.issues.push({expected:"record",code:"invalid_type",input:e,inst:a}),c;let f=[],g=b.keyType._zod.values;if(g){let h;c.value={};let i=new Set;for(let a of g)if("string"==typeof a||"number"==typeof a||"symbol"==typeof a){i.add("number"==typeof a?a.toString():a);let g=b.valueType._zod.run({value:e[a],issues:[]},d);g instanceof Promise?f.push(g.then(b=>{b.issues.length&&c.issues.push(...ce(a,b.issues)),c.value[a]=b.value})):(g.issues.length&&c.issues.push(...ce(a,g.issues)),c.value[a]=g.value)}for(let a in e)i.has(a)||(h=h??[]).push(a);h&&h.length>0&&c.issues.push({code:"unrecognized_keys",input:e,inst:a,keys:h})}else for(let g of(c.value={},Reflect.ownKeys(e))){if("__proto__"===g)continue;let h=b.keyType._zod.run({value:g,issues:[]},d);if(h instanceof Promise)throw Error("Async schemas not supported in object keys currently");if("string"==typeof g&&c7.test(g)&&h.issues.length){let a=b.keyType._zod.run({value:Number(g),issues:[]},d);if(a instanceof Promise)throw Error("Async schemas not supported in object keys currently");0===a.issues.length&&(h=a)}if(h.issues.length){"loose"===b.mode?c.value[g]=e[g]:c.issues.push({code:"invalid_key",origin:"record",issues:h.issues.map(a=>cg(a,d,bu())),input:g,path:[g],inst:a});continue}let i=b.valueType._zod.run({value:e[g],issues:[]},d);i instanceof Promise?f.push(i.then(a=>{a.issues.length&&c.issues.push(...ce(g,a.issues)),c.value[h.value]=a.value})):(i.issues.length&&c.issues.push(...ce(g,i.issues)),c.value[h.value]=i.value)}return f.length?Promise.all(f).then(()=>c):c}}),eK=bq("$ZodMap",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!(e instanceof Map))return c.issues.push({expected:"map",code:"invalid_type",input:e,inst:a}),c;let f=[];for(let[g,h]of(c.value=new Map,e)){let i=b.keyType._zod.run({value:g,issues:[]},d),j=b.valueType._zod.run({value:h,issues:[]},d);i instanceof Promise||j instanceof Promise?f.push(Promise.all([i,j]).then(([b,f])=>{eL(b,f,c,g,e,a,d)})):eL(i,j,c,g,e,a,d)}return f.length?Promise.all(f).then(()=>c):c}});function eL(a,b,c,d,e,f,g){a.issues.length&&(bY.has(typeof d)?c.issues.push(...ce(d,a.issues)):c.issues.push({code:"invalid_key",origin:"map",input:e,inst:f,issues:a.issues.map(a=>cg(a,g,bu()))})),b.issues.length&&(bY.has(typeof d)?c.issues.push(...ce(d,b.issues)):c.issues.push({origin:"map",code:"invalid_element",input:e,inst:f,key:d,issues:b.issues.map(a=>cg(a,g,bu()))})),c.value.set(a.value,b.value)}let eM=bq("$ZodSet",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!(e instanceof Set))return c.issues.push({input:e,inst:a,expected:"set",code:"invalid_type"}),c;let f=[];for(let a of(c.value=new Set,e)){let e=b.valueType._zod.run({value:a,issues:[]},d);e instanceof Promise?f.push(e.then(a=>eN(a,c))):eN(e,c)}return f.length?Promise.all(f).then(()=>c):c}});function eN(a,b){a.issues.length&&b.issues.push(...a.issues),b.value.add(a.value)}let eO=bq("$ZodEnum",(a,b)=>{dN.init(a,b);let c=bA(b.entries),d=new Set(c);a._zod.values=d,a._zod.pattern=RegExp(`^(${c.filter(a=>bY.has(typeof a)).map(a=>"string"==typeof a?b$(a):a.toString()).join("|")})$`),a._zod.parse=(b,e)=>{let f=b.value;return d.has(f)||b.issues.push({code:"invalid_value",values:c,input:f,inst:a}),b}}),eP=bq("$ZodLiteral",(a,b)=>{if(dN.init(a,b),0===b.values.length)throw Error("Cannot create literal schema with no valid values");let c=new Set(b.values);a._zod.values=c,a._zod.pattern=RegExp(`^(${b.values.map(a=>"string"==typeof a?b$(a):a?b$(a.toString()):String(a)).join("|")})$`),a._zod.parse=(d,e)=>{let f=d.value;return c.has(f)||d.issues.push({code:"invalid_value",values:b.values,input:f,inst:a}),d}}),eQ=bq("$ZodFile",(a,b)=>{dN.init(a,b),a._zod.parse=(b,c)=>{let d=b.value;return d instanceof File||b.issues.push({expected:"file",code:"invalid_type",input:d,inst:a}),b}}),eR=bq("$ZodTransform",(a,b)=>{dN.init(a,b),a._zod.parse=(c,d)=>{if("backward"===d.direction)throw new bs(a.constructor.name);let e=b.transform(c.value,c);if(d.async)return(e instanceof Promise?e:Promise.resolve(e)).then(a=>(c.value=a,c));if(e instanceof Promise)throw new br;return c.value=e,c}});function eS(a,b){return a.issues.length&&void 0===b?{issues:[],value:void 0}:a}let eT=bq("$ZodOptional",(a,b)=>{dN.init(a,b),a._zod.optin="optional",a._zod.optout="optional",bI(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,void 0]):void 0),bI(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${bF(a.source)})?$`):void 0}),a._zod.parse=(a,c)=>{if("optional"===b.innerType._zod.optin){let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(b=>eS(b,a.value)):eS(d,a.value)}return void 0===a.value?a:b.innerType._zod.run(a,c)}}),eU=bq("$ZodExactOptional",(a,b)=>{eT.init(a,b),bI(a._zod,"values",()=>b.innerType._zod.values),bI(a._zod,"pattern",()=>b.innerType._zod.pattern),a._zod.parse=(a,c)=>b.innerType._zod.run(a,c)}),eV=bq("$ZodNullable",(a,b)=>{dN.init(a,b),bI(a._zod,"optin",()=>b.innerType._zod.optin),bI(a._zod,"optout",()=>b.innerType._zod.optout),bI(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${bF(a.source)}|null)$`):void 0}),bI(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,null]):void 0),a._zod.parse=(a,c)=>null===a.value?a:b.innerType._zod.run(a,c)}),eW=bq("$ZodDefault",(a,b)=>{dN.init(a,b),a._zod.optin="optional",bI(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if("backward"===c.direction)return b.innerType._zod.run(a,c);if(void 0===a.value)return a.value=b.defaultValue,a;let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(a=>eX(a,b)):eX(d,b)}});function eX(a,b){return void 0===a.value&&(a.value=b.defaultValue),a}let eY=bq("$ZodPrefault",(a,b)=>{dN.init(a,b),a._zod.optin="optional",bI(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>("backward"===c.direction||void 0===a.value&&(a.value=b.defaultValue),b.innerType._zod.run(a,c))}),eZ=bq("$ZodNonOptional",(a,b)=>{dN.init(a,b),bI(a._zod,"values",()=>{let a=b.innerType._zod.values;return a?new Set([...a].filter(a=>void 0!==a)):void 0}),a._zod.parse=(c,d)=>{let e=b.innerType._zod.run(c,d);return e instanceof Promise?e.then(b=>e$(b,a)):e$(e,a)}});function e$(a,b){return a.issues.length||void 0!==a.value||a.issues.push({code:"invalid_type",expected:"nonoptional",input:a.value,inst:b}),a}let e_=bq("$ZodSuccess",(a,b)=>{dN.init(a,b),a._zod.parse=(a,c)=>{if("backward"===c.direction)throw new bs("ZodSuccess");let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(b=>(a.value=0===b.issues.length,a)):(a.value=0===d.issues.length,a)}}),e0=bq("$ZodCatch",(a,b)=>{dN.init(a,b),bI(a._zod,"optin",()=>b.innerType._zod.optin),bI(a._zod,"optout",()=>b.innerType._zod.optout),bI(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if("backward"===c.direction)return b.innerType._zod.run(a,c);let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(d=>(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>cg(a,c,bu()))},input:a.value}),a.issues=[]),a)):(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>cg(a,c,bu()))},input:a.value}),a.issues=[]),a)}}),e1=bq("$ZodNaN",(a,b)=>{dN.init(a,b),a._zod.parse=(b,c)=>("number"==typeof b.value&&Number.isNaN(b.value)||b.issues.push({input:b.value,inst:a,expected:"nan",code:"invalid_type"}),b)}),e2=bq("$ZodPipe",(a,b)=>{dN.init(a,b),bI(a._zod,"values",()=>b.in._zod.values),bI(a._zod,"optin",()=>b.in._zod.optin),bI(a._zod,"optout",()=>b.out._zod.optout),bI(a._zod,"propValues",()=>b.in._zod.propValues),a._zod.parse=(a,c)=>{if("backward"===c.direction){let d=b.out._zod.run(a,c);return d instanceof Promise?d.then(a=>e3(a,b.in,c)):e3(d,b.in,c)}let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>e3(a,b.out,c)):e3(d,b.out,c)}});function e3(a,b,c){return a.issues.length?(a.aborted=!0,a):b._zod.run({value:a.value,issues:a.issues},c)}let e4=bq("$ZodCodec",(a,b)=>{dN.init(a,b),bI(a._zod,"values",()=>b.in._zod.values),bI(a._zod,"optin",()=>b.in._zod.optin),bI(a._zod,"optout",()=>b.out._zod.optout),bI(a._zod,"propValues",()=>b.in._zod.propValues),a._zod.parse=(a,c)=>{if("forward"===(c.direction||"forward")){let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>e5(a,b,c)):e5(d,b,c)}{let d=b.out._zod.run(a,c);return d instanceof Promise?d.then(a=>e5(a,b,c)):e5(d,b,c)}}});function e5(a,b,c){if(a.issues.length)return a.aborted=!0,a;if("forward"===(c.direction||"forward")){let d=b.transform(a.value,a);return d instanceof Promise?d.then(d=>e6(a,d,b.out,c)):e6(a,d,b.out,c)}{let d=b.reverseTransform(a.value,a);return d instanceof Promise?d.then(d=>e6(a,d,b.in,c)):e6(a,d,b.in,c)}}function e6(a,b,c,d){return a.issues.length?(a.aborted=!0,a):c._zod.run({value:b,issues:a.issues},d)}let e7=bq("$ZodReadonly",(a,b)=>{dN.init(a,b),bI(a._zod,"propValues",()=>b.innerType._zod.propValues),bI(a._zod,"values",()=>b.innerType._zod.values),bI(a._zod,"optin",()=>b.innerType?._zod?.optin),bI(a._zod,"optout",()=>b.innerType?._zod?.optout),a._zod.parse=(a,c)=>{if("backward"===c.direction)return b.innerType._zod.run(a,c);let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(e8):e8(d)}});function e8(a){return a.value=Object.freeze(a.value),a}let e9=bq("$ZodTemplateLiteral",(a,b)=>{dN.init(a,b);let c=[];for(let a of b.parts)if("object"==typeof a&&null!==a){if(!a._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...a._zod.traits].shift()}`);let b=a._zod.pattern instanceof RegExp?a._zod.pattern.source:a._zod.pattern;if(!b)throw Error(`Invalid template literal part: ${a._zod.traits}`);let d=+!!b.startsWith("^"),e=b.endsWith("$")?b.length-1:b.length;c.push(b.slice(d,e))}else if(null===a||bZ.has(typeof a))c.push(b$(`${a}`));else throw Error(`Invalid template literal part: ${a}`);a._zod.pattern=RegExp(`^${c.join("")}$`),a._zod.parse=(c,d)=>("string"!=typeof c.value?c.issues.push({input:c.value,inst:a,expected:"string",code:"invalid_type"}):(a._zod.pattern.lastIndex=0,a._zod.pattern.test(c.value)||c.issues.push({input:c.value,inst:a,code:"invalid_format",format:b.format??"template_literal",pattern:a._zod.pattern.source})),c)}),fa=bq("$ZodFunction",(a,b)=>(dN.init(a,b),a._def=b,a._zod.def=b,a.implement=b=>{if("function"!=typeof b)throw Error("implement() must be called with a function");return function(...c){let d=Reflect.apply(b,this,a._def.input?cx(a._def.input,c):c);return a._def.output?cx(a._def.output,d):d}},a.implementAsync=b=>{if("function"!=typeof b)throw Error("implementAsync() must be called with a function");return async function(...c){let d=a._def.input?await cz(a._def.input,c):c,e=await Reflect.apply(b,this,d);return a._def.output?await cz(a._def.output,e):e}},a._zod.parse=(b,c)=>("function"!=typeof b.value?b.issues.push({code:"invalid_type",expected:"function",input:b.value,inst:a}):a._def.output&&"promise"===a._def.output._zod.def.type?b.value=a.implementAsync(b.value):b.value=a.implement(b.value),b),a.input=(...b)=>{let c=a.constructor;return new c(Array.isArray(b[0])?{type:"function",input:new eH({type:"tuple",items:b[0],rest:b[1]}),output:a._def.output}:{type:"function",input:b[0],output:a._def.output})},a.output=b=>new a.constructor({type:"function",input:a._def.input,output:b}),a)),fb=bq("$ZodPromise",(a,b)=>{dN.init(a,b),a._zod.parse=(a,c)=>Promise.resolve(a.value).then(a=>b.innerType._zod.run({value:a,issues:[]},c))}),fc=bq("$ZodLazy",(a,b)=>{dN.init(a,b),bI(a._zod,"innerType",()=>b.getter()),bI(a._zod,"pattern",()=>a._zod.innerType?._zod?.pattern),bI(a._zod,"propValues",()=>a._zod.innerType?._zod?.propValues),bI(a._zod,"optin",()=>a._zod.innerType?._zod?.optin??void 0),bI(a._zod,"optout",()=>a._zod.innerType?._zod?.optout??void 0),a._zod.parse=(b,c)=>a._zod.innerType._zod.run(b,c)}),fd=bq("$ZodCustom",(a,b)=>{dq.init(a,b),dN.init(a,b),a._zod.parse=(a,b)=>a,a._zod.check=c=>{let d=c.value,e=b.fn(d);if(e instanceof Promise)return e.then(b=>fe(b,c,d,a));fe(e,c,d,a)}});function fe(a,b,c,d){if(!a){let a={code:"custom",input:c,inst:d,path:[...d._zod.def.path??[]],continue:!d._zod.def.abort};d._zod.def.params&&(a.params=d._zod.def.params),b.issues.push(ck(a))}}a.s(["$ZodAny",0,eo,"$ZodArray",0,eu,"$ZodBase64",0,d9,"$ZodBase64URL",0,eb,"$ZodBigInt",0,ej,"$ZodBigIntFormat",0,ek,"$ZodBoolean",0,ei,"$ZodCIDRv4",0,d6,"$ZodCIDRv6",0,d7,"$ZodCUID",0,dW,"$ZodCUID2",0,dX,"$ZodCatch",0,e0,"$ZodCodec",0,e4,"$ZodCustom",0,fd,"$ZodCustomStringFormat",0,ef,"$ZodDate",0,es,"$ZodDefault",0,eW,"$ZodDiscriminatedUnion",0,eE,"$ZodE164",0,ec,"$ZodEmail",0,dS,"$ZodEmoji",0,dU,"$ZodEnum",0,eO,"$ZodExactOptional",0,eU,"$ZodFile",0,eQ,"$ZodFunction",0,fa,"$ZodGUID",0,dQ,"$ZodIPv4",0,d3,"$ZodIPv6",0,d4,"$ZodISODate",0,d0,"$ZodISODateTime",0,d_,"$ZodISODuration",0,d2,"$ZodISOTime",0,d1,"$ZodIntersection",0,eF,"$ZodJWT",0,ee,"$ZodKSUID",0,d$,"$ZodLazy",0,fc,"$ZodLiteral",0,eP,"$ZodMAC",0,d5,"$ZodMap",0,eK,"$ZodNaN",0,e1,"$ZodNanoID",0,dV,"$ZodNever",0,eq,"$ZodNonOptional",0,eZ,"$ZodNull",0,en,"$ZodNullable",0,eV,"$ZodNumber",0,eg,"$ZodNumberFormat",0,eh,"$ZodObject",0,ey,"$ZodObjectJIT",0,ez,"$ZodOptional",0,eT,"$ZodPipe",0,e2,"$ZodPrefault",0,eY,"$ZodPromise",0,fb,"$ZodReadonly",0,e7,"$ZodRecord",0,eJ,"$ZodSet",0,eM,"$ZodString",0,dO,"$ZodStringFormat",0,dP,"$ZodSuccess",0,e_,"$ZodSymbol",0,el,"$ZodTemplateLiteral",0,e9,"$ZodTransform",0,eR,"$ZodTuple",0,eH,"$ZodType",0,dN,"$ZodULID",0,dY,"$ZodURL",0,dT,"$ZodUUID",0,dR,"$ZodUndefined",0,em,"$ZodUnion",0,eB,"$ZodUnknown",0,ep,"$ZodVoid",0,er,"$ZodXID",0,dZ,"$ZodXor",0,eD,"isValidBase64",()=>d8,"isValidBase64URL",()=>ea,"isValidJWT",()=>ed],26766),Symbol("ZodOutput"),Symbol("ZodInput");(v=globalThis).__zod_globalRegistry??(v.__zod_globalRegistry=new class a{constructor(){this._map=new WeakMap,this._idmap=new Map}add(a,...b){let c=b[0];return this._map.set(a,c),c&&"object"==typeof c&&"id"in c&&this._idmap.set(c.id,a),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(a){let b=this._map.get(a);return b&&"object"==typeof b&&"id"in b&&this._idmap.delete(b.id),this._map.delete(a),this}get(a){let b=a._zod.parent;if(b){let c={...this.get(b)??{}};delete c.id;let d={...c,...this._map.get(a)};return Object.keys(d).length?d:void 0}return this._map.get(a)}has(a){return this._map.has(a)}});let ff=globalThis.__zod_globalRegistry;function fg(a,b){return new ds({check:"less_than",...b0(b),value:a,inclusive:!1})}function fh(a,b){return new ds({check:"less_than",...b0(b),value:a,inclusive:!0})}function fi(a,b){return new dt({check:"greater_than",...b0(b),value:a,inclusive:!1})}function fj(a,b){return new dt({check:"greater_than",...b0(b),value:a,inclusive:!0})}function fk(a,b){return new du({check:"multiple_of",...b0(b),value:a})}function fl(a,b){return new dA({check:"max_length",...b0(b),maximum:a})}function fm(a,b){return new dB({check:"min_length",...b0(b),minimum:a})}function fn(a,b){return new dC({check:"length_equals",...b0(b),length:a})}function fo(a){return new dK({check:"overwrite",tx:a})}function fp(a){let b=a?.target??"draft-2020-12";return"draft-4"===b&&(b="draft-04"),"draft-7"===b&&(b="draft-07"),{processors:a.processors??{},metadataRegistry:a?.metadata??ff,target:b,unrepresentable:a?.unrepresentable??"throw",override:a?.override??(()=>{}),io:a?.io??"output",counter:0,seen:new Map,cycles:a?.cycles??"ref",reused:a?.reused??"inline",external:a?.external??void 0}}function fq(a,b,c={path:[],schemaPath:[]}){var d;let e=a._zod.def,f=b.seen.get(a);if(f)return f.count++,c.schemaPath.includes(a)&&(f.cycle=c.path),f.schema;let g={schema:{},count:1,cycle:void 0,path:c.path};b.seen.set(a,g);let h=a._zod.toJSONSchema?.();if(h)g.schema=h;else{let d={...c,schemaPath:[...c.schemaPath,a],path:c.path};if(a._zod.processJSONSchema)a._zod.processJSONSchema(b,g.schema,d);else{let c=g.schema,f=b.processors[e.type];if(!f)throw Error(`[toJSONSchema]: Non-representable type encountered: ${e.type}`);f(a,b,c,d)}let f=a._zod.parent;f&&(g.ref||(g.ref=f),fq(f,b,d),b.seen.get(f).isParent=!0)}let i=b.metadataRegistry.get(a);return i&&Object.assign(g.schema,i),"input"===b.io&&function a(b,c){let d=c??{seen:new Set};if(d.seen.has(b))return!1;d.seen.add(b);let e=b._zod.def;if("transform"===e.type)return!0;if("array"===e.type)return a(e.element,d);if("set"===e.type)return a(e.valueType,d);if("lazy"===e.type)return a(e.getter(),d);if("promise"===e.type||"optional"===e.type||"nonoptional"===e.type||"nullable"===e.type||"readonly"===e.type||"default"===e.type||"prefault"===e.type)return a(e.innerType,d);if("intersection"===e.type)return a(e.left,d)||a(e.right,d);if("record"===e.type||"map"===e.type)return a(e.keyType,d)||a(e.valueType,d);if("pipe"===e.type)return a(e.in,d)||a(e.out,d);if("object"===e.type){for(let b in e.shape)if(a(e.shape[b],d))return!0;return!1}if("union"===e.type){for(let b of e.options)if(a(b,d))return!0;return!1}if("tuple"===e.type){for(let b of e.items)if(a(b,d))return!0;if(e.rest&&a(e.rest,d))return!0}return!1}(a)&&(delete g.schema.examples,delete g.schema.default),"input"===b.io&&g.schema._prefault&&((d=g.schema).default??(d.default=g.schema._prefault)),delete g.schema._prefault,b.seen.get(a).schema}function fr(a,b){let c=a.seen.get(b);if(!c)throw Error("Unprocessed schema. This is a bug in Zod.");let d=new Map;for(let b of a.seen.entries()){let c=a.metadataRegistry.get(b[0])?.id;if(c){let a=d.get(c);if(a&&a!==b[0])throw Error(`Duplicate schema id "${c}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);d.set(c,b[0])}}let e=b=>{if(b[1].schema.$ref)return;let d=b[1],{ref:e,defId:f}=(b=>{let d="draft-2020-12"===a.target?"$defs":"definitions";if(a.external){let c=a.external.registry.get(b[0])?.id,e=a.external.uri??(a=>a);if(c)return{ref:e(c)};let f=b[1].defId??b[1].schema.id??`schema${a.counter++}`;return b[1].defId=f,{defId:f,ref:`${e("__shared")}#/${d}/${f}`}}if(b[1]===c)return{ref:"#"};let e=`#/${d}/`,f=b[1].schema.id??`__schema${a.counter++}`;return{defId:f,ref:e+f}})(b);d.def={...d.schema},f&&(d.defId=f);let g=d.schema;for(let a in g)delete g[a];g.$ref=e};if("throw"===a.cycles)for(let b of a.seen.entries()){let a=b[1];if(a.cycle)throw Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let c of a.seen.entries()){let d=c[1];if(b===c[0]){e(c);continue}if(a.external){let d=a.external.registry.get(c[0])?.id;if(b!==c[0]&&d){e(c);continue}}if(a.metadataRegistry.get(c[0])?.id||d.cycle||d.count>1&&"ref"===a.reused){e(c);continue}}}function fs(a,b){let c=a.seen.get(b);if(!c)throw Error("Unprocessed schema. This is a bug in Zod.");let d=b=>{let c=a.seen.get(b);if(null===c.ref)return;let e=c.def??c.schema,f={...e},g=c.ref;if(c.ref=null,g){d(g);let c=a.seen.get(g),h=c.schema;if(h.$ref&&("draft-07"===a.target||"draft-04"===a.target||"openapi-3.0"===a.target)?(e.allOf=e.allOf??[],e.allOf.push(h)):Object.assign(e,h),Object.assign(e,f),b._zod.parent===g)for(let a in e)"$ref"!==a&&"allOf"!==a&&(a in f||delete e[a]);if(h.$ref&&c.def)for(let a in e)"$ref"!==a&&"allOf"!==a&&a in c.def&&JSON.stringify(e[a])===JSON.stringify(c.def[a])&&delete e[a]}let h=b._zod.parent;if(h&&h!==g){d(h);let b=a.seen.get(h);if(b?.schema.$ref&&(e.$ref=b.schema.$ref,b.def))for(let a in e)"$ref"!==a&&"allOf"!==a&&a in b.def&&JSON.stringify(e[a])===JSON.stringify(b.def[a])&&delete e[a]}a.override({zodSchema:b,jsonSchema:e,path:c.path??[]})};for(let b of[...a.seen.entries()].reverse())d(b[0]);let e={};if("draft-2020-12"===a.target?e.$schema="https://json-schema.org/draft/2020-12/schema":"draft-07"===a.target?e.$schema="http://json-schema.org/draft-07/schema#":"draft-04"===a.target?e.$schema="http://json-schema.org/draft-04/schema#":a.target,a.external?.uri){let c=a.external.registry.get(b)?.id;if(!c)throw Error("Schema is missing an `id` property");e.$id=a.external.uri(c)}Object.assign(e,c.def??c.schema);let f=a.external?.defs??{};for(let b of a.seen.entries()){let a=b[1];a.def&&a.defId&&(f[a.defId]=a.def)}a.external||Object.keys(f).length>0&&("draft-2020-12"===a.target?e.$defs=f:e.definitions=f);try{let c=JSON.parse(JSON.stringify(e));return Object.defineProperty(c,"~standard",{value:{...b["~standard"],jsonSchema:{input:ft(b,"input",a.processors),output:ft(b,"output",a.processors)}},enumerable:!1,writable:!1}),c}catch(a){throw Error("Error converting schema to JSON.")}}let ft=(a,b,c={})=>d=>{let{libraryOptions:e,target:f}=d??{},g=fp({...e??{},target:f,io:b,processors:c});return fq(a,g),fr(g,a),fs(g,a)},fu={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},fv=(a,b,c,d)=>{let e=a._zod.def;fq(e.innerType,b,d),b.seen.get(a).ref=e.innerType};a.i(26766),a.i(45976);var fw=a.i(66446),fw=fw;(a,b)=>{d_.init(a,b),fM.init(a,b)},(a,b)=>{d2.init(a,b),fM.init(a,b)};let fx=bq("ZodError",(a,b)=>{cu.init(a,b),a.name="ZodError",Object.defineProperties(a,{format:{value:b=>(function(a,b=a=>a.message){let c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code&&e.errors.length)e.errors.map(a=>d({issues:a}));else if("invalid_key"===e.code)d({issues:e.issues});else if("invalid_element"===e.code)d({issues:e.issues});else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(a),c})(a,b)},flatten:{value:b=>(function(a,b=a=>a.message){let c={},d=[];for(let e of a.issues)e.path.length>0?(c[e.path[0]]=c[e.path[0]]||[],c[e.path[0]].push(b(e))):d.push(b(e));return{formErrors:d,fieldErrors:c}})(a,b)},addIssue:{value:b=>{a.issues.push(b),a.message=JSON.stringify(a.issues,bC,2)}},addIssues:{value:b=>{a.issues.push(...b),a.message=JSON.stringify(a.issues,bC,2)}},isEmpty:{get:()=>0===a.issues.length}})},{Parent:Error}),fy=cw(fx),fz=cy(fx),fA=cA(fx),fB=cC(fx),fC=(a,b,c)=>{let d=c?Object.assign(c,{direction:"backward"}):{direction:"backward"};return cw(fx)(a,b,d)},fD=(a,b,c)=>cw(fx)(a,b,c),fE=async(a,b,c)=>{let d=c?Object.assign(c,{direction:"backward"}):{direction:"backward"};return cy(fx)(a,b,d)},fF=async(a,b,c)=>cy(fx)(a,b,c),fG=(a,b,c)=>{let d=c?Object.assign(c,{direction:"backward"}):{direction:"backward"};return cA(fx)(a,b,d)},fH=(a,b,c)=>cA(fx)(a,b,c),fI=async(a,b,c)=>{let d=c?Object.assign(c,{direction:"backward"}):{direction:"backward"};return cC(fx)(a,b,d)},fJ=async(a,b,c)=>cC(fx)(a,b,c),fK=bq("ZodType",(a,b)=>(dN.init(a,b),Object.assign(a["~standard"],{jsonSchema:{input:ft(a,"input"),output:ft(a,"output")}}),a.toJSONSchema=((a,b={})=>c=>{let d=fp({...c,processors:b});return fq(a,d),fr(d,a),fs(d,a)})(a,{}),a.def=b,a.type=b.type,Object.defineProperty(a,"_def",{value:b}),a.check=(...c)=>a.clone(fw.mergeDefs(b,{checks:[...b.checks??[],...c.map(a=>"function"==typeof a?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),{parent:!0}),a.with=a.check,a.clone=(b,c)=>b_(a,b,c),a.brand=()=>a,a.register=(b,c)=>(b.add(a,c),a),a.parse=(b,c)=>fy(a,b,c,{callee:a.parse}),a.safeParse=(b,c)=>fA(a,b,c),a.parseAsync=async(b,c)=>fz(a,b,c,{callee:a.parseAsync}),a.safeParseAsync=async(b,c)=>fB(a,b,c),a.spa=a.safeParseAsync,a.encode=(b,c)=>fC(a,b,c),a.decode=(b,c)=>fD(a,b,c),a.encodeAsync=async(b,c)=>fE(a,b,c),a.decodeAsync=async(b,c)=>fF(a,b,c),a.safeEncode=(b,c)=>fG(a,b,c),a.safeDecode=(b,c)=>fH(a,b,c),a.safeEncodeAsync=async(b,c)=>fI(a,b,c),a.safeDecodeAsync=async(b,c)=>fJ(a,b,c),a.refine=(b,c)=>a.check(function(a,b={}){return new f5({type:"custom",check:"custom",fn:a,...b0(b)})}(b,c)),a.superRefine=b=>a.check(function(a){var b;let c,d;return b=b=>(b.addIssue=a=>{"string"==typeof a?b.issues.push(ck(a,b.value,c._zod.def)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=b.value),a.inst??(a.inst=c),a.continue??(a.continue=!c._zod.def.abort),b.issues.push(ck(a)))},a(b.value,b)),(d=new dq({check:"custom",...b0(void 0)}))._zod.check=b,c=d}(b)),a.overwrite=b=>a.check(fo(b)),a.optional=()=>fW(a),a.exactOptional=()=>new fX({type:"optional",innerType:a}),a.nullable=()=>fZ(a),a.nullish=()=>fW(fZ(a)),a.nonoptional=b=>{var c,d;return c=a,d=b,new f0({type:"nonoptional",innerType:c,...fw.normalizeParams(d)})},a.array=()=>(function(a,b){return new fQ({type:"array",element:a,...b0(void 0)})})(a),a.or=b=>new fR({type:"union",options:[a,b],...fw.normalizeParams(void 0)}),a.and=b=>new fS({type:"intersection",left:a,right:b}),a.transform=b=>f3(a,new fU({type:"transform",transform:b})),a.default=b=>{var c,d;return c=a,d=b,new f$({type:"default",innerType:c,get defaultValue(){return"function"==typeof d?d():fw.shallowClone(d)}})},a.prefault=b=>{var c,d;return c=a,d=b,new f_({type:"prefault",innerType:c,get defaultValue(){return"function"==typeof d?d():fw.shallowClone(d)}})},a.catch=b=>{var c;return new f1({type:"catch",innerType:a,catchValue:"function"==typeof(c=b)?c:()=>c})},a.pipe=b=>f3(a,b),a.readonly=()=>new f4({type:"readonly",innerType:a}),a.describe=b=>{let c=a.clone();return ff.add(c,{description:b}),c},Object.defineProperty(a,"description",{get:()=>ff.get(a)?.description,configurable:!0}),a.meta=(...b)=>{if(0===b.length)return ff.get(a);let c=a.clone();return ff.add(c,b[0]),c},a.isOptional=()=>a.safeParse(void 0).success,a.isNullable=()=>a.safeParse(null).success,a.apply=b=>b(a),a)),fL=bq("_ZodString",(a,b)=>{dO.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>((a,b,c,d)=>{c.type="string";let{minimum:e,maximum:f,format:g,patterns:h,contentEncoding:i}=a._zod.bag;if("number"==typeof e&&(c.minLength=e),"number"==typeof f&&(c.maxLength=f),g&&(c.format=fu[g]??g,""===c.format&&delete c.format,"time"===g&&delete c.format),i&&(c.contentEncoding=i),h&&h.size>0){let a=[...h];1===a.length?c.pattern=a[0].source:a.length>1&&(c.allOf=[...a.map(a=>({..."draft-07"===b.target||"draft-04"===b.target||"openapi-3.0"===b.target?{type:"string"}:{},pattern:a.source}))])}})(a,b,c,0);let c=a._zod.bag;a.format=c.format??null,a.minLength=c.minimum??null,a.maxLength=c.maximum??null,a.regex=(...b)=>a.check(function(a,b){return new dE({check:"string_format",format:"regex",...b0(b),pattern:a})}(...b)),a.includes=(...b)=>a.check(function(a,b){return new dH({check:"string_format",format:"includes",...b0(b),includes:a})}(...b)),a.startsWith=(...b)=>a.check(function(a,b){return new dI({check:"string_format",format:"starts_with",...b0(b),prefix:a})}(...b)),a.endsWith=(...b)=>a.check(function(a,b){return new dJ({check:"string_format",format:"ends_with",...b0(b),suffix:a})}(...b)),a.min=(...b)=>a.check(fm(...b)),a.max=(...b)=>a.check(fl(...b)),a.length=(...b)=>a.check(fn(...b)),a.nonempty=(...b)=>a.check(fm(1,...b)),a.lowercase=b=>a.check(new dF({check:"string_format",format:"lowercase",...b0(b)})),a.uppercase=b=>a.check(new dG({check:"string_format",format:"uppercase",...b0(b)})),a.trim=()=>a.check(fo(a=>a.trim())),a.normalize=(...b)=>a.check(function(a){return fo(b=>b.normalize(a))}(...b)),a.toLowerCase=()=>a.check(fo(a=>a.toLowerCase())),a.toUpperCase=()=>a.check(fo(a=>a.toUpperCase())),a.slugify=()=>a.check(fo(a=>bR(a)))}),fM=bq("ZodStringFormat",(a,b)=>{dP.init(a,b),fL.init(a,b)}),fN=((a,b)=>{dS.init(a,b),fM.init(a,b)},bq("ZodNumber",(a,b)=>{eg.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>((a,b,c,d)=>{let{minimum:e,maximum:f,format:g,multipleOf:h,exclusiveMaximum:i,exclusiveMinimum:j}=a._zod.bag;"string"==typeof g&&g.includes("int")?c.type="integer":c.type="number","number"==typeof j&&("draft-04"===b.target||"openapi-3.0"===b.target?(c.minimum=j,c.exclusiveMinimum=!0):c.exclusiveMinimum=j),"number"==typeof e&&(c.minimum=e,"number"==typeof j&&"draft-04"!==b.target&&(j>=e?delete c.minimum:delete c.exclusiveMinimum)),"number"==typeof i&&("draft-04"===b.target||"openapi-3.0"===b.target?(c.maximum=i,c.exclusiveMaximum=!0):c.exclusiveMaximum=i),"number"==typeof f&&(c.maximum=f,"number"==typeof i&&"draft-04"!==b.target&&(i<=f?delete c.maximum:delete c.exclusiveMaximum)),"number"==typeof h&&(c.multipleOf=h)})(a,b,c,0),a.gt=(b,c)=>a.check(fi(b,c)),a.gte=(b,c)=>a.check(fj(b,c)),a.min=(b,c)=>a.check(fj(b,c)),a.lt=(b,c)=>a.check(fg(b,c)),a.lte=(b,c)=>a.check(fh(b,c)),a.max=(b,c)=>a.check(fh(b,c)),a.int=b=>a.check(fP(b)),a.safe=b=>a.check(fP(b)),a.positive=b=>a.check(fi(0,b)),a.nonnegative=b=>a.check(fj(0,b)),a.negative=b=>a.check(fg(0,b)),a.nonpositive=b=>a.check(fh(0,b)),a.multipleOf=(b,c)=>a.check(fk(b,c)),a.step=(b,c)=>a.check(fk(b,c)),a.finite=()=>a;let c=a._zod.bag;a.minValue=Math.max(c.minimum??-1/0,c.exclusiveMinimum??-1/0)??null,a.maxValue=Math.min(c.maximum??1/0,c.exclusiveMaximum??1/0)??null,a.isInt=(c.format??"").includes("int")||Number.isSafeInteger(c.multipleOf??.5),a.isFinite=!0,a.format=c.format??null})),fO=bq("ZodNumberFormat",(a,b)=>{eh.init(a,b),fN.init(a,b)});function fP(a){return new fO({type:"number",check:"number_format",abort:!1,format:"safeint",...b0(a)})}(a,b)=>{ej.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(a,b,c)=>((a,b,c,d)=>{if("throw"===b.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema")})(0,a,0,0),a.gte=(b,c)=>a.check(fj(b,c)),a.min=(b,c)=>a.check(fj(b,c)),a.gt=(b,c)=>a.check(fi(b,c)),a.gte=(b,c)=>a.check(fj(b,c)),a.min=(b,c)=>a.check(fj(b,c)),a.lt=(b,c)=>a.check(fg(b,c)),a.lte=(b,c)=>a.check(fh(b,c)),a.max=(b,c)=>a.check(fh(b,c)),a.positive=b=>a.check(fi(BigInt(0),b)),a.negative=b=>a.check(fg(BigInt(0),b)),a.nonpositive=b=>a.check(fh(BigInt(0),b)),a.nonnegative=b=>a.check(fj(BigInt(0),b)),a.multipleOf=(b,c)=>a.check(fk(b,c));let c=a._zod.bag;a.minValue=c.minimum??null,a.maxValue=c.maximum??null,a.format=c.format??null};(a,b)=>{ep.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(a,b,c)=>{}};(a,b)=>{eq.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(a,b,c)=>{b.not={}}};let fQ=bq("ZodArray",(a,b)=>{eu.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>((a,b,c,d)=>{let e=a._zod.def,{minimum:f,maximum:g}=a._zod.bag;"number"==typeof f&&(c.minItems=f),"number"==typeof g&&(c.maxItems=g),c.type="array",c.items=fq(e.element,b,{...d,path:[...d.path,"items"]})})(a,b,c,d),a.element=b.element,a.min=(b,c)=>a.check(fm(b,c)),a.nonempty=b=>a.check(fm(1,b)),a.max=(b,c)=>a.check(fl(b,c)),a.length=(b,c)=>a.check(fn(b,c)),a.unwrap=()=>a.element}),fR=bq("ZodUnion",(a,b)=>{eB.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{var e,f,g,h;let i,j,k;return e=a,f=b,g=c,h=d,j=!1===(i=e._zod.def).inclusive,k=i.options.map((a,b)=>fq(a,f,{...h,path:[...h.path,j?"oneOf":"anyOf",b]})),void(j?g.oneOf=k:g.anyOf=k)},a.options=b.options}),fS=bq("ZodIntersection",(a,b)=>{eF.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e,f,g,h;return f=fq((e=a._zod.def).left,b,{...d,path:[...d.path,"allOf",0]}),g=fq(e.right,b,{...d,path:[...d.path,"allOf",1]}),void(c.allOf=[...(h=a=>"allOf"in a&&1===Object.keys(a).length)(f)?f.allOf:[f],...h(g)?g.allOf:[g]])}}),fT=bq("ZodEnum",(a,b)=>{eO.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e;(e=bA(a._zod.def.entries)).every(a=>"number"==typeof a)&&(c.type="number"),e.every(a=>"string"==typeof a)&&(c.type="string"),c.enum=e},a.enum=b.entries,a.options=Object.values(b.entries);let c=new Set(Object.keys(b.entries));a.extract=(a,d)=>{let e={};for(let d of a)if(c.has(d))e[d]=b.entries[d];else throw Error(`Key ${d} not found in enum`);return new fT({...b,checks:[],...fw.normalizeParams(d),entries:e})},a.exclude=(a,d)=>{let e={...b.entries};for(let b of a)if(c.has(b))delete e[b];else throw Error(`Key ${b} not found in enum`);return new fT({...b,checks:[],...fw.normalizeParams(d),entries:e})}}),fU=bq("ZodTransform",(a,b)=>{eR.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(a,b,c)=>((a,b,c,d)=>{if("throw"===b.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema")})(0,a,0,0),a._zod.parse=(c,d)=>{if("backward"===d.direction)throw new bs(a.constructor.name);c.addIssue=d=>{"string"==typeof d?c.issues.push(fw.issue(d,c.value,b)):(d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=c.value),d.inst??(d.inst=a),c.issues.push(fw.issue(d)))};let e=b.transform(c.value,c);return e instanceof Promise?e.then(a=>(c.value=a,c)):(c.value=e,c)}}),fV=bq("ZodOptional",(a,b)=>{eT.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>fv(a,b,c,d),a.unwrap=()=>a._zod.def.innerType});function fW(a){return new fV({type:"optional",innerType:a})}let fX=bq("ZodExactOptional",(a,b)=>{eU.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>fv(a,b,c,d),a.unwrap=()=>a._zod.def.innerType}),fY=bq("ZodNullable",(a,b)=>{eV.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e,f,g;return f=fq((e=a._zod.def).innerType,b,d),g=b.seen.get(a),void("openapi-3.0"===b.target?(g.ref=e.innerType,c.nullable=!0):c.anyOf=[f,{type:"null"}])},a.unwrap=()=>a._zod.def.innerType});function fZ(a){return new fY({type:"nullable",innerType:a})}let f$=bq("ZodDefault",(a,b)=>{eW.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e;fq((e=a._zod.def).innerType,b,d),b.seen.get(a).ref=e.innerType,c.default=JSON.parse(JSON.stringify(e.defaultValue))},a.unwrap=()=>a._zod.def.innerType,a.removeDefault=a.unwrap}),f_=bq("ZodPrefault",(a,b)=>{eY.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e;fq((e=a._zod.def).innerType,b,d),b.seen.get(a).ref=e.innerType,"input"===b.io&&(c._prefault=JSON.parse(JSON.stringify(e.defaultValue)))},a.unwrap=()=>a._zod.def.innerType}),f0=bq("ZodNonOptional",(a,b)=>{eZ.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e;fq((e=a._zod.def).innerType,b,d),b.seen.get(a).ref=e.innerType},a.unwrap=()=>a._zod.def.innerType}),f1=bq("ZodCatch",(a,b)=>{e0.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>((a,b,c,d)=>{let e,f=a._zod.def;fq(f.innerType,b,d),b.seen.get(a).ref=f.innerType;try{e=f.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}c.default=e})(a,b,c,d),a.unwrap=()=>a._zod.def.innerType,a.removeCatch=a.unwrap}),f2=bq("ZodPipe",(a,b)=>{e2.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e,f;return e=a._zod.def,void(fq(f="input"===b.io?"transform"===e.in._zod.def.type?e.out:e.in:e.out,b,d),b.seen.get(a).ref=f)},a.in=b.in,a.out=b.out});function f3(a,b){return new f2({type:"pipe",in:a,out:b})}let f4=bq("ZodReadonly",(a,b)=>{e7.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(b,c,d)=>{let e;fq((e=a._zod.def).innerType,b,d),b.seen.get(a).ref=e.innerType,c.readOnly=!0},a.unwrap=()=>a._zod.def.innerType}),f5=bq("ZodCustom",(a,b)=>{fd.init(a,b),fK.init(a,b),a._zod.processJSONSchema=(a,b,c)=>((a,b,c,d)=>{if("throw"===b.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")})(0,a,0,0)});var f6=class extends Error{constructor(a,b){super(a,b),this.name="BetterAuthError",this.message=a,this.stack=""}};function f7(a,b="/api/auth"){try{let b=new URL(a);if("http:"!==b.protocol&&"https:"!==b.protocol)throw new f6(`Invalid base URL: ${a}. URL must include 'http://' or 'https://'`)}catch(b){if(b instanceof f6)throw b;throw new f6(`Invalid base URL: ${a}. Please provide a valid base URL.`,{cause:b})}if(function(a){try{return"/"!==(new URL(a).pathname.replace(/\/+$/,"")||"/")}catch{throw new f6(`Invalid base URL: ${a}. Please provide a valid base URL.`)}}(a))return a;let c=a.replace(/\/+$/,"");return b&&"/"!==b?(b=b.startsWith("/")?b:`/${b}`,`${c}${b}`):c}let f8={id:"redirect",name:"Redirect",hooks:{onSuccess(a){a.data?.url&&a.data?.redirect}}},f9={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},ga=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,gb={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},gc=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,gd=[],ge=0,gf=0,gg=a=>{let b=[],c={get:()=>(c.lc||c.listen(()=>{})(),c.value),lc:0,listen:a=>(c.lc=b.push(a),()=>{for(let b=ge+4;b<gd.length;)gd[b]===a?gd.splice(b,4):b+=4;let d=b.indexOf(a);~d&&(b.splice(d,1),--c.lc||c.off())}),notify(a,d){gf++;let e=!gd.length;for(let e of b)gd.push(e,c.value,a,d);if(e){for(ge=0;ge<gd.length;ge+=4)gd[ge](gd[ge+1],gd[ge+2],gd[ge+3]);gd.length=0}},off(){},set(a){let b=c.value;b!==a&&(c.value=a,c.notify(b))},subscribe(a){let b=c.listen(a);return a(c.value),b},value:a};return c},gh=()=>!0,gi=(a,b,c,d)=>{let e=gg({data:null,error:null,isPending:!0,isRefetching:!1,refetch:a=>f(a)}),f=async a=>new Promise(f=>{let g="function"==typeof d?d({data:e.get().data,error:e.get().error,isPending:e.get().isPending}):d;c(b,{...g,query:{...g?.query,...a?.query},async onSuccess(a){e.set({data:a.data,error:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await g?.onSuccess?.(a)},async onError(a){let{request:b}=a,c="number"==typeof b.retry?b.retry:b.retry?.attempts,d=b.retryAttempt||0;c&&d<c||(e.set({error:a.error,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await g?.onError?.(a))},async onRequest(a){let b=e.get();e.set({isPending:null===b.data,data:b.data,error:null,isRefetching:!0,refetch:e.value.refetch}),await g?.onRequest?.(a)}}).catch(a=>{e.set({error:a,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch})}).finally(()=>{f(void 0)})});for(let b of a=Array.isArray(a)?a:[a])b.subscribe(async()=>{if(gh())return});return e},gj=Symbol.for("better-auth:broadcast-channel");var gk=class{listeners=new Set;name;constructor(a="better-auth.message"){this.name=a}subscribe(a){return this.listeners.add(a),()=>{this.listeners.delete(a)}}post(a){}setup(){return()=>{}}};function gl(a="better-auth.message"){return globalThis[gj]||(globalThis[gj]=new gk(a)),globalThis[gj]}let gm=Symbol.for("better-auth:focus-manager");var gn=class{listeners=new Set;subscribe(a){return this.listeners.add(a),()=>{this.listeners.delete(a)}}setFocused(a){this.listeners.forEach(b=>b(a))}setup(){return()=>{}}};function go(){return globalThis[gm]||(globalThis[gm]=new gn),globalThis[gm]}let gp=Symbol.for("better-auth:online-manager");var gq=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(a){return this.listeners.add(a),()=>{this.listeners.delete(a)}}setOnline(a){this.isOnline=a,this.listeners.forEach(b=>b(a))}setup(){return()=>{}}};function gr(){return globalThis[gp]||(globalThis[gp]=new gq),globalThis[gp]}let gs=()=>Math.floor(Date.now()/1e3);function gt(a){if(null===a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.iterator in a)&&(!(Symbol.toStringTag in a)||"[object Module]"===Object.prototype.toString.call(a))}function gu(a){return(...b)=>b.reduce((b,c)=>(function a(b,c,d=".",e){if(!gt(c))return a(b,{},d,e);let f=Object.assign({},c);for(let c in b){if("__proto__"===c||"constructor"===c)continue;let g=b[c];null!=g&&(e&&e(f,c,g,d)||(Array.isArray(g)&&Array.isArray(f[c])?f[c]=[...g,...f[c]]:gt(g)&&gt(f[c])?f[c]=a(g,f[c],(d?`${d}.`:"")+c.toString(),e):f[c]=g))}return f})(b,c,"",a),{})}let gv=gu();gu((a,b,c)=>{if(void 0!==a[b]&&"function"==typeof c)return a[b]=c(a[b]),!0}),gu((a,b,c)=>{if(Array.isArray(a[b])&&"function"==typeof c)return a[b]=c(a[b]),!0});var gw=Object.defineProperty,gx=Object.defineProperties,gy=Object.getOwnPropertyDescriptors,gz=Object.getOwnPropertySymbols,gA=Object.prototype.hasOwnProperty,gB=Object.prototype.propertyIsEnumerable,gC=(a,b,c)=>b in a?gw(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,gD=(a,b)=>{for(var c in b||(b={}))gA.call(b,c)&&gC(a,c,b[c]);if(gz)for(var c of gz(b))gB.call(b,c)&&gC(a,c,b[c]);return a},gE=(a,b)=>gx(a,gy(b)),gF=class extends Error{constructor(a,b,c){super(b||a.toString(),{cause:c}),this.status=a,this.statusText=b,this.error=c,Error.captureStackTrace(this,this.constructor)}},gG=async(a,b)=>{var c,d,e,f,g,h;let i=b||{},j={onRequest:[null==b?void 0:b.onRequest],onResponse:[null==b?void 0:b.onResponse],onSuccess:[null==b?void 0:b.onSuccess],onError:[null==b?void 0:b.onError],onRetry:[null==b?void 0:b.onRetry]};if(!b||!(null==b?void 0:b.plugins))return{url:a,options:i,hooks:j};for(let k of(null==b?void 0:b.plugins)||[]){if(k.init){let d=await (null==(c=k.init)?void 0:c.call(k,a.toString(),b));i=d.options||i,a=d.url}j.onRequest.push(null==(d=k.hooks)?void 0:d.onRequest),j.onResponse.push(null==(e=k.hooks)?void 0:e.onResponse),j.onSuccess.push(null==(f=k.hooks)?void 0:f.onSuccess),j.onError.push(null==(g=k.hooks)?void 0:g.onError),j.onRetry.push(null==(h=k.hooks)?void 0:h.onRetry)}return{url:a,options:i,hooks:j}},gH=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(){return this.options.delay}},gI=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(a){return Math.min(this.options.maxDelay,this.options.baseDelay*2**a)}},gJ=async a=>{let b={},c=async a=>"function"==typeof a?await a():a;if(null==a?void 0:a.auth){if("Bearer"===a.auth.type){let d=await c(a.auth.token);if(!d)return b;b.authorization=`Bearer ${d}`}else if("Basic"===a.auth.type){let[d,e]=await Promise.all([c(a.auth.username),c(a.auth.password)]);if(!d||!e)return b;b.authorization=`Basic ${btoa(`${d}:${e}`)}`}else if("Custom"===a.auth.type){let[d,e]=await Promise.all([c(a.auth.prefix),c(a.auth.value)]);if(!e)return b;b.authorization=`${null!=d?d:""} ${e}`}}return b},gK=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function gL(a){if(void 0===a)return!1;let b=typeof a;return"string"===b||"number"===b||"boolean"===b||null===b||"object"===b&&(!!Array.isArray(a)||!a.buffer&&(a.constructor&&"Object"===a.constructor.name||"function"==typeof a.toJSON))}function gM(a){try{return JSON.parse(a)}catch(b){return a}}async function gN(a){let b=new Headers(null==a?void 0:a.headers);for(let[c,d]of Object.entries(await gJ(a)||{}))b.set(c,d);if(!b.has("content-type")){let c=gL(null==a?void 0:a.body)?"application/json":null;c&&b.set("content-type",c)}return b}var gO=class a extends Error{constructor(b,c){super(c||JSON.stringify(b,null,2)),this.issues=b,Object.setPrototypeOf(this,a.prototype)}};async function gP(a,b){let c=await a["~standard"].validate(b);if(c.issues)throw new gO(c.issues);return c.value}var gQ=["get","post","put","patch","delete"],gR=async(a,b)=>{var c,d,e,f,g,h,i,j;let k,{hooks:l,url:m,options:n}=await gG(a,b),o=function(a){if(null==a?void 0:a.customFetchImpl)return a.customFetchImpl;if("u">typeof globalThis&&"function"==typeof globalThis.fetch)return globalThis.fetch;throw Error("No fetch implementation found")}(n),p=new AbortController,q=null!=(c=n.signal)?c:p.signal,r=function(a,b){let{baseURL:c,params:d,query:e}=b||{query:{},params:{},baseURL:""},f=a.startsWith("http")?a.split("/").slice(0,3).join("/"):c||"";if(a.startsWith("@")){let b=a.toString().split("@")[1].split("/")[0];gQ.includes(b)&&(a=a.replace(`@${b}/`,"/"))}f.endsWith("/")||(f+="/");let[g,h]=a.replace(f,"").split("?"),i=new URLSearchParams(h);for(let[a,b]of Object.entries(e||{})){let c;if(null!=b){if("string"==typeof b)c=b;else if(Array.isArray(b)){for(let c of b)i.append(a,c);continue}else c=JSON.stringify(b);i.set(a,c)}}if(d)if(Array.isArray(d))for(let[a,b]of g.split("/").filter(a=>a.startsWith(":")).entries()){let c=d[a];g=g.replace(b,c)}else for(let[a,b]of Object.entries(d))g=g.replace(`:${a}`,String(b));(g=g.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(g=g.slice(1));let j=i.toString();return(j=j.length>0?`?${j}`.replace(/\+/g,"%20"):"",f.startsWith("http"))?new URL(`${g}${j}`,f):`${f}${g}${j}`}(m,n),s=function(a){if(!(null==a?void 0:a.body))return null;let b=new Headers(null==a?void 0:a.headers);if(gL(a.body)&&!b.has("content-type")){for(let[b,c]of Object.entries(null==a?void 0:a.body))c instanceof Date&&(a.body[b]=c.toISOString());return JSON.stringify(a.body)}return b.has("content-type")&&"application/x-www-form-urlencoded"===b.get("content-type")&&gL(a.body)?new URLSearchParams(a.body).toString():a.body}(n),t=await gN(n),u=function(a,b){var c;if(null==b?void 0:b.method)return b.method.toUpperCase();if(a.startsWith("@")){let d=null==(c=a.split("@")[1])?void 0:c.split("/")[0];return gQ.includes(d)?d.toUpperCase():(null==b?void 0:b.body)?"POST":"GET"}return(null==b?void 0:b.body)?"POST":"GET"}(m,n),v=gE(gD({},n),{url:r,headers:t,body:s,method:u,signal:q});for(let a of l.onRequest)if(a){let b=await a(v);"object"==typeof b&&null!==b&&(v=b)}("pipeTo"in v&&"function"==typeof v.pipeTo||"function"==typeof(null==(d=null==b?void 0:b.body)?void 0:d.pipe))&&!("duplex"in v)&&(v.duplex="half");let{clearTimeout:w}=(!(null==n?void 0:n.signal)&&(null==n?void 0:n.timeout)&&(k=setTimeout(()=>null==p?void 0:p.abort(),null==n?void 0:n.timeout)),{abortTimeout:k,clearTimeout:()=>{k&&clearTimeout(k)}}),x=await o(v.url,v);w();let y={response:x,request:v};for(let a of l.onResponse)if(a){let c=await a(gE(gD({},y),{response:(null==(e=null==b?void 0:b.hookOptions)?void 0:e.cloneResponse)?x.clone():x}));c instanceof Response?x=c:"object"==typeof c&&null!==c&&(x=c.response)}if(x.ok){if("HEAD"===v.method)return{data:"",error:null};let a=function(a){let b=a.headers.get("content-type"),c=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!b)return"json";let d=b.split(";").shift()||"";return gK.test(d)?"json":c.has(d)||d.startsWith("text/")?"text":"blob"}(x),c={data:null,response:x,request:v};if("json"===a||"text"===a){let a=await x.text(),b=null!=(f=v.jsonParser)?f:gM;c.data=await b(a)}else c.data=await x[a]();for(let a of((null==v?void 0:v.output)&&v.output&&!v.disableValidation&&(c.data=await gP(v.output,c.data)),l.onSuccess))a&&await a(gE(gD({},c),{response:(null==(g=null==b?void 0:b.hookOptions)?void 0:g.cloneResponse)?x.clone():x}));return(null==b?void 0:b.throw)?c.data:{data:c.data,error:null}}let z=null!=(h=null==b?void 0:b.jsonParser)?h:gM,A=await x.text(),B=function(a){try{return JSON.parse(a),!0}catch(a){return!1}}(A),C=B?await z(A):null,D={response:x,responseText:A,request:v,error:gE(gD({},C),{status:x.status,statusText:x.statusText})};for(let a of l.onError)a&&await a(gE(gD({},D),{response:(null==(i=null==b?void 0:b.hookOptions)?void 0:i.cloneResponse)?x.clone():x}));if(null==b?void 0:b.retry){let c=function(a){if("number"==typeof a)return new gH({type:"linear",attempts:a,delay:1e3});switch(a.type){case"linear":return new gH(a);case"exponential":return new gI(a);default:throw Error("Invalid retry strategy")}}(b.retry),d=null!=(j=b.retryAttempt)?j:0;if(await c.shouldAttemptRetry(d,x)){for(let a of l.onRetry)a&&await a(y);let e=c.getDelay(d);return await new Promise(a=>setTimeout(a,e)),await gR(a,gE(gD({},b),{retryAttempt:d+1}))}}if(null==b?void 0:b.throw)throw new gF(x.status,x.statusText,B?C:A);return{data:null,error:gE(gD({},C),{status:x.status,statusText:x.statusText})}};function gS(a){let b=new Uint8Array(a),c="";for(let a of b)c+=String.fromCharCode(a);return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function gT(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4,d=atob(b.padEnd(b.length+c,"=")),e=new ArrayBuffer(d.length),f=new Uint8Array(e);for(let a=0;a<d.length;a++)f[a]=d.charCodeAt(a);return e}function gU(){return gV.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}let gV={stubThis:a=>a};function gW(a){let{id:b}=a;return{...a,id:gT(b),transports:a.transports}}function gX(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}class gY extends Error{constructor({message:a,code:b,cause:c,name:d}){super(a,{cause:c}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=d??c.name,this.code=b}}let gZ=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}},g$=["cross-platform","platform"];function g_(a){if(a&&!(0>g$.indexOf(a)))return a}async function g0(a){let b,c,d,e,f;!a.optionsJSON&&a.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:g,useAutoRegister:h=!1}=a;if(!gU())throw Error("WebAuthn is not supported in this browser");let i={...g,challenge:gT(g.challenge),user:{...g.user,id:gT(g.user.id)},excludeCredentials:g.excludeCredentials?.map(gW)},j={};h&&(j.mediation="conditional"),j.publicKey=i,j.signal=gZ.createNewAbortSignal();try{b=await navigator.credentials.create(j)}catch(a){throw function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new gY({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if(c.authenticatorSelection?.requireResidentKey===!0)return new gY({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&c.authenticatorSelection?.userVerification==="required")return new gY({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if(c.authenticatorSelection?.userVerification==="required")return new gY({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new gY({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new gY({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new gY(0===c.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!gX(b))return new gY({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rp.id!==b)return new gY({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new gY({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new gY({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}({error:a,options:j})}if(!b)throw Error("Registration was not completed");let{id:k,rawId:l,response:m,type:n}=b;if("function"==typeof m.getTransports&&(d=m.getTransports()),"function"==typeof m.getPublicKeyAlgorithm)try{e=m.getPublicKeyAlgorithm()}catch(a){g1("getPublicKeyAlgorithm()",a)}if("function"==typeof m.getPublicKey)try{let a=m.getPublicKey();null!==a&&(f=gS(a))}catch(a){g1("getPublicKey()",a)}if("function"==typeof m.getAuthenticatorData)try{c=gS(m.getAuthenticatorData())}catch(a){g1("getAuthenticatorData()",a)}return{id:k,rawId:gS(l),response:{attestationObject:gS(m.attestationObject),clientDataJSON:gS(m.clientDataJSON),transports:d,publicKeyAlgorithm:e,publicKey:f,authenticatorData:c},type:n,clientExtensionResults:b.getClientExtensionResults(),authenticatorAttachment:g_(b.authenticatorAttachment)}}function g1(a,b){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${a}. You should report this error to them.
`,b)}let g2=a=>a;async function g3(a){let b,c,d;!a.optionsJSON&&a.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:e,useBrowserAutofill:f=!1,verifyBrowserAutofillInput:g=!0}=a;if(!gU())throw Error("WebAuthn is not supported in this browser");e.allowCredentials?.length!==0&&(b=e.allowCredentials?.map(gW));let h={...e,challenge:gT(e.challenge),allowCredentials:b},i={};if(f){if(!await function(){if(!gU())return g2(new Promise(a=>a(!1)));let a=globalThis.PublicKeyCredential;return a?.isConditionalMediationAvailable===void 0?g2(new Promise(a=>a(!1))):g2(a.isConditionalMediationAvailable())}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&g)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');i.mediation="conditional",h.allowCredentials=[]}i.publicKey=h,i.signal=gZ.createNewAbortSignal();try{c=await navigator.credentials.get(i)}catch(a){throw function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new gY({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new gY({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!gX(b))return new gY({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new gY({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new gY({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}({error:a,options:i})}if(!c)throw Error("Authentication was not completed");let{id:j,rawId:k,response:l,type:m}=c;return l.userHandle&&(d=gS(l.userHandle)),{id:j,rawId:gS(k),response:{authenticatorData:gS(l.authenticatorData),clientDataJSON:gS(l.clientDataJSON),signature:gS(l.signature),userHandle:d},type:m,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:g_(c.authenticatorAttachment)}}function g4(a){return{newRole:a=>{var b;return{authorize(a,c="AND"){let d=!1;for(let[e,f]of Object.entries(a)){let a=b[e];if(!a)return{success:!1,error:`You are not allowed to access resource: ${e}`};if(Array.isArray(f))d=f.every(b=>a.includes(b));else if("object"==typeof f)d="OR"===f.connector?f.actions.some(b=>a.includes(b)):f.actions.every(b=>a.includes(b));else throw new f6("Invalid access control request");if(d&&"OR"===c)return{success:d};if(!d&&"AND"===c)return{success:!1,error:`unauthorized to access resource "${e}"`}}return d?{success:d}:{success:!1,error:"Not authorized"}},statements:b=a}},statements:a}}let g5=g4({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]});g5.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),g5.newRole({user:[],session:[]});let g6=g4({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]});g6.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),g6.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),g6.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]});let g7=function(a){var b;let{pluginPathMethods:c,pluginsActions:d,pluginsAtoms:e,$fetch:f,$store:g,atomListeners:h}=((a,b)=>{var c,d,e,f;let g,h,i="credentials"in Request.prototype,j=function(a,b,c,d,e){if(a)return f7(a,b);if(!1!==d){let a=bd.BETTER_AUTH_URL||bd.NEXT_PUBLIC_BETTER_AUTH_URL||bd.PUBLIC_BETTER_AUTH_URL||bd.NUXT_PUBLIC_BETTER_AUTH_URL||bd.NUXT_PUBLIC_AUTH_URL||("/"!==bd.BASE_URL?bd.BASE_URL:void 0);if(a)return f7(a,b)}c?.headers.get("x-forwarded-host"),c?.headers.get("x-forwarded-proto");if(c){let a=function(a){try{let b=new URL(a);return"null"===b.origin?null:b.origin}catch{return null}}(c.url);if(!a)throw new f6("Could not get origin from request. Please provide a valid base URL.");return f7(a,b)}}(a?.baseURL,a?.basePath,void 0,b)??"/api/auth",k=a?.plugins?.flatMap(a=>a.fetchPlugins).filter(a=>void 0!==a)||[],l={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:a?.fetchOptions?.onSuccess,onError:a?.fetchOptions?.onError,onRequest:a?.fetchOptions?.onRequest,onResponse:a?.fetchOptions?.onResponse}},{onSuccess:m,onError:n,onRequest:o,onResponse:p,...q}=a?.fetchOptions||{},r=(c={baseURL:j,...i?{credentials:"include"}:{},method:"GET",jsonParser:a=>a?function(a,b={strict:!0}){return function(a,b={}){let{strict:c=!1,warnings:d=!1,reviver:e,parseDates:f=!0}=b;if("string"!=typeof a)return a;let g=a.trim();if(g.length>0&&'"'===g[0]&&g.endsWith('"')&&!g.slice(1,-1).includes('"'))return g.slice(1,-1);let h=g.toLowerCase();if(h.length<=9&&h in gb)return gb[h];if(!ga.test(g)){if(c)throw SyntaxError("[better-json] Invalid JSON");return a}if(Object.entries(f9).some(([a,b])=>{let c=b.test(g);return c&&d&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${a} pattern`),c})&&c)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(g,(a,b)=>{if("__proto__"===a||"constructor"===a&&b&&"object"==typeof b&&"prototype"in b){d&&console.warn(`[better-json] Dropping "${a}" key to prevent prototype pollution`);return}if(f&&"string"==typeof b){let a=function(a){let b=gc.exec(a);if(!b)return null;let[,c,d,e,f,g,h,i,j,k,l]=b,m=new Date(Date.UTC(parseInt(c,10),parseInt(d,10)-1,parseInt(e,10),parseInt(f,10),parseInt(g,10),parseInt(h,10),i?parseInt(i.padEnd(3,"0"),10):0));if(j){let a=(60*parseInt(k,10)+parseInt(l,10))*("+"===j?-1:1);m.setUTCMinutes(m.getUTCMinutes()+a)}return m instanceof Date&&!isNaN(m.getTime())?m:null}(b);if(a)return a}return e?e(a,b):b})}catch(b){if(c)throw b;return a}}(a,b)}(a,{strict:!1}):null,customFetchImpl:fetch,...q,plugins:[l,...q.plugins||[],...a?.disableDefaultFetchPlugins?[]:[f8],...k]},async function(a,b){let d,e=gE(gD(gD({},c),b),{plugins:[...(null==c?void 0:c.plugins)||[],(d=c||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(a,b){var c,e,f,g;let h=(null==(e=null==(c=d.plugins)?void 0:c.find(b=>{var c;return null!=(c=b.schema)&&!!c.config&&(a.startsWith(b.schema.config.baseURL||"")||a.startsWith(b.schema.config.prefix||""))}))?void 0:e.schema)||d.schema;if(h){let c=a;(null==(f=h.config)?void 0:f.prefix)&&c.startsWith(h.config.prefix)&&(c=c.replace(h.config.prefix,""),h.config.baseURL&&(a=a.replace(h.config.prefix,h.config.baseURL))),(null==(g=h.config)?void 0:g.baseURL)&&c.startsWith(h.config.baseURL)&&(c=c.replace(h.config.baseURL,""));let d=h.schema[c];if(d){let c=gE(gD({},b),{method:d.method,output:d.output});return(null==b?void 0:b.disableValidation)||(c=gE(gD({},c),{body:d.input?await gP(d.input,null==b?void 0:b.body):null==b?void 0:b.body,params:d.params?await gP(d.params,null==b?void 0:b.params):null==b?void 0:b.params,query:d.query?await gP(d.query,null==b?void 0:b.query):null==b?void 0:b.query})),{url:a,options:c}}}return{url:a,options:b}}}),...(null==b?void 0:b.plugins)||[]]});if(null==c?void 0:c.catchAllError)try{return await gR(a,e)}catch(a){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:a}}}return await gR(a,e)}),{$sessionSignal:s,session:t}=(h=gi(g=gg(!1),"/get-session",r,{method:"GET"}),d=()=>{let b=function(a){let{sessionAtom:b,sessionSignal:c,$fetch:d,options:e={}}=a,f=e.sessionOptions?.refetchInterval??0,g=e.sessionOptions?.refetchOnWindowFocus??!0,h=e.sessionOptions?.refetchWhenOffline??!1,i={lastSync:0,lastSessionRequest:0,cachedSession:void 0},j=a=>{if(!(h||gr().isOnline))return;if(a?.event==="storage"){i.lastSync=gs(),c.set(!c.get());return}let e=b.get();if(a?.event==="poll"){i.lastSessionRequest=gs(),d("/get-session").then(a=>{a.error?b.set({...e,data:null,error:a.error}):b.set({...e,data:a.data,error:null}),i.lastSync=gs(),c.set(!c.get())}).catch(()=>{});return}if(a?.event==="visibilitychange"){if(gs()-i.lastSessionRequest<5)return;i.lastSessionRequest=gs()}(e?.data===null||e?.data===void 0||a?.event==="visibilitychange")&&(i.lastSync=gs(),c.set(!c.get()))};return{init:()=>{f&&f>0&&(i.pollInterval=setInterval(()=>{b.get()?.data&&j({event:"poll"})},1e3*f)),i.unsubscribeBroadcast=gl().subscribe(()=>{j({event:"storage"})}),g&&(i.unsubscribeFocus=go().subscribe(()=>{j({event:"visibilitychange"})})),i.unsubscribeOnline=gr().subscribe(a=>{a&&j({event:"visibilitychange"})}),gl().setup(),go().setup(),gr().setup()},cleanup:()=>{i.pollInterval&&(clearInterval(i.pollInterval),i.pollInterval=void 0),i.unsubscribeBroadcast&&(i.unsubscribeBroadcast(),i.unsubscribeBroadcast=void 0),i.unsubscribeFocus&&(i.unsubscribeFocus(),i.unsubscribeFocus=void 0),i.unsubscribeOnline&&(i.unsubscribeOnline(),i.unsubscribeOnline=void 0),i.lastSync=0,i.lastSessionRequest=0,i.cachedSession=void 0},triggerRefetch:j,broadcastSessionUpdate:a=>{gl().post({event:"session",data:{trigger:a},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:h,sessionSignal:g,$fetch:r,options:a});return b.init(),()=>{b.cleanup()}},e=a=>{let b=d(a);b&&h.events[6].push(b)},f=a=>{let b=h.listen;h.listen=(...c)=>(h.lc||h.active||(h.active=!0,a()),b(...c));let c=h.off;return h.events[6]=[],h.off=()=>{c(),setTimeout(()=>{if(h.active&&!h.lc){for(let a of(h.active=!1,h.events[6]))a();h.events[6]=[]}},1e3)},()=>{h.listen=b,h.off=c}},h.events=h.events||{},h.events[15]||(h.events[15]=f(a=>{h.events[5].reduceRight((a,b)=>(b(a),a),{shared:{},...a})})),h.events[5]=h.events[5]||[],h.events[5].push(e),{session:h,$sessionSignal:g}),u=a?.plugins||[],v={},w={$sessionSignal:s,session:t},x={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},y=[{signal:"$sessionSignal",matcher:a=>"/sign-out"===a||"/update-user"===a||"/sign-up/email"===a||"/sign-in/email"===a||"/delete-user"===a||"/verify-email"===a||"/revoke-sessions"===a||"/revoke-session"===a||"/change-email"===a}];for(let a of u)a.getAtoms&&Object.assign(w,a.getAtoms?.(r)),a.pathMethods&&Object.assign(x,a.pathMethods),a.atomListeners&&y.push(...a.atomListeners);let z={notify:a=>{w[a].set(!w[a].get())},listen:(a,b)=>{w[a].subscribe(b)},atoms:w};for(let b of u)b.getActions&&(v=gv(b.getActions?.(r,z,a)??{},v));return{get baseURL(){return j},pluginsActions:v,pluginsAtoms:w,pluginPathMethods:x,atomListeners:y,$fetch:r,$store:z}})(a),i={};for(let[a,b]of Object.entries(e))i[function(a){return`use${a.charAt(0).toUpperCase()+a.slice(1)}`}(a)]=()=>(function(a,b={}){let c=(0,x.useRef)(a.get()),{keys:d,deps:e=[a,d]}=b,f=(0,x.useCallback)(b=>{let e=a=>{c.current!==a&&(c.current=a,b())};if(e(a.value),d?.length){let b;return b=new Set(d).add(void 0),a.listen((a,c,d)=>{b.has(d)&&e(a,c,d)})}return a.listen(e)},e),g=()=>c.current;return(0,x.useSyncExternalStore)(f,g,g)})(b);return b={...d,...i,$fetch:f,$store:g},function a(d=[]){return new Proxy(function(){},{get(c,e){var f;if("string"!=typeof e||"then"===e||"catch"===e||"finally"===e)return;let g=[...d,e],h=b;for(let a of g)if(h&&"object"==typeof h&&a in h)h=h[a];else{h=void 0;break}return"function"==typeof h?h:"object"==typeof(f=h)&&null!==f&&"get"in f&&"function"==typeof f.get&&"lc"in f&&"number"==typeof f.lc?h:a(g)},apply:async(a,b,g)=>{let i="/"+d.map(a=>a.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)).join("/"),j=g[0]||{},k=g[1]||{},{query:l,fetchOptions:m,...n}=j,o={...k,...m},p=function(a,b,c){let d=b[a],{fetchOptions:e,query:f,...g}=c||{};return d||(e?.method?e.method:g&&Object.keys(g).length>0?"POST":"GET")}(i,c,j);return await f(i,{...o,body:"GET"===p?void 0:{...n,...o?.body||{}},query:l||o?.query,method:p,async onSuccess(a){if(await o?.onSuccess?.(a),!h||o.disableSignal)return;let b=h.filter(a=>a.matcher(i));if(!b.length)return;let c=new Set;for(let a of b){let b=e[a.signal];if(!b)return;if(c.has(a.signal))continue;c.add(a.signal);let d=b.get();setTimeout(()=>{b.set(!d)},10)}}})}})}()}({baseURL:process.env.NEXT_PUBLIC_BETTER_AUTH_URL||"http://localhost:3000",plugins:[(i=gg(),{id:"passkey",$InferServerPlugin:{},getActions:(a,b)=>((a,{$listPasskeys:b,$store:c})=>({signIn:{passkey:async(d,e)=>{let f=await a("/passkey/generate-authenticate-options",{method:"GET",throw:!1});if(!f.data)return f;try{let g=await a("/passkey/verify-authentication",{body:{response:await g3({optionsJSON:f.data,useBrowserAutofill:d?.autoFill})},...d?.fetchOptions,...e,method:"POST",throw:!1});return b.set(Math.random()),c.notify("$sessionSignal"),g}catch(a){return console.error("[Better Auth] Error verifying passkey",a),{data:null,error:{code:"AUTH_CANCELLED",message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(c,d)=>{let e=await a("/passkey/generate-register-options",{method:"GET",query:{...c?.authenticatorAttachment&&{authenticatorAttachment:c.authenticatorAttachment},...c?.name&&{name:c.name}},throw:!1});if(!e.data)return e;try{let f=await g0({optionsJSON:e.data,useAutoRegister:c?.useAutoRegister}),g=await a("/passkey/verify-registration",{...c?.fetchOptions,...d,body:{response:f,name:c?.name},method:"POST",throw:!1});if(!g.data)return g;return b.set(Math.random()),g}catch(a){if(a instanceof gY){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===a.code)return{data:null,error:{code:a.code,message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===a.code)return{data:null,error:{code:a.code,message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{code:a.code,message:a.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{code:"UNKNOWN_ERROR",message:a instanceof Error?a.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}))(a,{$listPasskeys:i,$store:b}),getAtoms:a=>({listPasskeys:gi(i,"/passkey/list-user-passkeys",a,{method:"GET"}),$listPasskeys:i}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:a=>"/passkey/verify-registration"===a||"/passkey/delete-passkey"===a||"/passkey/update-passkey"===a||"/sign-out"===a,signal:"$listPasskeys"},{matcher:a=>"/passkey/verify-authentication"===a,signal:"$sessionSignal"}]}),{id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST","/delete-anonymous-user":"POST"},atomListeners:[{matcher:a=>"/sign-in/anonymous"===a,signal:"$sessionSignal"}]}]}),{signIn:g8,signUp:g9,useSession:ha,signOut:hb}=g7,hc=({onLogin:a,tenantName:b})=>{let[c,d]=(0,x.useState)("choice"),[e,f]=(0,x.useState)(""),[g,h]=(0,x.useState)("male"),[i,j]=(0,x.useState)(""),[k,l]=(0,x.useState)(null),m=async()=>{l(null),d("loading");try{console.log("[Passkey] Starting authentication...");let{data:a,error:b}=await g7.signIn.passkey();b&&(console.error("[Passkey] Login error:",b),404===b.status||"PASSKEY_NOT_FOUND"===b.code?l("Nessuna Passkey trovata per questo dispositivo. Registrati prima!"):l(b.message||"Errore durante l'accesso"),d("choice"))}catch(a){console.error("[Passkey] Unexpected login error:",a),"NotAllowedError"===a.name?l("L'operazione non  permessa in questo contesto. Assicurati di usare 'localhost' o HTTPS per accedere alla chat."):l(a.message||"Errore inaspettato"),d("choice")}},n=async a=>{if(a.preventDefault(),e.trim()&&i.trim()){l(null),d("loading");try{localStorage.setItem("waiting_for_passkey","true");let{data:a,error:b}=await g7.signIn.anonymous();if(b){localStorage.removeItem("waiting_for_passkey"),l(b.message||"Errore durante l'inizializzazione"),d("passkey_reg");return}let{error:c}=await g7.updateUser({name:e.trim(),phoneNumber:i.trim(),gender:g});c&&console.warn("Profile update failed, continuing with passkey",c),console.log("[Passkey] Starting biometric registration...");let{data:f,error:h}=await g7.passkey.addPasskey({name:"Passkey Principale"});h?(console.error("[Passkey] Registration error:",h),localStorage.removeItem("waiting_for_passkey"),l(h.message||"Errore durante la registrazione biometrica"),d("passkey_reg")):(console.log("[Passkey] Registration successful!"),await g7.updateUser({isAnonymous:!1}),localStorage.removeItem("waiting_for_passkey"),setTimeout(()=>{window.location.reload()},500))}catch(a){console.error("[Passkey] Unexpected error:",a),localStorage.removeItem("waiting_for_passkey"),"NotAllowedError"===a.name?l("L'operazione non  permessa in questo contesto. Assicurati di usare 'localhost' o HTTPS per accedere alla chat."):l(a.message||"Errore inaspettato"),d("passkey_reg")}}},o={male:"Maschio",female:"Femmina",other:"Altro"};return"loading"===c?(0,w.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col items-center justify-center",children:[(0,w.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mb-4"}),(0,w.jsx)("p",{className:"text-gray-500",children:"In attesa..."})]}):(0,w.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col justify-center",children:[(0,w.jsxs)("div",{className:"text-center mb-8",children:[(0,w.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 flex items-center justify-center",children:(0,w.jsx)("img",{src:"/local_logo.svg",alt:"Local Logo",className:"w-full h-full object-contain"})}),(0,w.jsx)("h1",{className:"text-2xl font-bold text-gray-800 tracking-tight",children:b}),"choice"===c&&(0,w.jsx)("p",{className:"text-gray-500 mt-2 text-sm",children:"chatta in modo anonimo o crea un profilo sicuro"})]}),k&&(0,w.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-100 text-red-600 text-sm rounded-xl text-center",children:k}),"choice"===c&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("button",{onClick:()=>d("anonymous"),className:"w-full bg-white hover:bg-gray-50 text-gray-700 font-semibold py-4 rounded-xl border border-gray-200 transition-all flex items-center justify-center gap-2",children:"Accesso anonimo"}),(0,w.jsxs)("div",{className:"relative py-2",children:[(0,w.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,w.jsx)("div",{className:"w-full border-t border-gray-100"})}),(0,w.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,w.jsx)("span",{className:"bg-white px-2 text-gray-400",children:"Oppure"})})]}),(0,w.jsx)("button",{onClick:m,className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2",children:"Accedi con Passkey"}),(0,w.jsx)("button",{onClick:()=>d("passkey_reg"),className:"w-full text-emerald-600 font-semibold text-sm hover:underline py-2",children:"Non hai un account? Registrati con Passkey"})]}),"anonymous"===c&&(0,w.jsxs)("form",{onSubmit:b=>{b.preventDefault(),e.trim()&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),a({id:`guest_${Math.random().toString(36).substr(2,9)}`,alias:e.trim(),gender:g,joinedAt:Date.now()}))},className:"space-y-6",children:[(0,w.jsx)("button",{onClick:()=>d("choice"),className:"text-gray-400 text-sm flex items-center gap-1 hover:text-gray-600 mb-2",children:" Torna indietro"}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Alias"}),(0,w.jsx)("input",{type:"text",required:!0,maxLength:20,value:e,onChange:a=>f(a.target.value),placeholder:"es. ShadowHunter",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Identit di Genere"}),(0,w.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(a=>(0,w.jsx)("button",{type:"button",onClick:()=>h(a),className:`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${g===a?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"}`,children:o[a]},a))})]}),(0,w.jsx)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200",children:"Entra nella Stanza"})]}),"passkey_reg"===c&&(0,w.jsxs)("form",{onSubmit:n,className:"space-y-6",children:[(0,w.jsx)("button",{onClick:()=>d("choice"),className:"text-gray-400 text-sm flex items-center gap-1 hover:text-gray-600 mb-2",children:" Torna indietro"}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Scegli un Alias"}),(0,w.jsx)("input",{type:"text",required:!0,maxLength:20,value:e,onChange:a=>f(a.target.value),placeholder:"es. MarcoPass",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cellulare (per il recupero)"}),(0,w.jsx)("input",{type:"tel",required:!0,value:i,onChange:a=>j(a.target.value),placeholder:"+39 333 1234567",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-gray-800"})]}),(0,w.jsx)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-200 flex items-center justify-center gap-2",children:"Crea Account con Passkey"}),(0,w.jsx)("p",{className:"text-[11px] text-gray-400 leading-relaxed",children:"Il tuo numero verr utilizzato esclusivamente per permetterti di recuperare l'accesso in caso di smarrimento del dispositivo."})]}),(0,w.jsx)("p",{className:"text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest",children:"Powered by Local - Copyright 2025"})]})};var hd=a.i(35112);function he(a){a()}function hf(a,b){return c=>a(b(c))}function hg(a){return void 0!==a}function hh(){}function hi(a,b){return b(a)}function hj(...a){return a}function hk(a){a(2)}function hl(a){return a(4)}function hm(a,b){return a(1,a=>b(0,a))}function hn(a,b){let c=a(1,a=>{c(),b(a)});return c}function ho(a){let b,c;return d=>e=>{b=e,c&&clearTimeout(c),c=setTimeout(()=>{d(b)},a)}}function hp(a,b){return a===b}function hq(a=hp){let b;return c=>d=>{a(b,d)||(b=d,c(d))}}function hr(a){return b=>c=>{a(c)&&b(c)}}function hs(a){return b=>hf(b,a)}function ht(a){return b=>()=>{b(a)}}function hu(a,...b){let c=function(...a){return b=>a.reduceRight(hi,b)}(...b);return(b,d)=>{switch(b){case 2:hk(a);return;case 1:return a(1,c(d))}}}function hv(a,b){return c=>d=>{c(b=a(b,d))}}function hw(a){return b=>c=>{a>0?a--:b(c)}}function hx(a){let b=null,c;return d=>e=>{b=e,c||(c=setTimeout(()=>{c=void 0,d(b)},a))}}function hy(...a){let b=Array(a.length),c=0,d=null,e=Math.pow(2,a.length)-1;return a.forEach((a,f)=>{let g=Math.pow(2,f);a(1,a=>{let h=c;c|=g,b[f]=a,h!==e&&c===e&&d&&(d(),d=null)})}),a=>f=>{let g=()=>{a([f].concat(b))};c===e?g():d=g}}function hz(a){let b=a,c=hB();return(a,d)=>{switch(a){case 0:b=d;break;case 1:d(b);break;case 4:return b}return c(a,d)}}function hA(a,b){var c;return c=hz(b),hm(a,c),c}function hB(){let a=[];return(b,c)=>{switch(b){case 0:a.slice().forEach(a=>{a(c)});return;case 2:a.splice(0,a.length);return;case 1:return a.push(c),()=>{let b=a.indexOf(c);b>-1&&a.splice(b,1)}}}}function hC(a){var b;return b=hB(),hm(a,b),b}function hD(a,b=[],{singleton:c}={singleton:!0}){return{constructor:a,dependencies:b,id:hE(),singleton:c}}let hE=()=>Symbol();function hF(...a){let b=hB(),c=Array(a.length),d=0,e=Math.pow(2,a.length)-1;return a.forEach((a,f)=>{let g=Math.pow(2,f);a(1,a=>{c[f]=a,(d|=g)===e&&b(0,c)})}),function(a,f){switch(a){case 2:return void hk(b);case 1:return d===e&&f(c),b(1,f)}}}function hG(a,b=hp){return hu(a,hq(b))}function hH(...a){return function(b,c){switch(b){case 2:return;case 1:return function(...a){return()=>{a.map(he)}}(...a.map(a=>a(1,c)))}}}var hI=((j=hI||{})[j.DEBUG=0]="DEBUG",j[j.INFO=1]="INFO",j[j.WARN=2]="WARN",j[j.ERROR=3]="ERROR",j);let hJ={0:"debug",3:"error",1:"log",2:"warn"},hK=hD(()=>{let a=hz(3);return{log:hz((b,c,d=1)=>{var e;d>=(null!=(e=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?e:hl(a))&&console[hJ[d]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",b,c)}),logLevel:a}},[],{singleton:!0});function hL(a,b,c){return hM(a,b,c).callbackRef}function hM(a,b,c){let d=x.default.useRef(null),e=x.default.useMemo(()=>"u">typeof ResizeObserver?new ResizeObserver(b=>{let d=()=>{let c=b[0].target;null!==c.offsetParent&&a(c)};c?d():requestAnimationFrame(d)}):null,[a,c]);return{callbackRef:a=>{a&&b?(null==e||e.observe(a),d.current=a):(d.current&&(null==e||e.unobserve(d.current)),d.current=null)},ref:d}}function hN(a,b,c,d,e,f,g,h,i){return hM(x.default.useCallback(c=>{let i,j=function(a,b,c,d){let e=a.length;if(0===e)return null;let f=[];for(let g=0;g<e;g++){let e=a.item(g);if(void 0===e.dataset.index)continue;let h=parseInt(e.dataset.index),i=parseFloat(e.dataset.knownSize),j=b(e,c);if(0===j&&d("Zero-sized element, this should not happen",{child:e},hI.ERROR),j===i)continue;let k=f[f.length-1];0===f.length||k.size!==j||k.endIndex!==h-1?f.push({endIndex:h,size:j,startIndex:h}):f[f.length-1].endIndex++}return f}(c.children,b,h?"offsetWidth":"offsetHeight",e),k=c.parentElement;for(;!k.dataset.virtuosoScroller;)k=k.parentElement;let l="window"===k.lastElementChild.dataset.viewportType;l&&(i=k.ownerDocument.defaultView);let m=g?h?g.scrollLeft:g.scrollTop:l?h?i.scrollX||i.document.documentElement.scrollLeft:i.scrollY||i.document.documentElement.scrollTop:h?k.scrollLeft:k.scrollTop;d({scrollHeight:g?h?g.scrollWidth:g.scrollHeight:l?h?i.document.documentElement.scrollWidth:i.document.documentElement.scrollHeight:h?k.scrollWidth:k.scrollHeight,scrollTop:Math.max(m,0),viewportHeight:g?h?g.offsetWidth:g.offsetHeight:l?h?i.innerWidth:i.innerHeight:h?k.offsetWidth:k.offsetHeight}),null==f||f(h?hO("column-gap",getComputedStyle(c).columnGap,e):hO("row-gap",getComputedStyle(c).rowGap,e)),null!==j&&a(j)},[a,b,e,f,g,d,h]),c,i)}function hO(a,b,c){return"normal"===b||null!=b&&b.endsWith("px")||c(`${a} was not resolved to pixel value correctly`,b,hI.WARN),"normal"===b?0:parseInt(null!=b?b:"0",10)}function hP(a,b,c){let d=x.default.useRef(null),e=x.default.useCallback(c=>{let e,f;if(!(null!=c&&c.offsetParent))return;let h=c.getBoundingClientRect(),i=h.width;if(b){let a=b.getBoundingClientRect(),c=h.top-a.top;f=a.height-Math.max(0,c),e=c+b.scrollTop}else{let a=g.current.ownerDocument.defaultView;f=a.innerHeight-Math.max(0,h.top),e=h.top+a.scrollY}d.current={offsetTop:e,visibleHeight:f,visibleWidth:i},a(d.current)},[a,b]),{callbackRef:f,ref:g}=hM(e,!0,c),h=x.default.useCallback(()=>{e(g.current)},[e,g]);return x.default.useEffect(()=>{var a;if(b){b.addEventListener("scroll",h);let a=new ResizeObserver(()=>{requestAnimationFrame(h)});return a.observe(b),()=>{b.removeEventListener("scroll",h),a.unobserve(b)}}{let b=null==(a=g.current)?void 0:a.ownerDocument.defaultView;return null==b||b.addEventListener("scroll",h),null==b||b.addEventListener("resize",h),()=>{null==b||b.removeEventListener("scroll",h),null==b||b.removeEventListener("resize",h)}}},[h,b,g]),f}let hQ=hD(()=>{let a=hB(),b=hB(),c=hz(0),d=hB(),e=hz(0),f=hB(),g=hB(),h=hz(0),i=hz(0),j=hz(0),k=hz(0),l=hB(),m=hB(),n=hz(!1),o=hz(!1),p=hz(!1);return hm(hu(a,hs(({scrollTop:a})=>a)),b),hm(hu(a,hs(({scrollHeight:a})=>a)),g),hm(b,e),{deviation:c,fixedFooterHeight:j,fixedHeaderHeight:i,footerHeight:k,headerHeight:h,horizontalDirection:o,scrollBy:m,scrollContainerState:a,scrollHeight:g,scrollingInProgress:n,scrollTo:l,scrollTop:b,skipAnimationFrameInResizeObserver:p,smoothScrollTargetReached:d,statefulScrollTop:e,viewportHeight:f}},[],{singleton:!0}),hR={lvl:0};function hS(a,b){let c=a.length;if(0===c)return[];let{index:d,value:e}=b(a[0]),f=[];for(let g=1;g<c;g++){let{index:c,value:h}=b(a[g]);f.push({end:c-1,start:d,value:e}),d=c,e=h}return f.push({end:1/0,start:d,value:e}),f}function hT(a){return a===hR}function hU(a,b){if(!hT(a))return b===a.k?a.v:b<a.k?hU(a.l,b):hU(a.r,b)}function hV(a,b,c="k"){if(hT(a))return[-1/0,void 0];if(Number(a[c])===b)return[a.k,a.v];if(Number(a[c])<b){let d=hV(a.r,b,c);return d[0]===-1/0?[a.k,a.v]:d}return hV(a.l,b,c)}function hW(a,b,c){return hT(a)?h0(b,c,1):b===a.k?h$(a,{k:b,v:c}):b<a.k?h2(h1(h$(a,{l:hW(a.l,b,c)}))):h2(h1(h$(a,{r:hW(a.r,b,c)})))}function hX(a,b,c){if(hT(a))return[];let d=hV(a,b)[0];return hS(function a(b,c,d){if(hT(b))return[];let{k:e,l:f,r:g,v:h}=b,i=[];return e>c&&(i=i.concat(a(f,c,d))),e>=c&&e<=d&&i.push({k:e,v:h}),e<=d&&(i=i.concat(a(g,c,d))),i}(a,d,c),({k:a,v:b})=>({index:a,value:b}))}function hY(a){return hT(a)?[]:[...hY(a.l),{k:a.k,v:a.v},...hY(a.r)]}function hZ(a){let{l:b,lvl:c,r:d}=a;if(d.lvl>=c-1&&b.lvl>=c-1)return a;if(c>d.lvl+1){if(h_(b))return h1(h$(a,{lvl:c-1}));if(!hT(b)&&!hT(b.r))return h$(b.r,{l:h$(b,{r:b.r.l}),lvl:c,r:h$(a,{l:b.r.r,lvl:c-1})});throw Error("Unexpected empty nodes")}if(h_(a))return h2(h$(a,{lvl:c-1}));if(hT(d)||hT(d.l))throw Error("Unexpected empty nodes");{let b=d.l,e=h_(b)?d.lvl-1:d.lvl;return h$(b,{l:h$(a,{lvl:c-1,r:b.l}),lvl:b.lvl+1,r:h2(h$(d,{l:b.r,lvl:e}))})}}function h$(a,b){return h0(void 0!==b.k?b.k:a.k,void 0!==b.v?b.v:a.v,void 0!==b.lvl?b.lvl:a.lvl,void 0!==b.l?b.l:a.l,void 0!==b.r?b.r:a.r)}function h_(a){return hT(a)||a.lvl>a.r.lvl}function h0(a,b,c,d=hR,e=hR){return{k:a,l:d,lvl:c,r:e,v:b}}function h1(a){let{l:b}=a;return hT(b)||b.lvl!==a.lvl?a:h$(b,{r:h$(a,{l:b.r})})}function h2(a){let{lvl:b,r:c}=a;return hT(c)||hT(c.r)||c.lvl!==b||c.r.lvl!==b?a:h$(c,{l:h$(a,{r:c.l}),lvl:b+1})}function h3(a,b){return!!(a&&a.startIndex===b.startIndex&&a.endIndex===b.endIndex)}function h4(a,b){return!!(a&&a[0]===b[0]&&a[1]===b[1])}let h5=hD(()=>({recalcInProgress:hz(!1)}),[],{singleton:!0});function h6(a,b,c,d=0){let e=a.length-1;for(;d<=e;){let f=Math.floor((d+e)/2),g=c(a[f],b);if(0===g)return f;if(-1===g){if(e-d<2)return f-1;e=f-1}else{if(e===d)return f;d=f+1}}throw Error(`Failed binary finding record in array - ${a.join(",")}, searched for ${b}`)}function h7(a,b){return Math.round(a.getBoundingClientRect()[b])}function h8(a){return!hT(a.groupOffsetTree)}function h9({index:a},b){return b===a?0:b<a?-1:1}function ia({offset:a},b){return b===a?0:b<a?-1:1}function ib(a,b,c){if(0===b.length)return 0;let{index:d,offset:e,size:f}=b[h6(b,a,h9)],g=a-d,h=f*g+(g-1)*c+e;return h>0?h+c:h}function ic(a,b){if(!h8(b))return a;let c=0;for(;b.groupIndices[c]<=a+c;)c++;return a+c}function id(a,b,c){if("u">typeof a.groupIndex)return b.groupIndices[a.groupIndex]+1;{let d=ic("LAST"===a.index?c:a.index,b);return Math.max(0,d,Math.min(c,d))}}function ie(a,[b,c,d,e]){b.length>0&&d("received item sizes",b,hI.DEBUG);let f=a.sizeTree,g=f,h=0;if(c.length>0&&hT(f)&&2===b.length){let a=b[0].size,d=b[1].size;g=c.reduce((b,c)=>hW(hW(b,c,a),c+1,d),g)}else[g,h]=function(a,b){let c=hT(a)?0:1/0;for(let d of b){let{endIndex:b,size:e,startIndex:f}=d;if(c=Math.min(c,f),hT(a)){a=hW(a,0,e);continue}let g=hX(a,f-1,b+1);if(g.some(function(a){let{endIndex:b,size:c,startIndex:d}=a;return a=>a.start===d&&(a.end===b||a.end===1/0)&&a.value===c}(d)))continue;let h=!1,i=!1;for(let{end:c,start:d,value:f}of g)h?(b>=d||e===f)&&(a=function a(b,c){if(hT(b))return hR;let{k:d,l:e,r:f}=b;if(c!==d)return c<d?hZ(h$(b,{l:a(e,c)})):hZ(h$(b,{r:a(f,c)}));if(hT(e))return f;if(hT(f))return e;{let[a,c]=function a(b){return hT(b.r)?[b.k,b.v]:a(b.r)}(e);return hZ(h$(b,{k:a,l:function a(b){return hT(b.r)?b.l:hZ(h$(b,{r:a(b.r)}))}(e),v:c}))}}(a,d)):(i=f!==e,h=!0),c>b&&b>=d&&f!==e&&(a=hW(a,b+1,f));i&&(a=hW(a,f,e))}return[a,c]}(g,b);if(g===f)return a;let{lastIndex:i,lastOffset:j,lastSize:k,offsetTree:l}=ih(a.offsetTree,h,g,e);return{groupIndices:c,groupOffsetTree:c.reduce((a,b)=>hW(a,b,ib(b,l,e)),hR),lastIndex:i,lastOffset:j,lastSize:k,offsetTree:l,sizeTree:g}}function ig(a,b){let c=0,d=0;for(;c<a;)c+=b[d+1]-b[d]-1,d++;return d-(c!==a)}function ih(a,b,c,d){let e=a,f=0,g=0,h=0,i=0;if(0!==b){i=h6(e,b-1,h9),h=e[i].offset;let a=hV(c,b-1);f=a[0],g=a[1],e.length&&e[i].size===hV(c,b)[1]&&(i-=1),e=e.slice(0,i+1)}else e=[];for(let{start:a,value:i}of hX(c,b,1/0)){let b=a-f,c=b*g+h+b*d;e.push({index:a,offset:c,size:i}),f=a,h=c,g=i}return{lastIndex:f,lastOffset:h,lastSize:g,offsetTree:e}}function ii(a){return{index:a.index,value:a}}let ij={offsetHeight:"height",offsetWidth:"width"},ik=hD(([{log:a},{recalcInProgress:b}])=>{let c=hB(),d=hB(),e=hA(d,0),f=hB(),g=hB(),h=hz(0),i=hz([]),j=hz(void 0),k=hz(void 0),l=hz(void 0),m=hz(void 0),n=hz((a,b)=>h7(a,ij[b])),o=hz(void 0),p=hz(0),q={groupIndices:[],groupOffsetTree:hR,lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:hR},r=hA(hu(c,hy(i,a,p),hv(ie,q),hq()),q),s=hA(hu(i,hq(),hv((a,b)=>({current:b,prev:a.current}),{current:[],prev:[]}),hs(({prev:a})=>a)),[]);hm(hu(i,hr(a=>a.length>0),hy(r,p),hs(([a,b,c])=>{let d=a.reduce((a,d,e)=>hW(a,d,ib(d,b.offsetTree,c)||e),hR);return{...b,groupIndices:a,groupOffsetTree:d}})),r),hm(hu(d,hy(r),hr(([a,{lastIndex:b}])=>a<b),hs(([a,{lastIndex:b,lastSize:c}])=>[{endIndex:b,size:c,startIndex:a}])),c),hm(j,k);let t=hA(hu(j,hs(a=>void 0===a)),!0);hm(hu(k,hr(a=>void 0!==a&&hT(hl(r).sizeTree)),hs(a=>{let b=hl(l),c=hl(i).length>0;return b?c?[{endIndex:0,size:b,startIndex:0},{endIndex:1,size:a,startIndex:1}]:[]:[{endIndex:0,size:a,startIndex:0}]})),c),hm(hu(m,hr(a=>void 0!==a&&a.length>0&&hT(hl(r).sizeTree)),hs(a=>{let b=[],c=a[0],d=0;for(let e=1;e<a.length;e++){let f=a[e];f!==c&&(b.push({endIndex:e-1,size:c,startIndex:d}),c=f,d=e)}return b.push({endIndex:a.length-1,size:c,startIndex:d}),b})),c),hm(hu(i,hy(l,k),hr(([,a,b])=>void 0!==a&&void 0!==b),hs(([a,b,c])=>{let d=[];for(let e=0;e<a.length;e++){let f=a[e],g=a[e+1];d.push({startIndex:f,endIndex:f,size:b}),void 0!==g&&d.push({startIndex:f+1,endIndex:g-1,size:c})}return d})),c);let u=hC(hu(c,hy(r),hv(({sizes:a},[b,c])=>({changed:c!==a,sizes:c}),{changed:!1,sizes:q}),hs(a=>a.changed)));hu(h,hv((a,b)=>({diff:a.prev-b,prev:b}),{diff:0,prev:0}),hs(a=>a.diff))(1,a=>{let{groupIndices:c}=hl(r);if(a>0)b(0,!0),f(0,a+ig(a,c));else if(a<0){let b=hl(s);b.length>0&&(a-=ig(-a,b)),g(0,a)}}),hu(h,hy(a))(1,([a,b])=>{a<0&&b("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:h},hI.ERROR)});let v=hC(f);hm(hu(f,hy(r),hs(([a,b])=>{let c=b.groupIndices.length>0,d=[],e=b.lastSize;if(c){let c=hU(b.sizeTree,0),f=0,g=0;for(;f<a;){let a=b.groupIndices[g],h=b.groupIndices.length===g+1?1/0:b.groupIndices[g+1]-a-1;d.push({endIndex:a,size:c,startIndex:a}),d.push({endIndex:a+1+h-1,size:e,startIndex:a+1}),g++,f+=h+1}let h=hY(b.sizeTree);return f!==a&&h.shift(),h.reduce((b,{k:c,v:d})=>{let e=b.ranges;return 0!==b.prevSize&&(e=[...b.ranges,{endIndex:c+a-1,size:b.prevSize,startIndex:b.prevIndex}]),{prevIndex:c+a,prevSize:d,ranges:e}},{prevIndex:a,prevSize:0,ranges:d}).ranges}return hY(b.sizeTree).reduce((b,{k:c,v:d})=>({prevIndex:c+a,prevSize:d,ranges:[...b.ranges,{endIndex:c+a-1,size:b.prevSize,startIndex:b.prevIndex}]}),{prevIndex:0,prevSize:e,ranges:[]}).ranges})),c);let w=hC(hu(g,hy(r,p),hs(([a,{offsetTree:b},c])=>ib(-a,b,c))));return hm(hu(g,hy(r,p),hs(([a,b,c])=>{if(b.groupIndices.length>0){if(hT(b.sizeTree))return b;let d=hR,e=hl(s),f=0,g=0,h=0;for(;f<-a;){h=e[g];let a=e[g+1]-h-1;g++,f+=a+1}return d=hY(b.sizeTree).reduce((b,{k:c,v:d})=>hW(b,Math.max(0,c+a),d),d),f!==-a&&(d=hW(d,0,hU(b.sizeTree,h)),d=hW(d,1,hV(b.sizeTree,-a+1)[1])),{...b,sizeTree:d,...ih(b.offsetTree,0,d,c)}}{let d=hY(b.sizeTree).reduce((b,{k:c,v:d})=>hW(b,Math.max(0,c+a),d),hR);return{...b,sizeTree:d,...ih(b.offsetTree,0,d,c)}}})),r),{beforeUnshiftWith:v,data:o,defaultItemSize:k,firstItemIndex:h,fixedItemSize:j,fixedGroupSize:l,gap:p,groupIndices:i,heightEstimates:m,itemSize:n,listRefresh:u,shiftWith:g,shiftWithOffset:w,sizeRanges:c,sizes:r,statefulTotalCount:e,totalCount:d,trackItemSizes:t,unshiftWith:f}},hj(hK,h5),{singleton:!0});function il(a){return a.reduce((a,b)=>(a.groupIndices.push(a.totalCount),a.totalCount+=b+1,a),{groupIndices:[],totalCount:0})}let im=hD(([{groupIndices:a,sizes:b,totalCount:c},{headerHeight:d,scrollTop:e}])=>{let f=hB(),g=hB(),h=hC(hu(f,hs(il)));return hm(hu(h,hs(a=>a.totalCount)),c),hm(hu(h,hs(a=>a.groupIndices)),a),hm(hu(hF(e,b,d),hr(([a,b])=>h8(b)),hs(([a,b,c])=>hV(b.groupOffsetTree,Math.max(a-c,0),"v")[0]),hq(),hs(a=>[a])),g),{groupCounts:f,topItemsIndexes:g}},hj(ik,hQ)),io=hD(([{log:a}])=>{let b=hz(!1),c=hC(hu(b,hr(a=>a),hq()));return b(1,b=>{b&&hl(a)("props updated",{},hI.DEBUG)}),{didMount:c,propsReady:b}},hj(hK),{singleton:!0}),ip="u">typeof document&&"scrollBehavior"in document.documentElement.style;function iq(a){let b="number"==typeof a?{index:a}:a;return b.align||(b.align="start"),b.behavior&&ip||(b.behavior="auto"),b.offset||(b.offset=0),b}let ir=hD(([{gap:a,listRefresh:b,sizes:c,totalCount:d},{fixedFooterHeight:e,fixedHeaderHeight:f,footerHeight:g,headerHeight:h,scrollingInProgress:i,scrollTo:j,smoothScrollTargetReached:k,viewportHeight:l},{log:m}])=>{let n=hB(),o=hB(),p=hz(0),q=null,r=null,s=null;function t(){q&&(q(),q=null),s&&(s(),s=null),r&&(clearTimeout(r),r=null),i(0,!1)}return hm(hu(n,hy(c,l,d,p,h,g,m),hy(a,f,e),hs(([[a,c,d,e,f,g,h,j],l,m,p])=>{let u=iq(a),{align:v,behavior:w,offset:x}=u,y=e-1,z=id(u,c,y),A=ib(z,c.offsetTree,l)+g;"end"===v?(A+=m+hV(c.sizeTree,z)[1]-d+p,z===y&&(A+=h)):"center"===v?A+=(m+hV(c.sizeTree,z)[1]-d+p)/2:A-=f,x&&(A+=x);let B=b=>{t(),b?(j("retrying to scroll to",{location:a},hI.DEBUG),n(0,a)):(o(0,!0),j("list did not change, scroll successful",{},hI.DEBUG))};if(t(),"smooth"===w){let a=!1;s=b(1,b=>{a=a||b}),q=hn(k,()=>{B(a)})}else q=hn(hu(b,a=>{let b=setTimeout(()=>{a(!1)},150);return c=>{c&&(a(!0),clearTimeout(b))}}),B);return r=setTimeout(()=>{t()},1200),i(0,!0),j("scrolling from index to",{behavior:w,index:z,top:A},hI.DEBUG),{behavior:w,top:A}})),j),{scrollTargetReached:o,scrollToIndex:n,topListHeight:p}},hj(ik,hQ,hK),{singleton:!0});function is(a,b){0==a?b():requestAnimationFrame(()=>{is(a-1,b)})}function it(a,b){return"number"==typeof a?a:"LAST"===a.index?b-1:a.index}let iu=hD(([{defaultItemSize:a,listRefresh:b,sizes:c},{scrollTop:d},{scrollTargetReached:e,scrollToIndex:f},{didMount:g}])=>{let h=hz(!0),i=hz(0),j=hz(!0);return hm(hu(g,hy(i),hr(([a,b])=>!!b),ht(!1)),h),hm(hu(g,hy(i),hr(([a,b])=>!!b),ht(!1)),j),hu(hF(b,g),hy(h,c,a,j),hr(([[,a],b,{sizeTree:c},d,e])=>a&&(!hT(c)||hg(d))&&!b&&!e),hy(i))(1,([,a])=>{hn(e,()=>{j(0,!0)}),is(4,()=>{hn(d,()=>{h(0,!0)}),f(0,a)})}),{initialItemFinalLocationReached:j,initialTopMostItemIndex:i,scrolledToInitialItem:h}},hj(ik,hQ,ir,io),{singleton:!0});function iv(a,b){return 1.01>Math.abs(a-b)}let iw="down",ix={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},iy=hD(([{footerHeight:a,headerHeight:b,scrollBy:c,scrollContainerState:d,scrollTop:e,viewportHeight:f}])=>{let g=hz(!1),h=hz(!0),i=hB(),j=hB(),k=hz(4),l=hz(0),m=hA(hu(hH(hu(hG(e),hw(1),ht(!0)),hu(hG(e),hw(1),ht(!1),ho(100))),hq()),!1),n=hA(hu(hH(hu(c,ht(!0)),hu(c,ht(!1),ho(200))),hq()),!1);hm(hu(hF(hG(e),hG(l)),hs(([a,b])=>a<=b),hq()),h),hm(hu(h,hx(50)),j);let o=hC(hu(hF(d,hG(f),hG(b),hG(a),hG(k)),hv((a,[{scrollHeight:b,scrollTop:c},d,e,f,g])=>{let h={scrollHeight:b,scrollTop:c,viewportHeight:d};if(c+d-b>-g){let b,d;return c>a.state.scrollTop?(b="SCROLLED_DOWN",d=a.state.scrollTop-c):(b="SIZE_DECREASED",d=a.state.scrollTop-c||a.scrollTopDelta),{atBottom:!0,atBottomBecause:b,scrollTopDelta:d,state:h}}return{atBottom:!1,notAtBottomBecause:h.scrollHeight>a.state.scrollHeight?"SIZE_INCREASED":d<a.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":c<a.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:h}},ix),hq((a,b)=>a&&a.atBottom===b.atBottom))),p=hA(hu(d,hv((a,{scrollHeight:b,scrollTop:c,viewportHeight:d})=>{if(iv(a.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:c};{let e=b-(c+d)<1;return a.scrollTop!==c&&e?{changed:!0,jump:a.scrollTop-c,scrollHeight:b,scrollTop:c}:{changed:!0,jump:0,scrollHeight:b,scrollTop:c}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),hr(a=>a.changed),hs(a=>a.jump)),0);hm(hu(o,hs(a=>a.atBottom)),g),hm(hu(g,hx(50)),i);let q=hz(iw);hm(hu(d,hs(({scrollTop:a})=>a),hq(),hv((a,b)=>hl(n)?{direction:a.direction,prevScrollTop:b}:{direction:b<a.prevScrollTop?"up":iw,prevScrollTop:b},{direction:iw,prevScrollTop:0}),hs(a=>a.direction)),q),hm(hu(d,hx(50),ht("none")),q);let r=hz(0);return hm(hu(m,hr(a=>!a),ht(0)),r),hm(hu(e,hx(100),hy(m),hr(([a,b])=>b),hv(([a,b],[c])=>[b,c],[0,0]),hs(([a,b])=>b-a)),r),{atBottomState:o,atBottomStateChange:i,atBottomThreshold:k,atTopStateChange:j,atTopThreshold:l,isAtBottom:g,isAtTop:h,isScrolling:m,lastJumpDueToItemResize:p,scrollDirection:q,scrollVelocity:r}},hj(hQ)),iz="bottom",iA="none";function iB(a,b,c){return"number"==typeof a?"up"===c&&"top"===b||c===iw&&b===iz?a:0:"up"===c?"top"===b?a.main:a.reverse:b===iz?a.main:a.reverse}function iC(a,b){var c;return"number"==typeof a?a:null!=(c=a[b])?c:0}let iD=hD(([{deviation:a,fixedHeaderHeight:b,headerHeight:c,scrollTop:d,viewportHeight:e}])=>{let f=hB(),g=hz(0),h=hz(0),i=hz(0),j=hA(hu(hF(hG(d),hG(e),hG(c),hG(f,h4),hG(i),hG(g),hG(b),hG(a),hG(h)),hs(([a,b,c,[d,e],f,g,h,i,j])=>{let k=a-i,l=Math.max(c-k,0),m=iA,n=iC(j,"top"),o=iC(j,iz);return d-=i,d+=c+h,e+=c+h,d>a+(g+h)-n&&(m="up"),(e-=i)<a-l+b+o&&(m=iw),m!==iA?[Math.max(k-c-iB(f,"top",m)-n,0),k-l-h+b+iB(f,iz,m)+o]:null}),hr(a=>null!=a),hq(h4)),[0,0]);return{increaseViewportBy:h,listBoundary:f,overscan:i,topListHeight:g,visibleRange:j}},hj(hQ),{singleton:!0}),iE={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function iF(a,b,c,d,e,f){let{lastIndex:g,lastOffset:h,lastSize:i}=e,j=0,k=0;if(a.length>0){j=a[0].offset;let b=a[a.length-1];k=b.offset+b.size}let l=c-g,m=j,n=h+l*i+(l-1)*d-k;return{bottom:k,firstItemIndex:f,items:iH(a,e,f),offsetBottom:n,offsetTop:j,top:m,topItems:iH(b,e,f),topListHeight:b.reduce((a,b)=>b.size+a,0),totalCount:c}}function iG(a,b,c,d,e,f){let g=0;if(c.groupIndices.length>0)for(let b of c.groupIndices){if(b-g>=a)break;g++}let h=a+g,i=it(b,h);return iF(Array.from({length:h}).map((a,b)=>({data:f[b+i],index:b+i,offset:0,size:0})),[],h,e,c,d)}function iH(a,b,c){if(0===a.length)return[];if(!h8(b))return a.map(a=>({...a,index:a.index+c,originalIndex:a.index}));let d=a[0].index,e=a[a.length-1].index,f=[],g=hX(b.groupOffsetTree,d,e),h,i=0;for(let d of a){let a;(!h||h.end<d.index)&&(h=g.shift(),i=b.groupIndices.indexOf(h.start)),a=d.index===h.start?{index:i,type:"group"}:{groupIndex:i,index:d.index-(i+1)+c},f.push({...a,data:d.data,offset:d.offset,originalIndex:d.index,size:d.size})}return f}function iI(a,b){var c;return void 0===a?0:"number"==typeof a?a:null!=(c=a[b])?c:0}let iJ=hD(([{data:a,firstItemIndex:b,gap:c,sizes:d,totalCount:e},f,{listBoundary:g,topListHeight:h,visibleRange:i},{initialTopMostItemIndex:j,scrolledToInitialItem:k},{topListHeight:l},m,{didMount:n},{recalcInProgress:o}])=>{let p=hz([]),q=hz(0),r=hB(),s=hz(0);hm(f.topItemsIndexes,p);let t=hA(hu(hF(n,o,hG(i,h4),hG(e),hG(d),hG(j),k,hG(p),hG(b),hG(c),hG(s),a),hr(([a,b,,c,,,,,,,,d])=>{let e=d&&d.length!==c;return a&&!b&&!e}),hs(([,,[a,b],c,d,e,f,g,h,i,j,k])=>{var l,m,n,o,p;let{offsetTree:r,sizeTree:s}=d,t=hl(q);if(0===c)return{...iE,totalCount:c};if(0===a&&0===b)return 0===t?{...iE,totalCount:c}:iG(t,e,d,h,i,k||[]);if(hT(s))return t>0?null:iF(function(a,b,c){if(h8(b)){let d=ic(a,b);return[{index:hV(b.groupOffsetTree,d)[0],offset:0,size:0},{data:null==c?void 0:c[0],index:d,offset:0,size:0}]}return[{data:null==c?void 0:c[0],index:a,offset:0,size:0}]}(it(e,c),d,k),[],c,i,d,h);let u=[];if(g.length>0){let a=g[0],b=g[g.length-1],c=0;for(let d of hX(s,a,b)){let e=d.value,f=Math.max(d.start,a),g=Math.min(d.end,b);for(let a=f;a<=g;a++)u.push({data:null==k?void 0:k[a],index:a,offset:c,size:e}),c+=e}}if(!f)return iF([],u,c,i,d,h);let v=g.length>0?g[g.length-1]+1:0,w=function(a,b,c,d=0){let e,f;return d>0&&(b=Math.max(b,a[h6(a,d,h9)].offset)),hS((e=h6(a,b,ia),f=h6(a,c,ia,e),a.slice(e,f+1)),ii)}(r,a,b,v);if(0===w.length)return null;let x=c-1,y=((c=>{for(let d of w){let e=d.value,f=e.offset,g=d.start,h=e.size;if(e.offset<a){let b=(g+=Math.floor((a-e.offset+i)/(h+i)))-d.start;f+=b*h+b*i}g<v&&(f+=(v-g)*h,g=v);let j=Math.min(d.end,x);for(let a=g;a<=j&&!(f>=b);a++)c.push({data:null==k?void 0:k[a],index:a,offset:f,size:h}),f+=h+i}})(p=[]),p),z=iI(j,"top"),A=iI(j,iz);if(y.length>0&&(z>0||A>0)){let a=y[0],b=y[y.length-1];if(z>0&&a.index>v){let b=Math.min(z,a.index-v),c=[],d=a.offset;for(let e=a.index-1;e>=a.index-b;e--){let b=null!=(m=null==(l=hX(s,e,e)[0])?void 0:l.value)?m:a.size;d-=b+i,c.unshift({data:null==k?void 0:k[e],index:e,offset:d,size:b})}y.unshift(...c)}if(A>0&&b.index<x){let a=Math.min(A,x-b.index),c=b.offset+b.size+i;for(let d=b.index+1;d<=b.index+a;d++){let a=null!=(o=null==(n=hX(s,d,d)[0])?void 0:n.value)?o:b.size;y.push({data:null==k?void 0:k[d],index:d,offset:c,size:a}),c+=a+i}}}return iF(y,u,c,i,d,h)}),hr(a=>null!==a),hq()),iE);hm(hu(a,hr(hg),hs(a=>null==a?void 0:a.length)),e),hm(hu(t,hs(a=>a.topListHeight)),l),hm(l,h),hm(hu(t,hs(a=>[a.top,a.bottom])),g),hm(hu(t,hs(a=>a.items)),r);let u=hC(hu(t,hr(({items:a})=>a.length>0),hy(e,a),hr(([{items:a},b])=>a[a.length-1].originalIndex===b-1),hs(([,a,b])=>[a-1,b]),hq(h4),hs(([a])=>a))),v=hC(hu(t,hx(200),hr(({items:a,topItems:b})=>a.length>0&&a[0].originalIndex===b.length),hs(({items:a})=>a[0].index),hq())),w=hC(hu(t,hr(({items:a})=>a.length>0),hs(({items:a})=>{let b=0,c=a.length-1;for(;"group"===a[b].type&&b<c;)b++;for(;"group"===a[c].type&&c>b;)c--;return{endIndex:a[c].index,startIndex:a[b].index}}),hq(h3)));return{endReached:u,initialItemCount:q,itemsRendered:r,listState:t,minOverscanItemCount:s,rangeChanged:w,startReached:v,topItemsIndexes:p,...m}},hj(ik,im,iD,iu,ir,iy,io,h5),{singleton:!0}),iK=hD(([{fixedFooterHeight:a,fixedHeaderHeight:b,footerHeight:c,headerHeight:d},{listState:e}])=>{let f=hB(),g=hA(hu(hF(c,a,d,b,e),hs(([a,b,c,d,e])=>a+b+c+d+e.offsetBottom+e.bottom)),0);return hm(hG(g),f),{totalListHeight:g,totalListHeightChanged:f}},hj(hQ,iJ),{singleton:!0}),iL=hD(([{viewportHeight:a},{totalListHeight:b}])=>{let c=hz(!1),d=hA(hu(hF(c,a,b),hr(([a])=>a),hs(([,a,b])=>Math.max(0,a-b)),hx(0),hq()),0);return{alignToBottom:c,paddingTopAddition:d}},hj(hQ,iK),{singleton:!0}),iM=hD(()=>({context:hz(null)})),iN=({itemBottom:a,itemTop:b,locationParams:{align:c,behavior:d,...e},viewportBottom:f,viewportTop:g})=>b<g?{...e,align:null!=c?c:"start",behavior:d}:a>f?{...e,align:null!=c?c:"end",behavior:d}:null,iO=hD(([{gap:a,sizes:b,totalCount:c},{fixedFooterHeight:d,fixedHeaderHeight:e,headerHeight:f,scrollingInProgress:g,scrollTop:h,viewportHeight:i},{scrollToIndex:j}])=>{let k=hB();return hm(hu(k,hy(b,i,c,f,e,d,h),hy(a),hs(([[a,b,c,d,e,f,h,i],j])=>{let{align:k,behavior:l,calculateViewLocation:m=iN,done:n,...o}=a,p=id(a,b,d-1),q=ib(p,b.offsetTree,j)+e+f,r=m({itemBottom:q+hV(b.sizeTree,p)[1],itemTop:q,locationParams:{align:k,behavior:l,...o},viewportBottom:i+c-h,viewportTop:i+f});return r?n&&hn(hu(g,hr(a=>!a),hw(hl(g)?1:2)),n):null==n||n(),r}),hr(a=>null!==a)),j),{scrollIntoView:k}},hj(ik,hQ,ir,iJ,hK),{singleton:!0});function iP(a){return!!a&&("smooth"===a?"smooth":"auto")}let iQ=hD(([{listRefresh:a,totalCount:b,fixedItemSize:c,data:d},{atBottomState:e,isAtBottom:f},{scrollToIndex:g},{scrolledToInitialItem:h},{didMount:i,propsReady:j},{log:k},{scrollingInProgress:l},{context:m},{scrollIntoView:n}])=>{let o=hz(!1),p=hB(),q=null;function r(a){g(0,{align:"end",behavior:a,index:"LAST"})}function s(a){setTimeout(hn(e,b=>{!a||b.atBottom||"SIZE_INCREASED"!==b.notAtBottomBecause||q||(hl(k)("scrolling to bottom due to increased size",{},hI.DEBUG),r("auto"))}),100)}hu(hF(hu(hG(b),hw(1)),i),hy(hG(o),f,h,l),hs(([[a,b],c,d,e,f])=>{let g,h=b&&e,i="auto";return h&&(g=d||f,i="function"==typeof c?iP(c(g)):g&&iP(c),h=h&&!!i),{followOutputBehavior:i,shouldFollow:h,totalCount:a}}),hr(({shouldFollow:a})=>a))(1,({followOutputBehavior:b,totalCount:d})=>{q&&(q(),q=null),hl(c)?requestAnimationFrame(()=>{hl(k)("following output to ",{totalCount:d},hI.DEBUG),r(b)}):q=hn(a,()=>{hl(k)("following output to ",{totalCount:d},hI.DEBUG),r(b),q=null})}),hu(hF(hG(o),b,j),hr(([a,,b])=>a&&b),hv(({value:a},[,b])=>({refreshed:a===b,value:b}),{refreshed:!1,value:0}),hr(({refreshed:a})=>a),hy(o,b))(1,([,a])=>{hl(h)&&s(!1!==a)}),p(1,()=>{s(!1!==hl(o))}),hF(hG(o),e)(1,([a,b])=>{a&&!b.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===b.notAtBottomBecause&&r("auto")});let t=hz(null),u=hB();return hm(hH(hu(hG(d),hs(a=>{var b;return null!=(b=null==a?void 0:a.length)?b:0})),hu(hG(b))),u),hu(hF(hu(u,hw(1)),i),hy(hG(t),h,l,m),hs(([[a,b],c,d,e,f])=>b&&d&&(null==c?void 0:c({context:f,totalCount:a,scrollingInProgress:e}))),hr(a=>!!a),hx(0))(1,b=>{q&&(q(),q=null),hl(c)?requestAnimationFrame(()=>{hl(k)("scrolling into view",{}),n(0,b)}):q=hn(a,()=>{hl(k)("scrolling into view",{}),n(0,b),q=null})}),{autoscrollToBottom:p,followOutput:o,scrollIntoViewOnChange:t}},hj(ik,iy,ir,iu,io,hK,hQ,iM,iO)),iR=hD(([{data:a,firstItemIndex:b,gap:c,sizes:d},{initialTopMostItemIndex:e},{initialItemCount:f,listState:g},{didMount:h}])=>(hm(hu(h,hy(f),hr(([,a])=>0!==a),hy(e,d,b,c,a),hs(([[,a],b,c,d,e,f=[]])=>iG(a,b,c,d,e,f))),g),{}),hj(ik,iu,iJ,io),{singleton:!0}),iS=hD(([{didMount:a},{scrollTo:b},{listState:c}])=>{let d=hz(0);return hu(a,hy(d),hr(([,a])=>0!==a),hs(([,a])=>({top:a})))(1,a=>{hn(hu(c,hw(1),hr(a=>a.items.length>1)),()=>{requestAnimationFrame(()=>{b(0,a)})})}),{initialScrollTop:d}},hj(io,hQ,iJ),{singleton:!0}),iT=hD(([{scrollVelocity:a}])=>{let b=hz(!1),c=hB(),d=hz(!1);return hm(hu(a,hy(d,b,c),hr(([a,b])=>!!b),hs(([a,b,c,d])=>{let{enter:e,exit:f}=b;if(c){if(f(a,d))return!1}else if(e(a,d))return!0;return c}),hq()),b),hu(hF(b,a,c),hy(d))(1,([[a,b,c],d])=>{a&&d&&d.change&&d.change(b,c)}),{isSeeking:b,scrollSeekConfiguration:d,scrollSeekRangeChanged:c,scrollVelocity:a}},hj(iy),{singleton:!0}),iU=hD(([{scrollContainerState:a,scrollTo:b}])=>{let c=hB(),d=hB(),e=hB(),f=hz(!1),g=hz(void 0);return hm(hu(hF(c,d),hs(([{scrollHeight:a,scrollTop:b,viewportHeight:c},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,b-d),viewportHeight:c}))),a),hm(hu(b,hy(d),hs(([a,{offsetTop:b}])=>({...a,top:a.top+b}))),e),{customScrollParent:g,useWindowScroll:f,windowScrollContainerState:c,windowScrollTo:e,windowViewportRect:d}},hj(hQ)),iV=hD(([{sizeRanges:a,sizes:b},{headerHeight:c,scrollTop:d},{initialTopMostItemIndex:e},{didMount:f},{useWindowScroll:g,windowScrollContainerState:h,windowViewportRect:i}])=>{let j=hB(),k=hz(void 0),l=hz(null),m=hz(null);return hm(h,l),hm(i,m),hu(j,hy(b,d,g,l,m,c))(1,([a,b,c,d,e,f,g])=>{let h=hY(b.sizeTree).map(({k:a,v:b},c,d)=>{let e=d[c+1];return{endIndex:e?e.k-1:1/0,size:b,startIndex:a}});d&&null!==e&&null!==f&&(c=e.scrollTop-f.offsetTop),a({ranges:h,scrollTop:c-=g})}),hm(hu(k,hr(hg),hs(iW)),e),hm(hu(f,hy(k),hr(([,a])=>void 0!==a),hq(),hs(([,a])=>a.ranges)),a),{getState:j,restoreStateFrom:k}},hj(ik,hQ,iu,io,iU));function iW(a){return{align:"start",index:0,offset:a.scrollTop}}let iX=hD(([{topItemsIndexes:a}])=>{let b=hz(0);return hm(hu(b,hr(a=>a>=0),hs(a=>Array.from({length:a}).map((a,b)=>b))),a),{topItemCount:b}},hj(iJ));function iY(a){let b=!1,c;return()=>(b||(b=!0,c=a()),c)}let iZ=iY(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),i$=hD(([{deviation:a,scrollBy:b,scrollingInProgress:c,scrollTop:d},{isAtBottom:e,isScrolling:f,lastJumpDueToItemResize:g,scrollDirection:h},{listState:i},{beforeUnshiftWith:j,gap:k,shiftWithOffset:l,sizes:m},{log:n},{recalcInProgress:o}])=>{let p=hC(hu(i,hy(g),hv(([,a,b,c],[{bottom:d,items:e,offsetBottom:f,totalCount:g},h])=>{let i=d+f,j=0;return b===g&&a.length>0&&e.length>0&&(0===e[0].originalIndex&&0===a[0].originalIndex||0!=(j=i-c)&&(j+=h)),[j,e,g,i]},[0,[],0,0]),hr(([a])=>0!==a),hy(d,h,c,e,n,o),hr(([,a,b,c,,,d])=>!d&&!c&&0!==a&&"up"===b),hs(([[a],,,,,b])=>(b("Upward scrolling compensation",{amount:a},hI.DEBUG),a))));function q(c){c>0?(b(0,{behavior:"auto",top:-c}),a(0,0)):(a(0,0),b(0,{behavior:"auto",top:-c}))}return hu(p,hy(a,f))(1,([b,c,d])=>{d&&iZ()?a(0,c-b):q(-b)}),hu(hF(hA(f,!1),a,o),hr(([a,b,c])=>!a&&!c&&0!==b),hs(([a,b])=>b),hx(1))(1,q),hm(hu(l,hs(a=>({top:-a}))),b),hu(j,hy(m,k),hs(([a,{groupIndices:b,lastSize:c,sizeTree:d},e])=>{if(0===b.length)return a*(c+e);{let f=0,g=hU(d,0),h=0,i=0;for(;h<a;){h++,f+=g;let d=b.length===i+1?1/0:b[i+1]-b[i]-1;h+d>a&&(f-=g,d=a-h+1),h+=d,f+=d*(c+e),i++}return f}}))(1,c=>{a(0,c),requestAnimationFrame(()=>{b(0,{top:c}),requestAnimationFrame(()=>{a(0,0),o(0,!1)})})}),{deviation:a}},hj(hQ,iy,iJ,ik,hK,h5)),i_=hD(([a,b,c,d,e,f,g,h,i,j,k])=>({...a,...b,...c,...d,...e,...f,...g,...h,...i,...j,...k}),hj(iD,iR,io,iT,iK,iS,iL,iU,iO,hK,iM)),i0=hD(([{data:a,defaultItemSize:b,firstItemIndex:c,fixedItemSize:d,fixedGroupSize:e,gap:f,groupIndices:g,heightEstimates:h,itemSize:i,sizeRanges:j,sizes:k,statefulTotalCount:l,totalCount:m,trackItemSizes:n},{initialItemFinalLocationReached:o,initialTopMostItemIndex:p,scrolledToInitialItem:q},r,s,t,u,{scrollToIndex:v},w,{topItemCount:x},{groupCounts:y},z])=>{let{listState:A,minOverscanItemCount:B,topItemsIndexes:C,rangeChanged:D,...E}=u;return hm(D,z.scrollSeekRangeChanged),hm(hu(z.windowViewportRect,hs(a=>a.visibleHeight)),r.viewportHeight),{data:a,defaultItemHeight:b,firstItemIndex:c,fixedItemHeight:d,fixedGroupHeight:e,gap:f,groupCounts:y,heightEstimates:h,initialItemFinalLocationReached:o,initialTopMostItemIndex:p,scrolledToInitialItem:q,sizeRanges:j,topItemCount:x,topItemsIndexes:C,totalCount:m,...t,groupIndices:g,itemSize:i,listState:A,minOverscanItemCount:B,scrollToIndex:v,statefulTotalCount:l,trackItemSizes:n,rangeChanged:D,...E,...z,...r,sizes:k,...s}},hj(ik,iu,hQ,iV,iQ,iJ,ir,i$,iX,im,i_)),i1="u">typeof document?x.default.useLayoutEffect:x.default.useEffect;function i2(a,b,c){let d=Object.keys(b.required||{}),e=Object.keys(b.optional||{}),f=Object.keys(b.methods||{}),g=Object.keys(b.events||{}),h=x.default.createContext({});function i(a,c){for(let e of(a.propsReady&&(0,a.propsReady)(0,!1),d))(0,a[b.required[e]])(0,c[e]);for(let d of e)d in c&&(0,a[b.optional[d]])(0,c[d]);a.propsReady&&(0,a.propsReady)(0,!0)}function j(a){return g.reduce((c,d)=>{var e;let f,g,h;return c[d]=(e=a[b.events[d]],h=()=>null==f?void 0:f(),function(a,b){switch(a){case 1:return b?g===b?void 0:(h(),g=b,f=e(1,b)):(h(),hh);case 2:h(),g=null;return}}),c},{})}return{Component:x.default.forwardRef((k,l)=>{var m;let{children:n,...o}=k,[p]=x.default.useState(()=>{var b;let c,d;return c=new Map,i(b=(d=({constructor:a,dependencies:b,id:e,singleton:f})=>{if(f&&c.has(e))return c.get(e);let g=a(b.map(a=>d(a)));return f&&c.set(e,g),g})(a),o),b}),[q]=x.default.useState(()=>j(p));return i1(()=>{for(let a of g)a in o&&(0,q[a])(1,o[a]);return()=>{Object.values(q).map(hk)}},[o,q,p]),i1(()=>{i(p,o)}),x.default.useImperativeHandle(l,(m=f.reduce((a,c)=>(a[c]=a=>{(0,p[b.methods[c]])(0,a)},a),{}),()=>m)),(0,w.jsx)(h.Provider,{value:p,children:c?(0,w.jsx)(c,{...function(a,b){let c={},d={},e=0,f=a.length;for(;e<f;)d[a[e]]=1,e+=1;for(let a in b)Object.hasOwn(d,a)||(c[a]=b[a]);return c}([...d,...e,...g],o),children:n}):n})}),useEmitter:(a,b)=>{let c=x.default.useContext(h)[a];i1(()=>c(1,b),[b,c])},useEmitterValue:x.default.version.startsWith("18")?a=>{let b=x.default.useContext(h)[a],c=x.default.useCallback(a=>b(1,a),[b]);return x.default.useSyncExternalStore(c,()=>hl(b),()=>hl(b))}:a=>{let b=x.default.useContext(h)[a],[c,d]=x.default.useState(()=>hl(b));return i1(()=>b(1,a=>{a!==c&&d(()=>a)}),[b,c]),c},usePublisher:a=>{let b=x.default.useContext(h);return x.default.useCallback(c=>{(0,b[a])(0,c)},[b,a])}}}let i3=x.default.createContext(void 0),i4=x.default.createContext(void 0),i5="u">typeof document?x.default.useLayoutEffect:x.default.useEffect;function i6(a){return"self"in a}function i7(a,b,c,d=hh,e,f){let g=x.default.useRef(null),h=x.default.useRef(null),i=x.default.useRef(null),j=x.default.useCallback(c=>{let d,e,g,j=c.target;if("body"in j||i6(j)){let a=i6(j)?j:j.defaultView;g=f?a.scrollX:a.scrollY,d=f?a.document.documentElement.scrollWidth:a.document.documentElement.scrollHeight,e=f?a.innerWidth:a.innerHeight}else g=f?j.scrollLeft:j.scrollTop,d=f?j.scrollWidth:j.scrollHeight,e=f?j.offsetWidth:j.offsetHeight;let k=()=>{a({scrollHeight:d,scrollTop:Math.max(g,0),viewportHeight:e})};c.suppressFlushSync?k():hd.default.flushSync(k),null!==h.current&&(g===h.current||g<=0||g===d-e)&&(h.current=null,b(!0),i.current&&(clearTimeout(i.current),i.current=null))},[a,b,f]);return x.default.useEffect(()=>{let a=e||g.current;return d(e||g.current),j({suppressFlushSync:!0,target:a}),a.addEventListener("scroll",j,{passive:!0}),()=>{d(null),a.removeEventListener("scroll",j)}},[g,j,c,d,e]),{scrollByCallback:function(a){f&&(a={behavior:a.behavior,left:a.top}),g.current.scrollBy(a)},scrollerRef:g,scrollToCallback:function(c){let d,e,j,k=g.current;if(!k||(f?"offsetWidth"in k&&0===k.offsetWidth:"offsetHeight"in k&&0===k.offsetHeight))return;let l="smooth"===c.behavior;i6(k)?(e=Math.max(h7(k.document.documentElement,f?"width":"height"),f?k.document.documentElement.scrollWidth:k.document.documentElement.scrollHeight),d=f?k.innerWidth:k.innerHeight,j=f?window.scrollX:window.scrollY):(e=k[f?"scrollWidth":"scrollHeight"],d=h7(k,f?"width":"height"),j=k[f?"scrollLeft":"scrollTop"]);let m=e-d;if(c.top=Math.ceil(Math.max(Math.min(m,c.top),0)),iv(d,e)||c.top===j){a({scrollHeight:e,scrollTop:j,viewportHeight:d}),l&&b(!0);return}l?(h.current=c.top,i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{i.current=null,h.current=null,b(!0)},1e3)):h.current=null,f&&(c={behavior:c.behavior,left:c.top}),k.scrollTo(c)}}}let i8="-webkit-sticky",i9="sticky",ja=iY(()=>{if(typeof document>"u")return i9;let a=document.createElement("div");return a.style.position=i8,a.style.position===i8?i8:i9});function jb(a){return a}let jc=hD(()=>{let a=hz(a=>`Item ${a}`),b=hz(a=>`Group ${a}`),c=hz({}),d=hz(jb),e=hz("div"),f=hz(hh),g=(a,b=null)=>hA(hu(c,hs(b=>b[a]),hq()),b);return{components:c,computeItemKey:d,EmptyPlaceholder:g("EmptyPlaceholder"),FooterComponent:g("Footer"),GroupComponent:g("Group","div"),groupContent:b,HeaderComponent:g("Header"),HeaderFooterTag:e,ItemComponent:g("Item","div"),itemContent:a,ListComponent:g("List","div"),ScrollerComponent:g("Scroller","div"),scrollerRef:f,ScrollSeekPlaceholder:g("ScrollSeekPlaceholder"),TopItemListComponent:g("TopItemList")}}),jd=hD(([a,b])=>({...a,...b}),hj(i0,jc)),je=({height:a})=>(0,w.jsx)("div",{style:{height:a}}),jf={overflowAnchor:"none",position:ja(),zIndex:1},jg={overflowAnchor:"none"},jh={...jg,display:"inline-block",height:"100%"},ji=x.default.memo(function({showTopList:a=!1}){let b=jy("listState"),c=jz("sizeRanges"),d=jy("useWindowScroll"),e=jy("customScrollParent"),f=jz("windowScrollContainerState"),g=jz("scrollContainerState"),h=jy("itemContent"),i=jy("context"),j=jy("groupContent"),k=jy("trackItemSizes"),l=jy("itemSize"),m=jy("log"),n=jz("gap"),o=jy("horizontalDirection"),{callbackRef:p}=hN(c,l,k,a?hh:e||d?f:g,m,n,e,o,jy("skipAnimationFrameInResizeObserver")),[q,r]=x.default.useState(0);jx("deviation",a=>{q!==a&&r(a)});let s=jy("EmptyPlaceholder"),t=jy("ScrollSeekPlaceholder")||je,u=jy("ListComponent"),v=jy("ItemComponent"),y=jy("GroupComponent"),z=jy("computeItemKey"),A=jy("isSeeking"),B=jy("groupIndices").length>0,C=jy("alignToBottom"),D=jy("initialItemFinalLocationReached"),E=a?{}:{boxSizing:"border-box",...o?{display:"inline-block",height:"100%",marginLeft:0!==q?q:C?"auto":0,paddingLeft:b.offsetTop,paddingRight:b.offsetBottom,whiteSpace:"nowrap"}:{marginTop:0!==q?q:C?"auto":0,paddingBottom:b.offsetBottom,paddingTop:b.offsetTop},...D?{}:{visibility:"hidden"}};return!a&&0===b.totalCount&&s?(0,w.jsx)(s,{...jn(s,i)}):(0,w.jsx)(u,{...jn(u,i),"data-testid":a?"virtuoso-top-item-list":"virtuoso-item-list",ref:p,style:E,children:(a?b.topItems:b.items).map(a=>{let c=a.originalIndex,d=z(c+b.firstItemIndex,a.data,i);return A?(0,x.createElement)(t,{...jn(t,i),height:a.size,index:a.index,key:d,type:a.type||"item",..."group"===a.type?{}:{groupIndex:a.groupIndex}}):"group"===a.type?(0,x.createElement)(y,{...jn(y,i),"data-index":c,"data-item-index":a.index,"data-known-size":a.size,key:d,style:jf},j(a.index,i)):(0,x.createElement)(v,{...jn(v,i),...jo(v,a.data),"data-index":c,"data-item-group-index":a.groupIndex,"data-item-index":a.index,"data-known-size":a.size,key:d,style:o?jh:jg},B?h(a.index,a.groupIndex,a.data,i):h(a.index,a.data,i))})})}),jj={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},jk={outline:"none",overflowX:"auto",position:"relative"},jl=a=>({height:"100%",position:"absolute",top:0,width:"100%",...a?{display:"flex",flexDirection:"column"}:{}}),jm={position:ja(),top:0,width:"100%",zIndex:1};function jn(a,b){if("string"!=typeof a)return{context:b}}function jo(a,b){return{item:"string"==typeof a?void 0:b}}let jp=x.default.memo(function(){let a=jy("HeaderComponent"),b=jz("headerHeight"),c=jy("HeaderFooterTag"),d=hL(x.default.useMemo(()=>a=>{b(h7(a,"height"))},[b]),!0,jy("skipAnimationFrameInResizeObserver")),e=jy("context");return a?(0,w.jsx)(c,{ref:d,children:(0,w.jsx)(a,{...jn(a,e)})}):null}),jq=x.default.memo(function(){let a=jy("FooterComponent"),b=jz("footerHeight"),c=jy("HeaderFooterTag"),d=hL(x.default.useMemo(()=>a=>{b(h7(a,"height"))},[b]),!0,jy("skipAnimationFrameInResizeObserver")),e=jy("context");return a?(0,w.jsx)(c,{ref:d,children:(0,w.jsx)(a,{...jn(a,e)})}):null});function jr({useEmitter:a,useEmitterValue:b,usePublisher:c}){return x.default.memo(function({children:d,style:e,context:f,...g}){let h=c("scrollContainerState"),i=b("ScrollerComponent"),j=c("smoothScrollTargetReached"),k=b("scrollerRef"),l=b("horizontalDirection")||!1,{scrollByCallback:m,scrollerRef:n,scrollToCallback:o}=i7(h,j,i,k,void 0,l);return a("scrollTo",o),a("scrollBy",m),(0,w.jsx)(i,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:n,style:{...l?jk:jj,...e},tabIndex:0,...g,...jn(i,f),children:d})})}function js({useEmitter:a,useEmitterValue:b,usePublisher:c}){return x.default.memo(function({children:d,style:e,context:f,...g}){let h=c("windowScrollContainerState"),i=b("ScrollerComponent"),j=c("smoothScrollTargetReached"),k=b("totalListHeight"),l=b("deviation"),m=b("customScrollParent"),n=x.default.useRef(null),{scrollByCallback:o,scrollerRef:p,scrollToCallback:q}=i7(h,j,i,b("scrollerRef"),m);return i5(()=>{var a;return p.current=m||(null==(a=n.current)?void 0:a.ownerDocument.defaultView),()=>{p.current=null}},[p,m]),a("windowScrollTo",q),a("scrollBy",o),(0,w.jsx)(i,{ref:n,"data-virtuoso-scroller":!0,style:{position:"relative",...e,...0!==k?{height:k+l}:{}},...g,...jn(i,f),children:d})})}let jt=({children:a})=>{let b=x.default.useContext(i3),c=jz("viewportHeight"),d=jz("fixedItemHeight"),e=jy("alignToBottom"),f=jy("horizontalDirection"),g=hL(x.default.useMemo(()=>hf(c,a=>h7(a,f?"width":"height")),[c,f]),!0,jy("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{b&&(c(b.viewportHeight),d(b.itemHeight))},[b,c,d]),(0,w.jsx)("div",{"data-viewport-type":"element",ref:g,style:jl(e),children:a})},ju=({children:a})=>{let b=x.default.useContext(i3),c=jz("windowViewportRect"),d=jz("fixedItemHeight"),e=hP(c,jy("customScrollParent"),jy("skipAnimationFrameInResizeObserver")),f=jy("alignToBottom");return x.default.useEffect(()=>{b&&(d(b.itemHeight),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:100}))},[b,c,d]),(0,w.jsx)("div",{"data-viewport-type":"window",ref:e,style:jl(f),children:a})},jv=({children:a})=>{let b=jy("TopItemListComponent")||"div",c=jy("headerHeight"),d={...jm,marginTop:`${c}px`},e=jy("context");return(0,w.jsx)(b,{style:d,...jn(b,e),children:a})},{Component:jw,useEmitter:jx,useEmitterValue:jy,usePublisher:jz}=i2(jd,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},x.default.memo(function(a){let b=jy("useWindowScroll"),c=jy("topItemsIndexes").length>0,d=jy("customScrollParent"),e=jy("context");return(0,w.jsxs)(d||b?jB:jA,{...a,context:e,children:[c&&(0,w.jsx)(jv,{children:(0,w.jsx)(ji,{showTopList:!0})}),(0,w.jsxs)(d||b?ju:jt,{children:[(0,w.jsx)(jp,{}),(0,w.jsx)(ji,{}),(0,w.jsx)(jq,{})]})]})})),jA=jr({useEmitter:jx,useEmitterValue:jy,usePublisher:jz}),jB=js({useEmitter:jx,useEmitterValue:jy,usePublisher:jz}),jC=hD(()=>{let a=hz(a=>(0,w.jsxs)("td",{children:["Item $",a]})),b=hz(null),c=hz(a=>(0,w.jsxs)("td",{colSpan:1e3,children:["Group ",a]})),d=hz(null),e=hz(null),f=hz({}),g=hz(jb),h=hz(hh),i=(a,b=null)=>hA(hu(f,hs(b=>b[a]),hq()),b);return{components:f,computeItemKey:g,context:b,EmptyPlaceholder:i("EmptyPlaceholder"),FillerRow:i("FillerRow"),fixedFooterContent:e,fixedHeaderContent:d,itemContent:a,groupContent:c,ScrollerComponent:i("Scroller","div"),scrollerRef:h,ScrollSeekPlaceholder:i("ScrollSeekPlaceholder"),TableBodyComponent:i("TableBody","tbody"),TableComponent:i("Table","table"),TableFooterComponent:i("TableFoot","tfoot"),TableHeadComponent:i("TableHead","thead"),TableRowComponent:i("TableRow","tr"),GroupComponent:i("Group","tr")}}),jD=hD(([a,b])=>({...a,...b}),hj(i0,jC)),jE=({height:a})=>(0,w.jsx)("tr",{children:(0,w.jsx)("td",{style:{height:a}})}),jF=({height:a})=>(0,w.jsx)("tr",{children:(0,w.jsx)("td",{style:{border:0,height:a,padding:0}})}),jG={overflowAnchor:"none"},jH={position:ja(),zIndex:2,overflowAnchor:"none"},jI=x.default.memo(function({showTopList:a=!1}){let b=jN("listState"),c=jN("computeItemKey"),d=jN("firstItemIndex"),e=jN("context"),f=jN("isSeeking"),g=jN("fixedHeaderHeight"),h=jN("groupIndices").length>0,i=jN("itemContent"),j=jN("groupContent"),k=jN("ScrollSeekPlaceholder")||jE,l=jN("GroupComponent"),m=jN("TableRowComponent"),n=(a?b.topItems:[]).reduce((a,b,c)=>(0===c?a.push(b.size):a.push(a[c-1]+b.size),a),[]),o=(a?b.topItems:b.items).map(b=>{let o=b.originalIndex,p=c(o+d,b.data,e),q=a?0===o?0:n[o-1]:0;return f?(0,x.createElement)(k,{...jn(k,e),height:b.size,index:b.index,key:p,type:b.type||"item"}):"group"===b.type?(0,x.createElement)(l,{...jn(l,e),"data-index":o,"data-item-index":b.index,"data-known-size":b.size,key:p,style:{...jH,top:g}},j(b.index,e)):(0,x.createElement)(m,{...jn(m,e),...jo(m,b.data),"data-index":o,"data-item-index":b.index,"data-known-size":b.size,"data-item-group-index":b.groupIndex,key:p,style:a?{...jH,top:g+q}:jG},h?i(b.index,b.groupIndex,b.data,e):i(b.index,b.data,e))});return(0,w.jsx)(w.Fragment,{children:o})}),jJ=x.default.memo(function(){let a=jN("listState"),b=jN("topItemsIndexes").length>0,c=jO("sizeRanges"),d=jN("useWindowScroll"),e=jN("customScrollParent"),f=jO("windowScrollContainerState"),g=jO("scrollContainerState"),h=jN("trackItemSizes"),{callbackRef:i,ref:j}=hN(c,jN("itemSize"),h,e||d?f:g,jN("log"),void 0,e,!1,jN("skipAnimationFrameInResizeObserver")),[k,l]=x.default.useState(0);jM("deviation",a=>{k!==a&&(j.current.style.marginTop=`${a}px`,l(a))});let m=jN("EmptyPlaceholder"),n=jN("FillerRow")||jF,o=jN("TableBodyComponent"),p=jN("paddingTopAddition"),q=jN("statefulTotalCount"),r=jN("context");if(0===q&&m)return(0,w.jsx)(m,{...jn(m,r)});let s=(b?a.topItems:[]).reduce((a,b)=>a+b.size,0),t=a.offsetTop+p+k-s,u=a.offsetBottom,v=t>0?(0,w.jsx)(n,{context:r,height:t},"padding-top"):null,y=u>0?(0,w.jsx)(n,{context:r,height:u},"padding-bottom"):null;return(0,w.jsxs)(o,{"data-testid":"virtuoso-item-list",ref:i,...jn(o,r),children:[v,b&&(0,w.jsx)(jI,{showTopList:!0}),(0,w.jsx)(jI,{}),y]})}),jK=({children:a})=>{let b=x.default.useContext(i3),c=jO("viewportHeight"),d=jO("fixedItemHeight"),e=hL(x.default.useMemo(()=>hf(c,a=>h7(a,"height")),[c]),!0,jN("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{b&&(c(b.viewportHeight),d(b.itemHeight))},[b,c,d]),(0,w.jsx)("div",{"data-viewport-type":"element",ref:e,style:jl(!1),children:a})},jL=({children:a})=>{let b=x.default.useContext(i3),c=jO("windowViewportRect"),d=jO("fixedItemHeight"),e=hP(c,jN("customScrollParent"),jN("skipAnimationFrameInResizeObserver"));return x.default.useEffect(()=>{b&&(d(b.itemHeight),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:100}))},[b,c,d]),(0,w.jsx)("div",{"data-viewport-type":"window",ref:e,style:jl(!1),children:a})},{useEmitter:jM,useEmitterValue:jN,usePublisher:jO}=i2(jD,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},x.default.memo(function(a){let b=jN("useWindowScroll"),c=jN("customScrollParent"),d=jO("fixedHeaderHeight"),e=jO("fixedFooterHeight"),f=jN("fixedHeaderContent"),g=jN("fixedFooterContent"),h=jN("context"),i=hL(x.default.useMemo(()=>hf(d,a=>h7(a,"height")),[d]),!0,jN("skipAnimationFrameInResizeObserver")),j=hL(x.default.useMemo(()=>hf(e,a=>h7(a,"height")),[e]),!0,jN("skipAnimationFrameInResizeObserver")),k=c||b?jQ:jP,l=c||b?jL:jK,m=jN("TableComponent"),n=jN("TableHeadComponent"),o=jN("TableFooterComponent"),p=f?(0,w.jsx)(n,{ref:i,style:{position:"sticky",top:0,zIndex:2},...jn(n,h),children:f()},"TableHead"):null,q=g?(0,w.jsx)(o,{ref:j,style:{bottom:0,position:"sticky",zIndex:1},...jn(o,h),children:g()},"TableFoot"):null;return(0,w.jsx)(k,{...a,...jn(k,h),children:(0,w.jsx)(l,{children:(0,w.jsxs)(m,{style:{borderSpacing:0,overflowAnchor:"none"},...jn(m,h),children:[p,(0,w.jsx)(jJ,{},"TableBody"),q]})})})})),jP=jr({useEmitter:jM,useEmitterValue:jN,usePublisher:jO}),jQ=js({useEmitter:jM,useEmitterValue:jN,usePublisher:jO}),jR={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},jS={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:jT,floor:jU,max:jV,min:jW,round:jX}=Math;function jY(a,b,c){return Array.from({length:b-a+1}).map((b,d)=>({data:null===c?null:c[d+a],index:d+a}))}function jZ(a,b){return a&&a.width===b.width&&a.height===b.height}function j$(a,b){return a&&a.column===b.column&&a.row===b.row}let j_=hD(([{increaseViewportBy:a,listBoundary:b,overscan:c,visibleRange:d},{footerHeight:e,headerHeight:f,scrollBy:g,scrollContainerState:h,scrollTo:i,scrollTop:j,smoothScrollTargetReached:k,viewportHeight:l},m,n,{didMount:o,propsReady:p},{customScrollParent:q,useWindowScroll:r,windowScrollContainerState:s,windowScrollTo:t,windowViewportRect:u},v])=>{let w=hz(0),x=hz(0),y=hz(jR),z=hz({height:0,width:0}),A=hz({height:0,width:0}),B=hB(),C=hB(),D=hz(0),E=hz(null),F=hz({column:0,row:0}),G=hB(),H=hB(),I=hz(!1),J=hz(0),K=hz(!0),L=hz(!1),M=hz(!1);hu(o,hy(J),hr(([a,b])=>!!b))(1,()=>{K(0,!1)}),hu(hF(o,K,A,z,J,L),hr(([a,b,c,d,,e])=>a&&!b&&0!==c.height&&0!==d.height&&!e))(1,([,,,,a])=>{L(0,!0),is(1,()=>{B(0,a)}),hn(hu(j),()=>{b(0,[0,0]),K(0,!0)})}),hm(hu(H,hr(a=>null!=a&&a.scrollTop>0),ht(0)),x),hu(o,hy(H),hr(([,a])=>null!=a))(1,([,a])=>{a&&(z(0,a.viewport),A(0,a.item),F(0,a.gap),a.scrollTop>0&&(I(0,!0),hn(hu(j,hw(1)),a=>{I(0,!1)}),i(0,{top:a.scrollTop})))}),hm(hu(z,hs(({height:a})=>a)),l),hm(hu(hF(hG(z,jZ),hG(A,jZ),hG(F,(a,b)=>a&&a.column===b.column&&a.row===b.row),hG(j)),hs(([a,b,c,d])=>({gap:c,item:b,scrollTop:d,viewport:a}))),G),hm(hu(hF(hG(w),d,hG(F,j$),hG(A,jZ),hG(z,jZ),hG(E),hG(x),hG(I),hG(K),hG(J)),hr(([,,,,,,,a])=>!a),hs(([a,[b,c],d,e,f,g,h,,i,j])=>{let k,l,{column:m,row:n}=d,{height:o,width:p}=e,{width:q}=f;if(0===h&&(0===a||0===q))return jR;if(0===p){var r;let b=it(j,a),c=b+Math.max(h-1,0);return r=jY(b,c,g),{...jS,items:r}}let s=j0(q,p,m);i?0===b&&0===c&&h>0?(k=0,l=h-1):(k=s*jU((b+n)/(o+n)),l=jW(a-1,jV(l=s*jT((c+n)/(o+n))-1,s-1)),k=jW(l,jV(0,k))):(k=0,l=-1);let t=jY(k,l,g),{bottom:u,top:v}=j1(f,d,e,t),w=jT(a/s);return{bottom:u,itemHeight:o,items:t,itemWidth:p,offsetBottom:w*o+(w-1)*n-u,offsetTop:v,top:v}})),y),hm(hu(E,hr(a=>null!==a),hs(a=>a.length)),w),hm(hu(hF(z,A,y,F),hr(([a,b,{items:c}])=>c.length>0&&0!==b.height&&0!==a.height),hs(([a,b,{items:c},d])=>{let{bottom:e,top:f}=j1(a,d,b,c);return[f,e]}),hq(h4)),b);let N=hz(!1);hm(hu(j,hy(N),hs(([a,b])=>b||0!==a)),N);let O=hC(hu(hF(y,w),hr(([{items:a}])=>a.length>0),hy(N),hr(([[a,b],c])=>{let d=a.items[a.items.length-1].index===b-1;return(c||a.bottom>0&&a.itemHeight>0&&0===a.offsetBottom&&a.items.length===b)&&d}),hs(([[,a]])=>a-1),hq())),P=hC(hu(hG(y),hr(({items:a})=>a.length>0&&0===a[0].index),ht(0),hq())),Q=hC(hu(hG(y),hy(I),hr(([{items:a},b])=>a.length>0&&!b),hs(([{items:a}])=>({endIndex:a[a.length-1].index,startIndex:a[0].index})),hq(h3),hx(0)));hm(Q,n.scrollSeekRangeChanged),hm(hu(B,hy(z,A,w,F),hs(([a,b,c,d,e])=>{let f=iq(a),{align:g,behavior:h,offset:i}=f,j=f.index;"LAST"===j&&(j=d-1);let k=j2(b,e,c,j=jV(0,j,jW(d-1,j)));return"end"===g?k=jX(k-b.height+c.height):"center"===g&&(k=jX(k-b.height/2+c.height/2)),i&&(k+=i),{behavior:h,top:k}})),i);let R=hA(hu(y,hs(a=>a.offsetBottom+a.bottom)),0);return hm(hu(u,hs(a=>({height:a.visibleHeight,width:a.visibleWidth}))),z),{customScrollParent:q,data:E,deviation:D,footerHeight:e,gap:F,headerHeight:f,increaseViewportBy:a,initialItemCount:x,itemDimensions:A,overscan:c,restoreStateFrom:H,scrollBy:g,scrollContainerState:h,scrollHeight:C,scrollTo:i,scrollToIndex:B,scrollTop:j,smoothScrollTargetReached:k,totalCount:w,useWindowScroll:r,viewportDimensions:z,windowScrollContainerState:s,windowScrollTo:t,windowViewportRect:u,...n,gridState:y,horizontalDirection:M,initialTopMostItemIndex:J,totalListHeight:R,...m,endReached:O,propsReady:p,rangeChanged:Q,startReached:P,stateChanged:G,stateRestoreInProgress:I,...v}},hj(iD,hQ,iy,iT,io,iU,hK));function j0(a,b,c){return jV(1,jU((a+c)/(jU(b)+c)))}function j1(a,b,c,d){let{height:e}=c;if(void 0===e||0===d.length)return{bottom:0,top:0};let f=j2(a,b,c,d[0].index);return{bottom:j2(a,b,c,d[d.length-1].index)+e,top:f}}function j2(a,b,c,d){let e=jU(d/j0(a.width,c.width,b.column)),f=e*c.height+jV(0,e-1)*b.row;return f>0?f+b.row:f}let j3=hD(()=>{let a=hz(a=>`Item ${a}`),b=hz({}),c=hz(null),d=hz("virtuoso-grid-item"),e=hz("virtuoso-grid-list"),f=hz(jb),g=hz("div"),h=hz(hh),i=(a,c=null)=>hA(hu(b,hs(b=>b[a]),hq()),c),j=hz(!1),k=hz(!1);return hm(hG(k),j),{components:b,computeItemKey:f,context:c,FooterComponent:i("Footer"),HeaderComponent:i("Header"),headerFooterTag:g,itemClassName:d,ItemComponent:i("Item","div"),itemContent:a,listClassName:e,ListComponent:i("List","div"),readyStateChanged:j,reportReadyState:k,ScrollerComponent:i("Scroller","div"),scrollerRef:h,ScrollSeekPlaceholder:i("ScrollSeekPlaceholder","div")}}),j4=hD(([a,b])=>({...a,...b}),hj(j_,j3)),j5=x.default.memo(function(){let a=kb("gridState"),b=kb("listClassName"),c=kb("itemClassName"),d=kb("itemContent"),e=kb("computeItemKey"),f=kb("isSeeking"),g=kc("scrollHeight"),h=kb("ItemComponent"),i=kb("ListComponent"),j=kb("ScrollSeekPlaceholder"),k=kb("context"),l=kc("itemDimensions"),m=kc("gap"),n=kb("log"),o=kb("stateRestoreInProgress"),p=kc("reportReadyState"),q=hL(x.default.useMemo(()=>a=>{g(a.parentElement.parentElement.scrollHeight);let b=a.firstChild;if(b){let{height:a,width:c}=b.getBoundingClientRect();l({height:a,width:c})}m({column:kf("column-gap",getComputedStyle(a).columnGap,n),row:kf("row-gap",getComputedStyle(a).rowGap,n)})},[g,l,m,n]),!0,!1);return i5(()=>{a.itemHeight>0&&a.itemWidth>0&&p(!0)},[a]),o?null:(0,w.jsx)(i,{className:b,ref:q,...jn(i,k),"data-testid":"virtuoso-item-list",style:{paddingBottom:a.offsetBottom,paddingTop:a.offsetTop},children:a.items.map(b=>{let g=e(b.index,b.data,k);return f?(0,w.jsx)(j,{...jn(j,k),height:a.itemHeight,index:b.index,width:a.itemWidth},g):(0,x.createElement)(h,{...jn(h,k),className:c,"data-index":b.index,key:g},d(b.index,b.data,k))})})}),j6=x.default.memo(function(){let a=kb("HeaderComponent"),b=kc("headerHeight"),c=kb("headerFooterTag"),d=hL(x.default.useMemo(()=>a=>{b(h7(a,"height"))},[b]),!0,!1),e=kb("context");return a?(0,w.jsx)(c,{ref:d,children:(0,w.jsx)(a,{...jn(a,e)})}):null}),j7=x.default.memo(function(){let a=kb("FooterComponent"),b=kc("footerHeight"),c=kb("headerFooterTag"),d=hL(x.default.useMemo(()=>a=>{b(h7(a,"height"))},[b]),!0,!1),e=kb("context");return a?(0,w.jsx)(c,{ref:d,children:(0,w.jsx)(a,{...jn(a,e)})}):null}),j8=({children:a})=>{let b=x.default.useContext(i4),c=kc("itemDimensions"),d=kc("viewportDimensions"),e=hL(x.default.useMemo(()=>a=>{d(a.getBoundingClientRect())},[d]),!0,!1);return x.default.useEffect(()=>{b&&(d({height:b.viewportHeight,width:b.viewportWidth}),c({height:b.itemHeight,width:b.itemWidth}))},[b,d,c]),(0,w.jsx)("div",{ref:e,style:jl(!1),children:a})},j9=({children:a})=>{let b=x.default.useContext(i4),c=kc("windowViewportRect"),d=kc("itemDimensions"),e=hP(c,kb("customScrollParent"),!1);return x.default.useEffect(()=>{b&&(d({height:b.itemHeight,width:b.itemWidth}),c({offsetTop:0,visibleHeight:b.viewportHeight,visibleWidth:b.viewportWidth}))},[b,c,d]),(0,w.jsx)("div",{ref:e,style:jl(!1),children:a})},{useEmitter:ka,useEmitterValue:kb,usePublisher:kc}=i2(j4,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},x.default.memo(function({...a}){let b=kb("useWindowScroll"),c=kb("customScrollParent"),d=c||b?ke:kd,e=c||b?j9:j8,f=kb("context");return(0,w.jsx)(d,{...a,...jn(d,f),children:(0,w.jsxs)(e,{children:[(0,w.jsx)(j6,{}),(0,w.jsx)(j5,{}),(0,w.jsx)(j7,{})]})})})),kd=jr({useEmitter:ka,useEmitterValue:kb,usePublisher:kc}),ke=js({useEmitter:ka,useEmitterValue:kb,usePublisher:kc});function kf(a,b,c){return"normal"===b||null!=b&&b.endsWith("px")||c(`${a} was not resolved to pixel value correctly`,b,hI.WARN),"normal"===b?0:parseInt(null!=b?b:"0",10)}let kg=(0,x.memo)(({gender:a,className:b})=>"male"===a?(0,w.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,w.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,w.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):"female"===a?(0,w.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,w.jsx)("path",{d:"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"}),(0,w.jsx)("path",{d:"M18 22H6c0-4 4-3 6-3s6-1 6 3Z"})]}):(0,w.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:b,children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,w.jsx)("circle",{cx:"12",cy:"10",r:"3"}),(0,w.jsx)("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]})),kh=(0,x.memo)(({onSendMessage:a,showBottomNavPadding:b,onFocusChange:c,isFocused:d})=>{let[e,f]=(0,x.useState)(""),g=(0,x.useRef)(null);return(0,w.jsx)("footer",{className:`px-3 py-3 md:p-4 bg-gray-50 border-t border-gray-200 shrink-0 ${d?"pb-4 pt-3":b?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+12px)] md:pb-[90px] pt-4":"py-4"}`,children:(0,w.jsxs)("form",{onSubmit:b=>{b.preventDefault(),e.trim()&&(a(e.trim()),f(""),g.current?.blur())},className:"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto",children:[(0,w.jsx)("input",{ref:g,type:"text",value:e,onChange:a=>f(a.target.value),onFocus:()=>c?.(!0),onBlur:()=>c?.(!1),placeholder:"Messaggio alla stanza...",className:"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-sm md:text-base placeholder-gray-400",style:{fontSize:"16px"}}),(0,w.jsx)("button",{type:"submit",className:"w-10 h-10 flex items-center justify-center rounded-full bg-emerald-500 text-white shadow-md active:scale-95 transition-transform",onMouseDown:a=>a.preventDefault(),children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 rotate-45",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})}),ki=({user:a,messages:b,onSendMessage:c,onlineCount:d,isOnline:e,hideHeader:f,headerTitle:g,showBottomNavPadding:h,onInputFocusChange:i,isFocused:j,isSyncing:k})=>{let l=(0,x.useRef)(null),m=(0,x.useCallback)((c,d)=>{let e=d.senderId===a.id,f=0===c||b[c-1].senderId!==d.senderId;return(0,w.jsx)("div",{className:`flex ${e?"justify-end":"justify-start"} animate-message pb-4 px-4`,children:(0,w.jsxs)("div",{className:`flex flex-col max-w-[85%] ${e?"items-end":"items-start"}`,children:[f&&(0,w.jsxs)("span",{className:`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${e?"text-emerald-700":"text-gray-600"}`,children:[!e&&(0,w.jsx)("div",{className:`w-3.5 h-3.5 rounded-full flex items-center justify-center ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(d.senderGender)}`,children:(0,w.jsx)(kg,{gender:d.senderGender,className:"w-2 h-2 text-white"})}),e?"Tu":d.senderAlias]}),(0,w.jsx)("div",{className:`px-3 py-2 rounded-2xl shadow-sm ${e?"bg-emerald-500 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:(0,w.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed text-[15px]",children:d.text})}),(0,w.jsx)("span",{className:"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70",children:new Date(d.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},[a.id,b]);return(0,w.jsxs)("div",{className:"w-full h-full flex flex-col bg-white",children:[!f&&(0,w.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 shrink-0",children:(0,w.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight",children:g||"Stanza"}),(0,w.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,w.jsx)("span",{className:`w-2 h-2 rounded-full ${e?"bg-emerald-500":"bg-red-500"}`}),(0,w.jsx)("p",{className:"text-[11px] font-bold text-emerald-600 uppercase tracking-wide",children:e?`${d} persone qui`:"Disconnesso"})]})]})]}),k&&(0,w.jsxs)("div",{className:"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse",children:[(0,w.jsxs)("svg",{className:"animate-spin h-3 w-3 text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,w.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,w.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,w.jsx)("span",{className:"text-[10px] font-bold text-emerald-700 tracking-wide uppercase",children:"Sincronizzazione"})]})]})}),(0,w.jsx)("div",{className:"flex-1 overflow-hidden relative chat-bg",children:(0,w.jsx)(jw,{ref:l,data:b,initialTopMostItemIndex:b.length-1,itemContent:m,followOutput:"smooth",className:"h-full w-full",alignToBottom:!0})}),(0,w.jsx)(kh,{onSendMessage:c,showBottomNavPadding:h,onFocusChange:i,isFocused:j})]})},kj=({activeTab:a,onTabChange:b,usersCount:c,unreadChatsCount:d})=>(0,w.jsxs)("nav",{className:"bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)] shadow-[0_-1px_3px_rgba(0,0,0,0.05)]",children:[(0,w.jsxs)("button",{onClick:()=>b("room"),className:`flex flex-col items-center justify-center w-full relative ${"room"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"room"===a?2.6:2.2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),c>0&&(0,w.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-emerald-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:c})]}),(0,w.jsx)("span",{className:`text-[10px] mt-1 ${"room"===a?"font-bold":"font-semibold"}`,children:"Stanza"})]}),(0,w.jsxs)("button",{onClick:()=>b("users"),className:`flex flex-col items-center justify-center w-full relative ${"users"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"users"===a?2.6:2.2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,w.jsx)("span",{className:`text-[10px] mt-1 ${"users"===a?"font-bold":"font-semibold"}`,children:"Utenti"})]}),(0,w.jsxs)("button",{onClick:()=>b("chats"),className:`flex flex-col items-center justify-center w-full relative ${"chats"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"chats"===a?2.6:2.2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),d>0&&(0,w.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:d})]}),(0,w.jsx)("span",{className:`text-[10px] mt-1 ${"chats"===a?"font-bold":"font-semibold"}`,children:"Chats"})]}),(0,w.jsxs)("button",{onClick:()=>b("settings"),className:`flex flex-col items-center justify-center w-full relative ${"settings"===a?"text-emerald-700":"text-gray-500"}`,children:[(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"settings"===a?2.6:2.2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,w.jsx)("span",{className:`text-[10px] mt-1 ${"settings"===a?"font-bold":"font-semibold"}`,children:"Me"})]})]}),kk=({currentUser:a,users:b,onStartChat:c})=>{let[d,e]=(0,x.useState)(""),f=b.filter(b=>b.id!==a.id&&b.alias.toLowerCase().includes(d.toLowerCase()));return(0,w.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,w.jsxs)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10 transition-all",children:[(0,w.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,w.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Utenti"}),(0,w.jsxs)("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide",children:[b.length," Online"]})]}),(0,w.jsx)("div",{className:"px-4 pb-3",children:(0,w.jsxs)("div",{className:"relative group",children:[(0,w.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,w.jsx)("input",{type:"text",placeholder:"Cerca utente per nome...",value:d,onChange:a=>e(a.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm"}),d&&(0,w.jsx)("button",{onClick:()=>e(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),(0,w.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===f.length?(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,w.jsx)("p",{className:"text-center font-medium",children:d?"Nessun utente trovato.":"Nessun altro utente online al momento."})]}):(0,w.jsx)("ul",{className:"space-y-4",children:f.map(a=>(0,w.jsxs)("li",{className:"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0",children:[(0,w.jsxs)("div",{className:`w-12 h-12 rounded-full ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(a.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:[(0,w.jsx)("span",{className:"font-bold text-lg uppercase",children:a.alias.charAt(0)}),(0,w.jsx)("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"})]}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:a.alias}),(0,w.jsx)("p",{className:"text-sm text-gray-500 truncate",children:a.status||(0,w.jsx)("span",{className:"capitalize",children:a.gender})})]}),(0,w.jsx)("button",{onClick:()=>c(a),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]},a.id))})})]})},kl=({chats:a,onSelectChat:b,onDeleteChat:c})=>(0,w.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,w.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,w.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,w.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Chat private"})})}),(0,w.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===a.length?(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,w.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,w.jsxs)("p",{className:"text-center font-medium",children:["Nessuna chat attiva.",(0,w.jsx)("br",{}),"Cerca utenti nella scheda Utenti."]})]}):(0,w.jsx)("ul",{className:"space-y-4",children:a.map(a=>{var d;return(0,w.jsxs)("li",{onClick:()=>b(a.peer.id),className:"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0",children:[(0,w.jsx)("div",{className:`w-14 h-14 rounded-full ${(a=>{switch(a){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(a.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:(0,w.jsx)("span",{className:"font-bold text-xl uppercase",children:a.peer.alias.charAt(0)})}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,w.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:a.peer.alias}),(0,w.jsx)("span",{className:"text-[11px] text-gray-400 font-medium",children:(a=>{if(0===a.length)return"";let b=new Date(a[a.length-1].timestamp),c=new Date;return b.toDateString()===c.toDateString()?b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):b.toLocaleDateString([],{day:"2-digit",month:"2-digit"})})(a.messages)})]}),(0,w.jsx)("p",{className:"text-sm text-gray-500 truncate",children:0===(d=a.messages).length?"Inizia la conversazione...":d[d.length-1].text})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[a.unreadCount>0&&(0,w.jsx)("div",{className:"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center",children:(0,w.jsx)("span",{className:"text-[10px] font-bold text-white",children:a.unreadCount})}),(0,w.jsx)("button",{onClick:b=>{b.stopPropagation(),c(a.peer.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},a.peer.id)})})})]}),km=({user:a,onLogout:b,onUpdateAlias:c,onUpdateStatus:d})=>{let[e,f]=(0,x.useState)(!1),[g,h]=(0,x.useState)(!1),[i,j]=(0,x.useState)(a.alias),[k,l]=(0,x.useState)(a.status||""),m=()=>{i.trim()&&i!==a.alias&&c(i.trim()),f(!1)},n=()=>{k.trim()!==(a.status||"")&&d(k.trim()),h(!1)};return(0,w.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,w.jsx)("header",{className:"bg-white pt-safe border-b border-gray-100 sticky top-0 z-10",children:(0,w.jsx)("div",{className:"h-[60px] px-4 flex items-center",children:(0,w.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Profilo"})})}),(0,w.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,w.jsxs)("div",{className:"pb-32",children:[(0,w.jsx)("div",{className:"py-8 flex flex-col items-center bg-white border-b border-gray-100",children:(0,w.jsx)("div",{className:"relative group",children:(0,w.jsx)("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden",children:a.alias.charAt(0).toUpperCase()})})}),(0,w.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stato"}),(0,w.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,w.jsxs)("button",{onClick:()=>h(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,w.jsx)("div",{className:"flex flex-col items-start truncate overflow-hidden",children:g?(0,w.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),onBlur:n,onKeyDown:a=>"Enter"===a.key&&n(),maxLength:50,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,w.jsx)("span",{className:"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left",children:a.status||"Disponibile"})}),(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alias"}),(0,w.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,w.jsxs)("button",{onClick:()=>f(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,w.jsx)("div",{className:"flex flex-col items-start",children:e?(0,w.jsx)("input",{type:"text",value:i,onChange:a=>j(a.target.value),onBlur:m,onKeyDown:a=>"Enter"===a.key&&m(),maxLength:20,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,w.jsx)("span",{className:"text-[17px] text-gray-900",children:a.alias})}),(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Informazioni"}),(0,w.jsxs)("div",{className:"bg-white border-y border-gray-100 divide-y divide-gray-50",children:[(0,w.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,w.jsx)("span",{className:"text-[17px] text-gray-400",children:"Sesso"}),(0,w.jsx)("span",{className:"text-[17px] text-gray-900 capitalize",children:{male:"maschio",female:"femmina",other:"altro"}[a.gender]||a.gender})]}),(0,w.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,w.jsx)("span",{className:"text-[17px] text-gray-400",children:"User ID"}),(0,w.jsx)("span",{className:"text-xs font-mono text-gray-400 uppercase tracking-wider",children:a.id})]})]})]}),(0,w.jsx)("div",{className:"pt-4",children:(0,w.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,w.jsx)("button",{onClick:b,className:"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors",children:"Esci"})})})]})]})})]})};function kn({tenant:a,initialMessages:b}){let[c,d]=(0,x.useState)(null),[e,f]=(0,x.useState)(null),{data:g,isPending:h}=ha(),[i,j]=(0,x.useState)("room"),[k,l]=(0,x.useState)(null),[m,n]=(0,x.useState)(!1),[o,p]=(0,x.useState)([]),[q,r]=(0,x.useState)({}),[s,t]=(0,x.useState)(!1),u=(0,a3.useQueryClient)(),{data:v=b,isFetching:y}=function(a,b,c){let d,e=x.useContext(a5),f=x.useContext(a4),g=(0,a3.useQueryClient)(c),h=g.defaultQueryOptions(a);g.getDefaultOptions().queries?._experimental_beforeQuery?.(h);let i=g.getQueryCache().get(h.queryHash);if(h._optimisticResults=e?"isRestoring":"optimistic",h.suspense){let a=a=>"static"===a?a:Math.max(a??1e3,1e3),b=h.staleTime;h.staleTime="function"==typeof b?(...c)=>a(b(...c)):a(b),"number"==typeof h.gcTime&&(h.gcTime=Math.max(h.gcTime,1e3))}d=i?.state.error&&"function"==typeof h.throwOnError?(0,aY.shouldThrowError)(h.throwOnError,[i.state.error,i]):h.throwOnError,(h.suspense||h.experimental_prefetchInRender||d)&&!f.isReset()&&(h.retryOnMount=!1),x.useEffect(()=>{f.clearReset()},[f]);let j=!g.getQueryCache().get(h.queryHash),[k]=x.useState(()=>new b(g,h)),l=k.getOptimisticResult(h),m=!e&&!1!==a.subscribed;if(x.useSyncExternalStore(x.useCallback(a=>{let b=m?k.subscribe(aU.notifyManager.batchCalls(a)):aY.noop;return k.updateResult(),b},[k,m]),()=>k.getCurrentResult(),()=>k.getCurrentResult()),x.useEffect(()=>{k.setOptions(h)},[h,k]),h?.suspense&&l.isPending)throw a6(h,k,f);if((({result:a,errorResetBoundary:b,throwOnError:c,query:d,suspense:e})=>a.isError&&!b.isReset()&&!a.isFetching&&d&&(e&&void 0===a.data||(0,aY.shouldThrowError)(c,[a.error,d])))({result:l,errorResetBoundary:f,throwOnError:h.throwOnError,query:i,suspense:h.suspense}))throw l.error;if(g.getDefaultOptions().queries?._experimental_afterQuery?.(h,l),h.experimental_prefetchInRender&&!aY.isServer&&l.isLoading&&l.isFetching&&!e){let a=j?a6(h,k,f):i?.promise;a?.catch(aY.noop).finally(()=>{k.updateResult()})}return h.notifyOnChangeProps?l:k.trackResult(l)}({queryKey:["messages","global",a.slug],queryFn:async()=>{let c=await a8.getMessages(!0);try{let b=await fetch(`${aS.API_BASE_URL}/api/messages?tenant=${a.slug}`);if(b.ok){let a=await b.json();for(let b of a)await a8.saveMessage(b,!0);return a}}catch(a){console.warn("Failed to fetch from server, using local data",a)}return c.length>0?c:b},initialData:b},a$,void 0);(0,x.useEffect)(()=>{if(console.log(`[Session] Loading: ${h}, User: ${g?.user?.id}, Name: ${g?.user?.name}`),!h&&g?.user){let a="true"===localStorage.getItem("waiting_for_passkey");if(console.log(`[Session] Waiting for passkey: ${a}`),a)return;let b={id:g.user.id,alias:g.user.name||"User",gender:g.user.gender||"other",status:g.user.status||"",phoneNumber:g.user.phoneNumber,joinedAt:new Date(g.user.createdAt).getTime()};console.log("[Session] Setting authenticated user:",b),d(b),localStorage.setItem("chat_user",JSON.stringify(b))}},[g,h]),(0,x.useEffect)(()=>{},[a.slug]),(0,x.useEffect)(()=>{if(!c)return;let b=aR(aS.API_BASE_URL||void 0,{query:{tenantSlug:a.slug,userId:c.id},transports:["websocket"],reconnectionAttempts:5,timeout:1e4});return f(b),b.on("connect_error",a=>{console.error("[Socket] Connect Error:",a.message,a)}),b.on("error",a=>{console.error("[Socket] General Error:",a)}),b.on("connect",()=>{console.log("Socket connected"),t(!0),b.emit("join",{user:c,tenantSlug:a.slug})}),b.on("disconnect",()=>{t(!1)}),b.on("presenceUpdate",a=>{p(a)}),b.on("newMessage",async b=>{await a8.saveMessage(b,!0),u.invalidateQueries({queryKey:["messages","global",a.slug]})}),b.on("privateMessage",async a=>{let b=a.senderId===c.id,d=b?a.recipientId:a.senderId;await a8.saveMessage(a,!1),!b&&a7.Capacitor.isNativePlatform()&&ba.impact({style:a9.ImpactStyle.Light}).catch(()=>{}),r(c=>{let e=c[d]||{peer:{id:d,alias:b?"Unknown":a.senderAlias,gender:b?"male":a.senderGender,joinedAt:Date.now()},messages:[],unread:0};return e.messages.some(b=>b.id===a.id)?c:{...c,[d]:{...e,messages:[...e.messages,a],unread:e.unread+1}}})}),()=>{b.disconnect()}},[c,a.slug,u]),(0,x.useEffect)(()=>{"chats"===i&&k&&q[k]?.unread>0&&r(a=>({...a,[k]:{...a[k],unread:0}}))},[i,k,q]);let z=async()=>{g&&await hb(),d(null),f(null),localStorage.removeItem("chat_user"),r({}),a8.clearMessages(),u.setQueryData(["messages","global",a.slug],b),l(null),j("room")},A=async b=>{if(!c||!e)return;let d={id:Date.now().toString(),text:b,senderId:c.id,senderAlias:c.alias,senderGender:c.gender,timestamp:new Date().toISOString()};a7.Capacitor.isNativePlatform()&&ba.impact({style:a9.ImpactStyle.Light}).catch(()=>{}),await a8.saveMessage(d,!0),u.setQueryData(["messages","global",a.slug],a=>[...a||[],d]),e.emit("sendMessage",{...d,tenantSlug:a.slug})},B=async b=>{if(!c||!e||!k)return;let d={id:Date.now().toString(),text:b,senderId:c.id,senderAlias:c.alias,senderGender:c.gender,timestamp:new Date().toISOString(),recipientId:k};a7.Capacitor.isNativePlatform()&&ba.impact({style:a9.ImpactStyle.Light}).catch(()=>{}),await a8.saveMessage(d,!1),r(a=>({...a,[k]:{...a[k],messages:[...a[k].messages,d]}})),e.emit("sendMessage",{...d,tenantSlug:a.slug,isPrivate:!0})},{swipeHandlers:C,swipeStyle:D,isDragging:E}=function({onSwipeBack:a,edgeWidth:b=30,threshold:c=100,enabled:d=!0}){let[e,f]=(0,x.useState)({isDragging:!1,translateX:0,opacity:1}),g=(0,x.useRef)(0),h=(0,x.useRef)(0),i=(0,x.useRef)(!1),j=(0,x.useRef)(!1);return{swipeHandlers:{onTouchStart:(0,x.useCallback)(a=>{if(!d)return;let c=a.touches[0];g.current=c.clientX,h.current=c.clientY,i.current=c.clientX<=b,j.current=!1,i.current&&f({isDragging:!0,translateX:0,opacity:1})},[d,b]),onTouchMove:(0,x.useCallback)(a=>{if(!d||!i.current||j.current)return;let b=a.touches[0],c=b.clientX-g.current;if(Math.abs(b.clientY-h.current)>30&&c<30){i.current=!1,f({isDragging:!1,translateX:0,opacity:1});return}if(c>0){let b=Math.min(.8*c,window.innerWidth),d=1-b/window.innerWidth*.3;f({isDragging:!0,translateX:b,opacity:d}),a.preventDefault()}},[d]),onTouchEnd:(0,x.useCallback)(()=>{if(!d||!i.current||j.current)return void f({isDragging:!1,translateX:0,opacity:1});let{translateX:b}=e;b>=c?(j.current=!0,f({isDragging:!1,translateX:window.innerWidth,opacity:0}),setTimeout(()=>{a(),f({isDragging:!1,translateX:0,opacity:1})},150)):f({isDragging:!1,translateX:0,opacity:1}),i.current=!1},[d,e,c,a])},swipeStyle:{transform:`translateX(${e.translateX}px)`,transition:e.isDragging?"none":"transform 0.2s ease-out, opacity 0.2s ease-out",opacity:e.opacity},isDragging:e.isDragging,translateX:e.translateX}}({onSwipeBack:()=>l(null),enabled:a7.Capacitor.isNativePlatform()&&null!==k});if(!c)return(0,w.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col",children:(0,w.jsx)(hc,{onLogin:a=>{d(a),localStorage.setItem("chat_user",JSON.stringify(a))},tenantName:a.name})});if(k&&"chats"===i){let a=q[k];return a?(0,w.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",style:D,...C,children:[E&&(0,w.jsx)("div",{className:"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none"}),(0,w.jsx)("header",{className:"bg-white border-b border-gray-100 pt-safe text-gray-800 z-10 sticky top-0",children:(0,w.jsxs)("div",{className:"h-[60px] px-4 flex items-center gap-3",children:[(0,w.jsx)("button",{onClick:()=>l(null),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,w.jsxs)("div",{className:"flex flex-col",children:[(0,w.jsx)("h2",{className:"font-bold text-lg leading-tight",children:a.peer.alias}),o.some(a=>a.id===k)&&(0,w.jsx)("span",{className:"text-xs text-emerald-500 font-medium",children:"Online"})]})]})}),(0,w.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,w.jsx)(ki,{user:c,messages:a.messages,onSendMessage:B,onlineCount:0,isOnline:!0,hideHeader:!0,showBottomNavPadding:!1,onInputFocusChange:n,isFocused:m,isSyncing:!1})})]}):(l(null),null)}let F=Object.values(q).reduce((a,b)=>a+b.unread,0);return(0,w.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",children:[(0,w.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:["room"===i&&(0,w.jsx)(ki,{user:c,messages:v,onSendMessage:A,onlineCount:o.length,isOnline:s,headerTitle:a.name,showBottomNavPadding:!0,onInputFocusChange:n,isFocused:m,isSyncing:y}),"users"===i&&(0,w.jsx)(kk,{currentUser:c,users:o,onStartChat:a=>{q[a.id]||r(b=>({...b,[a.id]:{peer:a,messages:[],unread:0}})),l(a.id),j("chats")}}),"chats"===i&&(0,w.jsx)(kl,{chats:Object.values(q).map(a=>({...a,unreadCount:a.unread})).sort((a,b)=>{let c=a.messages.length?new Date(a.messages[a.messages.length-1].timestamp).getTime():0;return(b.messages.length?new Date(b.messages[b.messages.length-1].timestamp).getTime():0)-c}),onSelectChat:l,onDeleteChat:a=>{r(b=>{let c={...b};return delete c[a],c}),k===a&&l(null)}}),"settings"===i&&(0,w.jsx)(km,{user:c,onLogout:z,onUpdateAlias:b=>{if(!c||!e)return;let f={...c,alias:b};d(f),localStorage.setItem("chat_user",JSON.stringify(f)),e.emit("join",{user:f,tenantSlug:a.slug})},onUpdateStatus:b=>{if(!c||!e)return;let f={...c,status:b};d(f),localStorage.setItem("chat_user",JSON.stringify(f)),e.emit("join",{user:f,tenantSlug:a.slug})}})]}),(0,w.jsx)("div",{className:`transition-all duration-300 ease-in-out border-t border-gray-100 bg-white z-20 overflow-hidden ${m?"opacity-0 pointer-events-none h-0":"opacity-100 h-auto"}`,children:(0,w.jsx)(kj,{activeTab:i,onTabChange:a=>{j(a),l(null)},usersCount:o.length,unreadChatsCount:F})})]})}var ko=a.i(59197);function kp(){let a=(0,y.useParams)().tenantSlug,[b,c]=(0,x.useState)(null),[d,e]=(0,x.useState)([]),[f,g]=(0,x.useState)(!0),[h,i]=(0,x.useState)(!1);return((0,x.useEffect)(()=>{!async function(){try{let b=await (0,ko.clientGetTenantBySlug)(a);if(!b){i(!0),g(!1);return}c(b);let d=(await (0,ko.clientGetMessages)(a)).map(a=>({id:a.id,text:a.text,senderId:a.senderId||a.userId,senderAlias:a.senderAlias||a.user?.name||"Anonymous",senderGender:a.senderGender||"other",timestamp:new Date(a.timestamp||a.createdAt).toISOString()}));e(d),g(!1)}catch(a){console.error("Error loading chat data",a),i(!0),g(!1)}}()},[a]),f)?(0,w.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,w.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Caricamento chat..."})}):((h||!b)&&(0,y.notFound)(),(0,w.jsx)("main",{className:"flex h-full flex-col items-center justify-between",children:(0,w.jsx)(kn,{tenant:b,initialMessages:d})}))}a.s(["default",()=>kp],15540)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__88b6e4ed._.js.map