module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},53774,a=>{"use strict";var b,c,d,e,f,g,h,i;let j,k,l,m,n,o;(e=b||(b={})).Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE";class p extends Error{constructor(a,b,c){super(a),this.message=a,this.code=b,this.data=c}}let q=(j=(g=f="u">typeof globalThis?globalThis:"u">typeof self?self:a.g).CapacitorCustomPlatform||null,l=(k=g.Capacitor||{}).Plugins=k.Plugins||{},m=()=>{var a,b;return null!==j?j.name:(null==g?void 0:g.androidBridge)?"android":(null==(b=null==(a=null==g?void 0:g.webkit)?void 0:a.messageHandlers)?void 0:b.bridge)?"ios":"web"},n=a=>{var b;return null==(b=k.PluginHeaders)?void 0:b.find(b=>b.name===a)},o=new Map,k.convertFileSrc||(k.convertFileSrc=a=>a),k.getPlatform=m,k.handleError=a=>g.console.error(a),k.isNativePlatform=()=>"web"!==m(),k.isPluginAvailable=a=>{let b=o.get(a);return!!((null==b?void 0:b.platforms.has(m()))||n(a))},k.registerPlugin=(a,c={})=>{let d,e=o.get(a);if(e)return console.warn(`Capacitor plugin "${a}" already registered. Cannot register plugins twice.`),e.proxy;let f=m(),g=n(a),h=async()=>(!d&&f in c?d=d="function"==typeof c[f]?await c[f]():c[f]:null!==j&&!d&&"web"in c&&(d=d="function"==typeof c.web?await c.web():c.web),d),i=c=>{let d,e=(...e)=>{let i=h().then(h=>{let i=((c,d)=>{var e,h;if(g){let b=null==g?void 0:g.methods.find(a=>d===a.name);if(b)if("promise"===b.rtype)return b=>k.nativePromise(a,d.toString(),b);else return(b,c)=>k.nativeCallback(a,d.toString(),b,c);if(c)return null==(e=c[d])?void 0:e.bind(c)}else if(c)return null==(h=c[d])?void 0:h.bind(c);else throw new p(`"${a}" plugin is not implemented on ${f}`,b.Unimplemented)})(h,c);if(i){let a=i(...e);return d=null==a?void 0:a.remove,a}throw new p(`"${a}.${c}()" is not implemented on ${f}`,b.Unimplemented)});return"addListener"===c&&(i.remove=async()=>d()),i};return e.toString=()=>`${c.toString()}() { [capacitor code] }`,Object.defineProperty(e,"name",{value:c,writable:!1,configurable:!1}),e},q=i("addListener"),r=i("removeListener"),s=(a,b)=>{let c=q({eventName:a},b),d=async()=>{r({eventName:a,callbackId:await c},b)},e=new Promise(a=>c.then(()=>a({remove:d})));return e.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await d()},e},t=new Proxy({},{get(a,b){switch(b){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?s:q;case"removeListener":return r;default:return i(b)}}});return l[a]=t,o.set(a,{name:a,proxy:t,platforms:new Set([...Object.keys(c),...g?[f]:[]])}),t},k.Exception=p,k.DEBUG=!!k.DEBUG,k.isLoggingEnabled=!!k.isLoggingEnabled,f.Capacitor=k),r=q.registerPlugin;class s{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(a,b){let c=!1;this.listeners[a]||(this.listeners[a]=[],c=!0),this.listeners[a].push(b);let d=this.windowListeners[a];return d&&!d.registered&&this.addWindowListener(d),c&&this.sendRetainedArgumentsForEvent(a),Promise.resolve({remove:async()=>this.removeListener(a,b)})}async removeAllListeners(){for(let a in this.listeners={},this.windowListeners)this.removeWindowListener(this.windowListeners[a]);this.windowListeners={}}notifyListeners(a,b,c){let d=this.listeners[a];if(!d){if(c){let c=this.retainedEventArguments[a];c||(c=[]),c.push(b),this.retainedEventArguments[a]=c}return}d.forEach(a=>a(b))}hasListeners(a){var b;return!!(null==(b=this.listeners[a])?void 0:b.length)}registerWindowListener(a,b){this.windowListeners[b]={registered:!1,windowEventName:a,pluginEventName:b,handler:a=>{this.notifyListeners(b,a)}}}unimplemented(a="not implemented"){return new q.Exception(a,b.Unimplemented)}unavailable(a="not available"){return new q.Exception(a,b.Unavailable)}async removeListener(a,b){let c=this.listeners[a];if(!c)return;let d=c.indexOf(b);this.listeners[a].splice(d,1),this.listeners[a].length||this.removeWindowListener(this.windowListeners[a])}addWindowListener(a){window.addEventListener(a.windowEventName,a.handler),a.registered=!0}removeWindowListener(a){a&&(window.removeEventListener(a.windowEventName,a.handler),a.registered=!1)}sendRetainedArgumentsForEvent(a){let b=this.retainedEventArguments[a];b&&(delete this.retainedEventArguments[a],b.forEach(b=>{this.notifyListeners(a,b)}))}}let t=a=>encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);class u extends s{async getCookies(){let a=document.cookie,b={};return a.split(";").forEach(a=>{if(a.length<=0)return;let[c,d]=a.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=c.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent).trim(),d=d.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent).trim(),b[c]=d}),b}async setCookie(a){try{let b=t(a.key),c=t(a.value),d=`; expires=${(a.expires||"").replace("expires=","")}`,e=(a.path||"/").replace("path=",""),f=null!=a.url&&a.url.length>0?`domain=${a.url}`:"";document.cookie=`${b}=${c||""}${d}; path=${e}; ${f};`}catch(a){return Promise.reject(a)}}async deleteCookie(a){try{document.cookie=`${a.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}}async clearCookies(){try{for(let a of document.cookie.split(";")||[])document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(a){return Promise.reject(a)}}async clearAllCookies(){try{await this.clearCookies()}catch(a){return Promise.reject(a)}}}r("CapacitorCookies",{web:()=>new u});let v=async a=>new Promise((b,c)=>{let d=new FileReader;d.onload=()=>{let a=d.result;b(a.indexOf(",")>=0?a.split(",")[1]:a)},d.onerror=a=>c(a),d.readAsDataURL(a)});class w extends s{async request(a){let b,c,d=((a,b={})=>{let c=Object.assign({method:a.method||"GET",headers:a.headers},b),d=((a={})=>{let b=Object.keys(a);return Object.keys(a).map(a=>a.toLocaleLowerCase()).reduce((c,d,e)=>(c[d]=a[b[e]],c),{})})(a.headers)["content-type"]||"";if("string"==typeof a.data)c.body=a.data;else if(d.includes("application/x-www-form-urlencoded")){let b=new URLSearchParams;for(let[c,d]of Object.entries(a.data||{}))b.set(c,d);c.body=b.toString()}else if(d.includes("multipart/form-data")||a.data instanceof FormData){let b=new FormData;if(a.data instanceof FormData)a.data.forEach((a,c)=>{b.append(c,a)});else for(let c of Object.keys(a.data))b.append(c,a.data[c]);c.body=b;let d=new Headers(c.headers);d.delete("content-type"),c.headers=d}else(d.includes("application/json")||"object"==typeof a.data)&&(c.body=JSON.stringify(a.data));return c})(a,a.webFetchExtra),e=((a,b=!0)=>a?Object.entries(a).reduce((a,c)=>{let d,e,[f,g]=c;return Array.isArray(g)?(e="",g.forEach(a=>{d=b?encodeURIComponent(a):a,e+=`${f}=${d}&`}),e.slice(0,-1)):(d=b?encodeURIComponent(g):g,e=`${f}=${d}`),`${a}&${e}`},"").substr(1):null)(a.params,a.shouldEncodeUrlParams),f=e?`${a.url}?${e}`:a.url,g=await fetch(f,d),h=g.headers.get("content-type")||"",{responseType:i="text"}=g.ok?a:{};switch(h.includes("application/json")&&(i="json"),i){case"arraybuffer":case"blob":c=await g.blob(),b=await v(c);break;case"json":b=await g.json();break;default:b=await g.text()}let j={};return g.headers.forEach((a,b)=>{j[b]=a}),{data:b,headers:j,status:g.status,url:g.url}}async get(a){return this.request(Object.assign(Object.assign({},a),{method:"GET"}))}async post(a){return this.request(Object.assign(Object.assign({},a),{method:"POST"}))}async put(a){return this.request(Object.assign(Object.assign({},a),{method:"PUT"}))}async patch(a){return this.request(Object.assign(Object.assign({},a),{method:"PATCH"}))}async delete(a){return this.request(Object.assign(Object.assign({},a),{method:"DELETE"}))}}r("CapacitorHttp",{web:()=>new w}),(h=c||(c={})).Dark="DARK",h.Light="LIGHT",h.Default="DEFAULT",(i=d||(d={})).StatusBar="StatusBar",i.NavigationBar="NavigationBar";class x extends s{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}r("SystemBars",{web:()=>new x}),a.s(["Capacitor",()=>q,"WebPlugin",()=>s,"registerPlugin",()=>r])},60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(59197),f=a.i(53774);let g=null;async function h(){if(f.Capacitor.isNativePlatform()&&!g)try{g=(await a.A(19258)).CapacitorWifi}catch(a){console.error("Failed to load WiFi plugin:",a)}return g}async function i(){if(!f.Capacitor.isNativePlatform())return{ssid:null,bssid:null,isConnected:!1};let a=await h();if(!a)return{ssid:null,bssid:null,isConnected:!1};try{let b=await a.getWifiInfo();return{ssid:b.ssid||null,bssid:b.bssid||null,isConnected:!!b.ssid}}catch(a){return console.error("Error getting WiFi info:",a),{ssid:null,bssid:null,isConnected:!1}}}async function j(){if(!f.Capacitor.isNativePlatform())return!0;let a=await h();if(!a)return!1;try{let b=await a.checkPermissions();if("granted"===b.location)return!0;let c=await a.requestPermissions();return"granted"===c.location}catch(a){return console.error("Error checking/requesting permissions:",a),!1}}function k(){let a=(0,d.useRouter)(),g=(0,d.useSearchParams)(),[h,k]=(0,c.useState)("loading"),[l,m]=(0,c.useState)(null);if((0,c.useEffect)(()=>{!async function(){try{let b,c=f.Capacitor.isNativePlatform(),d=g.get("nas_id")||void 0;if(c)try{let a=async()=>{if(await j()){let a=await i();a.isConnected&&a.bssid&&(b=a.bssid)}},c=new Promise((a,b)=>setTimeout(()=>b(Error("Timeout")),1500));await Promise.race([a(),c])}catch(a){console.warn("WiFi detection skipped or failed:",a)}let h=await (0,e.clientResolveTenant)(d,b);h?a.replace(`/${h}`):k("tenant_not_found")}catch(a){console.error("Failed to resolve tenant",a),m("Errore durante l'identificazione dello spazio chat."),k("error")}}()},[a,g]),"loading"===h)return(0,b.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,b.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Inizializzazione in corso..."})});let n={permission_denied:{title:"Permessi Richiesti",message:"Per identificare la tua posizione, l'app ha bisogno del permesso di localizzazione.",hint:"Vai nelle Impostazioni del telefono e abilita i permessi di localizzazione per TrenoChat."},wifi_disconnected:{title:"WiFi Non Connesso",message:"Devi essere connesso alla rete WiFi del locale per accedere alla chat.",hint:"Connettiti al WiFi del treno o del locale e riprova."},tenant_not_found:{title:"Accesso Negato",message:"Impossibile identificare lo spazio chat.",hint:"Assicurati di essere connesso al WiFi corretto (es. Treno WiFi)."},error:{title:"Errore",message:l||"Si è verificato un errore imprevisto.",hint:"Riprova più tardi."}}[h];return(0,b.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-100 p-4",children:(0,b.jsxs)("div",{className:"text-center p-8 bg-white rounded-2xl shadow-lg max-w-md",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-50 flex items-center justify-center",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:n.title}),(0,b.jsx)("p",{className:"text-gray-600 mb-2",children:n.message}),(0,b.jsx)("p",{className:"text-gray-400 text-sm",children:n.hint}),(0,b.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-2.5 bg-emerald-500 text-white rounded-full font-medium hover:bg-emerald-600 transition-colors",children:"Riprova"})]})})}function l(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,b.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Inizializzazione in corso..."})}),children:(0,b.jsx)(k,{})})}a.s(["default",()=>l],60350)},19258,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_@capgo_capacitor-wifi_dist_esm_2adb2641._.js"].map(b=>a.l(b))).then(()=>b(69163)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a3cc2ec3._.js.map