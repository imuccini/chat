(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95969,e=>{"use strict";let t,r,n,i,s,o,a,l,u;var c,d,h,p,f,m,g,y,v=e.i(43476),b=e.i(71645),x=e.i(18566);let w=Object.create(null);w.open="0",w.close="1",w.ping="2",w.pong="3",w.message="4",w.upgrade="5",w.noop="6";let _=Object.create(null);Object.keys(w).forEach(e=>{_[w[e]]=e});let S={type:"error",data:"parser error"},C="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),T="function"==typeof ArrayBuffer,E=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,k=({type:e,data:t},r,n)=>{if(C&&t instanceof Blob)if(r)return n(t);else return R(t,n);if(T&&(t instanceof ArrayBuffer||E(t)))if(r)return n(t);else return R(new Blob([t]),n);return n(w[e]+(t||""))},R=(e,t)=>{let r=new FileReader;return r.onload=function(){t("b"+(r.result.split(",")[1]||""))},r.readAsDataURL(e)};function z(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j="u"<typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<I.length;e++)j[I.charCodeAt(e)]=e;let O="function"==typeof ArrayBuffer,N=(e,t)=>{if("string"!=typeof e)return{type:"message",data:$(e,t)};let r=e.charAt(0);return"b"===r?{type:"message",data:A(e.substring(1),t)}:_[r]?e.length>1?{type:_[r],data:e.substring(1)}:{type:_[r]}:S},A=(e,t)=>O?$((e=>{let t=.75*e.length,r=e.length,n,i=0,s,o,a,l;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let u=new ArrayBuffer(t),c=new Uint8Array(u);for(n=0;n<r;n+=4)s=j[e.charCodeAt(n)],o=j[e.charCodeAt(n+1)],a=j[e.charCodeAt(n+2)],l=j[e.charCodeAt(n+3)],c[i++]=s<<2|o>>4,c[i++]=(15&o)<<4|a>>2,c[i++]=(3&a)<<6|63&l;return u})(e),t):{base64:!0,data:e},$=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer;function P(e){return e.reduce((e,t)=>e+t.length,0)}function L(e,t){if(e[0].length===t)return e.shift();let r=new Uint8Array(t),n=0;for(let i=0;i<t;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function M(e){if(e){var t=e;for(var r in M.prototype)t[r]=M.prototype[r];return t}}M.prototype.on=M.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},M.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},M.prototype.off=M.prototype.removeListener=M.prototype.removeAllListeners=M.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},M.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,t)}return this},M.prototype.emitReserved=M.prototype.emit,M.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},M.prototype.hasListeners=function(e){return!!this.listeners(e).length};let B="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),D="u">typeof self?self:"u">typeof window?window:Function("return this")();function H(e,...t){return t.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}let Z=D.setTimeout,U=D.clearTimeout;function F(e,t){t.useNativeTimers?(e.setTimeoutFn=Z.bind(D),e.clearTimeoutFn=U.bind(D)):(e.setTimeoutFn=D.setTimeout.bind(D),e.clearTimeoutFn=D.clearTimeout.bind(D))}function V(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class W extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class q extends M{constructor(e){super(),this.writable=!1,F(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new W(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=N(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return -1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){let t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}class G extends q{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};((e,t)=>{let r=e.split("\x1e"),n=[];for(let e=0;e<r.length;e++){let i=N(r[e],t);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){let e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){var t;let r,n,i;this.writable=!1,t=e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})},n=Array(r=e.length),i=0,e.forEach((e,s)=>{k(e,!1,e=>{n[s]=e,++i===r&&t(n.join("\x1e"))})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=V()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let J=!1;try{J="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}let Q=J;function K(){}class Y extends G{constructor(e){if(super(e),"u">typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="u">typeof location&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class X extends M{constructor(e,t,r){super(),this.createRequest=e,F(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var e;let t=H(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let e in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this._opts.extraHeaders[e])}catch(e){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}null==(e=this._opts.cookieJar)||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null==(e=this._opts.cookieJar)||e.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof r.status?r.status:0)},0))},r.send(this._data)}catch(e){this.setTimeoutFn(()=>{this._onError(e)},0);return}"u">typeof document&&(this._index=X.requestsCount++,X.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=K,e)try{this._xhr.abort()}catch(e){}"u">typeof document&&delete X.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function ee(){for(let e in X.requests)X.requests.hasOwnProperty(e)&&X.requests[e].abort()}X.requestsCount=0,X.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",ee):"function"==typeof addEventListener&&addEventListener("onpagehide"in D?"pagehide":"unload",ee,!1));let et=(n=er({xdomain:!1}))&&null!==n.responseType;function er(e){let t=e.xdomain;try{if("u">typeof XMLHttpRequest&&(!t||Q))return new XMLHttpRequest}catch(e){}if(!t)try{return new D[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}let en="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class ei extends q{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,r=en?{}:H(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;k(r,this.supportsBinary,e=>{try{this.doWrite(r,e)}catch(e){}n&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=V()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}let es=D.WebSocket||D.MozWebSocket,eo={websocket:class extends ei{createSocket(e,t,r){return en?new es(e,t,r):t?new es(e,t):new es(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends q{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{var n,i;let s,o,a,l,u=(n=Number.MAX_SAFE_INTEGER,i=this.socket.binaryType,r||(r=new TextDecoder),s=[],o=0,a=-1,l=!1,new TransformStream({transform(e,t){for(s.push(e);;){if(0===o){if(1>P(s))break;let e=L(s,1);l=(128&e[0])==128,o=(a=127&e[0])<126?3:126===a?1:2}else if(1===o){if(2>P(s))break;let e=L(s,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),o=3}else if(2===o){if(8>P(s))break;let e=L(s,8),r=new DataView(e.buffer,e.byteOffset,e.length),n=r.getUint32(0);if(n>2097151){t.enqueue(S);break}a=0x100000000*n+r.getUint32(4),o=3}else{if(P(s)<a)break;let e=L(s,a);t.enqueue(N(l?e:r.decode(e),i)),o=0}if(0===a||a>n){t.enqueue(S);break}}}})),c=e.readable.pipeThrough(u).getReader(),d=new TransformStream({transform(e,r){var n;n=t=>{let n,i=t.length;if(i<126)new DataView((n=new Uint8Array(1)).buffer).setUint8(0,i);else if(i<65536){let e=new DataView((n=new Uint8Array(3)).buffer);e.setUint8(0,126),e.setUint16(1,i)}else{let e=new DataView((n=new Uint8Array(9)).buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(n[0]|=128),r.enqueue(n),r.enqueue(t)},C&&e.data instanceof Blob?e.data.arrayBuffer().then(z).then(n):T&&(e.data instanceof ArrayBuffer||E(e.data))?n(z(e.data)):k(e,!1,e=>{t||(t=new TextEncoder),n(t.encode(e))})}});d.readable.pipeTo(e.writable),this._writer=d.writable.getWriter();let h=()=>{c.read().then(({done:e,value:t})=>{e||(this.onPacket(t),h())}).catch(e=>{})};h();let p={type:"open"};this.query.sid&&(p.data=`{"sid":"${this.query.sid}"}`),this._writer.write(p).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;this._writer.write(r).then(()=>{n&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null==(e=this._transport)||e.close()}},polling:class extends Y{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=et&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new X(er,this.uri(),e)}}},ea=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,el=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function eu(e){var t,r;let n,i;if(e.length>8e3)throw"URI too long";let s=e,o=e.indexOf("["),a=e.indexOf("]");-1!=o&&-1!=a&&(e=e.substring(0,o)+e.substring(o,a).replace(/:/g,";")+e.substring(a,e.length));let l=ea.exec(e||""),u={},c=14;for(;c--;)u[el[c]]=l[c]||"";return -1!=o&&-1!=a&&(u.source=s,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),n=(t=u.path).replace(/\/{2,9}/g,"/").split("/"),("/"==t.slice(0,1)||0===t.length)&&n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),u.pathNames=n,r=u.query,i={},r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(i[t]=r)}),u.queryKey=i,u}let ec="function"==typeof addEventListener&&"function"==typeof removeEventListener,ed=[];ec&&addEventListener("offline",()=>{ed.forEach(e=>e())},!1);class eh extends M{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const r=eu(e);t.hostname=r.host,t.secure="https"===r.protocol||"wss"===r.protocol,t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=eu(t.host).host);F(this,t),this.secure=null!=t.secure?t.secure:"u">typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("u">typeof location?location.hostname:"localhost"),this.port=t.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{let t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),ec&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ed.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);let e=this.opts.rememberUpgrade&&eh.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",eh.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r&&(e+="string"==typeof r?function(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(r):Math.ceil(1.33*(r.byteLength||r.size))),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,B(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(eh.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ec&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let e=ed.indexOf(this._offlineEventListener);-1!==e&&ed.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}eh.protocol=4;class ep extends eh{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;eh.priorWebsocketSuccess=!1;let n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;eh.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{r||"closed"!==this.readyState&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{let e=Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function i(){r||(r=!0,u(),t.close(),t=null)}let s=e=>{let r=Error("probe error: "+e);r.transport=t.name,i(),this.emitReserved("upgradeError",r)};function o(){s("transport closed")}function a(){s("socket closed")}function l(e){t&&e.name!==t.name&&i()}let u=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",o),this.off("close",a),this.off("upgrading",l)};t.once("open",n),t.once("error",s),t.once("close",o),this.once("close",a),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}class ef extends ep{constructor(e,t={}){const r="object"==typeof e?e:t;(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(e=>eo[e]).filter(e=>!!e)),super(e,r)}}ef.protocol;let em="function"==typeof ArrayBuffer,eg=Object.prototype.toString,ey="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===eg.call(Blob),ev="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===eg.call(File);function eb(e){return em&&(e instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer))||ey&&e instanceof Blob||ev&&e instanceof File}let ex=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];(c=f||(f={}))[c.CONNECT=0]="CONNECT",c[c.DISCONNECT=1]="DISCONNECT",c[c.EVENT=2]="EVENT",c[c.ACK=3]="ACK",c[c.CONNECT_ERROR=4]="CONNECT_ERROR",c[c.BINARY_EVENT=5]="BINARY_EVENT",c[c.BINARY_ACK=6]="BINARY_ACK";class ew{constructor(e){this.replacer=e}encode(e){return(e.type===f.EVENT||e.type===f.ACK)&&function e(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(e(t[r]))return!0;return!1}if(eb(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)?this.encodeAsBinary({type:e.type===f.EVENT?f.BINARY_EVENT:f.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===f.BINARY_EVENT||e.type===f.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t,r,n=(t=[],r=e.data,e.data=function e(t,r){if(!t)return t;if(eb(t)){let e={_placeholder:!0,num:r.length};return r.push(t),e}if(Array.isArray(t)){let n=Array(t.length);for(let i=0;i<t.length;i++)n[i]=e(t[i],r);return n}if("object"==typeof t&&!(t instanceof Date)){let n={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e(t[i],r));return n}return t}(r,t),e.attachments=t.length,{packet:e,buffers:t}),i=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(i),s}}class e_ extends M{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let r=(t=this.decodeString(e)).type===f.BINARY_EVENT;r||t.type===f.BINARY_ACK?(t.type=r?f.EVENT:f.ACK,this.reconstructor=new eS(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(eb(e)||e.base64)if(this.reconstructor)(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(void 0===f[r.type])throw Error("unknown packet type "+r.type);if(r.type===f.BINARY_EVENT||r.type===f.BINARY_ACK){let n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);let i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){let n=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(n,t)}else r.nsp="/";let n=e.charAt(t+1);if(""!==n&&Number(n)==n){let n=t+1;for(;++t;){let r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){let n=this.tryParse(e.substr(t));if(e_.isPayloadValid(r.type,n))r.data=n;else throw Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case f.CONNECT:return eT(t);case f.DISCONNECT:return void 0===t;case f.CONNECT_ERROR:return"string"==typeof t||eT(t);case f.EVENT:case f.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ex.indexOf(t[0]));case f.ACK:case f.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class eS{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t,r;let e=(t=this.reconPack,r=this.buffers,t.data=function e(t,r){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<r.length)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=e(t[n],r);else if("object"==typeof t)for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e(t[n],r));return t}(t.data,r),delete t.attachments,t);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}let eC=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function eT(e){return"[object Object]"===Object.prototype.toString.call(e)}function eE(e){var t;return"string"==typeof e.nsp&&(void 0===(t=e.id)||eC(t))&&function(e,t){switch(e){case f.CONNECT:return void 0===t||eT(t);case f.DISCONNECT:return void 0===t;case f.EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ex.indexOf(t[0]));case f.ACK:return Array.isArray(t);case f.CONNECT_ERROR:return"string"==typeof t||eT(t);default:return!1}}(e.type,e.data)}function ek(e,t,r){return e.on(t,r),function(){e.off(t,r)}}e.s(["Decoder",()=>e_,"Encoder",()=>ew,"PacketType",()=>f,"isPacketValid",()=>eE,"protocol",0,5],51890);let eR=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ez extends M{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[ek(e,"open",this.onopen.bind(this)),ek(e,"packet",this.onpacket.bind(this)),ek(e,"error",this.onerror.bind(this)),ek(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,n,i;if(eR.hasOwnProperty(e))throw Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let s={type:f.EVENT,data:t};if(s.options={},s.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){let e=this.ids++,r=t.pop();this._registerAckCallback(e,r),s.id=e}let o=null==(n=null==(r=this.io.engine)?void 0:r.transport)?void 0:n.writable,a=this.connected&&!(null==(i=this.io.engine)?void 0:i._hasPingExpired());return this.flags.volatile&&!o||(a?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var r;let n=null!=(r=this.flags.timeout)?r:this._opts.ackTimeout;if(void 0===n){this.acks[e]=t;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,Error("operation has timed out"))},n),s=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,e)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...t){return new Promise((r,n)=>{let i=(e,t)=>e?n(e):r(t);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...n)=>(this._queue[0],null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;let t=this._queue[0];(!t.pending||e)&&(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:f.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case f.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case f.EVENT:case f.BINARY_EVENT:this.onevent(e);break;case f.ACK:case f.BINARY_ACK:this.onack(e);break;case f.DISCONNECT:this.ondisconnect();break;case f.CONNECT_ERROR:this.destroy();let t=Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){let t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(let t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...n){r||(r=!0,t.packet({type:f.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:f.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}var eI=e.i(51890);function ej(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ej.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(1&Math.floor(10*t))==0?e-r:e+r}return 0|Math.min(e,this.max)},ej.prototype.reset=function(){this.attempts=0},ej.prototype.setMin=function(e){this.ms=e},ej.prototype.setMax=function(e){this.max=e},ej.prototype.setJitter=function(e){this.jitter=e};class eO extends M{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,F(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(r=t.randomizationFactor)?r:.5),this.backoff=new ej({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||eI;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null==(t=this.backoff)||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null==(t=this.backoff)||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null==(t=this.backoff)||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ef(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=ek(t,"open",function(){r.onopen(),e&&e()}),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=ek(t,"error",i);if(!1!==this._timeout){let e=this._timeout,r=this.setTimeoutFn(()=>{n(),i(Error("timeout")),t.close()},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(ek(e,"ping",this.onping.bind(this)),ek(e,"data",this.ondata.bind(this)),ek(e,"error",this.onerror.bind(this)),ek(e,"close",this.onclose.bind(this)),ek(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){B(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new ez(this,e,t),this.nsps[e]=r),r}_destroy(e){for(let e of Object.keys(this.nsps))if(this.nsps[e].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),null==(r=this.engine)||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}let eN={};function eA(e,t){let r;"object"==typeof e&&(t=e,e=void 0);let n=function(e,t="",r){let n=e;r=r||"u">typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=eu(e)),!n.port&&(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),i=n.source,s=n.id,o=n.path,a=eN[s]&&o in eN[s].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?r=new eO(i,t):(eN[s]||(eN[s]=new eO(i,t)),r=eN[s]),n.query&&!t.query&&(t.query=n.queryKey),r.socket(n.path,t)}Object.assign(eA,{Manager:eO,Socket:ez,io:eA,connect:eA});var e$=e.i(41533),eP=e.i(75555),eL=e.i(40143),eM=e.i(86491),eB=e.i(15823),eD=e.i(93803),eH=e.i(19273),eZ=e.i(80166),eU=class extends eB.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,eD.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#n=void 0;#i=void 0;#s=void 0;#o;#a;#r;#t;#l;#u;#c;#d;#h;#p;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#n.addObserver(this),eF(this.#n,this.options)?this.#m():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return eV(this.#n,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return eV(this.#n,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#v(),this.#n.removeObserver(this)}setOptions(e){let t=this.options,r=this.#n;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,eH.resolveEnabled)(this.options.enabled,this.#n))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#n.setOptions(this.options),t._defaulted&&!(0,eH.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#n,observer:this});let n=this.hasListeners();n&&eW(this.#n,r,this.options,t)&&this.#m(),this.updateResult(),n&&(this.#n!==r||(0,eH.resolveEnabled)(this.options.enabled,this.#n)!==(0,eH.resolveEnabled)(t.enabled,this.#n)||(0,eH.resolveStaleTime)(this.options.staleTime,this.#n)!==(0,eH.resolveStaleTime)(t.staleTime,this.#n))&&this.#x();let i=this.#w();n&&(this.#n!==r||(0,eH.resolveEnabled)(this.options.enabled,this.#n)!==(0,eH.resolveEnabled)(t.enabled,this.#n)||i!==this.#p)&&this.#_(i)}getOptimisticResult(e){var t,r;let n=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(n,e);return t=this,r=i,(0,eH.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#s=i,this.#a=this.options,this.#o=this.#n.state),i}getCurrentResult(){return this.#s}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#n}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#m(e){this.#b();let t=this.#n.fetch(this.options,e);return e?.throwOnError||(t=t.catch(eH.noop)),t}#x(){this.#y();let e=(0,eH.resolveStaleTime)(this.options.staleTime,this.#n);if(eH.isServer||this.#s.isStale||!(0,eH.isValidTimeout)(e))return;let t=(0,eH.timeUntilStale)(this.#s.dataUpdatedAt,e);this.#d=eZ.timeoutManager.setTimeout(()=>{this.#s.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#n):this.options.refetchInterval)??!1}#_(e){this.#v(),this.#p=e,!eH.isServer&&!1!==(0,eH.resolveEnabled)(this.options.enabled,this.#n)&&(0,eH.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=eZ.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||eP.focusManager.isFocused())&&this.#m()},this.#p))}#g(){this.#x(),this.#_(this.#w())}#y(){this.#d&&(eZ.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#v(){this.#h&&(eZ.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,n=this.#n,i=this.options,s=this.#s,o=this.#o,a=this.#a,l=e!==n?e.state:this.#i,{state:u}=e,c={...u},d=!1;if(t._optimisticResults){let r=this.hasListeners(),s=!r&&eF(e,t),o=r&&eW(e,n,t,i);(s||o)&&(c={...c,...(0,eM.fetchState)(u.data,e.options)}),"isRestoring"===t._optimisticResults&&(c.fetchStatus="idle")}let{error:h,errorUpdatedAt:p,status:f}=c;r=c.data;let m=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===f){let e;s?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(e=s.data,m=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(f="success",r=(0,eH.replaceData)(s?.data,e,t),d=!0)}if(t.select&&void 0!==r&&!m)if(s&&r===o?.data&&t.select===this.#l)r=this.#u;else try{this.#l=t.select,r=t.select(r),r=(0,eH.replaceData)(s?.data,r,t),this.#u=r,this.#t=null}catch(e){this.#t=e}this.#t&&(h=this.#t,r=this.#u,p=Date.now(),f="error");let g="fetching"===c.fetchStatus,y="pending"===f,v="error"===f,b=y&&g,x=void 0!==r,w={status:f,fetchStatus:c.fetchStatus,isPending:y,isSuccess:"success"===f,isError:v,isInitialLoading:b,isLoading:b,data:r,dataUpdatedAt:c.dataUpdatedAt,error:h,errorUpdatedAt:p,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>l.dataUpdateCount||c.errorUpdateCount>l.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:v&&!x,isPaused:"paused"===c.fetchStatus,isPlaceholderData:d,isRefetchError:v&&x,isStale:eq(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,eH.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==w.data,r="error"===w.status&&!t,i=e=>{r?e.reject(w.error):t&&e.resolve(w.data)},s=()=>{i(this.#r=w.promise=(0,eD.pendingThenable)())},o=this.#r;switch(o.status){case"pending":e.queryHash===n.queryHash&&i(o);break;case"fulfilled":(r||w.data!==o.value)&&s();break;case"rejected":r&&w.error===o.reason||s()}}return w}updateResult(){let e=this.#s,t=this.createResult(this.#n,this.options);if(this.#o=this.#n.state,this.#a=this.options,void 0!==this.#o.data&&(this.#c=this.#n),(0,eH.shallowEqualObjects)(t,e))return;this.#s=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;let n=new Set(r??this.#f);return this.options.throwOnError&&n.add("error"),Object.keys(this.#s).some(t=>this.#s[t]!==e[t]&&n.has(t))};this.#S({listeners:r()})}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#n)return;let t=this.#n;this.#n=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#S(e){eL.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#n,type:"observerResultsUpdated"})})}};function eF(e,t){return!1!==(0,eH.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&eV(e,t,t.refetchOnMount)}function eV(e,t,r){if(!1!==(0,eH.resolveEnabled)(t.enabled,e)&&"static"!==(0,eH.resolveStaleTime)(t.staleTime,e)){let n="function"==typeof r?r(e):r;return"always"===n||!1!==n&&eq(e,t)}return!1}function eW(e,t,r,n){return(e!==t||!1===(0,eH.resolveEnabled)(n.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&eq(e,r)}function eq(e,t){return!1!==(0,eH.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,eH.resolveStaleTime)(t.staleTime,e))}var eG=e.i(47167),eJ=e.i(12598),eQ=b.createContext((i=!1,{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i})),eK=b.createContext(!1);eK.Provider;var eY=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()}),eX=e.i(82568);(0,eX.registerPlugin)("CapacitorSQLite",{web:()=>e.A(29126).then(e=>new e.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite});let e0=new class{sqlite=null;db=null;dbName="chat_cache";async initialize(){console.log("SQLite: Disabled for debugging.")}async saveMessage(e,t=!0){if(this.db||await this.initialize(),!this.db)return;let r=`
            INSERT OR REPLACE INTO messages (id, text, senderId, senderAlias, senderGender, timestamp, recipientId, roomId, isGlobal)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);
        `,n=[e.id,e.text,e.senderId,e.senderAlias,e.senderGender,e.timestamp,e.recipientId||null,e.roomId||null,+!!t];try{await this.db.run(r,n)}catch(e){console.error("Error saving message to SQLite:",e)}}async purgeOldMessages(){if(this.db||await this.initialize(),!this.db)return;let e=new Date(Date.now()-108e5).toISOString();try{await this.db.run("DELETE FROM messages WHERE timestamp < ?;",[e]),console.log("SQLite: Purged messages older than:",e)}catch(e){console.error("Error purging old messages from SQLite:",e)}}async getMessages(e=!0,t){if(await this.purgeOldMessages(),!this.db)return[];let r=new Date(Date.now()-108e5).toISOString(),n="",i=[];e?t?(n="SELECT * FROM messages WHERE roomId = ? AND timestamp >= ? ORDER BY timestamp ASC LIMIT 100;",i=[t,r]):(n='SELECT * FROM messages WHERE isGlobal = 1 AND (roomId IS NULL OR roomId = "") AND timestamp >= ? ORDER BY timestamp ASC LIMIT 100;',i=[r]):(n="SELECT * FROM messages WHERE isGlobal = 0 AND timestamp >= ? ORDER BY timestamp ASC LIMIT 100;",i=[r]);try{return((await this.db.query(n,i)).values||[]).map(e=>({...e,isGlobal:void 0}))}catch(e){return console.error("Error fetching messages from SQLite:",e),[]}}async clearMessages(){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages;",[])}catch(e){console.error("Error clearing messages from SQLite:",e)}}async deleteMessage(e){if(this.db||await this.initialize(),this.db)try{await this.db.run("DELETE FROM messages WHERE id = ?;",[e])}catch(e){console.error("Error deleting message from SQLite:",e)}}async getPrivateChats(e){if(await this.purgeOldMessages(),!this.db)return[];try{let t=new Date(Date.now()-108e5).toISOString(),r=((await this.db.query("SELECT * FROM messages WHERE isGlobal = 0 AND timestamp >= ? ORDER BY timestamp ASC;",[t])).values||[]).map(e=>({id:e.id,text:e.text,senderId:e.senderId,senderAlias:e.senderAlias,senderGender:e.senderGender,timestamp:e.timestamp,recipientId:e.recipientId})),n=new Map;for(let t of r){let r=t.senderId===e?t.recipientId:t.senderId;n.has(r)||n.set(r,[]),n.get(r).push(t)}return Array.from(n.entries()).map(([e,t])=>({peerId:e,messages:t}))}catch(e){return console.error("Error loading private chats from SQLite:",e),[]}}};(d=m||(m={})).Dark="DARK",d.Light="LIGHT",d.Default="DEFAULT",(h=g||(g={})).Body="body",h.Ionic="ionic",h.Native="native",h.None="none";let e1=(0,eX.registerPlugin)("Keyboard");var e2=e.i(67065);let e4=(0,eX.registerPlugin)("Haptics",{web:()=>e.A(19924).then(e=>new e.HapticsWeb)}),e9=Object.create(null),e3=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?e9:globalThis),e5=new Proxy(e9,{get:(e,t)=>e3()[t]??e9[t],has:(e,t)=>t in e3()||t in e9,set:(e,t,r)=>(e3(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=e3(!0);return delete r[t],!0},ownKeys:()=>Object.keys(e3(!0))});function e6(e,t){return void 0!==eG.default&&eG.default.env?eG.default.env[e]??t:"u">typeof Deno?Deno.env.get(e)??t:"u">typeof Bun?Bun.env[e]??t:t}void 0!==eG.default&&eG.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return e6("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return e6("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return e6("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return e6("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return e6("NODE_ENV","development")},get PACKAGE_VERSION(){return e6("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return e6("BETTER_AUTH_TELEMETRY_ENDPOINT","")}});let e7={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},e8=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),te=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],tt="\x1b[0m",tr="\x1b[31m",tn="\x1b[32m",ti="\x1b[33m",ts="\x1b[34m",to="\x1b[35m",ta=["debug","info","success","warn","error"],tl={info:ts,success:tn,warn:ti,error:tr,debug:to};function tu(e,t,r){function n(r,n){if(r._zod||Object.defineProperty(r,"_zod",{value:{def:n,constr:o,traits:new Set},enumerable:!1}),r._zod.traits.has(e))return;r._zod.traits.add(e),t(r,n);let i=o.prototype,s=Object.keys(i);for(let e=0;e<s.length;e++){let t=s[e];t in r||(r[t]=i[t].bind(r))}}let i=r?.Parent??Object;class s extends i{}function o(e){var t;let i=r?.Parent?new s:this;for(let r of(n(i,e),(t=i._zod).deferred??(t.deferred=[]),i._zod.deferred))r();return i}return Object.defineProperty(s,"name",{value:e}),Object.defineProperty(o,"init",{value:n}),Object.defineProperty(o,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(o,"name",{value:e}),o}s=p?.disabled!==!0,o=p?.level??"warn",a=p?.disableColors!==void 0?!p.disableColors:1!==function(){if(void 0!==e6("FORCE_COLOR"))switch(e6("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==e6("NODE_DISABLE_COLORS")&&""!==e6("NODE_DISABLE_COLORS")||void 0!==e6("NO_COLOR")&&""!==e6("NO_COLOR")||"dumb"===e6("TERM"))return 1;if(e6("TMUX"))return 24;if("TF_BUILD"in e5&&"AGENT_NAME"in e5)return 4;if("CI"in e5){for(let{0:e,1:t}of e8)if(e in e5)return t;return"codeship"===e6("CI_NAME")?8:1}if("TEAMCITY_VERSION"in e5)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(e6("TEAMCITY_VERSION"))?4:1;switch(e6("TERM_PROGRAM")){case"iTerm.app":if(!e6("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(e6("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===e6("COLORTERM")||"24bit"===e6("COLORTERM"))return 24;if(e6("TERM")){if(null!==/truecolor/.exec(e6("TERM")))return 24;if(null!==/^xterm-256/.exec(e6("TERM")))return 8;let e=e6("TERM").toLowerCase();if(e7[e])return e7[e];if(te.some(t=>null!==t.exec(e)))return 4}return e6("COLORTERM")?4:1}(),Object.fromEntries(ta.map(e=>[e,(...[t,...r])=>((e,t,r=[])=>{let n;if(!s||!(ta.indexOf(e)>=ta.indexOf(o)))return;let i=(n=new Date().toISOString(),a?`\x1b[2m${n}${tt} ${tl[e]}${e.toUpperCase()}${tt} \x1b[1m[Better Auth]:${tt} ${t}`:`${n} ${e.toUpperCase()} [Better Auth]: ${t}`);p&&"function"==typeof p.log?p.log("success"===e?"info":e,t,...r):"error"===e?console.error(i,...r):"warn"===e?console.warn(i,...r):console.log(i,...r)})(e,t,r)])),Object.freeze({status:"aborted"}),Symbol("zod_brand");class tc extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class td extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let th={};function tp(e){return e&&Object.assign(th,e),th}function tf(e){return e}function tm(e){return e}function tg(e){}function ty(e){throw Error("Unexpected value in exhaustive check")}function tv(e){}function tb(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function tx(e,t="|"){return e.map(e=>tJ(e)).join(t)}function tw(e,t){return"bigint"==typeof t?t.toString():t}function t_(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function tS(e){return null==e}function tC(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function tT(e,t){let r=(e.toString().split(".")[1]||"").length,n=t.toString(),i=(n.split(".")[1]||"").length;if(0===i&&/\d?e-\d?/.test(n)){let e=n.match(/\d?e-(\d?)/);e?.[1]&&(i=Number.parseInt(e[1]))}let s=r>i?r:i;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}let tE=Symbol("evaluating");function tk(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==tE)return void 0===n&&(n=tE,n=r()),n},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function tR(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function tz(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function tI(...e){let t={};for(let r of e)Object.assign(t,Object.getOwnPropertyDescriptors(r));return Object.defineProperties({},t)}function tj(e){return tI(e._zod.def)}function tO(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function tN(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r})}function tA(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function t$(e){return JSON.stringify(e)}function tP(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let tL="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function tM(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let tB=t_(()=>{if("u">typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function tD(e){if(!1===tM(e))return!1;let t=e.constructor;if(void 0===t||"function"!=typeof t)return!0;let r=t.prototype;return!1!==tM(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function tH(e){return tD(e)?{...e}:Array.isArray(e)?[...e]:e}function tZ(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}let tU=new Set(["string","number","symbol"]),tF=new Set(["string","number","bigint","boolean","symbol","undefined"]);function tV(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tW(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function tq(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function tG(e){let t;return new Proxy({},{get:(r,n,i)=>(t??(t=e()),Reflect.get(t,n,i)),set:(r,n,i,s)=>(t??(t=e()),Reflect.set(t,n,i,s)),has:(r,n)=>(t??(t=e()),Reflect.has(t,n)),deleteProperty:(r,n)=>(t??(t=e()),Reflect.deleteProperty(t,n)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,n)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)),defineProperty:(r,n,i)=>(t??(t=e()),Reflect.defineProperty(t,n,i))})}function tJ(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function tQ(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let tK={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},tY={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function tX(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".pick() cannot be used on object schemas containing refinements");let i=tI(e._zod.def,{get shape(){let e={};for(let n in t){if(!(n in r.shape))throw Error(`Unrecognized key: "${n}"`);t[n]&&(e[n]=r.shape[n])}return tz(this,"shape",e),e},checks:[]});return tW(e,i)}function t0(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".omit() cannot be used on object schemas containing refinements");let i=tI(e._zod.def,{get shape(){let n={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete n[e]}return tz(this,"shape",n),n},checks:[]});return tW(e,i)}function t1(e,t){if(!tD(t))throw Error("Invalid input to extend: expected a plain object");let r=e._zod.def.checks;if(r&&r.length>0){let r=e._zod.def.shape;for(let e in t)if(void 0!==Object.getOwnPropertyDescriptor(r,e))throw Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}let n=tI(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tz(this,"shape",r),r}});return tW(e,n)}function t2(e,t){if(!tD(t))throw Error("Invalid input to safeExtend: expected a plain object");let r=tI(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tz(this,"shape",r),r}});return tW(e,r)}function t4(e,t){let r=tI(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return tz(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return tW(e,r)}function t9(e,t,r){let n=t._zod.def.checks;if(n&&n.length>0)throw Error(".partial() cannot be used on object schemas containing refinements");let i=tI(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)i[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return tz(this,"shape",i),i},checks:[]});return tW(t,i)}function t3(e,t,r){let n=tI(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in i))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)i[t]=new e({type:"nonoptional",innerType:n[t]});return tz(this,"shape",i),i}});return tW(t,n)}function t5(e,t=0){if(!0===e.aborted)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function t6(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function t7(e){return"string"==typeof e?e:e?.message}function t8(e,t,r){let n={...e,path:e.path??[]};return e.message||(n.message=t7(e.inst?._zod.def?.error?.(e))??t7(t?.error?.(e))??t7(r.customError?.(e))??t7(r.localeError?.(e))??"Invalid input"),delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function re(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function rt(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function rr(e){let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":if(null===e)return"null";if(Array.isArray(e))return"array";if(e&&Object.getPrototypeOf(e)!==Object.prototype&&"constructor"in e&&e.constructor)return e.constructor.name}return t}function rn(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}}function ri(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function rs(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function ro(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function ra(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return rs(t+r)}function rl(e){return ro(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ru(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=Number.parseInt(t.slice(e,e+2),16);return r}function rc(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class rd{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,tY,"Class",()=>rd,"NUMBER_FORMAT_RANGES",0,tK,"aborted",()=>t5,"allowsEval",0,tB,"assert",()=>tv,"assertEqual",()=>tf,"assertIs",()=>tg,"assertNever",()=>ty,"assertNotEqual",()=>tm,"assignProp",()=>tz,"base64ToUint8Array",()=>rs,"base64urlToUint8Array",()=>ra,"cached",()=>t_,"captureStackTrace",0,tL,"cleanEnum",()=>ri,"cleanRegex",()=>tC,"clone",()=>tW,"cloneDef",()=>tj,"createTransparentProxy",()=>tG,"defineLazy",()=>tk,"esc",()=>t$,"escapeRegex",()=>tV,"extend",()=>t1,"finalizeIssue",()=>t8,"floatSafeRemainder",()=>tT,"getElementAtPath",()=>tO,"getEnumValues",()=>tb,"getLengthableOrigin",()=>rt,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("u">typeof Map&&e instanceof Map)return"map";if("u">typeof Set&&e instanceof Set)return"set";if("u">typeof Date&&e instanceof Date)return"date";if("u">typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>re,"hexToUint8Array",()=>ru,"isObject",()=>tM,"isPlainObject",()=>tD,"issue",()=>rn,"joinValues",()=>tx,"jsonStringifyReplacer",()=>tw,"merge",()=>t4,"mergeDefs",()=>tI,"normalizeParams",()=>tq,"nullish",()=>tS,"numKeys",()=>tZ,"objectClone",()=>tR,"omit",()=>t0,"optionalKeys",()=>tQ,"parsedType",()=>rr,"partial",()=>t9,"pick",()=>tX,"prefixIssues",()=>t6,"primitiveTypes",0,tF,"promiseAllObject",()=>tN,"propertyKeyTypes",0,tU,"randomString",()=>tA,"required",()=>t3,"safeExtend",()=>t2,"shallowClone",()=>tH,"slugify",()=>tP,"stringifyPrimitive",()=>tJ,"uint8ArrayToBase64",()=>ro,"uint8ArrayToBase64url",()=>rl,"uint8ArrayToHex",()=>rc,"unwrapMessage",()=>t7],22143);let rh=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,tw,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},rp=tu("$ZodError",rh),rf=tu("$ZodError",rh,{Parent:Error}),rm=e=>(t,r,n,i)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},o=t._zod.run({value:r,issues:[]},s);if(o instanceof Promise)throw new tc;if(o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>t8(e,s,tp())));throw tL(t,i?.callee),t}return o.value},rg=rm(rf),ry=e=>async(t,r,n,i)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=t._zod.run({value:r,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>t8(e,s,tp())));throw tL(t,i?.callee),t}return o.value},rv=ry(rf),rb=e=>(t,r,n)=>{let i=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},i);if(s instanceof Promise)throw new tc;return s.issues.length?{success:!1,error:new(e??rp)(s.issues.map(e=>t8(e,i,tp())))}:{success:!0,data:s.value}},rx=rb(rf),rw=e=>async(t,r,n)=>{let i=n?Object.assign(n,{async:!0}):{async:!0},s=t._zod.run({value:r,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(e=>t8(e,i,tp())))}:{success:!0,data:s.value}},r_=rw(rf),rS=/^[cC][^\s-]{8,}$/,rC=/^[0-9a-z]+$/,rT=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,rE=/^[0-9a-vA-V]{20}$/,rk=/^[A-Za-z0-9]{27}$/,rR=/^[a-zA-Z0-9_-]{21}$/,rz=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,rI=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,rj=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,rO=rj(4),rN=rj(6),rA=rj(7),r$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,rP=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function rL(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let rM=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rB=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,rD=e=>{let t=tV(e??":");return RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},rH=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,rZ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rU=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,rF=/^[A-Za-z0-9_-]*$/,rV=/^\+[1-9]\d{6,14}$/,rW="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",rq=RegExp(`^${rW}$`);function rG(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function rJ(e){return RegExp(`^${rG(e)}$`)}function rQ(e){let t=rG({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let n=`${t}(?:${r.join("|")})`;return RegExp(`^${rW}T(?:${n})$`)}let rK=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},rY=/^-?\d+n?$/,rX=/^-?\d+$/,r0=/^-?\d+(?:\.\d+)?$/,r1=/^(?:true|false)$/i,r2=/^null$/i,r4=/^undefined$/i,r9=/^[^A-Z]*$/,r3=/^[^a-z]*$/;function r5(e,t){return RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function r6(e){return RegExp(`^[A-Za-z0-9_-]{${e}}$`)}let r7=r5(22,"=="),r8=r6(22),ne=r5(27,"="),nt=r6(27),nr=r5(43,"="),nn=r6(43),ni=r5(64,""),ns=r6(64),no=r5(86,"=="),na=r6(86);e.s(["base64",0,rU,"base64url",0,rF,"bigint",0,rY,"boolean",0,r1,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,rH,"cidrv6",0,rZ,"cuid",0,rS,"cuid2",0,rC,"date",0,rq,"datetime",()=>rQ,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,rz,"e164",0,rV,"email",0,r$,"emoji",()=>rL,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,rI,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,rP,"integer",0,rX,"ipv4",0,rM,"ipv6",0,rB,"ksuid",0,rk,"lowercase",0,r9,"mac",0,rD,"md5_base64",0,r7,"md5_base64url",0,r8,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,rR,"null",()=>r2,"number",0,r0,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,ne,"sha1_base64url",0,nt,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,nr,"sha256_base64url",0,nn,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,ni,"sha384_base64url",0,ns,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,no,"sha512_base64url",0,na,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,rK,"time",()=>rJ,"ulid",0,rT,"undefined",()=>r4,"unicodeEmail",0,rP,"uppercase",0,r3,"uuid",0,rj,"uuid4",0,rO,"uuid6",0,rN,"uuid7",0,rA,"xid",0,rE],82358);let nl=tu("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),nu={number:"number",bigint:"bigint",object:"date"},nc=tu("$ZodCheckLessThan",(e,t)=>{nl.init(e,t);let r=nu[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.maximum:r.exclusiveMaximum)??1/0;t.value<n&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),nd=tu("$ZodCheckGreaterThan",(e,t)=>{nl.init(e,t);let r=nu[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.minimum:r.exclusiveMinimum)??-1/0;t.value>n&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),nh=tu("$ZodCheckMultipleOf",(e,t)=>{nl.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===tT(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),np=tu("$ZodCheckNumberFormat",(e,t)=>{nl.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),n=r?"int":"number",[i,s]=tK[t.format];e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,n.minimum=i,n.maximum=s,r&&(n.pattern=rX)}),e._zod.check=o=>{let a=o.value;if(r){if(!Number.isInteger(a))return void o.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});if(!Number.isSafeInteger(a))return void(a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}))}a<i&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:i,inclusive:!0,inst:e,continue:!t.abort}),a>s&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inclusive:!0,inst:e,continue:!t.abort})}}),nf=tu("$ZodCheckBigIntFormat",(e,t)=>{nl.init(e,t);let[r,n]=tY[t.format];e._zod.onattach.push(e=>{let i=e._zod.bag;i.format=t.format,i.minimum=r,i.maximum=n}),e._zod.check=i=>{let s=i.value;s<r&&i.issues.push({origin:"bigint",input:s,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),s>n&&i.issues.push({origin:"bigint",input:s,code:"too_big",maximum:n,inclusive:!0,inst:e,continue:!t.abort})}}),nm=tu("$ZodCheckMaxSize",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;n.size<=t.maximum||r.issues.push({origin:re(n),code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),ng=tu("$ZodCheckMinSize",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;n.size>=t.minimum||r.issues.push({origin:re(n),code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),ny=tu("$ZodCheckSizeEquals",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=r=>{let n=r.value,i=n.size;if(i===t.size)return;let s=i>t.size;r.issues.push({origin:re(n),...s?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nv=tu("$ZodCheckMaxLength",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;if(n.length<=t.maximum)return;let i=rt(n);r.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nb=tu("$ZodCheckMinLength",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;if(n.length>=t.minimum)return;let i=rt(n);r.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nx=tu("$ZodCheckLengthEquals",(e,t)=>{var r;nl.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tS(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let n=r.value,i=n.length;if(i===t.length)return;let s=rt(n),o=i>t.length;r.issues.push({origin:s,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nw=tu("$ZodCheckStringFormat",(e,t)=>{var r,n;nl.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),n_=tu("$ZodCheckRegex",(e,t)=>{nw.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),nS=tu("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=r9),nw.init(e,t)}),nC=tu("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=r3),nw.init(e,t)}),nT=tu("$ZodCheckIncludes",(e,t)=>{nl.init(e,t);let r=tV(t.includes),n=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),nE=tu("$ZodCheckStartsWith",(e,t)=>{nl.init(e,t);let r=RegExp(`^${tV(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),nk=tu("$ZodCheckEndsWith",(e,t)=>{nl.init(e,t);let r=RegExp(`.*${tV(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}});(e,t)=>{nl.init(e,t);let r=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:t.mime,input:n.value.type,inst:e,continue:!t.abort})}};let nR=tu("$ZodCheckOverwrite",(e,t)=>{nl.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class nz{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}let nI={major:4,minor:3,patch:6},nj=tu("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=nI;let n=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&n.unshift(e),n))for(let r of t._zod.onattach)r(e);if(0===n.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let n,i=t5(e);for(let s of t){if(s._zod.def.when){if(!s._zod.def.when(e))continue}else if(i)continue;let t=e.issues.length,o=s._zod.check(e);if(o instanceof Promise&&r?.async===!1)throw new tc;if(n||o instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await o,e.issues.length!==t&&(i||(i=t5(e,t)))});else{if(e.issues.length===t)continue;i||(i=t5(e,t))}}return n?n.then(()=>e):e},r=(r,i,s)=>{if(t5(r))return r.aborted=!0,r;let o=t(i,n,s);if(o instanceof Promise){if(!1===s.async)throw new tc;return o.then(t=>e._zod.parse(t,s))}return e._zod.parse(o,s)};e._zod.run=(i,s)=>{if(s.skipChecks)return e._zod.parse(i,s);if("backward"===s.direction){let t=e._zod.parse({value:i.value,issues:[]},{...s,skipChecks:!0});return t instanceof Promise?t.then(e=>r(e,i,s)):r(t,i,s)}let o=e._zod.parse(i,s);if(o instanceof Promise){if(!1===s.async)throw new tc;return o.then(e=>t(e,n,s))}return t(o,n,s)}}tk(e,"~standard",()=>({validate:t=>{try{let r=rx(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return r_(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}))}),nO=tu("$ZodString",(e,t)=>{nj.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??rK(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),nN=tu("$ZodStringFormat",(e,t)=>{nw.init(e,t),nO.init(e,t)}),nA=tu("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=rI),nN.init(e,t)}),n$=tu("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=rj(e))}else t.pattern??(t.pattern=rj());nN.init(e,t)}),nP=tu("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=r$),nN.init(e,t)}),nL=tu("$ZodURL",(e,t)=>{nN.init(e,t),e._zod.check=r=>{try{let n=r.value.trim(),i=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=i.href:r.value=n;return}catch(n){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),nM=tu("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=rL()),nN.init(e,t)}),nB=tu("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=rR),nN.init(e,t)}),nD=tu("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=rS),nN.init(e,t)}),nH=tu("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=rC),nN.init(e,t)}),nZ=tu("$ZodULID",(e,t)=>{t.pattern??(t.pattern=rT),nN.init(e,t)}),nU=tu("$ZodXID",(e,t)=>{t.pattern??(t.pattern=rE),nN.init(e,t)}),nF=tu("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=rk),nN.init(e,t)}),nV=tu("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=rQ(t)),nN.init(e,t)}),nW=tu("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=rq),nN.init(e,t)}),nq=tu("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=rJ(t)),nN.init(e,t)}),nG=tu("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=rz),nN.init(e,t)}),nJ=tu("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=rM),nN.init(e,t),e._zod.bag.format="ipv4"}),nQ=tu("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=rB),nN.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),nK=tu("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=rD(t.delimiter)),nN.init(e,t),e._zod.bag.format="mac"}),nY=tu("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=rH),nN.init(e,t)}),nX=tu("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=rZ),nN.init(e,t),e._zod.check=r=>{let n=r.value.split("/");try{if(2!==n.length)throw Error();let[e,t]=n;if(!t)throw Error();let r=Number(t);if(`${r}`!==t||r<0||r>128)throw Error();new URL(`http://[${e}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function n0(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let n1=tu("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=rU),nN.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{n0(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function n2(e){if(!rF.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return n0(t.padEnd(4*Math.ceil(t.length/4),"="))}let n4=tu("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=rF),nN.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{n2(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),n9=tu("$ZodE164",(e,t)=>{t.pattern??(t.pattern=rV),nN.init(e,t)});function n3(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[n]=r;if(!n)return!1;let i=JSON.parse(atob(n));if("typ"in i&&i?.typ!=="JWT"||!i.alg||t&&(!("alg"in i)||i.alg!==t))return!1;return!0}catch{return!1}}let n5=tu("$ZodJWT",(e,t)=>{nN.init(e,t),e._zod.check=r=>{n3(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),n6=tu("$ZodCustomStringFormat",(e,t)=>{nN.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),n7=tu("$ZodNumber",(e,t)=>{nj.init(e,t),e._zod.pattern=e._zod.bag.pattern??r0,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let i=r.value;if("number"==typeof i&&!Number.isNaN(i)&&Number.isFinite(i))return r;let s="number"==typeof i?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...s?{received:s}:{}}),r}}),n8=tu("$ZodNumberFormat",(e,t)=>{np.init(e,t),n7.init(e,t)}),ie=tu("$ZodBoolean",(e,t)=>{nj.init(e,t),e._zod.pattern=r1,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let i=r.value;return"boolean"==typeof i||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),r}}),it=tu("$ZodBigInt",(e,t)=>{nj.init(e,t),e._zod.pattern=rY,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch(e){}return"bigint"==typeof r.value||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),ir=tu("$ZodBigIntFormat",(e,t)=>{nf.init(e,t),it.init(e,t)}),ii=tu("$ZodSymbol",(e,t)=>{nj.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return"symbol"==typeof n||t.issues.push({expected:"symbol",code:"invalid_type",input:n,inst:e}),t}}),is=tu("$ZodUndefined",(e,t)=>{nj.init(e,t),e._zod.pattern=r4,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"undefined",code:"invalid_type",input:n,inst:e}),t}}),io=tu("$ZodNull",(e,t)=>{nj.init(e,t),e._zod.pattern=r2,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;return null===n||t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}}),ia=tu("$ZodAny",(e,t)=>{nj.init(e,t),e._zod.parse=e=>e}),il=tu("$ZodUnknown",(e,t)=>{nj.init(e,t),e._zod.parse=e=>e}),iu=tu("$ZodNever",(e,t)=>{nj.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),ic=tu("$ZodVoid",(e,t)=>{nj.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"void",code:"invalid_type",input:n,inst:e}),t}}),id=tu("$ZodDate",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=new Date(r.value)}catch(e){}let i=r.value,s=i instanceof Date;return s&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...s?{received:"Invalid Date"}:{},inst:e}),r}});function ih(e,t,r){e.issues.length&&t.issues.push(...t6(r,e.issues)),t.value[r]=e.value}let ip=tu("$ZodArray",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),r;r.value=Array(i.length);let s=[];for(let e=0;e<i.length;e++){let o=i[e],a=t.element._zod.run({value:o,issues:[]},n);a instanceof Promise?s.push(a.then(t=>ih(t,r,e))):ih(a,r,e)}return s.length?Promise.all(s).then(()=>r):r}});function im(e,t,r,n,i){if(e.issues.length){if(i&&!(r in n))return;t.issues.push(...t6(r,e.issues))}void 0===e.value?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function ig(e){let t=Object.keys(e.shape);for(let r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=tQ(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function iy(e,t,r,n,i,s){let o=[],a=i.keySet,l=i.catchall._zod,u=l.def.type,c="optional"===l.optout;for(let i in t){if(a.has(i))continue;if("never"===u){o.push(i);continue}let s=l.run({value:t[i],issues:[]},n);s instanceof Promise?e.push(s.then(e=>im(e,r,i,t,c))):im(s,r,i,t,c)}return(o.length&&r.issues.push({code:"unrecognized_keys",keys:o,input:t,inst:s}),e.length)?Promise.all(e).then(()=>r):r}let iv=tu("$ZodObject",(e,t)=>{let r;nj.init(e,t);let n=Object.getOwnPropertyDescriptor(t,"shape");if(!n?.get){let e=t.shape;Object.defineProperty(t,"shape",{get:()=>{let r={...e};return Object.defineProperty(t,"shape",{value:r}),r}})}let i=t_(()=>ig(t));tk(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values)for(let e of(r[t]??(r[t]=new Set),n.values))r[t].add(e)}return r});let s=t.catchall;e._zod.parse=(t,n)=>{r??(r=i.value);let o=t.value;if(!tM(o))return t.issues.push({expected:"object",code:"invalid_type",input:o,inst:e}),t;t.value={};let a=[],l=r.shape;for(let e of r.keys){let r=l[e],i="optional"===r._zod.optout,s=r._zod.run({value:o[e],issues:[]},n);s instanceof Promise?a.push(s.then(r=>im(r,t,e,o,i))):im(s,t,e,o,i)}return s?iy(a,o,t,n,i.value,e):a.length?Promise.all(a).then(()=>t):t}}),ib=tu("$ZodObjectJIT",(e,t)=>{let r,n;iv.init(e,t);let i=e._zod.parse,s=t_(()=>ig(t)),o=!th.jitless,a=o&&tB.value,l=t.catchall;e._zod.parse=(u,c)=>{n??(n=s.value);let d=u.value;return tM(d)?o&&a&&c?.async===!1&&!0!==c.jitless?(r||(r=(e=>{let t=new nz(["shape","payload","ctx"]),r=s.value,n=e=>{let t=t$(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let i=Object.create(null),o=0;for(let e of r.keys)i[e]=`key_${o++}`;for(let s of(t.write("const newResult = {};"),r.keys)){let r=i[s],o=t$(s),a=e[s],l=a?._zod?.optout==="optional";t.write(`const ${r} = ${n(s)};`),l?t.write(`
        if (${r}.issues.length) {
          if (${o} in input) {
            payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${o}, ...iss.path] : [${o}]
            })));
          }
        }
        
        if (${r}.value === undefined) {
          if (${o} in input) {
            newResult[${o}] = undefined;
          }
        } else {
          newResult[${o}] = ${r}.value;
        }
        
      `):t.write(`
        if (${r}.issues.length) {
          payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${o}, ...iss.path] : [${o}]
          })));
        }
        
        if (${r}.value === undefined) {
          if (${o} in input) {
            newResult[${o}] = undefined;
          }
        } else {
          newResult[${o}] = ${r}.value;
        }
        
      `)}t.write("payload.value = newResult;"),t.write("return payload;");let a=t.compile();return(t,r)=>a(e,t,r)})(t.shape)),u=r(u,c),l)?iy([],d,u,c,n,e):u:i(u,c):(u.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),u)}});function ix(e,t,r,n){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;let i=e.filter(e=>!t5(e));return 1===i.length?(t.value=i[0].value,i[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>t8(e,n,tp())))}),t)}let iw=tu("$ZodUnion",(e,t)=>{nj.init(e,t),tk(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),tk(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),tk(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),tk(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>tC(e.source)).join("|")})$`)}});let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let o=!1,a=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);if(t instanceof Promise)a.push(t),o=!0;else{if(0===t.issues.length)return t;a.push(t)}}return o?Promise.all(a).then(t=>ix(t,i,e,s)):ix(a,i,e,s)}});function i_(e,t,r,n){let i=e.filter(e=>0===e.issues.length);return 1===i.length?t.value=i[0].value:0===i.length?t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>t8(e,n,tp())))}):t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:[],inclusive:!1}),t}let iS=tu("$ZodXor",(e,t)=>{iw.init(e,t),t.inclusive=!1;let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let o=!1,a=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);t instanceof Promise?(a.push(t),o=!0):a.push(t)}return o?Promise.all(a).then(t=>i_(t,i,e,s)):i_(a,i,e,s)}}),iC=tu("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,iw.init(e,t);let r=e._zod.parse;tk(e._zod,"propValues",()=>{let e={};for(let r of t.options){let n=r._zod.propValues;if(!n||0===Object.keys(n).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(n))for(let n of(e[t]||(e[t]=new Set),r))e[t].add(n)}return e});let n=t_(()=>{let e=t.options,r=new Map;for(let n of e){let e=n._zod.propValues?.[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,n)}}return r});e._zod.parse=(i,s)=>{let o=i.value;if(!tM(o))return i.issues.push({code:"invalid_type",expected:"object",input:o,inst:e}),i;let a=n.value.get(o?.[t.discriminator]);return a?a._zod.run(i,s):t.unionFallback?r(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:o,path:[t.discriminator],inst:e}),i)}}),iT=tu("$ZodIntersection",(e,t)=>{nj.init(e,t),e._zod.parse=(e,r)=>{let n=e.value,i=t.left._zod.run({value:n,issues:[]},r),s=t.right._zod.run({value:n,issues:[]},r);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([t,r])=>iE(e,t,r)):iE(e,i,s)}});function iE(e,t,r){let n,i=new Map;for(let r of t.issues)if("unrecognized_keys"===r.code)for(let e of(n??(n=r),r.keys))i.has(e)||i.set(e,{}),i.get(e).l=!0;else e.issues.push(r);for(let t of r.issues)if("unrecognized_keys"===t.code)for(let e of t.keys)i.has(e)||i.set(e,{}),i.get(e).r=!0;else e.issues.push(t);let s=[...i].filter(([,e])=>e.l&&e.r).map(([e])=>e);if(s.length&&n&&e.issues.push({...n,keys:s}),t5(e))return e;let o=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(tD(t)&&tD(r)){let n=Object.keys(r),i=Object.keys(t).filter(e=>-1!==n.indexOf(e)),s={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};s[n]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let i=0;i<t.length;i++){let s=e(t[i],r[i]);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!o.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return e.value=o.data,e}let ik=tu("$ZodTuple",(e,t)=>{nj.init(e,t);let r=t.items;e._zod.parse=(n,i)=>{let s=n.value;if(!Array.isArray(s))return n.issues.push({input:s,inst:e,expected:"tuple",code:"invalid_type"}),n;n.value=[];let o=[],a=[...r].reverse().findIndex(e=>"optional"!==e._zod.optin),l=-1===a?0:r.length-a;if(!t.rest){let t=s.length>r.length,i=s.length<l-1;if(t||i)return n.issues.push({...t?{code:"too_big",maximum:r.length,inclusive:!0}:{code:"too_small",minimum:r.length},input:s,inst:e,origin:"array"}),n}let u=-1;for(let e of r){if(++u>=s.length&&u>=l)continue;let t=e._zod.run({value:s[u],issues:[]},i);t instanceof Promise?o.push(t.then(e=>iR(e,n,u))):iR(t,n,u)}if(t.rest)for(let e of s.slice(r.length)){u++;let r=t.rest._zod.run({value:e,issues:[]},i);r instanceof Promise?o.push(r.then(e=>iR(e,n,u))):iR(r,n,u)}return o.length?Promise.all(o).then(()=>n):n}});function iR(e,t,r){e.issues.length&&t.issues.push(...t6(r,e.issues)),t.value[r]=e.value}let iz=tu("$ZodRecord",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!tD(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let s=[],o=t.keyType._zod.values;if(o){let a;r.value={};let l=new Set;for(let e of o)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){l.add("number"==typeof e?e.toString():e);let o=t.valueType._zod.run({value:i[e],issues:[]},n);o instanceof Promise?s.push(o.then(t=>{t.issues.length&&r.issues.push(...t6(e,t.issues)),r.value[e]=t.value})):(o.issues.length&&r.issues.push(...t6(e,o.issues)),r.value[e]=o.value)}for(let e in i)l.has(e)||(a=a??[]).push(e);a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:a})}else for(let o of(r.value={},Reflect.ownKeys(i))){if("__proto__"===o)continue;let a=t.keyType._zod.run({value:o,issues:[]},n);if(a instanceof Promise)throw Error("Async schemas not supported in object keys currently");if("string"==typeof o&&r0.test(o)&&a.issues.length){let e=t.keyType._zod.run({value:Number(o),issues:[]},n);if(e instanceof Promise)throw Error("Async schemas not supported in object keys currently");0===e.issues.length&&(a=e)}if(a.issues.length){"loose"===t.mode?r.value[o]=i[o]:r.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(e=>t8(e,n,tp())),input:o,path:[o],inst:e});continue}let l=t.valueType._zod.run({value:i[o],issues:[]},n);l instanceof Promise?s.push(l.then(e=>{e.issues.length&&r.issues.push(...t6(o,e.issues)),r.value[a.value]=e.value})):(l.issues.length&&r.issues.push(...t6(o,l.issues)),r.value[a.value]=l.value)}return s.length?Promise.all(s).then(()=>r):r}}),iI=tu("$ZodMap",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:i,inst:e}),r;let s=[];for(let[o,a]of(r.value=new Map,i)){let l=t.keyType._zod.run({value:o,issues:[]},n),u=t.valueType._zod.run({value:a,issues:[]},n);l instanceof Promise||u instanceof Promise?s.push(Promise.all([l,u]).then(([t,s])=>{ij(t,s,r,o,i,e,n)})):ij(l,u,r,o,i,e,n)}return s.length?Promise.all(s).then(()=>r):r}});function ij(e,t,r,n,i,s,o){e.issues.length&&(tU.has(typeof n)?r.issues.push(...t6(n,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:i,inst:s,issues:e.issues.map(e=>t8(e,o,tp()))})),t.issues.length&&(tU.has(typeof n)?r.issues.push(...t6(n,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:i,inst:s,key:n,issues:t.issues.map(e=>t8(e,o,tp()))})),r.value.set(e.value,t.value)}let iO=tu("$ZodSet",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Set))return r.issues.push({input:i,inst:e,expected:"set",code:"invalid_type"}),r;let s=[];for(let e of(r.value=new Set,i)){let i=t.valueType._zod.run({value:e,issues:[]},n);i instanceof Promise?s.push(i.then(e=>iN(e,r))):iN(i,r)}return s.length?Promise.all(s).then(()=>r):r}});function iN(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}let iA=tu("$ZodEnum",(e,t)=>{nj.init(e,t);let r=tb(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=RegExp(`^(${r.filter(e=>tU.has(typeof e)).map(e=>"string"==typeof e?tV(e):e.toString()).join("|")})$`),e._zod.parse=(t,i)=>{let s=t.value;return n.has(s)||t.issues.push({code:"invalid_value",values:r,input:s,inst:e}),t}}),i$=tu("$ZodLiteral",(e,t)=>{if(nj.init(e,t),0===t.values.length)throw Error("Cannot create literal schema with no valid values");let r=new Set(t.values);e._zod.values=r,e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?tV(e):e?tV(e.toString()):String(e)).join("|")})$`),e._zod.parse=(n,i)=>{let s=n.value;return r.has(s)||n.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),n}}),iP=tu("$ZodFile",(e,t)=>{nj.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return n instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:n,inst:e}),t}}),iL=tu("$ZodTransform",(e,t)=>{nj.init(e,t),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new td(e.constructor.name);let i=t.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(e=>(r.value=e,r));if(i instanceof Promise)throw new tc;return r.value=i,r}});function iM(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}let iB=tu("$ZodOptional",(e,t)=>{nj.init(e,t),e._zod.optin="optional",e._zod.optout="optional",tk(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),tk(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tC(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>{if("optional"===t.innerType._zod.optin){let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>iM(t,e.value)):iM(n,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,r)}}),iD=tu("$ZodExactOptional",(e,t)=>{iB.init(e,t),tk(e._zod,"values",()=>t.innerType._zod.values),tk(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(e,r)=>t.innerType._zod.run(e,r)}),iH=tu("$ZodNullable",(e,t)=>{nj.init(e,t),tk(e._zod,"optin",()=>t.innerType._zod.optin),tk(e._zod,"optout",()=>t.innerType._zod.optout),tk(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tC(e.source)}|null)$`):void 0}),tk(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),iZ=tu("$ZodDefault",(e,t)=>{nj.init(e,t),e._zod.optin="optional",tk(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);if(void 0===e.value)return e.value=t.defaultValue,e;let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(e=>iU(e,t)):iU(n,t)}});function iU(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let iF=tu("$ZodPrefault",(e,t)=>{nj.init(e,t),e._zod.optin="optional",tk(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>("backward"===r.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),iV=tu("$ZodNonOptional",(e,t)=>{nj.init(e,t),tk(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,n)=>{let i=t.innerType._zod.run(r,n);return i instanceof Promise?i.then(t=>iW(t,e)):iW(i,e)}});function iW(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let iq=tu("$ZodSuccess",(e,t)=>{nj.init(e,t),e._zod.parse=(e,r)=>{if("backward"===r.direction)throw new td("ZodSuccess");let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===n.issues.length,e)}}),iG=tu("$ZodCatch",(e,t)=>{nj.init(e,t),tk(e._zod,"optin",()=>t.innerType._zod.optin),tk(e._zod,"optout",()=>t.innerType._zod.optout),tk(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>t8(e,r,tp()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>t8(e,r,tp()))},input:e.value}),e.issues=[]),e)}}),iJ=tu("$ZodNaN",(e,t)=>{nj.init(e,t),e._zod.parse=(t,r)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),iQ=tu("$ZodPipe",(e,t)=>{nj.init(e,t),tk(e._zod,"values",()=>t.in._zod.values),tk(e._zod,"optin",()=>t.in._zod.optin),tk(e._zod,"optout",()=>t.out._zod.optout),tk(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("backward"===r.direction){let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>iK(e,t.in,r)):iK(n,t.in,r)}let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>iK(e,t.out,r)):iK(n,t.out,r)}});function iK(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}let iY=tu("$ZodCodec",(e,t)=>{nj.init(e,t),tk(e._zod,"values",()=>t.in._zod.values),tk(e._zod,"optin",()=>t.in._zod.optin),tk(e._zod,"optout",()=>t.out._zod.optout),tk(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("forward"===(r.direction||"forward")){let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>iX(e,t,r)):iX(n,t,r)}{let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>iX(e,t,r)):iX(n,t,r)}}});function iX(e,t,r){if(e.issues.length)return e.aborted=!0,e;if("forward"===(r.direction||"forward")){let n=t.transform(e.value,e);return n instanceof Promise?n.then(n=>i0(e,n,t.out,r)):i0(e,n,t.out,r)}{let n=t.reverseTransform(e.value,e);return n instanceof Promise?n.then(n=>i0(e,n,t.in,r)):i0(e,n,t.in,r)}}function i0(e,t,r,n){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},n)}let i1=tu("$ZodReadonly",(e,t)=>{nj.init(e,t),tk(e._zod,"propValues",()=>t.innerType._zod.propValues),tk(e._zod,"values",()=>t.innerType._zod.values),tk(e._zod,"optin",()=>t.innerType?._zod?.optin),tk(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(i2):i2(n)}});function i2(e){return e.value=Object.freeze(e.value),e}let i4=tu("$ZodTemplateLiteral",(e,t)=>{nj.init(e,t);let r=[];for(let e of t.parts)if("object"==typeof e&&null!==e){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let n=+!!t.startsWith("^"),i=t.endsWith("$")?t.length-1:t.length;r.push(t.slice(n,i))}else if(null===e||tF.has(typeof e))r.push(tV(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${r.join("")}$`),e._zod.parse=(r,n)=>("string"!=typeof r.value?r.issues.push({input:r.value,inst:e,expected:"string",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source})),r)}),i9=tu("$ZodFunction",(e,t)=>(nj.init(e,t),e._def=t,e._zod.def=t,e.implement=t=>{if("function"!=typeof t)throw Error("implement() must be called with a function");return function(...r){let n=Reflect.apply(t,this,e._def.input?rg(e._def.input,r):r);return e._def.output?rg(e._def.output,n):n}},e.implementAsync=t=>{if("function"!=typeof t)throw Error("implementAsync() must be called with a function");return async function(...r){let n=e._def.input?await rv(e._def.input,r):r,i=await Reflect.apply(t,this,n);return e._def.output?await rv(e._def.output,i):i}},e._zod.parse=(t,r)=>("function"!=typeof t.value?t.issues.push({code:"invalid_type",expected:"function",input:t.value,inst:e}):e._def.output&&"promise"===e._def.output._zod.def.type?t.value=e.implementAsync(t.value):t.value=e.implement(t.value),t),e.input=(...t)=>{let r=e.constructor;return new r(Array.isArray(t[0])?{type:"function",input:new ik({type:"tuple",items:t[0],rest:t[1]}),output:e._def.output}:{type:"function",input:t[0],output:e._def.output})},e.output=t=>new e.constructor({type:"function",input:e._def.input,output:t}),e)),i3=tu("$ZodPromise",(e,t)=>{nj.init(e,t),e._zod.parse=(e,r)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},r))}),i5=tu("$ZodLazy",(e,t)=>{nj.init(e,t),tk(e._zod,"innerType",()=>t.getter()),tk(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),tk(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),tk(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),tk(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),i6=tu("$ZodCustom",(e,t)=>{nl.init(e,t),nj.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let n=r.value,i=t.fn(n);if(i instanceof Promise)return i.then(t=>i7(t,r,n,e));i7(i,r,n,e)}});function i7(e,t,r,n){if(!e){let e={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),t.issues.push(rn(e))}}e.s(["$ZodAny",0,ia,"$ZodArray",0,ip,"$ZodBase64",0,n1,"$ZodBase64URL",0,n4,"$ZodBigInt",0,it,"$ZodBigIntFormat",0,ir,"$ZodBoolean",0,ie,"$ZodCIDRv4",0,nY,"$ZodCIDRv6",0,nX,"$ZodCUID",0,nD,"$ZodCUID2",0,nH,"$ZodCatch",0,iG,"$ZodCodec",0,iY,"$ZodCustom",0,i6,"$ZodCustomStringFormat",0,n6,"$ZodDate",0,id,"$ZodDefault",0,iZ,"$ZodDiscriminatedUnion",0,iC,"$ZodE164",0,n9,"$ZodEmail",0,nP,"$ZodEmoji",0,nM,"$ZodEnum",0,iA,"$ZodExactOptional",0,iD,"$ZodFile",0,iP,"$ZodFunction",0,i9,"$ZodGUID",0,nA,"$ZodIPv4",0,nJ,"$ZodIPv6",0,nQ,"$ZodISODate",0,nW,"$ZodISODateTime",0,nV,"$ZodISODuration",0,nG,"$ZodISOTime",0,nq,"$ZodIntersection",0,iT,"$ZodJWT",0,n5,"$ZodKSUID",0,nF,"$ZodLazy",0,i5,"$ZodLiteral",0,i$,"$ZodMAC",0,nK,"$ZodMap",0,iI,"$ZodNaN",0,iJ,"$ZodNanoID",0,nB,"$ZodNever",0,iu,"$ZodNonOptional",0,iV,"$ZodNull",0,io,"$ZodNullable",0,iH,"$ZodNumber",0,n7,"$ZodNumberFormat",0,n8,"$ZodObject",0,iv,"$ZodObjectJIT",0,ib,"$ZodOptional",0,iB,"$ZodPipe",0,iQ,"$ZodPrefault",0,iF,"$ZodPromise",0,i3,"$ZodReadonly",0,i1,"$ZodRecord",0,iz,"$ZodSet",0,iO,"$ZodString",0,nO,"$ZodStringFormat",0,nN,"$ZodSuccess",0,iq,"$ZodSymbol",0,ii,"$ZodTemplateLiteral",0,i4,"$ZodTransform",0,iL,"$ZodTuple",0,ik,"$ZodType",0,nj,"$ZodULID",0,nZ,"$ZodURL",0,nL,"$ZodUUID",0,n$,"$ZodUndefined",0,is,"$ZodUnion",0,iw,"$ZodUnknown",0,il,"$ZodVoid",0,ic,"$ZodXID",0,nU,"$ZodXor",0,iS,"isValidBase64",()=>n0,"isValidBase64URL",()=>n2,"isValidJWT",()=>n3],76094),Symbol("ZodOutput"),Symbol("ZodInput");(y=globalThis).__zod_globalRegistry??(y.__zod_globalRegistry=new class e{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){let r=t[0];return this._map.set(e,r),r&&"object"==typeof r&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};delete r.id;let n={...r,...this._map.get(e)};return Object.keys(n).length?n:void 0}return this._map.get(e)}has(e){return this._map.has(e)}});let i8=globalThis.__zod_globalRegistry;function se(e,t){return new nc({check:"less_than",...tq(t),value:e,inclusive:!1})}function st(e,t){return new nc({check:"less_than",...tq(t),value:e,inclusive:!0})}function sr(e,t){return new nd({check:"greater_than",...tq(t),value:e,inclusive:!1})}function sn(e,t){return new nd({check:"greater_than",...tq(t),value:e,inclusive:!0})}function si(e,t){return new nh({check:"multiple_of",...tq(t),value:e})}function ss(e,t){return new nv({check:"max_length",...tq(t),maximum:e})}function so(e,t){return new nb({check:"min_length",...tq(t),minimum:e})}function sa(e,t){return new nx({check:"length_equals",...tq(t),length:e})}function sl(e){return new nR({check:"overwrite",tx:e})}function su(e){let t=e?.target??"draft-2020-12";return"draft-4"===t&&(t="draft-04"),"draft-7"===t&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??i8,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function sc(e,t,r={path:[],schemaPath:[]}){var n;let i=e._zod.def,s=t.seen.get(e);if(s)return s.count++,r.schemaPath.includes(e)&&(s.cycle=r.path),s.schema;let o={schema:{},count:1,cycle:void 0,path:r.path};t.seen.set(e,o);let a=e._zod.toJSONSchema?.();if(a)o.schema=a;else{let n={...r,schemaPath:[...r.schemaPath,e],path:r.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,o.schema,n);else{let r=o.schema,s=t.processors[i.type];if(!s)throw Error(`[toJSONSchema]: Non-representable type encountered: ${i.type}`);s(e,t,r,n)}let s=e._zod.parent;s&&(o.ref||(o.ref=s),sc(s,t,n),t.seen.get(s).isParent=!0)}let l=t.metadataRegistry.get(e);return l&&Object.assign(o.schema,l),"input"===t.io&&function e(t,r){let n=r??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);let i=t._zod.def;if("transform"===i.type)return!0;if("array"===i.type)return e(i.element,n);if("set"===i.type)return e(i.valueType,n);if("lazy"===i.type)return e(i.getter(),n);if("promise"===i.type||"optional"===i.type||"nonoptional"===i.type||"nullable"===i.type||"readonly"===i.type||"default"===i.type||"prefault"===i.type)return e(i.innerType,n);if("intersection"===i.type)return e(i.left,n)||e(i.right,n);if("record"===i.type||"map"===i.type)return e(i.keyType,n)||e(i.valueType,n);if("pipe"===i.type)return e(i.in,n)||e(i.out,n);if("object"===i.type){for(let t in i.shape)if(e(i.shape[t],n))return!0;return!1}if("union"===i.type){for(let t of i.options)if(e(t,n))return!0;return!1}if("tuple"===i.type){for(let t of i.items)if(e(t,n))return!0;if(i.rest&&e(i.rest,n))return!0}return!1}(e)&&(delete o.schema.examples,delete o.schema.default),"input"===t.io&&o.schema._prefault&&((n=o.schema).default??(n.default=o.schema._prefault)),delete o.schema._prefault,t.seen.get(e).schema}function sd(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=new Map;for(let t of e.seen.entries()){let r=e.metadataRegistry.get(t[0])?.id;if(r){let e=n.get(r);if(e&&e!==t[0])throw Error(`Duplicate schema id "${r}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);n.set(r,t[0])}}let i=t=>{if(t[1].schema.$ref)return;let n=t[1],{ref:i,defId:s}=(t=>{let n="draft-2020-12"===e.target?"$defs":"definitions";if(e.external){let r=e.external.registry.get(t[0])?.id,i=e.external.uri??(e=>e);if(r)return{ref:i(r)};let s=t[1].defId??t[1].schema.id??`schema${e.counter++}`;return t[1].defId=s,{defId:s,ref:`${i("__shared")}#/${n}/${s}`}}if(t[1]===r)return{ref:"#"};let i=`#/${n}/`,s=t[1].schema.id??`__schema${e.counter++}`;return{defId:s,ref:i+s}})(t);n.def={...n.schema},s&&(n.defId=s);let o=n.schema;for(let e in o)delete o[e];o.$ref=i};if("throw"===e.cycles)for(let t of e.seen.entries()){let e=t[1];if(e.cycle)throw Error(`Cycle detected: #/${e.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let r of e.seen.entries()){let n=r[1];if(t===r[0]){i(r);continue}if(e.external){let n=e.external.registry.get(r[0])?.id;if(t!==r[0]&&n){i(r);continue}}if(e.metadataRegistry.get(r[0])?.id||n.cycle||n.count>1&&"ref"===e.reused){i(r);continue}}}function sh(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=t=>{let r=e.seen.get(t);if(null===r.ref)return;let i=r.def??r.schema,s={...i},o=r.ref;if(r.ref=null,o){n(o);let r=e.seen.get(o),a=r.schema;if(a.$ref&&("draft-07"===e.target||"draft-04"===e.target||"openapi-3.0"===e.target)?(i.allOf=i.allOf??[],i.allOf.push(a)):Object.assign(i,a),Object.assign(i,s),t._zod.parent===o)for(let e in i)"$ref"!==e&&"allOf"!==e&&(e in s||delete i[e]);if(a.$ref&&r.def)for(let e in i)"$ref"!==e&&"allOf"!==e&&e in r.def&&JSON.stringify(i[e])===JSON.stringify(r.def[e])&&delete i[e]}let a=t._zod.parent;if(a&&a!==o){n(a);let t=e.seen.get(a);if(t?.schema.$ref&&(i.$ref=t.schema.$ref,t.def))for(let e in i)"$ref"!==e&&"allOf"!==e&&e in t.def&&JSON.stringify(i[e])===JSON.stringify(t.def[e])&&delete i[e]}e.override({zodSchema:t,jsonSchema:i,path:r.path??[]})};for(let t of[...e.seen.entries()].reverse())n(t[0]);let i={};if("draft-2020-12"===e.target?i.$schema="https://json-schema.org/draft/2020-12/schema":"draft-07"===e.target?i.$schema="http://json-schema.org/draft-07/schema#":"draft-04"===e.target?i.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){let r=e.external.registry.get(t)?.id;if(!r)throw Error("Schema is missing an `id` property");i.$id=e.external.uri(r)}Object.assign(i,r.def??r.schema);let s=e.external?.defs??{};for(let t of e.seen.entries()){let e=t[1];e.def&&e.defId&&(s[e.defId]=e.def)}e.external||Object.keys(s).length>0&&("draft-2020-12"===e.target?i.$defs=s:i.definitions=s);try{let r=JSON.parse(JSON.stringify(i));return Object.defineProperty(r,"~standard",{value:{...t["~standard"],jsonSchema:{input:sp(t,"input",e.processors),output:sp(t,"output",e.processors)}},enumerable:!1,writable:!1}),r}catch(e){throw Error("Error converting schema to JSON.")}}let sp=(e,t,r={})=>n=>{let{libraryOptions:i,target:s}=n??{},o=su({...i??{},target:s,io:t,processors:r});return sc(e,o),sd(o,e),sh(o,e)},sf={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},sm=(e,t,r,n)=>{let i=e._zod.def;sc(i.innerType,t,n),t.seen.get(e).ref=i.innerType};e.i(76094),e.i(82358);var sg=e.i(22143),sg=sg;(e,t)=>{nV.init(e,t),sO.init(e,t)},(e,t)=>{nG.init(e,t),sO.init(e,t)};let sy=tu("ZodError",(e,t)=>{rp.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>(function(e,t=e=>e.message){let r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code&&i.errors.length)i.errors.map(e=>n({issues:e}));else if("invalid_key"===i.code)n({issues:i.issues});else if("invalid_element"===i.code)n({issues:i.issues});else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(e),r})(e,t)},flatten:{value:t=>(function(e,t=e=>e.message){let r={},n=[];for(let i of e.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(t(i))):n.push(t(i));return{formErrors:n,fieldErrors:r}})(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,tw,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,tw,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),sv=rm(sy),sb=ry(sy),sx=rb(sy),sw=rw(sy),s_=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rm(sy)(e,t,n)},sS=(e,t,r)=>rm(sy)(e,t,r),sC=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ry(sy)(e,t,n)},sT=async(e,t,r)=>ry(sy)(e,t,r),sE=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rb(sy)(e,t,n)},sk=(e,t,r)=>rb(sy)(e,t,r),sR=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rw(sy)(e,t,n)},sz=async(e,t,r)=>rw(sy)(e,t,r),sI=tu("ZodType",(e,t)=>(nj.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:sp(e,"input"),output:sp(e,"output")}}),e.toJSONSchema=((e,t={})=>r=>{let n=su({...r,processors:t});return sc(e,n),sd(n,e),sh(n,e)})(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(sg.mergeDefs(t,{checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),{parent:!0}),e.with=e.check,e.clone=(t,r)=>tW(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>sv(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>sx(e,t,r),e.parseAsync=async(t,r)=>sb(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>sw(e,t,r),e.spa=e.safeParseAsync,e.encode=(t,r)=>s_(e,t,r),e.decode=(t,r)=>sS(e,t,r),e.encodeAsync=async(t,r)=>sC(e,t,r),e.decodeAsync=async(t,r)=>sT(e,t,r),e.safeEncode=(t,r)=>sE(e,t,r),e.safeDecode=(t,r)=>sk(e,t,r),e.safeEncodeAsync=async(t,r)=>sR(e,t,r),e.safeDecodeAsync=async(t,r)=>sz(e,t,r),e.refine=(t,r)=>e.check(function(e,t={}){return new sX({type:"custom",check:"custom",fn:e,...tq(t)})}(t,r)),e.superRefine=t=>e.check(function(e){var t;let r,n;return t=t=>(t.addIssue=e=>{"string"==typeof e?t.issues.push(rn(e,t.value,r._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=t.value),e.inst??(e.inst=r),e.continue??(e.continue=!r._zod.def.abort),t.issues.push(rn(e)))},e(t.value,t)),(n=new nl({check:"custom",...tq(void 0)}))._zod.check=t,r=n}(t)),e.overwrite=t=>e.check(sl(t)),e.optional=()=>sZ(e),e.exactOptional=()=>new sU({type:"optional",innerType:e}),e.nullable=()=>sV(e),e.nullish=()=>sZ(sV(e)),e.nonoptional=t=>{var r,n;return r=e,n=t,new sG({type:"nonoptional",innerType:r,...sg.normalizeParams(n)})},e.array=()=>(function(e,t){return new sP({type:"array",element:e,...tq(void 0)})})(e),e.or=t=>new sL({type:"union",options:[e,t],...sg.normalizeParams(void 0)}),e.and=t=>new sM({type:"intersection",left:e,right:t}),e.transform=t=>sK(e,new sD({type:"transform",transform:t})),e.default=t=>{var r,n;return r=e,n=t,new sW({type:"default",innerType:r,get defaultValue(){return"function"==typeof n?n():sg.shallowClone(n)}})},e.prefault=t=>{var r,n;return r=e,n=t,new sq({type:"prefault",innerType:r,get defaultValue(){return"function"==typeof n?n():sg.shallowClone(n)}})},e.catch=t=>{var r;return new sJ({type:"catch",innerType:e,catchValue:"function"==typeof(r=t)?r:()=>r})},e.pipe=t=>sK(e,t),e.readonly=()=>new sY({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return i8.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>i8.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return i8.get(e);let r=e.clone();return i8.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=t=>t(e),e)),sj=tu("_ZodString",(e,t)=>{nO.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{r.type="string";let{minimum:i,maximum:s,format:o,patterns:a,contentEncoding:l}=e._zod.bag;if("number"==typeof i&&(r.minLength=i),"number"==typeof s&&(r.maxLength=s),o&&(r.format=sf[o]??o,""===r.format&&delete r.format,"time"===o&&delete r.format),l&&(r.contentEncoding=l),a&&a.size>0){let e=[...a];1===e.length?r.pattern=e[0].source:e.length>1&&(r.allOf=[...e.map(e=>({..."draft-07"===t.target||"draft-04"===t.target||"openapi-3.0"===t.target?{type:"string"}:{},pattern:e.source}))])}})(e,t,r,0);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new n_({check:"string_format",format:"regex",...tq(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new nT({check:"string_format",format:"includes",...tq(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new nE({check:"string_format",format:"starts_with",...tq(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new nk({check:"string_format",format:"ends_with",...tq(t),suffix:e})}(...t)),e.min=(...t)=>e.check(so(...t)),e.max=(...t)=>e.check(ss(...t)),e.length=(...t)=>e.check(sa(...t)),e.nonempty=(...t)=>e.check(so(1,...t)),e.lowercase=t=>e.check(new nS({check:"string_format",format:"lowercase",...tq(t)})),e.uppercase=t=>e.check(new nC({check:"string_format",format:"uppercase",...tq(t)})),e.trim=()=>e.check(sl(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return sl(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(sl(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(sl(e=>e.toUpperCase())),e.slugify=()=>e.check(sl(e=>tP(e)))}),sO=tu("ZodStringFormat",(e,t)=>{nN.init(e,t),sj.init(e,t)}),sN=((e,t)=>{nP.init(e,t),sO.init(e,t)},tu("ZodNumber",(e,t)=>{n7.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let{minimum:i,maximum:s,format:o,multipleOf:a,exclusiveMaximum:l,exclusiveMinimum:u}=e._zod.bag;"string"==typeof o&&o.includes("int")?r.type="integer":r.type="number","number"==typeof u&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.minimum=u,r.exclusiveMinimum=!0):r.exclusiveMinimum=u),"number"==typeof i&&(r.minimum=i,"number"==typeof u&&"draft-04"!==t.target&&(u>=i?delete r.minimum:delete r.exclusiveMinimum)),"number"==typeof l&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.maximum=l,r.exclusiveMaximum=!0):r.exclusiveMaximum=l),"number"==typeof s&&(r.maximum=s,"number"==typeof l&&"draft-04"!==t.target&&(l<=s?delete r.maximum:delete r.exclusiveMaximum)),"number"==typeof a&&(r.multipleOf=a)})(e,t,r,0),e.gt=(t,r)=>e.check(sr(t,r)),e.gte=(t,r)=>e.check(sn(t,r)),e.min=(t,r)=>e.check(sn(t,r)),e.lt=(t,r)=>e.check(se(t,r)),e.lte=(t,r)=>e.check(st(t,r)),e.max=(t,r)=>e.check(st(t,r)),e.int=t=>e.check(s$(t)),e.safe=t=>e.check(s$(t)),e.positive=t=>e.check(sr(0,t)),e.nonnegative=t=>e.check(sn(0,t)),e.negative=t=>e.check(se(0,t)),e.nonpositive=t=>e.check(st(0,t)),e.multipleOf=(t,r)=>e.check(si(t,r)),e.step=(t,r)=>e.check(si(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??-1/0,r.exclusiveMinimum??-1/0)??null,e.maxValue=Math.min(r.maximum??1/0,r.exclusiveMaximum??1/0)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null})),sA=tu("ZodNumberFormat",(e,t)=>{n8.init(e,t),sN.init(e,t)});function s$(e){return new sA({type:"number",check:"number_format",abort:!1,format:"safeint",...tq(e)})}(e,t)=>{it.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema")})(0,e,0,0),e.gte=(t,r)=>e.check(sn(t,r)),e.min=(t,r)=>e.check(sn(t,r)),e.gt=(t,r)=>e.check(sr(t,r)),e.gte=(t,r)=>e.check(sn(t,r)),e.min=(t,r)=>e.check(sn(t,r)),e.lt=(t,r)=>e.check(se(t,r)),e.lte=(t,r)=>e.check(st(t,r)),e.max=(t,r)=>e.check(st(t,r)),e.positive=t=>e.check(sr(BigInt(0),t)),e.negative=t=>e.check(se(BigInt(0),t)),e.nonpositive=t=>e.check(st(BigInt(0),t)),e.nonnegative=t=>e.check(sn(BigInt(0),t)),e.multipleOf=(t,r)=>e.check(si(t,r));let r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null};(e,t)=>{il.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{}};(e,t)=>{iu.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{t.not={}}};let sP=tu("ZodArray",(e,t)=>{ip.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i=e._zod.def,{minimum:s,maximum:o}=e._zod.bag;"number"==typeof s&&(r.minItems=s),"number"==typeof o&&(r.maxItems=o),r.type="array",r.items=sc(i.element,t,{...n,path:[...n.path,"items"]})})(e,t,r,n),e.element=t.element,e.min=(t,r)=>e.check(so(t,r)),e.nonempty=t=>e.check(so(1,t)),e.max=(t,r)=>e.check(ss(t,r)),e.length=(t,r)=>e.check(sa(t,r)),e.unwrap=()=>e.element}),sL=tu("ZodUnion",(e,t)=>{iw.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{var i,s,o,a;let l,u,c;return i=e,s=t,o=r,a=n,u=!1===(l=i._zod.def).inclusive,c=l.options.map((e,t)=>sc(e,s,{...a,path:[...a.path,u?"oneOf":"anyOf",t]})),void(u?o.oneOf=c:o.anyOf=c)},e.options=t.options}),sM=tu("ZodIntersection",(e,t)=>{iT.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,o,a;return s=sc((i=e._zod.def).left,t,{...n,path:[...n.path,"allOf",0]}),o=sc(i.right,t,{...n,path:[...n.path,"allOf",1]}),void(r.allOf=[...(a=e=>"allOf"in e&&1===Object.keys(e).length)(s)?s.allOf:[s],...a(o)?o.allOf:[o]])}}),sB=tu("ZodEnum",(e,t)=>{iA.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;(i=tb(e._zod.def.entries)).every(e=>"number"==typeof e)&&(r.type="number"),i.every(e=>"string"==typeof e)&&(r.type="string"),r.enum=i},e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,n)=>{let i={};for(let n of e)if(r.has(n))i[n]=t.entries[n];else throw Error(`Key ${n} not found in enum`);return new sB({...t,checks:[],...sg.normalizeParams(n),entries:i})},e.exclude=(e,n)=>{let i={...t.entries};for(let t of e)if(r.has(t))delete i[t];else throw Error(`Key ${t} not found in enum`);return new sB({...t,checks:[],...sg.normalizeParams(n),entries:i})}}),sD=tu("ZodTransform",(e,t)=>{iL.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema")})(0,e,0,0),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new td(e.constructor.name);r.addIssue=n=>{"string"==typeof n?r.issues.push(sg.issue(n,r.value,t)):(n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=r.value),n.inst??(n.inst=e),r.issues.push(sg.issue(n)))};let i=t.transform(r.value,r);return i instanceof Promise?i.then(e=>(r.value=e,r)):(r.value=i,r)}}),sH=tu("ZodOptional",(e,t)=>{iB.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>sm(e,t,r,n),e.unwrap=()=>e._zod.def.innerType});function sZ(e){return new sH({type:"optional",innerType:e})}let sU=tu("ZodExactOptional",(e,t)=>{iD.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>sm(e,t,r,n),e.unwrap=()=>e._zod.def.innerType}),sF=tu("ZodNullable",(e,t)=>{iH.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,o;return s=sc((i=e._zod.def).innerType,t,n),o=t.seen.get(e),void("openapi-3.0"===t.target?(o.ref=i.innerType,r.nullable=!0):r.anyOf=[s,{type:"null"}])},e.unwrap=()=>e._zod.def.innerType});function sV(e){return new sF({type:"nullable",innerType:e})}let sW=tu("ZodDefault",(e,t)=>{iZ.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sc((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.default=JSON.parse(JSON.stringify(i.defaultValue))},e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),sq=tu("ZodPrefault",(e,t)=>{iF.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sc((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,"input"===t.io&&(r._prefault=JSON.parse(JSON.stringify(i.defaultValue)))},e.unwrap=()=>e._zod.def.innerType}),sG=tu("ZodNonOptional",(e,t)=>{iV.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sc((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType},e.unwrap=()=>e._zod.def.innerType}),sJ=tu("ZodCatch",(e,t)=>{iG.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i,s=e._zod.def;sc(s.innerType,t,n),t.seen.get(e).ref=s.innerType;try{i=s.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}r.default=i})(e,t,r,n),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),sQ=tu("ZodPipe",(e,t)=>{iQ.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s;return i=e._zod.def,void(sc(s="input"===t.io?"transform"===i.in._zod.def.type?i.out:i.in:i.out,t,n),t.seen.get(e).ref=s)},e.in=t.in,e.out=t.out});function sK(e,t){return new sQ({type:"pipe",in:e,out:t})}let sY=tu("ZodReadonly",(e,t)=>{i1.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;sc((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.readOnly=!0},e.unwrap=()=>e._zod.def.innerType}),sX=tu("ZodCustom",(e,t)=>{i6.init(e,t),sI.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")})(0,e,0,0)});var s0=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};function s1(e,t="/api/auth"){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new s0(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof s0)throw t;throw new s0(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}if(function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new s0(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let s2={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},s4={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},s9=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,s3={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},s5=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,s6=[],s7=0,s8=0,oe=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=s7+4;t<s6.length;)s6[t]===e?s6.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){s8++;let i=!s6.length;for(let i of t)s6.push(i,r.value,e,n);if(i){for(s7=0;s7<s6.length;s7+=4)s6[s7](s6[s7+1],s6[s7+2],s6[s7+3]);s6.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},ot=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},or=()=>"u"<typeof window,on=(e,t,r,n)=>{let i=oe({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>s(e)}),s=async e=>new Promise(s=>{let o="function"==typeof n?n({data:i.get().data,error:i.get().error,isPending:i.get().isPending}):n;r(t,{...o,query:{...o?.query,...e?.query},async onSuccess(e){i.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await o?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(i.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await o?.onError?.(e))},async onRequest(e){let t=i.get();i.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:i.value.refetch}),await o?.onRequest?.(e)}}).catch(e=>{i.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch})}).finally(()=>{s(void 0)})});e=Array.isArray(e)?e:[e];let o=!1;for(let t of e)t.subscribe(async()=>{or()||(o?await s():ot(i,()=>{let e=setTimeout(async()=>{o||(await s(),o=!0)},0);return()=>{i.off(),t.off(),clearTimeout(e)}}))});return i},oi=Symbol.for("better-auth:broadcast-channel");var os=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("u">typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:Math.floor(Date.now()/1e3)}))}catch{}}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function oo(e="better-auth.message"){return globalThis[oi]||(globalThis[oi]=new os(e)),globalThis[oi]}let oa=Symbol.for("better-auth:focus-manager");var ol=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||"u"<typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function ou(){return globalThis[oa]||(globalThis[oa]=new ol),globalThis[oa]}let oc=Symbol.for("better-auth:online-manager");var od=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function oh(){return globalThis[oc]||(globalThis[oc]=new od),globalThis[oc]}let op=()=>Math.floor(Date.now()/1e3);function of(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e))}function om(e){return(...t)=>t.reduce((t,r)=>(function e(t,r,n=".",i){if(!of(r))return e(t,{},n,i);let s=Object.assign({},r);for(let r in t){if("__proto__"===r||"constructor"===r)continue;let o=t[r];null!=o&&(i&&i(s,r,o,n)||(Array.isArray(o)&&Array.isArray(s[r])?s[r]=[...o,...s[r]]:of(o)&&of(s[r])?s[r]=e(o,s[r],(n?`${n}.`:"")+r.toString(),i):s[r]=o))}return s})(t,r,"",e),{})}let og=om();om((e,t,r)=>{if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0}),om((e,t,r)=>{if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0});var oy=Object.defineProperty,ov=Object.defineProperties,ob=Object.getOwnPropertyDescriptors,ox=Object.getOwnPropertySymbols,ow=Object.prototype.hasOwnProperty,o_=Object.prototype.propertyIsEnumerable,oS=(e,t,r)=>t in e?oy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oC=(e,t)=>{for(var r in t||(t={}))ow.call(t,r)&&oS(e,r,t[r]);if(ox)for(var r of ox(t))o_.call(t,r)&&oS(e,r,t[r]);return e},oT=(e,t)=>ov(e,ob(t)),oE=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},ok=async(e,t)=>{var r,n,i,s,o,a;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));l=n.options||l,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(i=c.hooks)?void 0:i.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(o=c.hooks)?void 0:o.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:l,hooks:u}},oR=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},oz=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},oI=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!n||!i)return t;t.authorization=`Basic ${btoa(`${n}:${i}`)}`}else if("Custom"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!i)return t;t.authorization=`${null!=n?n:""} ${i}`}}return t},oj=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function oO(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function oN(e){try{return JSON.parse(e)}catch(t){return e}}function oA(e){return"function"==typeof e}async function o$(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await oI(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=oO(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var oP=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function oL(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new oP(r.issues);return r.value}var oM=["get","post","put","patch","delete"],oB=async(e,t)=>{var r,n,i,s,o,a,l,u;let c,{hooks:d,url:h,options:p}=await ok(e,t),f=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("u">typeof globalThis&&oA(globalThis.fetch))return globalThis.fetch;if("u">typeof window&&oA(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(p),m=new AbortController,g=null!=(r=p.signal)?r:m.signal,y=function(e,t){let{baseURL:r,params:n,query:i}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];oM.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[o,a]=e.replace(s,"").split("?"),l=new URLSearchParams(a);for(let[e,t]of Object.entries(i||{})){let r;if(null!=t){if("string"==typeof t)r=t;else if(Array.isArray(t)){for(let r of t)l.append(e,r);continue}else r=JSON.stringify(t);l.set(e,r)}}if(n)if(Array.isArray(n))for(let[e,t]of o.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];o=o.replace(t,r)}else for(let[e,t]of Object.entries(n))o=o.replace(`:${e}`,String(t));(o=o.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(o=o.slice(1));let u=l.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http"))?new URL(`${o}${u}`,s):`${s}${o}${u}`}(h,p),v=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(oO(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&oO(e.body)?new URLSearchParams(e.body).toString():e.body}(p),b=await o$(p),x=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return oM.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(h,p),w=oT(oC({},p),{url:y,headers:b,body:v,method:x,signal:g});for(let e of d.onRequest)if(e){let t=await e(w);"object"==typeof t&&null!==t&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:_}=(!(null==p?void 0:p.signal)&&(null==p?void 0:p.timeout)&&(c=setTimeout(()=>null==m?void 0:m.abort(),null==p?void 0:p.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),S=await f(w.url,w);_();let C={response:S,request:w};for(let e of d.onResponse)if(e){let r=await e(oT(oC({},C),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?S.clone():S}));r instanceof Response?S=r:"object"==typeof r&&null!==r&&(S=r.response)}if(S.ok){if("HEAD"===w.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return oj.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(S),r={data:null,response:S,request:w};if("json"===e||"text"===e){let e=await S.text(),t=null!=(s=w.jsonParser)?s:oN;r.data=await t(e)}else r.data=await S[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(r.data=await oL(w.output,r.data)),d.onSuccess))e&&await e(oT(oC({},r),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?S.clone():S}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let T=null!=(a=null==t?void 0:t.jsonParser)?a:oN,E=await S.text(),k=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(E),R=k?await T(E):null,z={response:S,responseText:E,request:w,error:oT(oC({},R),{status:S.status,statusText:S.statusText})};for(let e of d.onError)e&&await e(oT(oC({},z),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?S.clone():S}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new oR({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new oR(e);case"exponential":return new oz(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,S)){for(let e of d.onRetry)e&&await e(C);let i=r.getDelay(n);return await new Promise(e=>setTimeout(e,i)),await oB(e,oT(oC({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new oE(S.status,S.statusText,k?R:E);return{data:null,error:oT(oC({},R),{status:S.status,statusText:S.statusText})}};function oD(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function oH(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t.padEnd(t.length+r,"=")),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return i}function oZ(){return oU.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}let oU={stubThis:e=>e};function oF(e){let{id:t}=e;return{...e,id:oH(t),transports:e.transports}}function oV(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class oW extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=n??r.name,this.code=t}}let oq=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}},oG=["cross-platform","platform"];function oJ(e){if(e&&!(0>oG.indexOf(e)))return e}async function oQ(e){let t,r,n,i,s;!e.optionsJSON&&e.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:o,useAutoRegister:a=!1}=e;if(!oZ())throw Error("WebAuthn is not supported in this browser");let l={...o,challenge:oH(o.challenge),user:{...o.user,id:oH(o.user.id)},excludeCredentials:o.excludeCredentials?.map(oF)},u={};a&&(u.mediation="conditional"),u.publicKey=l,u.signal=oq.createNewAbortSignal();try{t=await navigator.credentials.create(u)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new oW({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new oW({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&r.authenticatorSelection?.userVerification==="required")return new oW({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if(r.authenticatorSelection?.userVerification==="required")return new oW({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new oW({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new oW({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new oW(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!oV(t))return new oW({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new oW({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new oW({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new oW({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:u})}if(!t)throw Error("Registration was not completed");let{id:c,rawId:d,response:h,type:p}=t;if("function"==typeof h.getTransports&&(n=h.getTransports()),"function"==typeof h.getPublicKeyAlgorithm)try{i=h.getPublicKeyAlgorithm()}catch(e){oK("getPublicKeyAlgorithm()",e)}if("function"==typeof h.getPublicKey)try{let e=h.getPublicKey();null!==e&&(s=oD(e))}catch(e){oK("getPublicKey()",e)}if("function"==typeof h.getAuthenticatorData)try{r=oD(h.getAuthenticatorData())}catch(e){oK("getAuthenticatorData()",e)}return{id:c,rawId:oD(d),response:{attestationObject:oD(h.attestationObject),clientDataJSON:oD(h.clientDataJSON),transports:n,publicKeyAlgorithm:i,publicKey:s,authenticatorData:r},type:p,clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:oJ(t.authenticatorAttachment)}}function oK(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}let oY=e=>e;async function oX(e){let t,r,n;!e.optionsJSON&&e.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:i,useBrowserAutofill:s=!1,verifyBrowserAutofillInput:o=!0}=e;if(!oZ())throw Error("WebAuthn is not supported in this browser");i.allowCredentials?.length!==0&&(t=i.allowCredentials?.map(oF));let a={...i,challenge:oH(i.challenge),allowCredentials:t},l={};if(s){if(!await function(){if(!oZ())return oY(new Promise(e=>e(!1)));let e=globalThis.PublicKeyCredential;return e?.isConditionalMediationAvailable===void 0?oY(new Promise(e=>e(!1))):oY(e.isConditionalMediationAvailable())}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&o)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');l.mediation="conditional",a.allowCredentials=[]}l.publicKey=a,l.signal=oq.createNewAbortSignal();try{r=await navigator.credentials.get(l)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new oW({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new oW({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!oV(t))return new oW({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new oW({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new oW({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:l})}if(!r)throw Error("Authentication was not completed");let{id:u,rawId:c,response:d,type:h}=r;return d.userHandle&&(n=oD(d.userHandle)),{id:u,rawId:oD(c),response:{authenticatorData:oD(d.authenticatorData),clientDataJSON:oD(d.clientDataJSON),signature:oD(d.signature),userHandle:n},type:h,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:oJ(r.authenticatorAttachment)}}function o0(e){return{newRole:e=>{var t;return{authorize(e,r="AND"){let n=!1;for(let[i,s]of Object.entries(e)){let e=t[i];if(!e)return{success:!1,error:`You are not allowed to access resource: ${i}`};if(Array.isArray(s))n=s.every(t=>e.includes(t));else if("object"==typeof s)n="OR"===s.connector?s.actions.some(t=>e.includes(t)):s.actions.every(t=>e.includes(t));else throw new s0("Invalid access control request");if(n&&"OR"===r)return{success:n};if(!n&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${i}"`}}return n?{success:n}:{success:!1,error:"Not authorized"}},statements:t=e}},statements:e}}let o1=o0({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]});o1.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),o1.newRole({user:[],session:[]});let o2=o0({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]});o2.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),o2.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),o2.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]});let o4=function(e){var t;let{pluginPathMethods:r,pluginsActions:n,pluginsAtoms:i,$fetch:s,$store:o,atomListeners:a}=((e,t)=>{var r;let n,i,s="credentials"in Request.prototype,o=function(e,t,r,n,i){if(e)return s1(e,t);if(!1!==n){let e=e5.BETTER_AUTH_URL||e5.NEXT_PUBLIC_BETTER_AUTH_URL||e5.PUBLIC_BETTER_AUTH_URL||e5.NUXT_PUBLIC_BETTER_AUTH_URL||e5.NUXT_PUBLIC_AUTH_URL||("/"!==e5.BASE_URL?e5.BASE_URL:void 0);if(e)return s1(e,t)}r?.headers.get("x-forwarded-host"),r?.headers.get("x-forwarded-proto");if(r){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(r.url);if(!e)throw new s0("Could not get origin from request. Please provide a valid base URL.");return s1(e,t)}if("u">typeof window&&window.location)return s1(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",a=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],l={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:u,onError:c,onRequest:d,onResponse:h,...p}=e?.fetchOptions||{},f=(r={baseURL:o,...s?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:i,parseDates:s=!0}=t;if("string"!=typeof e)return e;let o=e.trim();if(o.length>0&&'"'===o[0]&&o.endsWith('"')&&!o.slice(1,-1).includes('"'))return o.slice(1,-1);let a=o.toLowerCase();if(a.length<=9&&a in s3)return s3[a];if(!s9.test(o)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(s4).some(([e,t])=>{let r=t.test(o);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(o,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=function(e){let t=s5.exec(e);if(!t)return null;let[,r,n,i,s,o,a,l,u,c,d]=t,h=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10),parseInt(s,10),parseInt(o,10),parseInt(a,10),l?parseInt(l.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(d,10))*("+"===u?-1:1);h.setUTCMinutes(h.getUTCMinutes()+e)}return h instanceof Date&&!isNaN(h.getTime())?h:null}(t);if(e)return e}return i?i(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...p,plugins:[l,...p.plugins||[],...e?.disableDefaultFetchPlugins?[]:[s2],...a]},async function(e,t){let n,i=oT(oC(oC({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,i,s,o;let a=(null==(i=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:i.schema)||n.schema;if(a){let r=e;(null==(s=a.config)?void 0:s.prefix)&&r.startsWith(a.config.prefix)&&(r=r.replace(a.config.prefix,""),a.config.baseURL&&(e=e.replace(a.config.prefix,a.config.baseURL))),(null==(o=a.config)?void 0:o.baseURL)&&r.startsWith(a.config.baseURL)&&(r=r.replace(a.config.baseURL,""));let n=a.schema[r];if(n){let r=oT(oC({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=oT(oC({},r),{body:n.input?await oL(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await oL(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await oL(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}}),...(null==t?void 0:t.plugins)||[]]});if(null==r?void 0:r.catchAllError)try{return await oB(e,i)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await oB(e,i)}),{$sessionSignal:m,session:g}=(ot(i=on(n=oe(!1),"/get-session",f,{method:"GET"}),()=>{let t=function(e){let{sessionAtom:t,sessionSignal:r,$fetch:n,options:i={}}=e,s=i.sessionOptions?.refetchInterval??0,o=i.sessionOptions?.refetchOnWindowFocus??!0,a=i.sessionOptions?.refetchWhenOffline??!1,l={lastSync:0,lastSessionRequest:0,cachedSession:void 0},u=e=>{if(!(a||oh().isOnline))return;if(e?.event==="storage"){l.lastSync=op(),r.set(!r.get());return}let i=t.get();if(e?.event==="poll"){l.lastSessionRequest=op(),n("/get-session").then(e=>{e.error?t.set({...i,data:null,error:e.error}):t.set({...i,data:e.data,error:null}),l.lastSync=op(),r.set(!r.get())}).catch(()=>{});return}if(e?.event==="visibilitychange"){if(op()-l.lastSessionRequest<5)return;l.lastSessionRequest=op()}(i?.data===null||i?.data===void 0||e?.event==="visibilitychange")&&(l.lastSync=op(),r.set(!r.get()))};return{init:()=>{s&&s>0&&(l.pollInterval=setInterval(()=>{t.get()?.data&&u({event:"poll"})},1e3*s)),l.unsubscribeBroadcast=oo().subscribe(()=>{u({event:"storage"})}),o&&(l.unsubscribeFocus=ou().subscribe(()=>{u({event:"visibilitychange"})})),l.unsubscribeOnline=oh().subscribe(e=>{e&&u({event:"visibilitychange"})}),oo().setup(),ou().setup(),oh().setup()},cleanup:()=>{l.pollInterval&&(clearInterval(l.pollInterval),l.pollInterval=void 0),l.unsubscribeBroadcast&&(l.unsubscribeBroadcast(),l.unsubscribeBroadcast=void 0),l.unsubscribeFocus&&(l.unsubscribeFocus(),l.unsubscribeFocus=void 0),l.unsubscribeOnline&&(l.unsubscribeOnline(),l.unsubscribeOnline=void 0),l.lastSync=0,l.lastSessionRequest=0,l.cachedSession=void 0},triggerRefetch:u,broadcastSessionUpdate:e=>{oo().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:i,sessionSignal:n,$fetch:f,options:e});return t.init(),()=>{t.cleanup()}}),{session:i,$sessionSignal:n}),y=e?.plugins||[],v={},b={$sessionSignal:m,session:g},x={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},w=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of y)e.getAtoms&&Object.assign(b,e.getAtoms?.(f)),e.pathMethods&&Object.assign(x,e.pathMethods),e.atomListeners&&w.push(...e.atomListeners);let _={notify:e=>{b[e].set(!b[e].get())},listen:(e,t)=>{b[e].subscribe(t)},atoms:b};for(let t of y)t.getActions&&(v=og(t.getActions?.(f,_,e)??{},v));return{get baseURL(){return o},pluginsActions:v,pluginsAtoms:b,pluginPathMethods:x,atomListeners:w,$fetch:f,$store:_}})(e),l={};for(let[e,t]of Object.entries(i))l[function(e){return`use${e.charAt(0).toUpperCase()+e.slice(1)}`}(e)]=()=>(function(e,t={}){let r=(0,b.useRef)(e.get()),{keys:n,deps:i=[e,n]}=t,s=(0,b.useCallback)(t=>{let i=e=>{r.current!==e&&(r.current=e,t())};if(i(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&i(e,r,n)})}return e.listen(i)},i),o=()=>r.current;return(0,b.useSyncExternalStore)(s,o,o)})(t);return t={...n,...l,$fetch:s,$store:o},function e(n=[]){return new Proxy(function(){},{get(r,i){var s;if("string"!=typeof i||"then"===i||"catch"===i||"finally"===i)return;let o=[...n,i],a=t;for(let e of o)if(a&&"object"==typeof a&&e in a)a=a[e];else{a=void 0;break}return"function"==typeof a?a:"object"==typeof(s=a)&&null!==s&&"get"in s&&"function"==typeof s.get&&"lc"in s&&"number"==typeof s.lc?a:e(o)},apply:async(e,t,o)=>{let l="/"+n.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=o[0]||{},c=o[1]||{},{query:d,fetchOptions:h,...p}=u,f={...c,...h},m=function(e,t,r){let n=t[e],{fetchOptions:i,query:s,...o}=r||{};return n||(i?.method?i.method:o&&Object.keys(o).length>0?"POST":"GET")}(l,r,u);return await s(l,{...f,body:"GET"===m?void 0:{...p,...f?.body||{}},query:d||f?.query,method:m,async onSuccess(e){if(await f?.onSuccess?.(e),!a||f.disableSignal)return;let t=a.filter(e=>e.matcher(l));if(!t.length)return;let r=new Set;for(let e of t){let t=i[e.signal];if(!t)return;if(r.has(e.signal))continue;r.add(e.signal);let n=t.get();setTimeout(()=>{t.set(!n)},10)}}})}})}()}({baseURL:eX.Capacitor.isNativePlatform()?"http://192.168.1.111:3000":void 0,plugins:[(l=oe(),{id:"passkey",$InferServerPlugin:{},getActions:(e,t)=>((e,{$listPasskeys:t,$store:r})=>({signIn:{passkey:async(n,i)=>{let s=await e("/passkey/generate-authenticate-options",{method:"GET",throw:!1});if(!s.data)return s;try{let o=await e("/passkey/verify-authentication",{body:{response:await oX({optionsJSON:s.data,useBrowserAutofill:n?.autoFill})},...n?.fetchOptions,...i,method:"POST",throw:!1});return t.set(Math.random()),r.notify("$sessionSignal"),o}catch(e){return console.error("[Better Auth] Error verifying passkey",e),{data:null,error:{code:"AUTH_CANCELLED",message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(r,n)=>{let i=await e("/passkey/generate-register-options",{method:"GET",query:{...r?.authenticatorAttachment&&{authenticatorAttachment:r.authenticatorAttachment},...r?.name&&{name:r.name}},throw:!1});if(!i.data)return i;try{let s=await oQ({optionsJSON:i.data,useAutoRegister:r?.useAutoRegister}),o=await e("/passkey/verify-registration",{...r?.fetchOptions,...n,body:{response:s,name:r?.name},method:"POST",throw:!1});if(!o.data)return o;return t.set(Math.random()),o}catch(e){if(e instanceof oW){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===e.code)return{data:null,error:{code:e.code,message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===e.code)return{data:null,error:{code:e.code,message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{code:e.code,message:e.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{code:"UNKNOWN_ERROR",message:e instanceof Error?e.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}))(e,{$listPasskeys:l,$store:t}),getAtoms:e=>({listPasskeys:on(l,"/passkey/list-user-passkeys",e,{method:"GET"}),$listPasskeys:l}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:e=>"/passkey/verify-registration"===e||"/passkey/delete-passkey"===e||"/passkey/update-passkey"===e||"/sign-out"===e,signal:"$listPasskeys"},{matcher:e=>"/passkey/verify-authentication"===e,signal:"$sessionSignal"}]}),{id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST","/delete-anonymous-user":"POST"},atomListeners:[{matcher:e=>"/sign-in/anonymous"===e,signal:"$sessionSignal"}]}]}),{signIn:o9,signUp:o3,useSession:o5,signOut:o6}=o4,o7=({onLogin:e,tenantName:t})=>{let[r,n]=(0,b.useState)("choice"),[i,s]=(0,b.useState)(null),[o,a]=(0,b.useState)(""),[l,u]=(0,b.useState)("male"),[c,d]=(0,b.useState)(""),[h,p]=(0,b.useState)(""),[f,g]=(0,b.useState)(null),[y,x]=(0,b.useState)(!1);(0,b.useEffect)(()=>{eX.Capacitor.isNativePlatform()&&(document.body.style.backgroundColor="#ffffff",document.documentElement.style.backgroundColor="#ffffff",e1.setStyle({style:m.Light}).catch(()=>{}))},[]);let w=async e=>{if(e.preventDefault(),g(null),!(c.length<9)){x(!0);try{let e=await fetch("/api/auth/otp/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:"+39"+c})});if(!e.ok){let t=await e.json();throw Error(t.error||"Errore invio SMS")}x(!1),n("otp_verification")}catch(e){x(!1),g(e.message)}}},_=async t=>{if(t.preventDefault(),g(null),6===h.length){x(!0);try{let t=await fetch("/api/auth/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:"+39"+c,code:h})}),r=await t.json();if(!t.ok)throw Error(r.error||"Codice non valido");if(r.isNewUser){x(!1),n("profile_completion");return}if(r.success&&r.user){let t={...r.user,alias:r.user.alias||r.user.name||"User"};e(t)}}catch(e){x(!1),g(e.message)}}},S=async t=>{t.preventDefault(),g(null),x(!0);try{let t=await fetch("/api/auth/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:"+39"+c,code:h,alias:o.trim(),gender:l})}),r=await t.json();if(!t.ok)throw Error(r.error||"Errore creazione profilo");if(r.success&&r.user){let t={...r.user,alias:r.user.alias||r.user.name||"User"};e(t)}}catch(e){x(!1),g(e.message)}};(0,b.useEffect)(()=>{(async()=>{try{let{data:e}=await o4.getSession();if(e?.user){let t=e.user;!t.alias&&t.name&&(t.alias=t.name),s(t),n("continue")}}catch(e){}})()},[]),window.PublicKeyCredential&&(window.isSecureContext||window.location.hostname);let C={male:"Maschio",female:"Femmina",other:"Altro"};return(0,v.jsxs)("div",{className:"bg-white p-6 sm:p-8 w-full h-full sm:h-auto sm:max-w-md sm:rounded-2xl sm:shadow-xl sm:border border-gray-100 flex flex-col min-h-screen sm:min-h-[600px] justify-between",children:[(0,v.jsxs)("div",{className:`flex flex-col items-center transition-all duration-500 ${"choice"===r||"continue"===r?"mt-4 mb-2":"mt-2 mb-2"}`,children:[(0,v.jsx)("div",{className:`transition-all duration-300 ${"choice"===r||"continue"===r?"w-24 h-24 mb-12":"w-16 h-16 mb-2"}`,children:(0,v.jsx)("img",{src:"/local_logo.svg",alt:"Local Logo",className:"w-full h-full object-contain"})}),("choice"===r||"continue"===r)&&(0,v.jsxs)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-700 text-center",children:[(0,v.jsx)("p",{className:"text-emerald-600 font-bold text-[11px] uppercase tracking-[0.25em] mb-20 px-8 leading-relaxed",children:"Chatta con le persone intorno a te"}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("p",{className:"text-gray-400 text-[10px] uppercase tracking-[0.15em] font-medium",children:"Ti trovi nello spazio:"}),(0,v.jsx)("h1",{className:"text-3xl font-black text-gray-900 tracking-tight leading-tight",children:t})]})]})]}),(0,v.jsxs)("div",{className:"flex-1 flex flex-col justify-center py-12",children:["choice"===r&&(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("button",{onClick:()=>n("anonymous"),className:"w-full bg-white hover:bg-gray-50 text-gray-700 font-bold py-4 rounded-xl border-2 border-gray-100 hover:border-emerald-500 hover:text-emerald-600 transition-all flex items-center justify-center gap-2 group",children:[(0,v.jsx)("span",{className:"text-xl group-hover:scale-110 transition-transform",children:""}),(0,v.jsx)("span",{children:"Accedi come Anonimo"})]}),(0,v.jsx)("button",{onClick:()=>n("phone_input"),className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-200 transition-all flex items-center justify-center gap-2",children:(0,v.jsx)("span",{children:"Accedi con Account"})})]}),f&&(0,v.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-100 text-red-600 text-sm rounded-xl text-center animate-pulse",children:f}),"continue"===r&&i&&(0,v.jsxs)("div",{className:"space-y-6 text-center",children:[(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("div",{className:"w-20 h-20 bg-emerald-100 rounded-full mx-auto flex items-center justify-center text-3xl mb-4 shadow-inner",children:i.image?(0,v.jsx)("img",{src:i.image,className:"w-full h-full rounded-full border-2 border-white",alt:i.name}):(0,v.jsx)("span",{className:"opacity-80",children:""})}),(0,v.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:["Ciao, ",i.name,"!"]}),(0,v.jsx)("p",{className:"text-gray-500 mt-2",children:"Il tuo profilo  pronto. Entra subito nella chat dello spazio."})]}),(0,v.jsxs)("button",{onClick:()=>{i&&e(i)},className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-100 transition-all flex items-center justify-center gap-2",children:[(0,v.jsx)("span",{children:"Entra nella Chat"}),(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,v.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),(0,v.jsx)("button",{onClick:()=>{o4.signOut().then(()=>{s(null),n("phone_input")})},className:"text-gray-400 text-sm hover:text-gray-600 font-medium transition-colors",children:"Usa un altro account"})]}),"anonymous"===r&&(0,v.jsxs)("form",{onSubmit:t=>{t.preventDefault(),o.trim()&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),e({id:`guest_${Math.random().toString(36).substr(2,9)}`,alias:o.trim(),gender:l,joinedAt:Date.now()}))},className:"space-y-6",children:[(0,v.jsxs)("div",{className:"text-center mb-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Benvenuto"}),(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Scegli un alias per entrare subito"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Alias"}),(0,v.jsx)("input",{type:"text",required:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,maxLength:20,value:o,onChange:e=>a(e.target.value),placeholder:"es. ShadowHunter",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-gray-800",style:{fontSize:"18px"}})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Identit di Genere"}),(0,v.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(e=>(0,v.jsx)("button",{type:"button",onClick:()=>u(e),className:`py-2 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${l===e?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"}`,children:C[e]},e))})]}),(0,v.jsx)("button",{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-200",children:"Entra nella Stanza"}),(0,v.jsx)("button",{type:"button",onClick:()=>n("choice"),className:"w-full text-gray-400 text-sm flex items-center justify-center gap-1 hover:text-gray-600 mt-4",children:" Torna indietro"})]}),"phone_input"===r&&(0,v.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,v.jsxs)("div",{className:"text-center mb-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Accedi"}),(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Inserisci il tuo numero per accedere al profilo"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Numero di Telefono"}),(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-medium select-none pointer-events-none",children:" +39"}),(0,v.jsx)("input",{type:"tel",required:!0,autoFocus:!0,value:c,onChange:e=>{d(e.target.value.replace(/\D/g,""))},disabled:y,placeholder:"333 1234567",className:"w-full pl-20 pr-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-gray-800 font-medium tracking-wide disabled:bg-gray-50 disabled:text-gray-400",style:{fontSize:"18px"}})]})]}),(0,v.jsx)("button",{type:"submit",disabled:c.length<9||y,className:"w-full bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-100 transition-all flex items-center justify-center gap-2",children:y?(0,v.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,v.jsx)("span",{children:"Invia Codice Verifica"})}),(0,v.jsx)("button",{type:"button",onClick:()=>n("choice"),className:"w-full text-gray-400 text-sm flex items-center justify-center gap-1 hover:text-gray-600 mt-4",children:" Torna indietro"})]}),"otp_verification"===r&&(0,v.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[(0,v.jsx)("button",{type:"button",disabled:y,onClick:()=>n("phone_input"),className:"text-gray-400 text-sm flex items-center gap-1 hover:text-gray-600 mb-2",children:" Modifica numero"}),(0,v.jsxs)("div",{className:"text-center mb-2",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Verifica Numero"}),(0,v.jsxs)("p",{className:"text-sm text-gray-500",children:["Codice inviato a +39 ",c]})]}),(0,v.jsx)("div",{children:(0,v.jsx)("input",{type:"text",required:!0,autoFocus:!0,maxLength:6,value:h,onChange:e=>p(e.target.value.replace(/\D/g,"")),placeholder:"0 0 0 0 0 0",disabled:y,className:"w-full px-4 py-4 text-center rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-gray-800 font-bold tracking-[0.5em] disabled:bg-gray-50 disabled:text-gray-400",style:{fontSize:"24px"}})}),(0,v.jsx)("button",{type:"submit",disabled:6!==h.length||y,className:"w-full bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-100 transition-all flex items-center justify-center",children:y?(0,v.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Verifica e Accedi"})]}),"profile_completion"===r&&(0,v.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,v.jsxs)("div",{className:"text-center mb-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Completa Profilo"}),(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Dicci come chiamarti"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Il tuo Nome (Alias)"}),(0,v.jsx)("input",{type:"text",required:!0,autoFocus:!0,value:o,onChange:e=>a(e.target.value),disabled:y,placeholder:"es. Mario Rossi",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-gray-800 disabled:bg-gray-50",style:{fontSize:"18px"}})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Genere"}),(0,v.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["male","female","other"].map(e=>(0,v.jsx)("button",{type:"button",onClick:()=>u(e),disabled:y,className:`py-3 rounded-xl text-xs font-bold uppercase tracking-wider border transition-all ${l===e?"bg-emerald-500 text-white border-emerald-500 shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200"} ${y?"opacity-50 cursor-not-allowed":""}`,children:C[e]},e))})]}),(0,v.jsx)("button",{type:"submit",disabled:!o.trim()||y,className:"w-full bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-100 transition-all flex items-center justify-center",children:y?(0,v.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Entra nella Chat"})]}),(0,v.jsx)("div",{className:"py-8 border-t border-gray-50/50 mt-auto",children:(0,v.jsx)("p",{className:"text-center text-[10px] text-gray-400 uppercase tracking-[0.2em] font-medium opacity-50",children:"Powered by Local  Copyright 2025"})})]})]})};var o8=e.i(74080);function ae(e){e()}function at(e,t){return r=>e(t(r))}function ar(e){return void 0!==e}function an(){}function ai(e,t){return t(e)}function as(...e){return e}function ao(e){e(2)}function aa(e){return e(4)}function al(e,t){return e(1,e=>t(0,e))}function au(e,t){let r=e(1,e=>{r(),t(e)});return r}function ac(e){let t,r;return n=>i=>{t=i,r&&clearTimeout(r),r=setTimeout(()=>{n(t)},e)}}function ad(e,t){return e===t}function ah(e=ad){let t;return r=>n=>{e(t,n)||(t=n,r(n))}}function ap(e){return t=>r=>{e(r)&&t(r)}}function af(e){return t=>at(t,e)}function am(e){return t=>()=>{t(e)}}function ag(e,...t){let r=function(...e){return t=>e.reduceRight(ai,t)}(...t);return(t,n)=>{switch(t){case 2:ao(e);return;case 1:return e(1,r(n))}}}function ay(e,t){return r=>n=>{r(t=e(t,n))}}function av(e){return t=>r=>{e>0?e--:t(r)}}function ab(e){let t=null,r;return n=>i=>{t=i,r||(r=setTimeout(()=>{r=void 0,n(t)},e))}}function ax(...e){let t=Array(e.length),r=0,n=null,i=Math.pow(2,e.length)-1;return e.forEach((e,s)=>{let o=Math.pow(2,s);e(1,e=>{let a=r;r|=o,t[s]=e,a!==i&&r===i&&n&&(n(),n=null)})}),e=>s=>{let o=()=>{e([s].concat(t))};r===i?o():n=o}}function aw(e){let t=e,r=aS();return(e,n)=>{switch(e){case 0:t=n;break;case 1:n(t);break;case 4:return t}return r(e,n)}}function a_(e,t){var r;return r=aw(t),al(e,r),r}function aS(){let e=[];return(t,r)=>{switch(t){case 0:e.slice().forEach(e=>{e(r)});return;case 2:e.splice(0,e.length);return;case 1:return e.push(r),()=>{let t=e.indexOf(r);t>-1&&e.splice(t,1)}}}}function aC(e){var t;return t=aS(),al(e,t),t}function aT(e,t=[],{singleton:r}={singleton:!0}){return{constructor:e,dependencies:t,id:aE(),singleton:r}}let aE=()=>Symbol();function ak(...e){let t=aS(),r=Array(e.length),n=0,i=Math.pow(2,e.length)-1;return e.forEach((e,s)=>{let o=Math.pow(2,s);e(1,e=>{r[s]=e,(n|=o)===i&&t(0,r)})}),function(e,s){switch(e){case 2:return void ao(t);case 1:return n===i&&s(r),t(1,s)}}}function aR(e,t=ad){return ag(e,ah(t))}function az(...e){return function(t,r){switch(t){case 2:return;case 1:return function(...e){return()=>{e.map(ae)}}(...e.map(e=>e(1,r)))}}}var aI=((u=aI||{})[u.DEBUG=0]="DEBUG",u[u.INFO=1]="INFO",u[u.WARN=2]="WARN",u[u.ERROR=3]="ERROR",u);let aj={0:"debug",3:"error",1:"log",2:"warn"},aO=aT(()=>{let e=aw(3);return{log:aw((t,r,n=1)=>{var i;n>=(null!=(i=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?i:aa(e))&&console[aj[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,r)}),logLevel:e}},[],{singleton:!0});function aN(e,t,r){return aA(e,t,r).callbackRef}function aA(e,t,r){let n=b.default.useRef(null),i=b.default.useMemo(()=>"u">typeof ResizeObserver?new ResizeObserver(t=>{let n=()=>{let r=t[0].target;null!==r.offsetParent&&e(r)};r?n():requestAnimationFrame(n)}):null,[e,r]);return{callbackRef:e=>{e&&t?(null==i||i.observe(e),n.current=e):(n.current&&(null==i||i.unobserve(n.current)),n.current=null)},ref:n}}function a$(e,t,r,n,i,s,o,a,l){return aA(b.default.useCallback(r=>{let l,u=function(e,t,r,n){let i=e.length;if(0===i)return null;let s=[];for(let o=0;o<i;o++){let i=e.item(o);if(void 0===i.dataset.index)continue;let a=parseInt(i.dataset.index),l=parseFloat(i.dataset.knownSize),u=t(i,r);if(0===u&&n("Zero-sized element, this should not happen",{child:i},aI.ERROR),u===l)continue;let c=s[s.length-1];0===s.length||c.size!==u||c.endIndex!==a-1?s.push({endIndex:a,size:u,startIndex:a}):s[s.length-1].endIndex++}return s}(r.children,t,a?"offsetWidth":"offsetHeight",i),c=r.parentElement;for(;!c.dataset.virtuosoScroller;)c=c.parentElement;let d="window"===c.lastElementChild.dataset.viewportType;d&&(l=c.ownerDocument.defaultView);let h=o?a?o.scrollLeft:o.scrollTop:d?a?l.scrollX||l.document.documentElement.scrollLeft:l.scrollY||l.document.documentElement.scrollTop:a?c.scrollLeft:c.scrollTop;n({scrollHeight:o?a?o.scrollWidth:o.scrollHeight:d?a?l.document.documentElement.scrollWidth:l.document.documentElement.scrollHeight:a?c.scrollWidth:c.scrollHeight,scrollTop:Math.max(h,0),viewportHeight:o?a?o.offsetWidth:o.offsetHeight:d?a?l.innerWidth:l.innerHeight:a?c.offsetWidth:c.offsetHeight}),null==s||s(a?aP("column-gap",getComputedStyle(r).columnGap,i):aP("row-gap",getComputedStyle(r).rowGap,i)),null!==u&&e(u)},[e,t,i,s,o,n,a]),r,l)}function aP(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,aI.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}function aL(e,t,r){let n=b.default.useRef(null),i=b.default.useCallback(r=>{let i,s;if(!(null!=r&&r.offsetParent))return;let a=r.getBoundingClientRect(),l=a.width;if(t){let e=t.getBoundingClientRect(),r=a.top-e.top;s=e.height-Math.max(0,r),i=r+t.scrollTop}else{let e=o.current.ownerDocument.defaultView;s=e.innerHeight-Math.max(0,a.top),i=a.top+e.scrollY}n.current={offsetTop:i,visibleHeight:s,visibleWidth:l},e(n.current)},[e,t]),{callbackRef:s,ref:o}=aA(i,!0,r),a=b.default.useCallback(()=>{i(o.current)},[i,o]);return b.default.useEffect(()=>{var e;if(t){t.addEventListener("scroll",a);let e=new ResizeObserver(()=>{requestAnimationFrame(a)});return e.observe(t),()=>{t.removeEventListener("scroll",a),e.unobserve(t)}}{let t=null==(e=o.current)?void 0:e.ownerDocument.defaultView;return null==t||t.addEventListener("scroll",a),null==t||t.addEventListener("resize",a),()=>{null==t||t.removeEventListener("scroll",a),null==t||t.removeEventListener("resize",a)}}},[a,t,o]),s}let aM=aT(()=>{let e=aS(),t=aS(),r=aw(0),n=aS(),i=aw(0),s=aS(),o=aS(),a=aw(0),l=aw(0),u=aw(0),c=aw(0),d=aS(),h=aS(),p=aw(!1),f=aw(!1),m=aw(!1);return al(ag(e,af(({scrollTop:e})=>e)),t),al(ag(e,af(({scrollHeight:e})=>e)),o),al(t,i),{deviation:r,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:c,headerHeight:a,horizontalDirection:f,scrollBy:h,scrollContainerState:e,scrollHeight:o,scrollingInProgress:p,scrollTo:d,scrollTop:t,skipAnimationFrameInResizeObserver:m,smoothScrollTargetReached:n,statefulScrollTop:i,viewportHeight:s}},[],{singleton:!0}),aB={lvl:0};function aD(e,t){let r=e.length;if(0===r)return[];let{index:n,value:i}=t(e[0]),s=[];for(let o=1;o<r;o++){let{index:r,value:a}=t(e[o]);s.push({end:r-1,start:n,value:i}),n=r,i=a}return s.push({end:1/0,start:n,value:i}),s}function aH(e){return e===aB}function aZ(e,t){if(!aH(e))return t===e.k?e.v:t<e.k?aZ(e.l,t):aZ(e.r,t)}function aU(e,t,r="k"){if(aH(e))return[-1/0,void 0];if(Number(e[r])===t)return[e.k,e.v];if(Number(e[r])<t){let n=aU(e.r,t,r);return n[0]===-1/0?[e.k,e.v]:n}return aU(e.l,t,r)}function aF(e,t,r){return aH(e)?aQ(t,r,1):t===e.k?aG(e,{k:t,v:r}):t<e.k?aY(aK(aG(e,{l:aF(e.l,t,r)}))):aY(aK(aG(e,{r:aF(e.r,t,r)})))}function aV(e,t,r){if(aH(e))return[];let n=aU(e,t)[0];return aD(function e(t,r,n){if(aH(t))return[];let{k:i,l:s,r:o,v:a}=t,l=[];return i>r&&(l=l.concat(e(s,r,n))),i>=r&&i<=n&&l.push({k:i,v:a}),i<=n&&(l=l.concat(e(o,r,n))),l}(e,n,r),({k:e,v:t})=>({index:e,value:t}))}function aW(e){return aH(e)?[]:[...aW(e.l),{k:e.k,v:e.v},...aW(e.r)]}function aq(e){let{l:t,lvl:r,r:n}=e;if(n.lvl>=r-1&&t.lvl>=r-1)return e;if(r>n.lvl+1){if(aJ(t))return aK(aG(e,{lvl:r-1}));if(!aH(t)&&!aH(t.r))return aG(t.r,{l:aG(t,{r:t.r.l}),lvl:r,r:aG(e,{l:t.r.r,lvl:r-1})});throw Error("Unexpected empty nodes")}if(aJ(e))return aY(aG(e,{lvl:r-1}));if(aH(n)||aH(n.l))throw Error("Unexpected empty nodes");{let t=n.l,i=aJ(t)?n.lvl-1:n.lvl;return aG(t,{l:aG(e,{lvl:r-1,r:t.l}),lvl:t.lvl+1,r:aY(aG(n,{l:t.r,lvl:i}))})}}function aG(e,t){return aQ(void 0!==t.k?t.k:e.k,void 0!==t.v?t.v:e.v,void 0!==t.lvl?t.lvl:e.lvl,void 0!==t.l?t.l:e.l,void 0!==t.r?t.r:e.r)}function aJ(e){return aH(e)||e.lvl>e.r.lvl}function aQ(e,t,r,n=aB,i=aB){return{k:e,l:n,lvl:r,r:i,v:t}}function aK(e){let{l:t}=e;return aH(t)||t.lvl!==e.lvl?e:aG(t,{r:aG(e,{l:t.r})})}function aY(e){let{lvl:t,r:r}=e;return aH(r)||aH(r.r)||r.lvl!==t||r.r.lvl!==t?e:aG(r,{l:aG(e,{r:r.l}),lvl:t+1})}function aX(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}function a0(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}let a1=aT(()=>({recalcInProgress:aw(!1)}),[],{singleton:!0});function a2(e,t,r,n=0){let i=e.length-1;for(;n<=i;){let s=Math.floor((n+i)/2),o=r(e[s],t);if(0===o)return s;if(-1===o){if(i-n<2)return s-1;i=s-1}else{if(i===n)return s;n=s+1}}throw Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function a4(e,t){return Math.round(e.getBoundingClientRect()[t])}function a9(e){return!aH(e.groupOffsetTree)}function a3({index:e},t){return t===e?0:t<e?-1:1}function a5({offset:e},t){return t===e?0:t<e?-1:1}function a6(e,t,r){if(0===t.length)return 0;let{index:n,offset:i,size:s}=t[a2(t,e,a3)],o=e-n,a=s*o+(o-1)*r+i;return a>0?a+r:a}function a7(e,t){if(!a9(t))return e;let r=0;for(;t.groupIndices[r]<=e+r;)r++;return e+r}function a8(e,t,r){if("u">typeof e.groupIndex)return t.groupIndices[e.groupIndex]+1;{let n=a7("LAST"===e.index?r:e.index,t);return Math.max(0,n,Math.min(r,n))}}function le(e,[t,r,n,i]){t.length>0&&n("received item sizes",t,aI.DEBUG);let s=e.sizeTree,o=s,a=0;if(r.length>0&&aH(s)&&2===t.length){let e=t[0].size,n=t[1].size;o=r.reduce((t,r)=>aF(aF(t,r,e),r+1,n),o)}else[o,a]=function(e,t){let r=aH(e)?0:1/0;for(let n of t){let{endIndex:t,size:i,startIndex:s}=n;if(r=Math.min(r,s),aH(e)){e=aF(e,0,i);continue}let o=aV(e,s-1,t+1);if(o.some(function(e){let{endIndex:t,size:r,startIndex:n}=e;return e=>e.start===n&&(e.end===t||e.end===1/0)&&e.value===r}(n)))continue;let a=!1,l=!1;for(let{end:r,start:n,value:s}of o)a?(t>=n||i===s)&&(e=function e(t,r){if(aH(t))return aB;let{k:n,l:i,r:s}=t;if(r!==n)return r<n?aq(aG(t,{l:e(i,r)})):aq(aG(t,{r:e(s,r)}));if(aH(i))return s;if(aH(s))return i;{let[e,r]=function e(t){return aH(t.r)?[t.k,t.v]:e(t.r)}(i);return aq(aG(t,{k:e,l:function e(t){return aH(t.r)?t.l:aq(aG(t,{r:e(t.r)}))}(i),v:r}))}}(e,n)):(l=s!==i,a=!0),r>t&&t>=n&&s!==i&&(e=aF(e,t+1,s));l&&(e=aF(e,s,i))}return[e,r]}(o,t);if(o===s)return e;let{lastIndex:l,lastOffset:u,lastSize:c,offsetTree:d}=lr(e.offsetTree,a,o,i);return{groupIndices:r,groupOffsetTree:r.reduce((e,t)=>aF(e,t,a6(t,d,i)),aB),lastIndex:l,lastOffset:u,lastSize:c,offsetTree:d,sizeTree:o}}function lt(e,t){let r=0,n=0;for(;r<e;)r+=t[n+1]-t[n]-1,n++;return n-(r!==e)}function lr(e,t,r,n){let i=e,s=0,o=0,a=0,l=0;if(0!==t){l=a2(i,t-1,a3),a=i[l].offset;let e=aU(r,t-1);s=e[0],o=e[1],i.length&&i[l].size===aU(r,t)[1]&&(l-=1),i=i.slice(0,l+1)}else i=[];for(let{start:e,value:l}of aV(r,t,1/0)){let t=e-s,r=t*o+a+t*n;i.push({index:e,offset:r,size:l}),s=e,a=r,o=l}return{lastIndex:s,lastOffset:a,lastSize:o,offsetTree:i}}function ln(e){return{index:e.index,value:e}}let li={offsetHeight:"height",offsetWidth:"width"},ls=aT(([{log:e},{recalcInProgress:t}])=>{let r=aS(),n=aS(),i=a_(n,0),s=aS(),o=aS(),a=aw(0),l=aw([]),u=aw(void 0),c=aw(void 0),d=aw(void 0),h=aw(void 0),p=aw((e,t)=>a4(e,li[t])),f=aw(void 0),m=aw(0),g={groupIndices:[],groupOffsetTree:aB,lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:aB},y=a_(ag(r,ax(l,e,m),ay(le,g),ah()),g),v=a_(ag(l,ah(),ay((e,t)=>({current:t,prev:e.current}),{current:[],prev:[]}),af(({prev:e})=>e)),[]);al(ag(l,ap(e=>e.length>0),ax(y,m),af(([e,t,r])=>{let n=e.reduce((e,n,i)=>aF(e,n,a6(n,t.offsetTree,r)||i),aB);return{...t,groupIndices:e,groupOffsetTree:n}})),y),al(ag(n,ax(y),ap(([e,{lastIndex:t}])=>e<t),af(([e,{lastIndex:t,lastSize:r}])=>[{endIndex:t,size:r,startIndex:e}])),r),al(u,c);let b=a_(ag(u,af(e=>void 0===e)),!0);al(ag(c,ap(e=>void 0!==e&&aH(aa(y).sizeTree)),af(e=>{let t=aa(d),r=aa(l).length>0;return t?r?[{endIndex:0,size:t,startIndex:0},{endIndex:1,size:e,startIndex:1}]:[]:[{endIndex:0,size:e,startIndex:0}]})),r),al(ag(h,ap(e=>void 0!==e&&e.length>0&&aH(aa(y).sizeTree)),af(e=>{let t=[],r=e[0],n=0;for(let i=1;i<e.length;i++){let s=e[i];s!==r&&(t.push({endIndex:i-1,size:r,startIndex:n}),r=s,n=i)}return t.push({endIndex:e.length-1,size:r,startIndex:n}),t})),r),al(ag(l,ax(d,c),ap(([,e,t])=>void 0!==e&&void 0!==t),af(([e,t,r])=>{let n=[];for(let i=0;i<e.length;i++){let s=e[i],o=e[i+1];n.push({startIndex:s,endIndex:s,size:t}),void 0!==o&&n.push({startIndex:s+1,endIndex:o-1,size:r})}return n})),r);let x=aC(ag(r,ax(y),ay(({sizes:e},[t,r])=>({changed:r!==e,sizes:r}),{changed:!1,sizes:g}),af(e=>e.changed)));ag(a,ay((e,t)=>({diff:e.prev-t,prev:t}),{diff:0,prev:0}),af(e=>e.diff))(1,e=>{let{groupIndices:r}=aa(y);if(e>0)t(0,!0),s(0,e+lt(e,r));else if(e<0){let t=aa(v);t.length>0&&(e-=lt(-e,t)),o(0,e)}}),ag(a,ax(e))(1,([e,t])=>{e<0&&t("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},aI.ERROR)});let w=aC(s);al(ag(s,ax(y),af(([e,t])=>{let r=t.groupIndices.length>0,n=[],i=t.lastSize;if(r){let r=aZ(t.sizeTree,0),s=0,o=0;for(;s<e;){let e=t.groupIndices[o],a=t.groupIndices.length===o+1?1/0:t.groupIndices[o+1]-e-1;n.push({endIndex:e,size:r,startIndex:e}),n.push({endIndex:e+1+a-1,size:i,startIndex:e+1}),o++,s+=a+1}let a=aW(t.sizeTree);return s!==e&&a.shift(),a.reduce((t,{k:r,v:n})=>{let i=t.ranges;return 0!==t.prevSize&&(i=[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]),{prevIndex:r+e,prevSize:n,ranges:i}},{prevIndex:e,prevSize:0,ranges:n}).ranges}return aW(t.sizeTree).reduce((t,{k:r,v:n})=>({prevIndex:r+e,prevSize:n,ranges:[...t.ranges,{endIndex:r+e-1,size:t.prevSize,startIndex:t.prevIndex}]}),{prevIndex:0,prevSize:i,ranges:[]}).ranges})),r);let _=aC(ag(o,ax(y,m),af(([e,{offsetTree:t},r])=>a6(-e,t,r))));return al(ag(o,ax(y,m),af(([e,t,r])=>{if(t.groupIndices.length>0){if(aH(t.sizeTree))return t;let n=aB,i=aa(v),s=0,o=0,a=0;for(;s<-e;){a=i[o];let e=i[o+1]-a-1;o++,s+=e+1}return n=aW(t.sizeTree).reduce((t,{k:r,v:n})=>aF(t,Math.max(0,r+e),n),n),s!==-e&&(n=aF(n,0,aZ(t.sizeTree,a)),n=aF(n,1,aU(t.sizeTree,-e+1)[1])),{...t,sizeTree:n,...lr(t.offsetTree,0,n,r)}}{let n=aW(t.sizeTree).reduce((t,{k:r,v:n})=>aF(t,Math.max(0,r+e),n),aB);return{...t,sizeTree:n,...lr(t.offsetTree,0,n,r)}}})),y),{beforeUnshiftWith:w,data:f,defaultItemSize:c,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:d,gap:m,groupIndices:l,heightEstimates:h,itemSize:p,listRefresh:x,shiftWith:o,shiftWithOffset:_,sizeRanges:r,sizes:y,statefulTotalCount:i,totalCount:n,trackItemSizes:b,unshiftWith:s}},as(aO,a1),{singleton:!0});function lo(e){return e.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{groupIndices:[],totalCount:0})}let la=aT(([{groupIndices:e,sizes:t,totalCount:r},{headerHeight:n,scrollTop:i}])=>{let s=aS(),o=aS(),a=aC(ag(s,af(lo)));return al(ag(a,af(e=>e.totalCount)),r),al(ag(a,af(e=>e.groupIndices)),e),al(ag(ak(i,t,n),ap(([e,t])=>a9(t)),af(([e,t,r])=>aU(t.groupOffsetTree,Math.max(e-r,0),"v")[0]),ah(),af(e=>[e])),o),{groupCounts:s,topItemsIndexes:o}},as(ls,aM)),ll=aT(([{log:e}])=>{let t=aw(!1),r=aC(ag(t,ap(e=>e),ah()));return t(1,t=>{t&&aa(e)("props updated",{},aI.DEBUG)}),{didMount:r,propsReady:t}},as(aO),{singleton:!0}),lu="u">typeof document&&"scrollBehavior"in document.documentElement.style;function lc(e){let t="number"==typeof e?{index:e}:e;return t.align||(t.align="start"),t.behavior&&lu||(t.behavior="auto"),t.offset||(t.offset=0),t}let ld=aT(([{gap:e,listRefresh:t,sizes:r,totalCount:n},{fixedFooterHeight:i,fixedHeaderHeight:s,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:c,viewportHeight:d},{log:h}])=>{let p=aS(),f=aS(),m=aw(0),g=null,y=null,v=null;function b(){g&&(g(),g=null),v&&(v(),v=null),y&&(clearTimeout(y),y=null),l(0,!1)}return al(ag(p,ax(r,d,n,m,a,o,h),ax(e,s,i),af(([[e,r,n,i,s,o,a,u],d,h,m])=>{let x=lc(e),{align:w,behavior:_,offset:S}=x,C=i-1,T=a8(x,r,C),E=a6(T,r.offsetTree,d)+o;"end"===w?(E+=h+aU(r.sizeTree,T)[1]-n+m,T===C&&(E+=a)):"center"===w?E+=(h+aU(r.sizeTree,T)[1]-n+m)/2:E-=s,S&&(E+=S);let k=t=>{b(),t?(u("retrying to scroll to",{location:e},aI.DEBUG),p(0,e)):(f(0,!0),u("list did not change, scroll successful",{},aI.DEBUG))};if(b(),"smooth"===_){let e=!1;v=t(1,t=>{e=e||t}),g=au(c,()=>{k(e)})}else g=au(ag(t,e=>{let t=setTimeout(()=>{e(!1)},150);return r=>{r&&(e(!0),clearTimeout(t))}}),k);return y=setTimeout(()=>{b()},1200),l(0,!0),u("scrolling from index to",{behavior:_,index:T,top:E},aI.DEBUG),{behavior:_,top:E}})),u),{scrollTargetReached:f,scrollToIndex:p,topListHeight:m}},as(ls,aM,aO),{singleton:!0});function lh(e,t){0==e?t():requestAnimationFrame(()=>{lh(e-1,t)})}function lp(e,t){return"number"==typeof e?e:"LAST"===e.index?t-1:e.index}let lf=aT(([{defaultItemSize:e,listRefresh:t,sizes:r},{scrollTop:n},{scrollTargetReached:i,scrollToIndex:s},{didMount:o}])=>{let a=aw(!0),l=aw(0),u=aw(!0);return al(ag(o,ax(l),ap(([e,t])=>!!t),am(!1)),a),al(ag(o,ax(l),ap(([e,t])=>!!t),am(!1)),u),ag(ak(t,o),ax(a,r,e,u),ap(([[,e],t,{sizeTree:r},n,i])=>e&&(!aH(r)||ar(n))&&!t&&!i),ax(l))(1,([,e])=>{au(i,()=>{u(0,!0)}),lh(4,()=>{au(n,()=>{a(0,!0)}),s(0,e)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},as(ls,aM,ld,ll),{singleton:!0});function lm(e,t){return 1.01>Math.abs(e-t)}let lg="down",ly={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},lv=aT(([{footerHeight:e,headerHeight:t,scrollBy:r,scrollContainerState:n,scrollTop:i,viewportHeight:s}])=>{let o=aw(!1),a=aw(!0),l=aS(),u=aS(),c=aw(4),d=aw(0),h=a_(ag(az(ag(aR(i),av(1),am(!0)),ag(aR(i),av(1),am(!1),ac(100))),ah()),!1),p=a_(ag(az(ag(r,am(!0)),ag(r,am(!1),ac(200))),ah()),!1);al(ag(ak(aR(i),aR(d)),af(([e,t])=>e<=t),ah()),a),al(ag(a,ab(50)),u);let f=aC(ag(ak(n,aR(s),aR(t),aR(e),aR(c)),ay((e,[{scrollHeight:t,scrollTop:r},n,i,s,o])=>{let a={scrollHeight:t,scrollTop:r,viewportHeight:n};if(r+n-t>-o){let t,n;return r>e.state.scrollTop?(t="SCROLLED_DOWN",n=e.state.scrollTop-r):(t="SIZE_DECREASED",n=e.state.scrollTop-r||e.scrollTopDelta),{atBottom:!0,atBottomBecause:t,scrollTopDelta:n,state:a}}return{atBottom:!1,notAtBottomBecause:a.scrollHeight>e.state.scrollHeight?"SIZE_INCREASED":n<e.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":r<e.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:a}},ly),ah((e,t)=>e&&e.atBottom===t.atBottom))),m=a_(ag(n,ay((e,{scrollHeight:t,scrollTop:r,viewportHeight:n})=>{if(lm(e.scrollHeight,t))return{changed:!1,jump:0,scrollHeight:t,scrollTop:r};{let i=t-(r+n)<1;return e.scrollTop!==r&&i?{changed:!0,jump:e.scrollTop-r,scrollHeight:t,scrollTop:r}:{changed:!0,jump:0,scrollHeight:t,scrollTop:r}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),ap(e=>e.changed),af(e=>e.jump)),0);al(ag(f,af(e=>e.atBottom)),o),al(ag(o,ab(50)),l);let g=aw(lg);al(ag(n,af(({scrollTop:e})=>e),ah(),ay((e,t)=>aa(p)?{direction:e.direction,prevScrollTop:t}:{direction:t<e.prevScrollTop?"up":lg,prevScrollTop:t},{direction:lg,prevScrollTop:0}),af(e=>e.direction)),g),al(ag(n,ab(50),am("none")),g);let y=aw(0);return al(ag(h,ap(e=>!e),am(0)),y),al(ag(i,ab(100),ax(h),ap(([e,t])=>t),ay(([e,t],[r])=>[t,r],[0,0]),af(([e,t])=>t-e)),y),{atBottomState:f,atBottomStateChange:l,atBottomThreshold:c,atTopStateChange:u,atTopThreshold:d,isAtBottom:o,isAtTop:a,isScrolling:h,lastJumpDueToItemResize:m,scrollDirection:g,scrollVelocity:y}},as(aM)),lb="bottom",lx="none";function lw(e,t,r){return"number"==typeof e?"up"===r&&"top"===t||r===lg&&t===lb?e:0:"up"===r?"top"===t?e.main:e.reverse:t===lb?e.main:e.reverse}function l_(e,t){var r;return"number"==typeof e?e:null!=(r=e[t])?r:0}let lS=aT(([{deviation:e,fixedHeaderHeight:t,headerHeight:r,scrollTop:n,viewportHeight:i}])=>{let s=aS(),o=aw(0),a=aw(0),l=aw(0),u=a_(ag(ak(aR(n),aR(i),aR(r),aR(s,a0),aR(l),aR(o),aR(t),aR(e),aR(a)),af(([e,t,r,[n,i],s,o,a,l,u])=>{let c=e-l,d=Math.max(r-c,0),h=lx,p=l_(u,"top"),f=l_(u,lb);return n-=l,n+=r+a,i+=r+a,n>e+(o+a)-p&&(h="up"),(i-=l)<e-d+t+f&&(h=lg),h!==lx?[Math.max(c-r-lw(s,"top",h)-p,0),c-d-a+t+lw(s,lb,h)+f]:null}),ap(e=>null!=e),ah(a0)),[0,0]);return{increaseViewportBy:a,listBoundary:s,overscan:l,topListHeight:o,visibleRange:u}},as(aM),{singleton:!0}),lC={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function lT(e,t,r,n,i,s){let{lastIndex:o,lastOffset:a,lastSize:l}=i,u=0,c=0;if(e.length>0){u=e[0].offset;let t=e[e.length-1];c=t.offset+t.size}let d=r-o,h=u,p=a+d*l+(d-1)*n-c;return{bottom:c,firstItemIndex:s,items:lk(e,i,s),offsetBottom:p,offsetTop:u,top:h,topItems:lk(t,i,s),topListHeight:t.reduce((e,t)=>t.size+e,0),totalCount:r}}function lE(e,t,r,n,i,s){let o=0;if(r.groupIndices.length>0)for(let t of r.groupIndices){if(t-o>=e)break;o++}let a=e+o,l=lp(t,a);return lT(Array.from({length:a}).map((e,t)=>({data:s[t+l],index:t+l,offset:0,size:0})),[],a,i,r,n)}function lk(e,t,r){if(0===e.length)return[];if(!a9(t))return e.map(e=>({...e,index:e.index+r,originalIndex:e.index}));let n=e[0].index,i=e[e.length-1].index,s=[],o=aV(t.groupOffsetTree,n,i),a,l=0;for(let n of e){let e;(!a||a.end<n.index)&&(a=o.shift(),l=t.groupIndices.indexOf(a.start)),e=n.index===a.start?{index:l,type:"group"}:{groupIndex:l,index:n.index-(l+1)+r},s.push({...e,data:n.data,offset:n.offset,originalIndex:n.index,size:n.size})}return s}function lR(e,t){var r;return void 0===e?0:"number"==typeof e?e:null!=(r=e[t])?r:0}let lz=aT(([{data:e,firstItemIndex:t,gap:r,sizes:n,totalCount:i},s,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:c},{topListHeight:d},h,{didMount:p},{recalcInProgress:f}])=>{let m=aw([]),g=aw(0),y=aS(),v=aw(0);al(s.topItemsIndexes,m);let b=a_(ag(ak(p,f,aR(l,a0),aR(i),aR(n),aR(u),c,aR(m),aR(t),aR(r),aR(v),e),ap(([e,t,,r,,,,,,,,n])=>{let i=n&&n.length!==r;return e&&!t&&!i}),af(([,,[e,t],r,n,i,s,o,a,l,u,c])=>{var d,h,p,f,m;let{offsetTree:y,sizeTree:v}=n,b=aa(g);if(0===r)return{...lC,totalCount:r};if(0===e&&0===t)return 0===b?{...lC,totalCount:r}:lE(b,i,n,a,l,c||[]);if(aH(v))return b>0?null:lT(function(e,t,r){if(a9(t)){let n=a7(e,t);return[{index:aU(t.groupOffsetTree,n)[0],offset:0,size:0},{data:null==r?void 0:r[0],index:n,offset:0,size:0}]}return[{data:null==r?void 0:r[0],index:e,offset:0,size:0}]}(lp(i,r),n,c),[],r,l,n,a);let x=[];if(o.length>0){let e=o[0],t=o[o.length-1],r=0;for(let n of aV(v,e,t)){let i=n.value,s=Math.max(n.start,e),o=Math.min(n.end,t);for(let e=s;e<=o;e++)x.push({data:null==c?void 0:c[e],index:e,offset:r,size:i}),r+=i}}if(!s)return lT([],x,r,l,n,a);let w=o.length>0?o[o.length-1]+1:0,_=function(e,t,r,n=0){let i,s;return n>0&&(t=Math.max(t,e[a2(e,n,a3)].offset)),aD((i=a2(e,t,a5),s=a2(e,r,a5,i),e.slice(i,s+1)),ln)}(y,e,t,w);if(0===_.length)return null;let S=r-1,C=((r=>{for(let n of _){let i=n.value,s=i.offset,o=n.start,a=i.size;if(i.offset<e){let t=(o+=Math.floor((e-i.offset+l)/(a+l)))-n.start;s+=t*a+t*l}o<w&&(s+=(w-o)*a,o=w);let u=Math.min(n.end,S);for(let e=o;e<=u&&!(s>=t);e++)r.push({data:null==c?void 0:c[e],index:e,offset:s,size:a}),s+=a+l}})(m=[]),m),T=lR(u,"top"),E=lR(u,lb);if(C.length>0&&(T>0||E>0)){let e=C[0],t=C[C.length-1];if(T>0&&e.index>w){let t=Math.min(T,e.index-w),r=[],n=e.offset;for(let i=e.index-1;i>=e.index-t;i--){let t=null!=(h=null==(d=aV(v,i,i)[0])?void 0:d.value)?h:e.size;n-=t+l,r.unshift({data:null==c?void 0:c[i],index:i,offset:n,size:t})}C.unshift(...r)}if(E>0&&t.index<S){let e=Math.min(E,S-t.index),r=t.offset+t.size+l;for(let n=t.index+1;n<=t.index+e;n++){let e=null!=(f=null==(p=aV(v,n,n)[0])?void 0:p.value)?f:t.size;C.push({data:null==c?void 0:c[n],index:n,offset:r,size:e}),r+=e+l}}}return lT(C,x,r,l,n,a)}),ap(e=>null!==e),ah()),lC);al(ag(e,ap(ar),af(e=>null==e?void 0:e.length)),i),al(ag(b,af(e=>e.topListHeight)),d),al(d,a),al(ag(b,af(e=>[e.top,e.bottom])),o),al(ag(b,af(e=>e.items)),y);let x=aC(ag(b,ap(({items:e})=>e.length>0),ax(i,e),ap(([{items:e},t])=>e[e.length-1].originalIndex===t-1),af(([,e,t])=>[e-1,t]),ah(a0),af(([e])=>e))),w=aC(ag(b,ab(200),ap(({items:e,topItems:t})=>e.length>0&&e[0].originalIndex===t.length),af(({items:e})=>e[0].index),ah())),_=aC(ag(b,ap(({items:e})=>e.length>0),af(({items:e})=>{let t=0,r=e.length-1;for(;"group"===e[t].type&&t<r;)t++;for(;"group"===e[r].type&&r>t;)r--;return{endIndex:e[r].index,startIndex:e[t].index}}),ah(aX)));return{endReached:x,initialItemCount:g,itemsRendered:y,listState:b,minOverscanItemCount:v,rangeChanged:_,startReached:w,topItemsIndexes:m,...h}},as(ls,la,lS,lf,ld,lv,ll,a1),{singleton:!0}),lI=aT(([{fixedFooterHeight:e,fixedHeaderHeight:t,footerHeight:r,headerHeight:n},{listState:i}])=>{let s=aS(),o=a_(ag(ak(r,e,n,t,i),af(([e,t,r,n,i])=>e+t+r+n+i.offsetBottom+i.bottom)),0);return al(aR(o),s),{totalListHeight:o,totalListHeightChanged:s}},as(aM,lz),{singleton:!0}),lj=aT(([{viewportHeight:e},{totalListHeight:t}])=>{let r=aw(!1),n=a_(ag(ak(r,e,t),ap(([e])=>e),af(([,e,t])=>Math.max(0,e-t)),ab(0),ah()),0);return{alignToBottom:r,paddingTopAddition:n}},as(aM,lI),{singleton:!0}),lO=aT(()=>({context:aw(null)})),lN=({itemBottom:e,itemTop:t,locationParams:{align:r,behavior:n,...i},viewportBottom:s,viewportTop:o})=>t<o?{...i,align:null!=r?r:"start",behavior:n}:e>s?{...i,align:null!=r?r:"end",behavior:n}:null,lA=aT(([{gap:e,sizes:t,totalCount:r},{fixedFooterHeight:n,fixedHeaderHeight:i,headerHeight:s,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{let c=aS();return al(ag(c,ax(t,l,r,s,i,n,a),ax(e),af(([[e,t,r,n,i,s,a,l],u])=>{let{align:c,behavior:d,calculateViewLocation:h=lN,done:p,...f}=e,m=a8(e,t,n-1),g=a6(m,t.offsetTree,u)+i+s,y=h({itemBottom:g+aU(t.sizeTree,m)[1],itemTop:g,locationParams:{align:c,behavior:d,...f},viewportBottom:l+r-a,viewportTop:l+s});return y?p&&au(ag(o,ap(e=>!e),av(aa(o)?1:2)),p):null==p||p(),y}),ap(e=>null!==e)),u),{scrollIntoView:c}},as(ls,aM,ld,lz,aO),{singleton:!0});function l$(e){return!!e&&("smooth"===e?"smooth":"auto")}let lP=aT(([{listRefresh:e,totalCount:t,fixedItemSize:r,data:n},{atBottomState:i,isAtBottom:s},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:c},{scrollingInProgress:d},{context:h},{scrollIntoView:p}])=>{let f=aw(!1),m=aS(),g=null;function y(e){o(0,{align:"end",behavior:e,index:"LAST"})}function v(e){setTimeout(au(i,t=>{!e||t.atBottom||"SIZE_INCREASED"!==t.notAtBottomBecause||g||(aa(c)("scrolling to bottom due to increased size",{},aI.DEBUG),y("auto"))}),100)}ag(ak(ag(aR(t),av(1)),l),ax(aR(f),s,a,d),af(([[e,t],r,n,i,s])=>{let o,a=t&&i,l="auto";return a&&(o=n||s,l="function"==typeof r?l$(r(o)):o&&l$(r),a=a&&!!l),{followOutputBehavior:l,shouldFollow:a,totalCount:e}}),ap(({shouldFollow:e})=>e))(1,({followOutputBehavior:t,totalCount:n})=>{g&&(g(),g=null),aa(r)?requestAnimationFrame(()=>{aa(c)("following output to ",{totalCount:n},aI.DEBUG),y(t)}):g=au(e,()=>{aa(c)("following output to ",{totalCount:n},aI.DEBUG),y(t),g=null})}),ag(ak(aR(f),t,u),ap(([e,,t])=>e&&t),ay(({value:e},[,t])=>({refreshed:e===t,value:t}),{refreshed:!1,value:0}),ap(({refreshed:e})=>e),ax(f,t))(1,([,e])=>{aa(a)&&v(!1!==e)}),m(1,()=>{v(!1!==aa(f))}),ak(aR(f),i)(1,([e,t])=>{e&&!t.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===t.notAtBottomBecause&&y("auto")});let b=aw(null),x=aS();return al(az(ag(aR(n),af(e=>{var t;return null!=(t=null==e?void 0:e.length)?t:0})),ag(aR(t))),x),ag(ak(ag(x,av(1)),l),ax(aR(b),a,d,h),af(([[e,t],r,n,i,s])=>t&&n&&(null==r?void 0:r({context:s,totalCount:e,scrollingInProgress:i}))),ap(e=>!!e),ab(0))(1,t=>{g&&(g(),g=null),aa(r)?requestAnimationFrame(()=>{aa(c)("scrolling into view",{}),p(0,t)}):g=au(e,()=>{aa(c)("scrolling into view",{}),p(0,t),g=null})}),{autoscrollToBottom:m,followOutput:f,scrollIntoViewOnChange:b}},as(ls,lv,ld,lf,ll,aO,aM,lO,lA)),lL=aT(([{data:e,firstItemIndex:t,gap:r,sizes:n},{initialTopMostItemIndex:i},{initialItemCount:s,listState:o},{didMount:a}])=>(al(ag(a,ax(s),ap(([,e])=>0!==e),ax(i,n,t,r,e),af(([[,e],t,r,n,i,s=[]])=>lE(e,t,r,n,i,s))),o),{}),as(ls,lf,lz,ll),{singleton:!0}),lM=aT(([{didMount:e},{scrollTo:t},{listState:r}])=>{let n=aw(0);return ag(e,ax(n),ap(([,e])=>0!==e),af(([,e])=>({top:e})))(1,e=>{au(ag(r,av(1),ap(e=>e.items.length>1)),()=>{requestAnimationFrame(()=>{t(0,e)})})}),{initialScrollTop:n}},as(ll,aM,lz),{singleton:!0}),lB=aT(([{scrollVelocity:e}])=>{let t=aw(!1),r=aS(),n=aw(!1);return al(ag(e,ax(n,t,r),ap(([e,t])=>!!t),af(([e,t,r,n])=>{let{enter:i,exit:s}=t;if(r){if(s(e,n))return!1}else if(i(e,n))return!0;return r}),ah()),t),ag(ak(t,e,r),ax(n))(1,([[e,t,r],n])=>{e&&n&&n.change&&n.change(t,r)}),{isSeeking:t,scrollSeekConfiguration:n,scrollSeekRangeChanged:r,scrollVelocity:e}},as(lv),{singleton:!0}),lD=aT(([{scrollContainerState:e,scrollTo:t}])=>{let r=aS(),n=aS(),i=aS(),s=aw(!1),o=aw(void 0);return al(ag(ak(r,n),af(([{scrollHeight:e,scrollTop:t,viewportHeight:r},{offsetTop:n}])=>({scrollHeight:e,scrollTop:Math.max(0,t-n),viewportHeight:r}))),e),al(ag(t,ax(n),af(([e,{offsetTop:t}])=>({...e,top:e.top+t}))),i),{customScrollParent:o,useWindowScroll:s,windowScrollContainerState:r,windowScrollTo:i,windowViewportRect:n}},as(aM)),lH=aT(([{sizeRanges:e,sizes:t},{headerHeight:r,scrollTop:n},{initialTopMostItemIndex:i},{didMount:s},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{let u=aS(),c=aw(void 0),d=aw(null),h=aw(null);return al(a,d),al(l,h),ag(u,ax(t,n,o,d,h,r))(1,([e,t,r,n,i,s,o])=>{let a=aW(t.sizeTree).map(({k:e,v:t},r,n)=>{let i=n[r+1];return{endIndex:i?i.k-1:1/0,size:t,startIndex:e}});n&&null!==i&&null!==s&&(r=i.scrollTop-s.offsetTop),e({ranges:a,scrollTop:r-=o})}),al(ag(c,ap(ar),af(lZ)),i),al(ag(s,ax(c),ap(([,e])=>void 0!==e),ah(),af(([,e])=>e.ranges)),e),{getState:u,restoreStateFrom:c}},as(ls,aM,lf,ll,lD));function lZ(e){return{align:"start",index:0,offset:e.scrollTop}}let lU=aT(([{topItemsIndexes:e}])=>{let t=aw(0);return al(ag(t,ap(e=>e>=0),af(e=>Array.from({length:e}).map((e,t)=>t))),e),{topItemCount:t}},as(lz));function lF(e){let t=!1,r;return()=>(t||(t=!0,r=e()),r)}let lV=lF(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),lW=aT(([{deviation:e,scrollBy:t,scrollingInProgress:r,scrollTop:n},{isAtBottom:i,isScrolling:s,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:c,shiftWithOffset:d,sizes:h},{log:p},{recalcInProgress:f}])=>{let m=aC(ag(l,ax(o),ay(([,e,t,r],[{bottom:n,items:i,offsetBottom:s,totalCount:o},a])=>{let l=n+s,u=0;return t===o&&e.length>0&&i.length>0&&(0===i[0].originalIndex&&0===e[0].originalIndex||0!=(u=l-r)&&(u+=a)),[u,i,o,l]},[0,[],0,0]),ap(([e])=>0!==e),ax(n,a,r,i,p,f),ap(([,e,t,r,,,n])=>!n&&!r&&0!==e&&"up"===t),af(([[e],,,,,t])=>(t("Upward scrolling compensation",{amount:e},aI.DEBUG),e))));function g(r){r>0?(t(0,{behavior:"auto",top:-r}),e(0,0)):(e(0,0),t(0,{behavior:"auto",top:-r}))}return ag(m,ax(e,s))(1,([t,r,n])=>{n&&lV()?e(0,r-t):g(-t)}),ag(ak(a_(s,!1),e,f),ap(([e,t,r])=>!e&&!r&&0!==t),af(([e,t])=>t),ab(1))(1,g),al(ag(d,af(e=>({top:-e}))),t),ag(u,ax(h,c),af(([e,{groupIndices:t,lastSize:r,sizeTree:n},i])=>{if(0===t.length)return e*(r+i);{let s=0,o=aZ(n,0),a=0,l=0;for(;a<e;){a++,s+=o;let n=t.length===l+1?1/0:t[l+1]-t[l]-1;a+n>e&&(s-=o,n=e-a+1),a+=n,s+=n*(r+i),l++}return s}}))(1,r=>{e(0,r),requestAnimationFrame(()=>{t(0,{top:r}),requestAnimationFrame(()=>{e(0,0),f(0,!1)})})}),{deviation:e}},as(aM,lv,lz,ls,aO,a1)),lq=aT(([e,t,r,n,i,s,o,a,l,u,c])=>({...e,...t,...r,...n,...i,...s,...o,...a,...l,...u,...c}),as(lS,lL,ll,lB,lI,lM,lj,lD,lA,aO,lO)),lG=aT(([{data:e,defaultItemSize:t,firstItemIndex:r,fixedItemSize:n,fixedGroupSize:i,gap:s,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:c,statefulTotalCount:d,totalCount:h,trackItemSizes:p},{initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g},y,v,b,x,{scrollToIndex:w},_,{topItemCount:S},{groupCounts:C},T])=>{let{listState:E,minOverscanItemCount:k,topItemsIndexes:R,rangeChanged:z,...I}=x;return al(z,T.scrollSeekRangeChanged),al(ag(T.windowViewportRect,af(e=>e.visibleHeight)),y.viewportHeight),{data:e,defaultItemHeight:t,firstItemIndex:r,fixedItemHeight:n,fixedGroupHeight:i,gap:s,groupCounts:C,heightEstimates:a,initialItemFinalLocationReached:f,initialTopMostItemIndex:m,scrolledToInitialItem:g,sizeRanges:u,topItemCount:S,topItemsIndexes:R,totalCount:h,...b,groupIndices:o,itemSize:l,listState:E,minOverscanItemCount:k,scrollToIndex:w,statefulTotalCount:d,trackItemSizes:p,rangeChanged:z,...I,...T,...y,sizes:c,...v}},as(ls,lf,aM,lH,lP,lz,ld,lW,lU,la,lq)),lJ="u">typeof document?b.default.useLayoutEffect:b.default.useEffect;function lQ(e,t,r){let n=Object.keys(t.required||{}),i=Object.keys(t.optional||{}),s=Object.keys(t.methods||{}),o=Object.keys(t.events||{}),a=b.default.createContext({});function l(e,r){for(let i of(e.propsReady&&(0,e.propsReady)(0,!1),n))(0,e[t.required[i]])(0,r[i]);for(let n of i)n in r&&(0,e[t.optional[n]])(0,r[n]);e.propsReady&&(0,e.propsReady)(0,!0)}function u(e){return o.reduce((r,n)=>{var i;let s,o,a;return r[n]=(i=e[t.events[n]],a=()=>null==s?void 0:s(),function(e,t){switch(e){case 1:return t?o===t?void 0:(a(),o=t,s=i(1,t)):(a(),an);case 2:a(),o=null;return}}),r},{})}return{Component:b.default.forwardRef((c,d)=>{var h;let{children:p,...f}=c,[m]=b.default.useState(()=>{var t;let r,n;return r=new Map,l(t=(n=({constructor:e,dependencies:t,id:i,singleton:s})=>{if(s&&r.has(i))return r.get(i);let o=e(t.map(e=>n(e)));return s&&r.set(i,o),o})(e),f),t}),[g]=b.default.useState(()=>u(m));return lJ(()=>{for(let e of o)e in f&&(0,g[e])(1,f[e]);return()=>{Object.values(g).map(ao)}},[f,g,m]),lJ(()=>{l(m,f)}),b.default.useImperativeHandle(d,(h=s.reduce((e,r)=>(e[r]=e=>{(0,m[t.methods[r]])(0,e)},e),{}),()=>h)),(0,v.jsx)(a.Provider,{value:m,children:r?(0,v.jsx)(r,{...function(e,t){let r={},n={},i=0,s=e.length;for(;i<s;)n[e[i]]=1,i+=1;for(let e in t)Object.hasOwn(n,e)||(r[e]=t[e]);return r}([...n,...i,...o],f),children:p}):p})}),useEmitter:(e,t)=>{let r=b.default.useContext(a)[e];lJ(()=>r(1,t),[t,r])},useEmitterValue:b.default.version.startsWith("18")?e=>{let t=b.default.useContext(a)[e],r=b.default.useCallback(e=>t(1,e),[t]);return b.default.useSyncExternalStore(r,()=>aa(t),()=>aa(t))}:e=>{let t=b.default.useContext(a)[e],[r,n]=b.default.useState(()=>aa(t));return lJ(()=>t(1,e=>{e!==r&&n(()=>e)}),[t,r]),r},usePublisher:e=>{let t=b.default.useContext(a);return b.default.useCallback(r=>{(0,t[e])(0,r)},[t,e])}}}let lK=b.default.createContext(void 0),lY=b.default.createContext(void 0),lX="u">typeof document?b.default.useLayoutEffect:b.default.useEffect;function l0(e){return"self"in e}function l1(e,t,r,n=an,i,s){let o=b.default.useRef(null),a=b.default.useRef(null),l=b.default.useRef(null),u=b.default.useCallback(r=>{let n,i,o,u=r.target;if("body"in u||l0(u)){let e=l0(u)?u:u.defaultView;o=s?e.scrollX:e.scrollY,n=s?e.document.documentElement.scrollWidth:e.document.documentElement.scrollHeight,i=s?e.innerWidth:e.innerHeight}else o=s?u.scrollLeft:u.scrollTop,n=s?u.scrollWidth:u.scrollHeight,i=s?u.offsetWidth:u.offsetHeight;let c=()=>{e({scrollHeight:n,scrollTop:Math.max(o,0),viewportHeight:i})};r.suppressFlushSync?c():o8.default.flushSync(c),null!==a.current&&(o===a.current||o<=0||o===n-i)&&(a.current=null,t(!0),l.current&&(clearTimeout(l.current),l.current=null))},[e,t,s]);return b.default.useEffect(()=>{let e=i||o.current;return n(i||o.current),u({suppressFlushSync:!0,target:e}),e.addEventListener("scroll",u,{passive:!0}),()=>{n(null),e.removeEventListener("scroll",u)}},[o,u,r,n,i]),{scrollByCallback:function(e){s&&(e={behavior:e.behavior,left:e.top}),o.current.scrollBy(e)},scrollerRef:o,scrollToCallback:function(r){let n,i,u,c=o.current;if(!c||(s?"offsetWidth"in c&&0===c.offsetWidth:"offsetHeight"in c&&0===c.offsetHeight))return;let d="smooth"===r.behavior;l0(c)?(i=Math.max(a4(c.document.documentElement,s?"width":"height"),s?c.document.documentElement.scrollWidth:c.document.documentElement.scrollHeight),n=s?c.innerWidth:c.innerHeight,u=s?window.scrollX:window.scrollY):(i=c[s?"scrollWidth":"scrollHeight"],n=a4(c,s?"width":"height"),u=c[s?"scrollLeft":"scrollTop"]);let h=i-n;if(r.top=Math.ceil(Math.max(Math.min(h,r.top),0)),lm(n,i)||r.top===u){e({scrollHeight:i,scrollTop:u,viewportHeight:n}),d&&t(!0);return}d?(a.current=r.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,t(!0)},1e3)):a.current=null,s&&(r={behavior:r.behavior,left:r.top}),c.scrollTo(r)}}}let l2="-webkit-sticky",l4="sticky",l9=lF(()=>{if(typeof document>"u")return l4;let e=document.createElement("div");return e.style.position=l2,e.style.position===l2?l2:l4});function l3(e){return e}let l5=aT(()=>{let e=aw(e=>`Item ${e}`),t=aw(e=>`Group ${e}`),r=aw({}),n=aw(l3),i=aw("div"),s=aw(an),o=(e,t=null)=>a_(ag(r,af(t=>t[e]),ah()),t);return{components:r,computeItemKey:n,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:t,HeaderComponent:o("Header"),HeaderFooterTag:i,ItemComponent:o("Item","div"),itemContent:e,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:s,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),l6=aT(([e,t])=>({...e,...t}),as(lG,l5)),l7=({height:e})=>(0,v.jsx)("div",{style:{height:e}}),l8={overflowAnchor:"none",position:l9(),zIndex:1},ue={overflowAnchor:"none"},ut={...ue,display:"inline-block",height:"100%"},ur=b.default.memo(function({showTopList:e=!1}){let t=uv("listState"),r=ub("sizeRanges"),n=uv("useWindowScroll"),i=uv("customScrollParent"),s=ub("windowScrollContainerState"),o=ub("scrollContainerState"),a=uv("itemContent"),l=uv("context"),u=uv("groupContent"),c=uv("trackItemSizes"),d=uv("itemSize"),h=uv("log"),p=ub("gap"),f=uv("horizontalDirection"),{callbackRef:m}=a$(r,d,c,e?an:i||n?s:o,h,p,i,f,uv("skipAnimationFrameInResizeObserver")),[g,y]=b.default.useState(0);uy("deviation",e=>{g!==e&&y(e)});let x=uv("EmptyPlaceholder"),w=uv("ScrollSeekPlaceholder")||l7,_=uv("ListComponent"),S=uv("ItemComponent"),C=uv("GroupComponent"),T=uv("computeItemKey"),E=uv("isSeeking"),k=uv("groupIndices").length>0,R=uv("alignToBottom"),z=uv("initialItemFinalLocationReached"),I=e?{}:{boxSizing:"border-box",...f?{display:"inline-block",height:"100%",marginLeft:0!==g?g:R?"auto":0,paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,whiteSpace:"nowrap"}:{marginTop:0!==g?g:R?"auto":0,paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},...z?{}:{visibility:"hidden"}};return!e&&0===t.totalCount&&x?(0,v.jsx)(x,{...ua(x,l)}):(0,v.jsx)(_,{...ua(_,l),"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",ref:m,style:I,children:(e?t.topItems:t.items).map(e=>{let r=e.originalIndex,n=T(r+t.firstItemIndex,e.data,l);return E?(0,b.createElement)(w,{...ua(w,l),height:e.size,index:e.index,key:n,type:e.type||"item",..."group"===e.type?{}:{groupIndex:e.groupIndex}}):"group"===e.type?(0,b.createElement)(C,{...ua(C,l),"data-index":r,"data-item-index":e.index,"data-known-size":e.size,key:n,style:l8},u(e.index,l)):(0,b.createElement)(S,{...ua(S,l),...ul(S,e.data),"data-index":r,"data-item-group-index":e.groupIndex,"data-item-index":e.index,"data-known-size":e.size,key:n,style:f?ut:ue},k?a(e.index,e.groupIndex,e.data,l):a(e.index,e.data,l))})})}),un={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},ui={outline:"none",overflowX:"auto",position:"relative"},us=e=>({height:"100%",position:"absolute",top:0,width:"100%",...e?{display:"flex",flexDirection:"column"}:{}}),uo={position:l9(),top:0,width:"100%",zIndex:1};function ua(e,t){if("string"!=typeof e)return{context:t}}function ul(e,t){return{item:"string"==typeof e?void 0:t}}let uu=b.default.memo(function(){let e=uv("HeaderComponent"),t=ub("headerHeight"),r=uv("HeaderFooterTag"),n=aN(b.default.useMemo(()=>e=>{t(a4(e,"height"))},[t]),!0,uv("skipAnimationFrameInResizeObserver")),i=uv("context");return e?(0,v.jsx)(r,{ref:n,children:(0,v.jsx)(e,{...ua(e,i)})}):null}),uc=b.default.memo(function(){let e=uv("FooterComponent"),t=ub("footerHeight"),r=uv("HeaderFooterTag"),n=aN(b.default.useMemo(()=>e=>{t(a4(e,"height"))},[t]),!0,uv("skipAnimationFrameInResizeObserver")),i=uv("context");return e?(0,v.jsx)(r,{ref:n,children:(0,v.jsx)(e,{...ua(e,i)})}):null});function ud({useEmitter:e,useEmitterValue:t,usePublisher:r}){return b.default.memo(function({children:n,style:i,context:s,...o}){let a=r("scrollContainerState"),l=t("ScrollerComponent"),u=r("smoothScrollTargetReached"),c=t("scrollerRef"),d=t("horizontalDirection")||!1,{scrollByCallback:h,scrollerRef:p,scrollToCallback:f}=l1(a,u,l,c,void 0,d);return e("scrollTo",f),e("scrollBy",h),(0,v.jsx)(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...d?ui:un,...i},tabIndex:0,...o,...ua(l,s),children:n})})}function uh({useEmitter:e,useEmitterValue:t,usePublisher:r}){return b.default.memo(function({children:n,style:i,context:s,...o}){let a=r("windowScrollContainerState"),l=t("ScrollerComponent"),u=r("smoothScrollTargetReached"),c=t("totalListHeight"),d=t("deviation"),h=t("customScrollParent"),p=b.default.useRef(null),{scrollByCallback:f,scrollerRef:m,scrollToCallback:g}=l1(a,u,l,t("scrollerRef"),h);return lX(()=>{var e;return m.current=h||(null==(e=p.current)?void 0:e.ownerDocument.defaultView),()=>{m.current=null}},[m,h]),e("windowScrollTo",g),e("scrollBy",f),(0,v.jsx)(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...i,...0!==c?{height:c+d}:{}},...o,...ua(l,s),children:n})})}let up=({children:e})=>{let t=b.default.useContext(lK),r=ub("viewportHeight"),n=ub("fixedItemHeight"),i=uv("alignToBottom"),s=uv("horizontalDirection"),o=aN(b.default.useMemo(()=>at(r,e=>a4(e,s?"width":"height")),[r,s]),!0,uv("skipAnimationFrameInResizeObserver"));return b.default.useEffect(()=>{t&&(r(t.viewportHeight),n(t.itemHeight))},[t,r,n]),(0,v.jsx)("div",{"data-viewport-type":"element",ref:o,style:us(i),children:e})},uf=({children:e})=>{let t=b.default.useContext(lK),r=ub("windowViewportRect"),n=ub("fixedItemHeight"),i=aL(r,uv("customScrollParent"),uv("skipAnimationFrameInResizeObserver")),s=uv("alignToBottom");return b.default.useEffect(()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,n]),(0,v.jsx)("div",{"data-viewport-type":"window",ref:i,style:us(s),children:e})},um=({children:e})=>{let t=uv("TopItemListComponent")||"div",r=uv("headerHeight"),n={...uo,marginTop:`${r}px`},i=uv("context");return(0,v.jsx)(t,{style:n,...ua(t,i),children:e})},{Component:ug,useEmitter:uy,useEmitterValue:uv,usePublisher:ub}=lQ(l6,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},b.default.memo(function(e){let t=uv("useWindowScroll"),r=uv("topItemsIndexes").length>0,n=uv("customScrollParent"),i=uv("context");return(0,v.jsxs)(n||t?uw:ux,{...e,context:i,children:[r&&(0,v.jsx)(um,{children:(0,v.jsx)(ur,{showTopList:!0})}),(0,v.jsxs)(n||t?uf:up,{children:[(0,v.jsx)(uu,{}),(0,v.jsx)(ur,{}),(0,v.jsx)(uc,{})]})]})})),ux=ud({useEmitter:uy,useEmitterValue:uv,usePublisher:ub}),uw=uh({useEmitter:uy,useEmitterValue:uv,usePublisher:ub}),u_=aT(()=>{let e=aw(e=>(0,v.jsxs)("td",{children:["Item $",e]})),t=aw(null),r=aw(e=>(0,v.jsxs)("td",{colSpan:1e3,children:["Group ",e]})),n=aw(null),i=aw(null),s=aw({}),o=aw(l3),a=aw(an),l=(e,t=null)=>a_(ag(s,af(t=>t[e]),ah()),t);return{components:s,computeItemKey:o,context:t,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:i,fixedHeaderContent:n,itemContent:e,groupContent:r,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}}),uS=aT(([e,t])=>({...e,...t}),as(lG,u_)),uC=({height:e})=>(0,v.jsx)("tr",{children:(0,v.jsx)("td",{style:{height:e}})}),uT=({height:e})=>(0,v.jsx)("tr",{children:(0,v.jsx)("td",{style:{border:0,height:e,padding:0}})}),uE={overflowAnchor:"none"},uk={position:l9(),zIndex:2,overflowAnchor:"none"},uR=b.default.memo(function({showTopList:e=!1}){let t=uN("listState"),r=uN("computeItemKey"),n=uN("firstItemIndex"),i=uN("context"),s=uN("isSeeking"),o=uN("fixedHeaderHeight"),a=uN("groupIndices").length>0,l=uN("itemContent"),u=uN("groupContent"),c=uN("ScrollSeekPlaceholder")||uC,d=uN("GroupComponent"),h=uN("TableRowComponent"),p=(e?t.topItems:[]).reduce((e,t,r)=>(0===r?e.push(t.size):e.push(e[r-1]+t.size),e),[]),f=(e?t.topItems:t.items).map(t=>{let f=t.originalIndex,m=r(f+n,t.data,i),g=e?0===f?0:p[f-1]:0;return s?(0,b.createElement)(c,{...ua(c,i),height:t.size,index:t.index,key:m,type:t.type||"item"}):"group"===t.type?(0,b.createElement)(d,{...ua(d,i),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,key:m,style:{...uk,top:o}},u(t.index,i)):(0,b.createElement)(h,{...ua(h,i),...ul(h,t.data),"data-index":f,"data-item-index":t.index,"data-known-size":t.size,"data-item-group-index":t.groupIndex,key:m,style:e?{...uk,top:o+g}:uE},a?l(t.index,t.groupIndex,t.data,i):l(t.index,t.data,i))});return(0,v.jsx)(v.Fragment,{children:f})}),uz=b.default.memo(function(){let e=uN("listState"),t=uN("topItemsIndexes").length>0,r=uA("sizeRanges"),n=uN("useWindowScroll"),i=uN("customScrollParent"),s=uA("windowScrollContainerState"),o=uA("scrollContainerState"),a=uN("trackItemSizes"),{callbackRef:l,ref:u}=a$(r,uN("itemSize"),a,i||n?s:o,uN("log"),void 0,i,!1,uN("skipAnimationFrameInResizeObserver")),[c,d]=b.default.useState(0);uO("deviation",e=>{c!==e&&(u.current.style.marginTop=`${e}px`,d(e))});let h=uN("EmptyPlaceholder"),p=uN("FillerRow")||uT,f=uN("TableBodyComponent"),m=uN("paddingTopAddition"),g=uN("statefulTotalCount"),y=uN("context");if(0===g&&h)return(0,v.jsx)(h,{...ua(h,y)});let x=(t?e.topItems:[]).reduce((e,t)=>e+t.size,0),w=e.offsetTop+m+c-x,_=e.offsetBottom,S=w>0?(0,v.jsx)(p,{context:y,height:w},"padding-top"):null,C=_>0?(0,v.jsx)(p,{context:y,height:_},"padding-bottom"):null;return(0,v.jsxs)(f,{"data-testid":"virtuoso-item-list",ref:l,...ua(f,y),children:[S,t&&(0,v.jsx)(uR,{showTopList:!0}),(0,v.jsx)(uR,{}),C]})}),uI=({children:e})=>{let t=b.default.useContext(lK),r=uA("viewportHeight"),n=uA("fixedItemHeight"),i=aN(b.default.useMemo(()=>at(r,e=>a4(e,"height")),[r]),!0,uN("skipAnimationFrameInResizeObserver"));return b.default.useEffect(()=>{t&&(r(t.viewportHeight),n(t.itemHeight))},[t,r,n]),(0,v.jsx)("div",{"data-viewport-type":"element",ref:i,style:us(!1),children:e})},uj=({children:e})=>{let t=b.default.useContext(lK),r=uA("windowViewportRect"),n=uA("fixedItemHeight"),i=aL(r,uN("customScrollParent"),uN("skipAnimationFrameInResizeObserver"));return b.default.useEffect(()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,r,n]),(0,v.jsx)("div",{"data-viewport-type":"window",ref:i,style:us(!1),children:e})},{useEmitter:uO,useEmitterValue:uN,usePublisher:uA}=lQ(uS,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},b.default.memo(function(e){let t=uN("useWindowScroll"),r=uN("customScrollParent"),n=uA("fixedHeaderHeight"),i=uA("fixedFooterHeight"),s=uN("fixedHeaderContent"),o=uN("fixedFooterContent"),a=uN("context"),l=aN(b.default.useMemo(()=>at(n,e=>a4(e,"height")),[n]),!0,uN("skipAnimationFrameInResizeObserver")),u=aN(b.default.useMemo(()=>at(i,e=>a4(e,"height")),[i]),!0,uN("skipAnimationFrameInResizeObserver")),c=r||t?uP:u$,d=r||t?uj:uI,h=uN("TableComponent"),p=uN("TableHeadComponent"),f=uN("TableFooterComponent"),m=s?(0,v.jsx)(p,{ref:l,style:{position:"sticky",top:0,zIndex:2},...ua(p,a),children:s()},"TableHead"):null,g=o?(0,v.jsx)(f,{ref:u,style:{bottom:0,position:"sticky",zIndex:1},...ua(f,a),children:o()},"TableFoot"):null;return(0,v.jsx)(c,{...e,...ua(c,a),children:(0,v.jsx)(d,{children:(0,v.jsxs)(h,{style:{borderSpacing:0,overflowAnchor:"none"},...ua(h,a),children:[m,(0,v.jsx)(uz,{},"TableBody"),g]})})})})),u$=ud({useEmitter:uO,useEmitterValue:uN,usePublisher:uA}),uP=uh({useEmitter:uO,useEmitterValue:uN,usePublisher:uA}),uL={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},uM={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:uB,floor:uD,max:uH,min:uZ,round:uU}=Math;function uF(e,t,r){return Array.from({length:t-e+1}).map((t,n)=>({data:null===r?null:r[n+e],index:n+e}))}function uV(e,t){return e&&e.width===t.width&&e.height===t.height}function uW(e,t){return e&&e.column===t.column&&e.row===t.row}let uq=aT(([{increaseViewportBy:e,listBoundary:t,overscan:r,visibleRange:n},{footerHeight:i,headerHeight:s,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:c,viewportHeight:d},h,p,{didMount:f,propsReady:m},{customScrollParent:g,useWindowScroll:y,windowScrollContainerState:v,windowScrollTo:b,windowViewportRect:x},w])=>{let _=aw(0),S=aw(0),C=aw(uL),T=aw({height:0,width:0}),E=aw({height:0,width:0}),k=aS(),R=aS(),z=aw(0),I=aw(null),j=aw({column:0,row:0}),O=aS(),N=aS(),A=aw(!1),$=aw(0),P=aw(!0),L=aw(!1),M=aw(!1);ag(f,ax($),ap(([e,t])=>!!t))(1,()=>{P(0,!1)}),ag(ak(f,P,E,T,$,L),ap(([e,t,r,n,,i])=>e&&!t&&0!==r.height&&0!==n.height&&!i))(1,([,,,,e])=>{L(0,!0),lh(1,()=>{k(0,e)}),au(ag(u),()=>{t(0,[0,0]),P(0,!0)})}),al(ag(N,ap(e=>null!=e&&e.scrollTop>0),am(0)),S),ag(f,ax(N),ap(([,e])=>null!=e))(1,([,e])=>{e&&(T(0,e.viewport),E(0,e.item),j(0,e.gap),e.scrollTop>0&&(A(0,!0),au(ag(u,av(1)),e=>{A(0,!1)}),l(0,{top:e.scrollTop})))}),al(ag(T,af(({height:e})=>e)),d),al(ag(ak(aR(T,uV),aR(E,uV),aR(j,(e,t)=>e&&e.column===t.column&&e.row===t.row),aR(u)),af(([e,t,r,n])=>({gap:r,item:t,scrollTop:n,viewport:e}))),O),al(ag(ak(aR(_),n,aR(j,uW),aR(E,uV),aR(T,uV),aR(I),aR(S),aR(A),aR(P),aR($)),ap(([,,,,,,,e])=>!e),af(([e,[t,r],n,i,s,o,a,,l,u])=>{let c,d,{column:h,row:p}=n,{height:f,width:m}=i,{width:g}=s;if(0===a&&(0===e||0===g))return uL;if(0===m){var y;let t=lp(u,e),r=t+Math.max(a-1,0);return y=uF(t,r,o),{...uM,items:y}}let v=uG(g,m,h);l?0===t&&0===r&&a>0?(c=0,d=a-1):(c=v*uD((t+p)/(f+p)),d=uZ(e-1,uH(d=v*uB((r+p)/(f+p))-1,v-1)),c=uZ(d,uH(0,c))):(c=0,d=-1);let b=uF(c,d,o),{bottom:x,top:w}=uJ(s,n,i,b),_=uB(e/v);return{bottom:x,itemHeight:f,items:b,itemWidth:m,offsetBottom:_*f+(_-1)*p-x,offsetTop:w,top:w}})),C),al(ag(I,ap(e=>null!==e),af(e=>e.length)),_),al(ag(ak(T,E,C,j),ap(([e,t,{items:r}])=>r.length>0&&0!==t.height&&0!==e.height),af(([e,t,{items:r},n])=>{let{bottom:i,top:s}=uJ(e,n,t,r);return[s,i]}),ah(a0)),t);let B=aw(!1);al(ag(u,ax(B),af(([e,t])=>t||0!==e)),B);let D=aC(ag(ak(C,_),ap(([{items:e}])=>e.length>0),ax(B),ap(([[e,t],r])=>{let n=e.items[e.items.length-1].index===t-1;return(r||e.bottom>0&&e.itemHeight>0&&0===e.offsetBottom&&e.items.length===t)&&n}),af(([[,e]])=>e-1),ah())),H=aC(ag(aR(C),ap(({items:e})=>e.length>0&&0===e[0].index),am(0),ah())),Z=aC(ag(aR(C),ax(A),ap(([{items:e},t])=>e.length>0&&!t),af(([{items:e}])=>({endIndex:e[e.length-1].index,startIndex:e[0].index})),ah(aX),ab(0)));al(Z,p.scrollSeekRangeChanged),al(ag(k,ax(T,E,_,j),af(([e,t,r,n,i])=>{let s=lc(e),{align:o,behavior:a,offset:l}=s,u=s.index;"LAST"===u&&(u=n-1);let c=uQ(t,i,r,u=uH(0,u,uZ(n-1,u)));return"end"===o?c=uU(c-t.height+r.height):"center"===o&&(c=uU(c-t.height/2+r.height/2)),l&&(c+=l),{behavior:a,top:c}})),l);let U=a_(ag(C,af(e=>e.offsetBottom+e.bottom)),0);return al(ag(x,af(e=>({height:e.visibleHeight,width:e.visibleWidth}))),T),{customScrollParent:g,data:I,deviation:z,footerHeight:i,gap:j,headerHeight:s,increaseViewportBy:e,initialItemCount:S,itemDimensions:E,overscan:r,restoreStateFrom:N,scrollBy:o,scrollContainerState:a,scrollHeight:R,scrollTo:l,scrollToIndex:k,scrollTop:u,smoothScrollTargetReached:c,totalCount:_,useWindowScroll:y,viewportDimensions:T,windowScrollContainerState:v,windowScrollTo:b,windowViewportRect:x,...p,gridState:C,horizontalDirection:M,initialTopMostItemIndex:$,totalListHeight:U,...h,endReached:D,propsReady:m,rangeChanged:Z,startReached:H,stateChanged:O,stateRestoreInProgress:A,...w}},as(lS,aM,lv,lB,ll,lD,aO));function uG(e,t,r){return uH(1,uD((e+r)/(uD(t)+r)))}function uJ(e,t,r,n){let{height:i}=r;if(void 0===i||0===n.length)return{bottom:0,top:0};let s=uQ(e,t,r,n[0].index);return{bottom:uQ(e,t,r,n[n.length-1].index)+i,top:s}}function uQ(e,t,r,n){let i=uD(n/uG(e.width,r.width,t.column)),s=i*r.height+uH(0,i-1)*t.row;return s>0?s+t.row:s}let uK=aT(()=>{let e=aw(e=>`Item ${e}`),t=aw({}),r=aw(null),n=aw("virtuoso-grid-item"),i=aw("virtuoso-grid-list"),s=aw(l3),o=aw("div"),a=aw(an),l=(e,r=null)=>a_(ag(t,af(t=>t[e]),ah()),r),u=aw(!1),c=aw(!1);return al(aR(c),u),{components:t,computeItemKey:s,context:r,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:n,ItemComponent:l("Item","div"),itemContent:e,listClassName:i,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:c,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),uY=aT(([e,t])=>({...e,...t}),as(uq,uK)),uX=b.default.memo(function(){let e=u3("gridState"),t=u3("listClassName"),r=u3("itemClassName"),n=u3("itemContent"),i=u3("computeItemKey"),s=u3("isSeeking"),o=u5("scrollHeight"),a=u3("ItemComponent"),l=u3("ListComponent"),u=u3("ScrollSeekPlaceholder"),c=u3("context"),d=u5("itemDimensions"),h=u5("gap"),p=u3("log"),f=u3("stateRestoreInProgress"),m=u5("reportReadyState"),g=aN(b.default.useMemo(()=>e=>{o(e.parentElement.parentElement.scrollHeight);let t=e.firstChild;if(t){let{height:e,width:r}=t.getBoundingClientRect();d({height:e,width:r})}h({column:u8("column-gap",getComputedStyle(e).columnGap,p),row:u8("row-gap",getComputedStyle(e).rowGap,p)})},[o,d,h,p]),!0,!1);return lX(()=>{e.itemHeight>0&&e.itemWidth>0&&m(!0)},[e]),f?null:(0,v.jsx)(l,{className:t,ref:g,...ua(l,c),"data-testid":"virtuoso-item-list",style:{paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},children:e.items.map(t=>{let o=i(t.index,t.data,c);return s?(0,v.jsx)(u,{...ua(u,c),height:e.itemHeight,index:t.index,width:e.itemWidth},o):(0,b.createElement)(a,{...ua(a,c),className:r,"data-index":t.index,key:o},n(t.index,t.data,c))})})}),u0=b.default.memo(function(){let e=u3("HeaderComponent"),t=u5("headerHeight"),r=u3("headerFooterTag"),n=aN(b.default.useMemo(()=>e=>{t(a4(e,"height"))},[t]),!0,!1),i=u3("context");return e?(0,v.jsx)(r,{ref:n,children:(0,v.jsx)(e,{...ua(e,i)})}):null}),u1=b.default.memo(function(){let e=u3("FooterComponent"),t=u5("footerHeight"),r=u3("headerFooterTag"),n=aN(b.default.useMemo(()=>e=>{t(a4(e,"height"))},[t]),!0,!1),i=u3("context");return e?(0,v.jsx)(r,{ref:n,children:(0,v.jsx)(e,{...ua(e,i)})}):null}),u2=({children:e})=>{let t=b.default.useContext(lY),r=u5("itemDimensions"),n=u5("viewportDimensions"),i=aN(b.default.useMemo(()=>e=>{n(e.getBoundingClientRect())},[n]),!0,!1);return b.default.useEffect(()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),r({height:t.itemHeight,width:t.itemWidth}))},[t,n,r]),(0,v.jsx)("div",{ref:i,style:us(!1),children:e})},u4=({children:e})=>{let t=b.default.useContext(lY),r=u5("windowViewportRect"),n=u5("itemDimensions"),i=aL(r,u3("customScrollParent"),!1);return b.default.useEffect(()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,r,n]),(0,v.jsx)("div",{ref:i,style:us(!1),children:e})},{useEmitter:u9,useEmitterValue:u3,usePublisher:u5}=lQ(uY,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},b.default.memo(function({...e}){let t=u3("useWindowScroll"),r=u3("customScrollParent"),n=r||t?u7:u6,i=r||t?u4:u2,s=u3("context");return(0,v.jsx)(n,{...e,...ua(n,s),children:(0,v.jsxs)(i,{children:[(0,v.jsx)(u0,{}),(0,v.jsx)(uX,{}),(0,v.jsx)(u1,{})]})})})),u6=ud({useEmitter:u9,useEmitterValue:u3,usePublisher:u5}),u7=uh({useEmitter:u9,useEmitterValue:u3,usePublisher:u5});function u8(e,t,r){return"normal"===t||null!=t&&t.endsWith("px")||r(`${e} was not resolved to pixel value correctly`,t,aI.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}let ce=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),ct=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var cr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let cn=(0,b.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>(0,b.createElement)("svg",{ref:l,...cr,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:ce("lucide",i),...!s&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(a)&&{"aria-hidden":"true"},...a},[...o.map(([e,t])=>(0,b.createElement)(e,t)),...Array.isArray(s)?s:[s]])),ci=(e,t)=>{let r=(0,b.forwardRef)(({className:r,...n},i)=>(0,b.createElement)(cn,{ref:i,iconNode:t,className:ce(`lucide-${ct(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n}));return r.displayName=ct(e),r},cs=ci("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),co=(0,b.memo)(({gender:e,className:t})=>"male"===e?(0,v.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,v.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,v.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):"female"===e?(0,v.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,v.jsx)("path",{d:"M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"}),(0,v.jsx)("path",{d:"M18 22H6c0-4 4-3 6-3s6-1 6 3Z"})]}):(0,v.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,v.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,v.jsx)("circle",{cx:"12",cy:"10",r:"3"}),(0,v.jsx)("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]})),ca=(0,b.memo)(({onSendMessage:e,showBottomNavPadding:t,onFocusChange:r,isFocused:n,isReadOnly:i})=>{let[s,o]=(0,b.useState)(""),a=(0,b.useRef)(null);return i?(0,v.jsx)("footer",{className:`px-3 py-4 md:p-4 bg-[#e5ddd5] shrink-0 text-center text-gray-500 text-sm italic ${t?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+8px)]":"pb-safe"}`,children:"Solo gli amministratori possono scrivere qui."}):(0,v.jsx)("footer",{className:`px-3 py-2 md:p-4 bg-[#e5ddd5] shrink-0 ${n?"pb-3 pt-2":t?"pb-[calc(70px+env(safe-area-inset-bottom,0px)+8px)] md:pb-[90px] pt-3":"pb-[calc(env(safe-area-inset-bottom,0px)+12px)] pt-2"}`,children:(0,v.jsxs)("form",{onSubmit:t=>{t.preventDefault(),s.trim()&&(e(s.trim()),o(""),a.current?.blur())},className:"flex items-center gap-2 md:gap-3 max-w-5xl mx-auto",children:[(0,v.jsx)("input",{ref:a,type:"text",value:s,onChange:e=>o(e.target.value),onFocus:()=>r?.(!0),onBlur:()=>r?.(!1),placeholder:"Messaggio alla stanza...",className:"flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 text-sm md:text-base placeholder-gray-400",style:{fontSize:"16px"}}),(0,v.jsx)("button",{type:"submit",className:"p-2 flex items-center justify-center text-emerald-600 hover:text-emerald-700 active:scale-95 transition-transform",onMouseDown:e=>e.preventDefault(),children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:(0,v.jsx)("path",{d:"M19.4999 2.00098C20.0944 2.00063 20.6989 2.15072 21.2499 2.46875C22.924 3.43525 23.4977 5.57598 22.5312 7.25001L15.0311 20.2403C14.0646 21.9142 11.9238 22.488 10.2498 21.5215C9.41372 21.0387 8.85157 20.2605 8.61994 19.3975L7.1209 13.8028L15.8905 8.73927C16.3687 8.46311 16.5327 7.85126 16.2567 7.37306C15.9805 6.89505 15.3686 6.73096 14.8905 7.00685L6.12089 12.0713L2.02515 7.97462C0.658428 6.60771 0.658787 4.39204 2.02515 3.02539C2.65731 2.39319 3.53383 2.00021 4.49978 2L19.4999 2.00098Z"})})})]})})}),cl=(0,b.memo)(({user:e,messages:t,onSendMessage:r,onRemoveMessage:n,onlineCount:i,isOnline:s,hideHeader:o,headerTitle:a,showBottomNavPadding:l,onInputFocusChange:u,isFocused:c,isSyncing:d,isReadOnly:h,canModerate:p,onBack:f})=>{let m=(0,b.useRef)(null);(0,b.useEffect)(()=>{if(c&&t.length>0){let e=()=>{m.current?.scrollToIndex({index:t.length-1,align:"end",behavior:"auto"})};requestAnimationFrame(e);let r=setTimeout(e,100);return()=>clearTimeout(r)}},[c,t.length]);let g=(0,b.useCallback)((r,i)=>{let s=i.senderId===e.id,o=0===r||t[r-1].senderId!==i.senderId;return(0,v.jsx)("div",{className:`flex ${s?"justify-end":"justify-start"} animate-message pb-4 px-4 group/msg`,children:(0,v.jsxs)("div",{className:`flex flex-col max-w-[85%] ${s?"items-end":"items-start"}`,children:[o&&(0,v.jsxs)("span",{className:`text-[10px] font-bold mb-1 px-2 uppercase tracking-tight flex items-center gap-1.5 ${s?"text-emerald-700":"text-gray-600"}`,children:[!s&&(0,v.jsx)("div",{className:`w-3.5 h-3.5 rounded-full flex items-center justify-center ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(i.senderGender)}`,children:(0,v.jsx)(co,{gender:i.senderGender,className:"w-2 h-2 text-white"})}),s?"Tu":i.senderAlias]}),(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("div",{className:`px-3 py-2 rounded-2xl shadow-sm ${s?"bg-emerald-500 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:(0,v.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed text-[15px]",children:i.text})}),p&&(0,v.jsx)("button",{onClick:()=>n?.(i.id),className:`absolute top-0 ${s?"-left-8":"-right-8"} p-1 text-gray-400 hover:text-red-500 opacity-0 group-hover/msg:opacity-100 transition-opacity`,title:"Elimina messaggio",children:(0,v.jsx)(cs,{size:16})})]}),(0,v.jsx)("span",{className:"text-[9px] text-gray-400 px-1 mt-0.5 opacity-70",children:new Date(i.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},[e.id,t,p,n]);return(0,v.jsxs)("div",{className:"w-full h-full flex flex-col bg-white",children:[!o&&(0,v.jsx)("header",{className:"bg-white pt-safe sticky top-0 z-10 shrink-0",children:(0,v.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[f&&(0,v.jsx)("button",{onClick:f,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,v.jsx)("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center border border-emerald-100",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h2",{className:"font-extrabold text-2xl text-gray-900 leading-tight tracking-tight",children:a||"Stanza"}),(0,v.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,v.jsx)("span",{className:`w-2 h-2 rounded-full ${s?"bg-emerald-500":"bg-red-500"}`}),(0,v.jsx)("p",{className:"text-[11px] font-bold text-emerald-600 uppercase tracking-wide",children:s?`${i} persone qui`:"Disconnesso"})]})]})]}),d&&(0,v.jsxs)("div",{className:"flex items-center gap-1.5 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100 animate-pulse",children:[(0,v.jsxs)("svg",{className:"animate-spin h-3 w-3 text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,v.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,v.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,v.jsx)("span",{className:"text-[10px] font-bold text-emerald-700 tracking-wide uppercase",children:"Sincronizzazione"})]})]})}),(0,v.jsx)("div",{className:"flex-1 overflow-hidden relative chat-bg",children:(0,v.jsx)(ug,{ref:m,data:t,initialTopMostItemIndex:t.length-1,itemContent:g,followOutput:!0,className:"h-full w-full",alignToBottom:!0})}),(0,v.jsx)(ca,{onSendMessage:r,showBottomNavPadding:l,isFocused:c,onFocusChange:u,isReadOnly:h})]})});var cu=e.i(43191);function cc(e,t){let{data:r}=o5(),n=t||r?.user?.id,[i,s]=(0,b.useState)(null),[o,a]=(0,b.useState)(!1),[l,u]=(0,b.useState)(!1),[c,d]=(0,b.useState)(!0);(0,b.useEffect)(()=>{if(console.log("[useMembership] Hook triggered for tenant:",e,"Effective User ID:",n),!n||!e){s(null),a(!1),u(!1),d(!1);return}!async function(){try{let t=await (0,cu.getConnectedWifiInfo)(),r=new URL("/api/auth/membership",window.location.origin);r.searchParams.append("tenantId",e),t.bssid&&r.searchParams.append("bssid",t.bssid);let n=await fetch(r.toString(),{cache:"no-store"}),i=await n.json();console.log("[useMembership] Result for tenant",e,i),(i.error||i.reason)&&console.warn("[useMembership] Authorization Warning:",i.error||i.reason,i.debug),i.isMember?(s(i.membership),a(i.isAuthorized),u(i.isSuperadmin||!1)):(s(null),a(!1),u(!1))}catch(e){console.error("Failed to check membership:",e)}finally{d(!1)}}()},[n,e]);let h=l||o&&i?.role?.toUpperCase()==="ADMIN",p=o&&(i?.role?.toUpperCase()==="MODERATOR"||!!i?.canModerate);return{membership:i,isAuthorized:o,isSuperadmin:l,isAdmin:h,isModerator:p,canManageTenant:h||p,isLoading:c}}let cd=({activeTab:e,onTabChange:t,usersCount:r,unreadChatsCount:n,tenantId:i})=>{let{isAdmin:s}=cc(i);return(0,v.jsxs)("nav",{className:"bg-white fixed bottom-0 left-0 right-0 z-50 h-[calc(70px+env(safe-area-inset-bottom,0px))] md:h-[80px] flex justify-around items-start pt-3 pb-[calc(env(safe-area-inset-bottom,0px)+8px)]",children:[(0,v.jsxs)("button",{onClick:()=>t("room"),className:`flex flex-col items-center justify-center w-full relative ${"room"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,v.jsx)("div",{className:"relative",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",viewBox:"0 0 24 24",fill:"currentColor",children:(0,v.jsx)("path",{d:"room"===e?"M5.23379 7.72989C6.65303 5.48625 9.15342 4 12.0002 4C14.847 4 17.3474 5.48625 18.7667 7.72989L20.4569 6.66071C18.6865 3.86199 15.5612 2 12.0002 2C8.43928 2 5.31393 3.86199 3.54356 6.66071L5.23379 7.72989ZM12.0002 20C9.15342 20 6.65303 18.5138 5.23379 16.2701L3.54356 17.3393C5.31393 20.138 8.43928 22 12.0002 22C15.5612 22 18.6865 20.138 20.4569 17.3393L18.7667 16.2701C17.3474 18.5138 14.847 20 12.0002 20ZM12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12ZM12 13C14.2091 13 16 14.7909 16 17H8C8 14.7909 9.79086 13 12 13ZM6 12C6 13.6569 4.65685 15 3 15C1.34315 15 0 13.6569 0 12C0 10.3431 1.34315 9 3 9C4.65685 9 6 10.3431 6 12ZM21 15C22.6569 15 24 13.6569 24 12C24 10.3431 22.6569 9 21 9C19.3431 9 18 10.3431 18 12C18 13.6569 19.3431 15 21 15Z":"M5.23379 7.72989C6.65303 5.48625 9.15342 4 12.0002 4C14.847 4 17.3474 5.48625 18.7667 7.72989L20.4569 6.66071C18.6865 3.86199 15.5612 2 12.0002 2C8.43928 2 5.31393 3.86199 3.54356 6.66071L5.23379 7.72989ZM12.0002 20C9.15342 20 6.65303 18.5138 5.23379 16.2701L3.54356 17.3393C5.31393 20.138 8.43928 22 12.0002 22C15.5612 22 18.6865 20.138 20.4569 17.3393L18.7667 16.2701C17.3474 18.5138 14.847 20 12.0002 20ZM12 8C12.5523 8 13 8.44772 13 9C13 9.55228 12.5523 10 12 10C11.4477 10 11 9.55228 11 9C11 8.44772 11.4477 8 12 8ZM12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12ZM12 15C10.8954 15 10 15.8954 10 17H8C8 14.7909 9.79086 13 12 13C14.2091 13 16 14.7909 16 17H14C14 15.8954 13.1046 15 12 15ZM3 11C2.44772 11 2 11.4477 2 12C2 12.5523 2.44772 13 3 13C3.55228 13 4 12.5523 4 12C4 11.4477 3.55228 11 3 11ZM0 12C0 10.3431 1.34315 9 3 9C4.65685 9 6 10.3431 6 12C6 13.6569 4.65685 15 3 15C1.34315 15 0 13.6569 0 12ZM20 12C20 11.4477 20.4477 11 21 11C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13C20.4477 13 20 12.5523 20 12ZM21 9C19.3431 9 18 10.3431 18 12C18 13.6569 19.3431 15 21 15C22.6569 15 24 13.6569 24 12C24 10.3431 22.6569 9 21 9Z"})})}),(0,v.jsx)("span",{className:`text-[10px] mt-1 ${"room"===e?"font-bold":"font-semibold"}`,children:"Stanze"})]}),(0,v.jsxs)("button",{onClick:()=>t("users"),className:`flex flex-col items-center justify-center w-full relative ${"users"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",viewBox:"0 0 24 24",fill:"currentColor",children:(0,v.jsx)("path",{d:"users"===e?"M2 22C2 17.5817 5.58172 14 10 14C14.4183 14 18 17.5817 18 22H2ZM10 13C6.685 13 4 10.315 4 7C4 3.685 6.685 1 10 1C13.315 1 16 3.685 16 7C16 10.315 13.315 13 10 13ZM17.3628 15.2332C20.4482 16.0217 22.7679 18.7235 22.9836 22H20C20 19.3902 19.0002 17.0139 17.3628 15.2332ZM15.3401 12.9569C16.9728 11.4922 18 9.36607 18 7C18 5.58266 17.6314 4.25141 16.9849 3.09687C19.2753 3.55397 21 5.57465 21 8C21 10.7625 18.7625 13 16 13C15.7763 13 15.556 12.9853 15.3401 12.9569Z":"M2 22C2 17.5817 5.58172 14 10 14C14.4183 14 18 17.5817 18 22H16C16 18.6863 13.3137 16 10 16C6.68629 16 4 18.6863 4 22H2ZM10 13C6.685 13 4 10.315 4 7C4 3.685 6.685 1 10 1C13.315 1 16 3.685 16 7C16 10.315 13.315 13 10 13ZM10 11C12.21 11 14 9.21 14 7C14 4.79 12.21 3 10 3C7.79 3 6 4.79 6 7C6 9.21 7.79 11 10 11ZM18.2837 14.7028C21.0644 15.9561 23 18.752 23 22H21C21 19.564 19.5483 17.4671 17.4628 16.5271L18.2837 14.7028ZM17.5962 3.41321C19.5944 4.23703 21 6.20361 21 8.5C21 11.3702 18.8042 13.7252 16 13.9776V11.9646C17.6967 11.7222 19 10.264 19 8.5C19 7.11935 18.2016 5.92603 17.041 5.35635L17.5962 3.41321Z"})}),(0,v.jsx)("span",{className:`text-[10px] mt-1 ${"users"===e?"font-bold":"font-semibold"}`,children:"Utenti"})]}),(0,v.jsxs)("button",{onClick:()=>t("chats"),className:`flex flex-col items-center justify-center w-full relative ${"chats"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",viewBox:"0 0 24 24",fill:"currentColor",children:(0,v.jsx)("path",{d:"chats"===e?"M2 8.99374C2 5.68349 4.67654 3 8.00066 3H15.9993C19.3134 3 22 5.69478 22 8.99374V21H8.00066C4.68659 21 2 18.3052 2 15.0063V8.99374ZM14 11V13H16V11H14ZM8 11V13H10V11H8Z":"M2 8.99374C2 5.68349 4.67654 3 8.00066 3H15.9993C19.3134 3 22 5.69478 22 8.99374V21H8.00066C4.68659 21 2 18.3052 2 15.0063V8.99374ZM20 19V8.99374C20 6.79539 18.2049 5 15.9993 5H8.00066C5.78458 5 4 6.78458 4 8.99374V15.0063C4 17.2046 5.79512 19 8.00066 19H20ZM14 11H16V13H14V11ZM8 11H10V13H8V11Z"})}),n>0&&(0,v.jsx)("span",{className:"absolute -top-0.5 -right-1.5 bg-red-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full min-w-[16px] flex items-center justify-center border-2 border-white",children:n})]}),(0,v.jsx)("span",{className:`text-[10px] mt-1 ${"chats"===e?"font-bold":"font-semibold"}`,children:"Chats"})]}),(0,v.jsxs)("button",{onClick:()=>t("settings"),className:`flex flex-col items-center justify-center w-full relative ${"settings"===e?"text-emerald-700":"text-gray-500"}`,children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-7 md:w-7",viewBox:"0 0 24 24",fill:"currentColor",children:(0,v.jsx)("path",{d:"settings"===e?"M9.95401 2.2106C11.2876 1.93144 12.6807 1.92263 14.0449 2.20785C14.2219 3.3674 14.9048 4.43892 15.9997 5.07103C17.0945 5.70313 18.364 5.75884 19.4566 5.3323C20.3858 6.37118 21.0747 7.58203 21.4997 8.87652C20.5852 9.60958 19.9997 10.736 19.9997 11.9992C19.9997 13.2632 20.5859 14.3902 21.5013 15.1232C21.29 15.7636 21.0104 16.3922 20.6599 16.9992C20.3094 17.6063 19.9049 18.1627 19.4559 18.6659C18.3634 18.2396 17.0943 18.2955 15.9997 18.9274C14.9057 19.559 14.223 20.6294 14.0453 21.7879C12.7118 22.067 11.3187 22.0758 9.95443 21.7906C9.77748 20.6311 9.09451 19.5595 7.99967 18.9274C6.90484 18.2953 5.63539 18.2396 4.54272 18.6662C3.61357 17.6273 2.92466 16.4164 2.49964 15.1219C3.41412 14.3889 3.99968 13.2624 3.99968 11.9992C3.99968 10.7353 3.41344 9.60827 2.49805 8.87524C2.70933 8.23482 2.98894 7.60629 3.33942 6.99923C3.68991 6.39217 4.09443 5.83576 4.54341 5.33257C5.63593 5.75881 6.90507 5.703 7.99967 5.07103C9.09364 4.43942 9.7764 3.3691 9.95401 2.2106ZM11.9997 14.9992C13.6565 14.9992 14.9997 13.6561 14.9997 11.9992C14.9997 10.3424 13.6565 8.99923 11.9997 8.99923C10.3428 8.99923 8.99967 10.3424 8.99967 11.9992C8.99967 13.6561 10.3428 14.9992 11.9997 14.9992Z":"M3.33946 17.0002C2.90721 16.2515 2.58277 15.4702 2.36133 14.6741C3.3338 14.1779 3.99972 13.1668 3.99972 12.0002C3.99972 10.8345 3.3348 9.824 2.36353 9.32741C2.81025 7.71651 3.65857 6.21627 4.86474 4.99001C5.7807 5.58416 6.98935 5.65534 7.99972 5.072C9.01009 4.48866 9.55277 3.40635 9.4962 2.31604C11.1613 1.8846 12.8847 1.90004 14.5031 2.31862C14.4475 3.40806 14.9901 4.48912 15.9997 5.072C17.0101 5.65532 18.2187 5.58416 19.1346 4.99007C19.7133 5.57986 20.2277 6.25151 20.66 7.00021C21.0922 7.7489 21.4167 8.53025 21.6381 9.32628C20.6656 9.82247 19.9997 10.8336 19.9997 12.0002C19.9997 13.166 20.6646 14.1764 21.6359 14.673C21.1892 16.2839 20.3409 17.7841 19.1347 19.0104C18.2187 18.4163 17.0101 18.3451 15.9997 18.9284C14.9893 19.5117 14.4467 20.5941 14.5032 21.6844C12.8382 22.1158 11.1148 22.1004 9.49633 21.6818C9.55191 20.5923 9.00929 19.5113 7.99972 18.9284C6.98938 18.3451 5.78079 18.4162 4.86484 19.0103C4.28617 18.4205 3.77172 17.7489 3.33946 17.0002ZM8.99972 17.1964C10.0911 17.8265 10.8749 18.8227 11.2503 19.9659C11.7486 20.0133 12.2502 20.014 12.7486 19.9675C13.1238 18.8237 13.9078 17.8268 14.9997 17.1964C16.0916 16.5659 17.347 16.3855 18.5252 16.6324C18.8146 16.224 19.0648 15.7892 19.2729 15.334C18.4706 14.4373 17.9997 13.2604 17.9997 12.0002C17.9997 10.74 18.4706 9.5632 19.2729 8.6665C19.1688 8.4405 19.0538 8.21822 18.9279 8.00021C18.802 7.78219 18.667 7.57148 18.5233 7.36842C17.3457 7.61476 16.0911 7.43414 14.9997 6.80405C13.9083 6.17395 13.1246 5.17768 12.7491 4.03455C12.2509 3.98714 11.7492 3.98646 11.2509 4.03292C10.8756 5.17671 10.0916 6.17364 8.99972 6.80405C7.9078 7.43447 6.65245 7.61494 5.47428 7.36803C5.18485 7.77641 4.93463 8.21117 4.72656 8.66637C5.52881 9.56311 5.99972 10.74 5.99972 12.0002C5.99972 13.2604 5.52883 14.4372 4.72656 15.3339C4.83067 15.5599 4.94564 15.7822 5.07152 16.0002C5.19739 16.2182 5.3324 16.4289 5.47612 16.632C6.65377 16.3857 7.90838 16.5663 8.99972 17.1964ZM11.9997 15.0002C10.3429 15.0002 8.99972 13.6571 8.99972 12.0002C8.99972 10.3434 10.3429 9.00021 11.9997 9.00021C13.6566 9.00021 14.9997 10.3434 14.9997 12.0002C14.9997 13.6571 13.6566 15.0002 11.9997 15.0002ZM11.9997 13.0002C12.552 13.0002 12.9997 12.5525 12.9997 12.0002C12.9997 11.4479 12.552 11.0002 11.9997 11.0002C11.4474 11.0002 10.9997 11.4479 10.9997 12.0002C10.9997 12.5525 11.4474 13.0002 11.9997 13.0002Z"})}),(0,v.jsx)("span",{className:`text-[10px] mt-1 ${"settings"===e?"font-bold":"font-semibold"}`,children:"Profilo"})]})]})},ch=({currentUser:e,users:t,onStartChat:r})=>{let[n,i]=(0,b.useState)(""),s=t.filter(t=>t.id!==e.id&&t.alias.toLowerCase().includes(n.toLowerCase()));return(0,v.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,v.jsxs)("header",{className:"bg-white pt-safe sticky top-0 z-10 transition-all",children:[(0,v.jsxs)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:[(0,v.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Utenti"}),(0,v.jsxs)("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full uppercase tracking-wide",children:[t.length," Online"]})]}),(0,v.jsx)("div",{className:"px-4 pb-3",children:(0,v.jsxs)("div",{className:"relative group",children:[(0,v.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,v.jsx)("input",{type:"text",placeholder:"Cerca utente per nome...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-50 border border-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm"}),n&&(0,v.jsx)("button",{onClick:()=>i(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),(0,v.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===s.length?(0,v.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,v.jsx)("p",{className:"text-center font-medium",children:n?"Nessun utente trovato.":"Nessun altro utente online al momento."})]}):(0,v.jsx)("ul",{className:"space-y-4",children:s.map(e=>(0,v.jsxs)("li",{className:"flex items-center gap-4 p-3 bg-white rounded-xl active:bg-gray-50 transition-colors border-b border-gray-50 last:border-0",children:[(0,v.jsxs)("div",{className:`w-12 h-12 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:[(0,v.jsx)("span",{className:"font-bold text-lg uppercase",children:e.alias.charAt(0)}),(0,v.jsx)("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"})]}),(0,v.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,v.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.alias}),(0,v.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.status||(0,v.jsx)("span",{className:"capitalize",children:e.gender})})]}),(0,v.jsx)("button",{onClick:()=>r(e),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]},e.id))})})]})},cp=({chats:e,onSelectChat:t,onDeleteChat:r})=>(0,v.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,v.jsx)("header",{className:"bg-white pt-safe sticky top-0 z-10",children:(0,v.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,v.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Chat private"})})}),(0,v.jsx)("main",{className:"flex-1 overflow-y-auto p-4 pb-[80px]",children:0===e.length?(0,v.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4",children:[(0,v.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,v.jsxs)("p",{className:"text-center font-medium",children:["Nessuna chat attiva.",(0,v.jsx)("br",{}),"Cerca utenti nella scheda Utenti."]})]}):(0,v.jsx)("ul",{className:"space-y-4",children:e.map(e=>{var n;return(0,v.jsxs)("li",{onClick:()=>t(e.peer.id),className:"flex items-center gap-4 p-3 bg-white hover:bg-gray-50 rounded-xl transition-colors cursor-pointer border-b border-gray-50 last:border-0",children:[(0,v.jsx)("div",{className:`w-14 h-14 rounded-full ${(e=>{switch(e){case"male":return"bg-blue-500";case"female":return"bg-pink-500";default:return"bg-purple-500"}})(e.peer.gender)} flex items-center justify-center text-white shrink-0 shadow-sm relative`,children:(0,v.jsx)("span",{className:"font-bold text-xl uppercase",children:e.peer.alias.charAt(0)})}),(0,v.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,v.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,v.jsx)("h3",{className:"font-bold text-gray-900 truncate text-base",children:e.peer.alias}),(0,v.jsx)("span",{className:"text-[11px] text-gray-400 font-medium",children:(e=>{if(0===e.length)return"";let t=new Date(e[e.length-1].timestamp),r=new Date;return t.toDateString()===r.toDateString()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{day:"2-digit",month:"2-digit"})})(e.messages)})]}),(0,v.jsx)("p",{className:"text-sm text-gray-500 truncate",children:0===(n=e.messages).length?"Inizia la conversazione...":n[n.length-1].text})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[e.unreadCount>0&&(0,v.jsx)("div",{className:"min-w-[20px] h-5 px-1.5 bg-emerald-500 rounded-full flex items-center justify-center",children:(0,v.jsx)("span",{className:"text-[10px] font-bold text-white",children:e.unreadCount})}),(0,v.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e.peer.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},e.peer.id)})})})]}),cf=ci("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),cm=ci("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),cg=({user:e,onLogout:t,onUpdateAlias:r,onUpdateStatus:n,tenantId:i})=>{let{isAdmin:s,isModerator:o}=cc(i),[a,l]=(0,b.useState)(!1),[u,c]=(0,b.useState)(!1),[d,h]=(0,b.useState)(e.alias),[p,f]=(0,b.useState)(e.status||""),m=()=>{d.trim()&&d!==e.alias&&r(d.trim()),l(!1)},g=()=>{p.trim()!==(e.status||"")&&n(p.trim()),c(!1)};return(0,v.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,v.jsx)("header",{className:"bg-white pt-safe sticky top-0 z-10",children:(0,v.jsx)("div",{className:"h-[60px] px-4 flex items-center",children:(0,v.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Profilo"})})}),(0,v.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,v.jsxs)("div",{className:"pb-32",children:[(0,v.jsxs)("div",{className:"py-8 flex flex-col items-center bg-white border-b border-gray-100",children:[(0,v.jsx)("div",{className:"relative group mb-4",children:(0,v.jsx)("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-sm overflow-hidden",children:(e.alias||e.name||"?").charAt(0).toUpperCase()})}),(0,v.jsxs)("div",{className:"flex flex-wrap gap-2 px-4 justify-center",children:[s&&(0,v.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-blue-50 text-blue-700 rounded-full border border-blue-100 shadow-sm animate-in fade-in slide-in-from-top-2 duration-500",children:[(0,v.jsx)(cf,{size:14,className:"fill-blue-100"}),(0,v.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Admin"})]}),o&&(0,v.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-purple-50 text-purple-700 rounded-full border border-purple-100 shadow-sm animate-in fade-in slide-in-from-top-2 duration-500",children:[(0,v.jsx)(cm,{size:14,className:"fill-purple-100"}),(0,v.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Moderatore"})]})]})]}),(0,v.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stato"}),(0,v.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,v.jsxs)("button",{onClick:()=>c(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,v.jsx)("div",{className:"flex flex-col items-start truncate overflow-hidden",children:u?(0,v.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),onBlur:g,onKeyDown:e=>"Enter"===e.key&&g(),maxLength:50,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,v.jsx)("span",{className:"text-[17px] text-gray-900 truncate overflow-hidden w-full text-left",children:e.status||"Disponibile"})}),(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alias"}),(0,v.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,v.jsxs)("button",{onClick:()=>l(!0),className:"w-full px-4 py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,v.jsx)("div",{className:"flex flex-col items-start",children:a?(0,v.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),onBlur:m,onKeyDown:e=>"Enter"===e.key&&m(),maxLength:20,className:"text-[17px] text-gray-900 focus:outline-none w-full bg-transparent",autoFocus:!0}):(0,v.jsx)("span",{className:"text-[17px] text-gray-900",children:e.alias||e.name||"User"})}),(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300 shrink-0 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5l7 7-7 7"})})]})})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"px-4 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Informazioni"}),(0,v.jsxs)("div",{className:"bg-white border-y border-gray-100 divide-y divide-gray-50",children:[(0,v.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-[17px] text-gray-400",children:"Sesso"}),(0,v.jsx)("span",{className:"text-[17px] text-gray-900 capitalize",children:{male:"maschio",female:"femmina",other:"altro"}[e.gender]||e.gender})]}),(0,v.jsxs)("div",{className:"px-4 py-3.5 flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-[17px] text-gray-400",children:"User ID"}),(0,v.jsx)("span",{className:"text-xs font-mono text-gray-400 uppercase tracking-wider",children:e.id})]})]})]}),(0,v.jsx)("div",{className:"pt-4",children:(0,v.jsx)("div",{className:"bg-white border-y border-gray-100",children:(0,v.jsx)("button",{onClick:t,className:"w-full px-4 py-4 flex items-center justify-center text-red-600 font-semibold text-lg hover:bg-red-50 transition-colors",children:"Esci"})})})]})]})})]})},cy=ci("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),cv=ci("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),cb=ci("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function cx({rooms:e,onSelectRoom:t,activeRoomId:r}){return(0,v.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-gray-900",children:[(0,v.jsx)("header",{className:"bg-white pt-safe sticky top-0 z-10 dark:bg-gray-900",children:(0,v.jsx)("div",{className:"h-[60px] px-4 flex items-center justify-between",children:(0,v.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Stanze"})})}),(0,v.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:e.map(e=>{let n="ANNOUNCEMENT"===e.type,i=e.id===r;return(0,v.jsxs)("button",{onClick:()=>t(e.id),className:`w-full flex items-center p-3 rounded-xl transition-all ${i?"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400":"hover:bg-gray-50 text-gray-700 dark:hover:bg-gray-800 dark:text-gray-300"}`,children:[(0,v.jsx)("div",{className:`p-2 rounded-full mr-3 ${i?"bg-blue-100 text-blue-600 dark:bg-blue-800 dark:text-blue-300":"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400"}`,children:(0,v.jsx)(n?cb:cv,{size:20})}),(0,v.jsxs)("div",{className:"flex-1 text-left",children:[(0,v.jsx)("h3",{className:"font-semibold text-base",children:e.name}),(0,v.jsx)("p",{className:"text-xs text-opacity-70 opacity-70 truncate max-w-[200px]",children:n?"Annunci e messaggi ufficiali":"Discussione generale e chat pubblica"})]}),(0,v.jsx)(cy,{size:16,className:"text-gray-400"})]},e.id)})})]})}function cw({tenant:e,initialMessages:t}){let[r,n]=(0,b.useState)(null),[i,s]=(0,b.useState)(null),{data:o,isPending:a}=o5(),{canManageTenant:l,isAdmin:u,isModerator:c}=cc(e.id,r?.id);(0,b.useEffect)(()=>{r&&console.log(`[ChatInterface] User: ${r.alias} (${r.id}), canManage: ${l}, isAdmin: ${u}, isModerator: ${c}`)},[r,l,u,c]);let[d,h]=(0,b.useState)("room"),[p,f]=(0,b.useState)(null),[y,x]=(0,b.useState)(null),[w,_]=(0,b.useState)(!1),[S,C]=(0,b.useState)([]),[T,E]=(0,b.useState)({}),[k,R]=(0,b.useState)(!1),z=(0,eJ.useQueryClient)(),{data:I=p?[]:t,isFetching:j}=function(e,t,r){let n,i=b.useContext(eK),s=b.useContext(eQ),o=(0,eJ.useQueryClient)(r),a=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a);let l=o.getQueryCache().get(a.queryHash);if(a._optimisticResults=i?"isRestoring":"optimistic",a.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=a.staleTime;a.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof a.gcTime&&(a.gcTime=Math.max(a.gcTime,1e3))}n=l?.state.error&&"function"==typeof a.throwOnError?(0,eH.shouldThrowError)(a.throwOnError,[l.state.error,l]):a.throwOnError,(a.suspense||a.experimental_prefetchInRender||n)&&!s.isReset()&&(a.retryOnMount=!1),b.useEffect(()=>{s.clearReset()},[s]);let u=!o.getQueryCache().get(a.queryHash),[c]=b.useState(()=>new t(o,a)),d=c.getOptimisticResult(a),h=!i&&!1!==e.subscribed;if(b.useSyncExternalStore(b.useCallback(e=>{let t=h?c.subscribe(eL.notifyManager.batchCalls(e)):eH.noop;return c.updateResult(),t},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),b.useEffect(()=>{c.setOptions(a)},[a,c]),a?.suspense&&d.isPending)throw eY(a,c,s);if((({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&void 0===e.data||(0,eH.shouldThrowError)(r,[e.error,n])))({result:d,errorResetBoundary:s,throwOnError:a.throwOnError,query:l,suspense:a.suspense}))throw d.error;if(o.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!eH.isServer&&d.isLoading&&d.isFetching&&!i){let e=u?eY(a,c,s):l?.promise;e?.catch(eH.noop).finally(()=>{c.updateResult()})}return a.notifyOnChangeProps?d:c.trackResult(d)}({queryKey:["messages","global",e.slug,p],queryFn:async()=>{let r=await e0.getMessages(!0,p||void 0);try{let t=new URLSearchParams({tenant:e.slug});p&&t.append("roomId",p);let r=await fetch(`${e$.API_BASE_URL}/api/messages?${t.toString()}`);if(r.ok){let e=await r.json();for(let t of e)await e0.saveMessage(t,!0);return e}}catch(e){console.warn("Failed to fetch from server, using local data",e)}return r.length>0?r:p?[]:t},initialData:p?void 0:t},eU,void 0);(0,b.useEffect)(()=>{if(console.log(`[Session] Loading: ${a}, User: ${o?.user?.id}, Name: ${o?.user?.name}`),!a&&o?.user){let e="true"===localStorage.getItem("waiting_for_passkey");if(console.log(`[Session] Waiting for passkey: ${e}`),e)return;let t={id:o.user.id,alias:o.user.name||"User",gender:o.user.gender||"other",status:o.user.status||"",phoneNumber:o.user.phoneNumber,joinedAt:new Date(o.user.createdAt).getTime()};console.log("[Session] Setting authenticated user:",t),n(e=>e&&e.id===t.id&&e.alias===t.alias&&e.gender===t.gender&&e.status===t.status?e:(localStorage.setItem("chat_user",JSON.stringify(t)),t))}},[o,a]),(0,b.useEffect)(()=>{{let e=localStorage.getItem("chat_user"),t="true"===localStorage.getItem("waiting_for_passkey");if(e&&!o&&!a&&!t)try{let t=JSON.parse(e);n(t),eX.Capacitor.isNativePlatform()&&e0.getPrivateChats(t.id).then(e=>{if(e.length>0){let r={};for(let n of e){let e=n.messages[n.messages.length-1];r[n.peerId]={peer:{id:n.peerId,alias:e.senderId===t.id?"Chat":e.senderAlias,gender:e.senderId===t.id?"other":e.senderGender,joinedAt:Date.now()},messages:n.messages,unread:0}}E(r),console.log(`Restored ${e.length} private chats from SQLite`)}}).catch(e=>console.error("Error restoring private chats:",e))}catch(e){console.error("Invalid saved user",e)}}let e=eX.Capacitor.getPlatform();document.documentElement.classList.add(`platform-${e}`)},[e.slug]);let O=!!r;(0,b.useEffect)(()=>{if(!eX.Capacitor.isNativePlatform())return;if(!r){document.body.style.backgroundColor="#ffffff",document.documentElement.style.backgroundColor="#ffffff";return}let e="room"===d||y?"#e5ddd5":"#ffffff";return document.body.style.backgroundColor=e,document.documentElement.style.backgroundColor=e,()=>{document.body.style.backgroundColor="#ffffff",document.documentElement.style.backgroundColor="#ffffff"}},[d,y,r]),(0,b.useEffect)(()=>{if(eX.Capacitor.isNativePlatform()&&O){let e,t;return e1.setResizeMode({mode:g.Body}).catch(e=>{console.error("Error setting keyboard resize mode",e)}),e1.setStyle({style:m.Light}).catch(e=>{console.warn("Error setting keyboard style",e)}),e1.setAccessoryBarVisible({isVisible:!1}).catch(()=>{}),(async()=>{e=await e1.addListener("keyboardDidShow",()=>{_(!0)}),t=await e1.addListener("keyboardDidHide",()=>{_(!1)})})(),()=>{e&&e.remove(),t&&t.remove()}}},[O]),(0,b.useEffect)(()=>{if(!r)return;let t=eA(e$.API_BASE_URL||void 0,{query:{tenantSlug:e.slug,userId:r.id},transports:["websocket"],reconnectionAttempts:5,timeout:1e4});return s(t),t.on("connect_error",e=>{console.error("[Socket] Connect Error:",e.message,e)}),t.on("error",e=>{console.error("[Socket] General Error:",e)}),t.on("connect",()=>{console.log("Socket connected"),R(!0),t.emit("join",{user:r,tenantSlug:e.slug})}),t.on("disconnect",()=>{R(!1)}),t.on("presenceUpdate",e=>{C(e)}),t.on("newMessage",async t=>{console.log("[Socket] New message received:",t.id,"Room:",t.roomId),await e0.saveMessage(t,!0),t.roomId?z.invalidateQueries({queryKey:["messages","global",e.slug,t.roomId]}):z.invalidateQueries({queryKey:["messages","global",e.slug,null]})}),t.on("messageDeleted",async t=>{console.log("[Socket] Message deleted:",t.messageId),await e0.deleteMessage(t.messageId);let r=["messages","global",e.slug,t.roomId||null];z.setQueryData(r,e=>(e||[]).filter(e=>e.id!==t.messageId))}),t.on("privateMessage",async e=>{let t=e.senderId===r.id,n=t?e.recipientId:e.senderId;await e0.saveMessage(e,!1),!t&&eX.Capacitor.isNativePlatform()&&e4.impact({style:e2.ImpactStyle.Light}).catch(()=>{}),E(r=>{let i=r[n]||{peer:{id:n,alias:t?"Unknown":e.senderAlias,gender:t?"male":e.senderGender,joinedAt:Date.now()},messages:[],unread:0};return i.messages.some(t=>t.id===e.id)?r:{...r,[n]:{...i,messages:[...i.messages,e],unread:i.unread+1}}})}),()=>{t.disconnect()}},[r,e.slug,z]),(0,b.useEffect)(()=>{"chats"===d&&y&&T[y]?.unread>0&&E(e=>({...e,[y]:{...e[y],unread:0}}))},[d,y,T]);let N=async()=>{o&&await o6(),n(null),s(null),localStorage.removeItem("chat_user"),E({}),e0.clearMessages(),z.setQueryData(["messages","global",e.slug],t),x(null),h("room")},A=(0,b.useCallback)(async t=>{if(!r||!i||!p)return;let n={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString(),roomId:p,tenantId:e.id};eX.Capacitor.isNativePlatform()&&e4.impact({style:e2.ImpactStyle.Light}).catch(()=>{}),await e0.saveMessage(n,!0),z.setQueryData(["messages","global",e.slug,p],e=>[...e||[],n]),i.emit("sendMessage",{...n,tenantSlug:e.slug})},[r,i,e.slug,p,z,e.id]),$=(0,b.useCallback)(t=>{i&&p&&i.emit("deleteMessage",{messageId:t,roomId:p,tenantSlug:e.slug})},[i,p,e.slug]),P=(0,b.useCallback)(async t=>{if(!r||!i||!y)return;let n={id:Date.now().toString(),text:t,senderId:r.id,senderAlias:r.alias,senderGender:r.gender,timestamp:new Date().toISOString(),recipientId:y};eX.Capacitor.isNativePlatform()&&e4.impact({style:e2.ImpactStyle.Light}).catch(()=>{}),await e0.saveMessage(n,!1),E(e=>({...e,[y]:{...e[y],messages:[...e[y].messages,n]}})),i.emit("sendMessage",{...n,tenantSlug:e.slug,isPrivate:!0})},[r,i,y,e.slug]),{swipeHandlers:L,swipeStyle:M,isDragging:B}=function({onSwipeBack:e,edgeWidth:t=30,threshold:r=100,enabled:n=!0}){let[i,s]=(0,b.useState)({isDragging:!1,translateX:0,opacity:1}),o=(0,b.useRef)(0),a=(0,b.useRef)(0),l=(0,b.useRef)(!1),u=(0,b.useRef)(!1);return{swipeHandlers:{onTouchStart:(0,b.useCallback)(e=>{if(!n)return;let r=e.touches[0];o.current=r.clientX,a.current=r.clientY,l.current=r.clientX<=t,u.current=!1,l.current&&s({isDragging:!0,translateX:0,opacity:1})},[n,t]),onTouchMove:(0,b.useCallback)(e=>{if(!n||!l.current||u.current)return;let t=e.touches[0],r=t.clientX-o.current;if(Math.abs(t.clientY-a.current)>30&&r<30){l.current=!1,s({isDragging:!1,translateX:0,opacity:1});return}if(r>0){let t=Math.min(.8*r,window.innerWidth),n=1-t/window.innerWidth*.3;s({isDragging:!0,translateX:t,opacity:n}),e.preventDefault()}},[n]),onTouchEnd:(0,b.useCallback)(()=>{if(!n||!l.current||u.current)return void s({isDragging:!1,translateX:0,opacity:1});let{translateX:t}=i;t>=r?(u.current=!0,s({isDragging:!1,translateX:window.innerWidth,opacity:0}),setTimeout(()=>{e(),s({isDragging:!1,translateX:0,opacity:1})},150)):s({isDragging:!1,translateX:0,opacity:1}),l.current=!1},[n,i,r,e])},swipeStyle:{transform:`translateX(${i.translateX}px)`,transition:i.isDragging?"none":"transform 0.2s ease-out, opacity 0.2s ease-out",opacity:i.opacity},isDragging:i.isDragging,translateX:i.translateX}}({onSwipeBack:()=>x(null),enabled:eX.Capacitor.isNativePlatform()&&null!==y});if(!r)return(0,v.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-white sm:bg-gray-50 flex-col",children:(0,v.jsx)(o7,{onLogin:e=>{n(e),localStorage.setItem("chat_user",JSON.stringify(e))},tenantName:e.name})});if(y&&"chats"===d){let e=T[y];return e?(0,v.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",style:M,...L,children:[B&&(0,v.jsx)("div",{className:"absolute inset-y-0 -left-8 w-8 bg-gradient-to-r from-black/10 to-transparent z-50 pointer-events-none"}),(0,v.jsx)("header",{className:"bg-white pt-safe text-gray-800 z-10 sticky top-0",children:(0,v.jsxs)("div",{className:"h-[60px] px-4 flex items-center gap-3",children:[(0,v.jsx)("button",{onClick:()=>x(null),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsx)("h2",{className:"font-bold text-lg leading-tight",children:e.peer.alias}),S.some(e=>e.id===y)&&(0,v.jsx)("span",{className:"text-xs text-emerald-500 font-medium",children:"Online"})]})]})}),(0,v.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,v.jsx)(cl,{user:r,messages:e.messages,onSendMessage:P,onlineCount:0,isOnline:!0,hideHeader:!0,showBottomNavPadding:!1,isFocused:w,isSyncing:!1})})]}):(x(null),null)}let D=Object.values(T).reduce((e,t)=>e+t.unread,0);return(0,v.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl mx-auto bg-white shadow-xl overflow-hidden relative",children:[(0,v.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:["room"===d&&!p&&(0,v.jsx)(cx,{rooms:e.rooms||[],onSelectRoom:f,activeRoomId:p||void 0}),"room"===d&&p&&(0,v.jsx)(cl,{user:r,messages:I,onSendMessage:A,onRemoveMessage:$,onlineCount:S.length,isOnline:k,headerTitle:e.rooms?.find(e=>e.id===p)?.name||e.name,showBottomNavPadding:!1,isFocused:w,onInputFocusChange:e=>{_(e)},isSyncing:j,isReadOnly:e.rooms?.find(e=>e.id===p)?.type==="ANNOUNCEMENT"&&!l,canModerate:l,onBack:()=>{f(null)}}),"users"===d&&(0,v.jsx)(ch,{currentUser:r,users:S,onStartChat:e=>{T[e.id]||E(t=>({...t,[e.id]:{peer:e,messages:[],unread:0}})),x(e.id),h("chats")}}),"chats"===d&&(0,v.jsx)(cp,{chats:Object.values(T).map(e=>({...e,unreadCount:e.unread})).sort((e,t)=>{let r=e.messages.length?new Date(e.messages[e.messages.length-1].timestamp).getTime():0;return(t.messages.length?new Date(t.messages[t.messages.length-1].timestamp).getTime():0)-r}),onSelectChat:x,onDeleteChat:e=>{E(t=>{let r={...t};return delete r[e],r}),y===e&&x(null)}}),"settings"===d&&(0,v.jsx)(cg,{user:r,onLogout:N,onUpdateAlias:t=>{if(!r||!i)return;let s={...r,alias:t};n(s),localStorage.setItem("chat_user",JSON.stringify(s)),i.emit("join",{user:s,tenantSlug:e.slug})},onUpdateStatus:t=>{if(!r||!i)return;let s={...r,status:t};n(s),localStorage.setItem("chat_user",JSON.stringify(s)),i.emit("join",{user:s,tenantSlug:e.slug})},tenantId:e.id})]}),(0,v.jsx)("div",{className:`border-t border-gray-100 bg-white z-20 overflow-hidden ${w||"room"===d&&p?"hidden":"block"}`,children:(0,v.jsx)(cd,{activeTab:d,onTabChange:e=>{if("admin"===e){window.location.href="/admin/dashboard";return}h(e),x(null),"room"!==e&&f(null)},usersCount:S.length,unreadChatsCount:D,tenantId:e.id})})]})}var c_=e.i(1647);function cS(){let e=(0,x.usePathname)(),t=e?.replace(/^\//,"")||"",[r,n]=(0,b.useState)(null),[i,s]=(0,b.useState)([]),[o,a]=(0,b.useState)(!0),[l,u]=(0,b.useState)(!1);return((0,b.useEffect)(()=>{if(!t){u(!0),a(!1);return}!async function(){try{let e=await (0,c_.clientGetTenantBySlug)(t);if(!e){u(!0),a(!1);return}n(e);let r=(await (0,c_.clientGetMessages)(t)).map(e=>({id:e.id,text:e.text,senderId:e.senderId||e.userId,senderAlias:e.senderAlias||e.user?.name||"Anonymous",senderGender:e.senderGender||"other",timestamp:new Date(e.timestamp||e.createdAt).toISOString()}));s(r),a(!1)}catch(e){console.error("Error loading chat data",e),u(!0),a(!1)}}()},[t]),o)?(0,v.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50",children:(0,v.jsx)("div",{className:"animate-pulse text-gray-400 font-medium",children:"Caricamento chat..."})}):((l||!r)&&(0,x.notFound)(),(0,v.jsx)("main",{className:"flex h-full flex-col items-center justify-between",children:(0,v.jsx)(cw,{tenant:r,initialMessages:i})}))}e.s(["default",()=>cS],95969)}]);